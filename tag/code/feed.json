{
    "version": "https://jsonfeed.org/version/1",
    "title": "Hexo • All posts by \"code\" tag",
    "description": "",
    "home_page_url": "https://enjundu.github.io",
    "items": [
        {
            "id": "https://enjundu.github.io/recommendation/Contrastive%20Learning%20for%20Sequential%20Recommendation%20%E4%B8%8E%20Self-Supervised%20Learning%20for%20Sequential%20Recommendation%20with%20Mutual%20Information%20Maximization/",
            "url": "https://enjundu.github.io/recommendation/Contrastive%20Learning%20for%20Sequential%20Recommendation%20%E4%B8%8E%20Self-Supervised%20Learning%20for%20Sequential%20Recommendation%20with%20Mutual%20Information%20Maximization/",
            "title": "Contrastive Learning for Sequential Recommendation",
            "date_published": "2024-08-04T01:41:31.000Z",
            "content_html": "<h1 id=\"阅读报告contrastive-learning-for-sequential-recommendation-与-self-supervised-learning-for-sequential-recommendation-with-mutual-information-maximization\"><a class=\"anchor\" href=\"#阅读报告contrastive-learning-for-sequential-recommendation-与-self-supervised-learning-for-sequential-recommendation-with-mutual-information-maximization\">#</a> 阅读报告：Contrastive Learning for Sequential Recommendation 与 Self-Supervised Learning for Sequential Recommendation with Mutual Information Maximization</h1>\n<hr />\n<h2 id=\"1-概述\"><a class=\"anchor\" href=\"#1-概述\">#</a> 1. 概述</h2>\n<p>本文综述了两种用于顺序推荐的自监督学习方法：对比学习用于顺序推荐（CL4SRec）和自监督学习用于顺序推荐（S3-Rec）。这两种方法旨在解决数据稀疏性问题，提高推荐系统的性能。CL4SRec 通过对比学习框架生成自监督信号，而 S3-Rec 则通过用户行为序列和项目属性的融合生成自监督信号。</p>\n<h2 id=\"2-cl4srec\"><a class=\"anchor\" href=\"#2-cl4srec\">#</a> 2. CL4SRec</h2>\n<h3 id=\"21-数据稀疏性问题\"><a class=\"anchor\" href=\"#21-数据稀疏性问题\">#</a> 2.1 数据稀疏性问题</h3>\n<p>在许多实际应用中，数据集中存在大量缺失数据或零值数据，导致数据集非常稀疏，难以有效地进行数据分析和建模。</p>\n<h3 id=\"22-对比学习框架\"><a class=\"anchor\" href=\"#22-对比学习框架\">#</a> 2.2 对比学习框架</h3>\n<p>CL4SRec 模型采用对比学习框架，通过用户交互序列的数据增强和用户表征编码器，生成自监督信号，从而提高用户表示的质量。</p>\n<h3 id=\"23-数据增强方法\"><a class=\"anchor\" href=\"#23-数据增强方法\">#</a> 2.3 数据增强方法</h3>\n<ul>\n<li>\n<p><strong>项目裁剪（Item Crop）</strong>：从用户的历史行为序列中随机选择一个连续的子序列，提供用户历史行为的局部视图。公式如下：<br />\n[<br />\ns^{crop}<em crop=\"\">u = a</em>(s_u) = [v_c, v_{c+1}, \\ldots, v_{c+L_c-1}]<br />\n]<br />\n 其中，(L_c = \\left\\lfloor \\eta \\cdot |s_u| \\right\\rfloor)。</p>\n</li>\n<li>\n<p><strong>项目掩码（Item Mask）</strong>：随机遮掩用户历史行为序列中的部分项目，用特殊标记 [mask] 替换。公式如下：<br />\n[<br />\ns^{mask}<em mask=\"\">u = a</em>(s_u) = [\\hat{v}<em su=\"\">1, \\hat{v}<em |s_u|=\"\">2, \\ldots, \\hat{v}</em>]<br />\n]<br />\n 其中：<br />\n[<br />\n\\hat{v}<em su=\"\">t = \\begin{cases}<br />\nv_t &amp; \\text{if } t \\notin T</em> \\<br />\n\\text{[mask]} &amp; \\text{if } t \\in T</em><br />\n\\end{cases}<br />\n]<br />\n 其中，(T_{su} = (t_1, t_2, \\ldots, t_{L_m})) 且 (L_m = \\left\\lfloor \\gamma \\cdot |s_u| \\right\\rfloor)。</p>\n</li>\n<li>\n<p><strong>项目重排序（Item Reorder）</strong>：随机打乱用户历史行为序列中的项目顺序，使模型能够捕捉到用户行为序列中项目之间的长距离依赖关系。公式如下：<br />\n[<br />\ns^{reorder}<em reorder=\"\">u = a</em>(s_u) = [v_1, v_2, \\ldots, \\hat{v}<em i+L_r-1=\"\">i, \\ldots, \\hat{v}</em>, \\ldots, v_{|s_u|}]<br />\n]<br />\n 其中，(\\hat {v}_i) 是随机打乱后的子序列，(L_r = \\left\\lfloor \\beta \\cdot |s_u| \\right\\rfloor)。</p>\n</li>\n</ul>\n<h3 id=\"24-用户表示模型\"><a class=\"anchor\" href=\"#24-用户表示模型\">#</a> 2.4 用户表示模型</h3>\n<p>CL4SRec 模型通过堆叠多个 Transformer 编码器层来对用户的历史行为序列进行编码，最终输出用户在时间戳上的表示，用于预测用户下一步最可能交互的物品。</p>\n<h3 id=\"25-多任务训练\"><a class=\"anchor\" href=\"#25-多任务训练\">#</a> 2.5 多任务训练</h3>\n<p>采用联合优化的方法，通过主要损失和对比损失的线性加权和进行优化，从而提高模型的推荐性能。总损失函数为：<br />\n[<br />\nL_<ruby>total} = L_{main} + \\lambda L_{cl}\n\\]\n其中，主要损失函数 \\(L_{main}\\) 为每个用户在每个时间步的负对数似然：\n\\[\nL_{main}(s_{u,t}) = - \\log \\frac {\\exp (s_{u,t}<rp>(</rp><rt>\\top v^+_{t+1</rt><rp>)</rp></ruby>)}<ruby>\\exp(s_{u,t}<rp>(</rp><rt>\\top v^+_{t+1</rt><rp>)</rp></ruby>) + \\sum_<ruby>v<rp>(</rp><rt>-_{t+1</rt><rp>)</rp></ruby> \\in V^-} \\exp(s_<ruby>u,t}<rp>(</rp><rt>\\top v^-_{t+1</rt><rp>)</rp></ruby>)}<br />\n]<br />\n 对比损失函数 (L_<ruby>cl}\\) <rt></rt>为<rp> (</rp><rt>{a_i</rt><rp>)</rp>：\n\\[\nL_{cl}(s<rt></rt></ruby>_u, s^<ruby>a_j}_u) = - \\log \\frac{\\exp(\\text{sim}(s<rp>(</rp><rt>{a_i</rt><rp>)</rp></ruby>_u, s^<ruby>a_j}_u))}{\\exp(\\text{sim}(s<rp>(</rp><rt>{a_i</rt><rp>)</rp></ruby>_u, s^<ruby>a_j}_u)) + \\sum_{s<rp>(</rp><rt>- \\in S^-</rt><rp>)</rp></ruby> \\exp(\\text<ruby>sim}(s<rp>(</rp><rt>{a_i</rt><rp>)</rp></ruby>_u, s^-))}<br />\n]</p>\n<h2 id=\"3-s3-rec\"><a class=\"anchor\" href=\"#3-s3-rec\">#</a> 3. S3-Rec</h2>\n<h3 id=\"31-自监督学习框架\"><a class=\"anchor\" href=\"#31-自监督学习框架\">#</a> 3.1 自监督学习框架</h3>\n<p>S3-Rec 模型利用自监督学习方法，通过用户行为序列和项目属性的融合，生成自监督信号，从而提高推荐系统的性能。</p>\n<h3 id=\"32-数据增强方法\"><a class=\"anchor\" href=\"#32-数据增强方法\">#</a> 3.2 数据增强方法</h3>\n<p>S3-Rec 的主要数据增强方法与 CL4SRec 类似，包括项目裁剪、项目掩码和项目重排序。</p>\n<h2 id=\"4-实验\"><a class=\"anchor\" href=\"#4-实验\">#</a> 4. 实验</h2>\n<p>实验结果表明，CL4SRec 和 S3-Rec 在处理数据稀疏性问题上表现出色，显著提高了推荐系统的性能。特别是在 Top-K 命中率（HR@K）、归一化折扣累计增益（NDCG@K）和平均倒数排名（MRR）等指标上，两种方法均表现出较大的改进。</p>\n<h3 id=\"41-数据集\"><a class=\"anchor\" href=\"#41-数据集\">#</a> 4.1 数据集</h3>\n<p>使用了来自 Amazon 和 Yelp 的四个公共数据集：Beauty、Sports、Yelp 和 MovieLens-1M。每个数据集经过预处理以确保每个用户和项目至少有 5 条交互记录（5-core）。</p>\n<h3 id=\"42-评估指标\"><a class=\"anchor\" href=\"#42-评估指标\">#</a> 4.2 评估指标</h3>\n<p>采用命中率（HR）和归一化折扣累计增益（NDCG）来评估每种方法的性能。</p>\n<h3 id=\"43-实验结果\"><a class=\"anchor\" href=\"#43-实验结果\">#</a> 4.3 实验结果</h3>\n<p>实验结果表明，CL4SRec 和 S3-Rec 在所有数据集上的所有评估指标上均显著优于现有的基线方法，验证了该方法在顺序推荐任务中的有效性。特别是 CL4SRec，在数据稀疏的数据集上表现尤为显著。</p>\n<h2 id=\"5-结论\"><a class=\"anchor\" href=\"#5-结论\">#</a> 5. 结论</h2>\n<p>CL4SRec 和 S3-Rec 通过引入对比学习和自监督学习框架，显著提升了顺序推荐任务中的用户表示质量和推荐性能。未来可以进一步探索更多类型的数据增强方法，并将这些模型应用于其他类型的推荐系统中，以验证其通用性和适用性。</p>\n<h2 id=\"6-未来工作\"><a class=\"anchor\" href=\"#6-未来工作\">#</a> 6. 未来工作</h2>\n<p>未来可以进一步探索更多类型的数据增强方法，并将这些模型应用于其他类型的推荐系统中，以验证其通用性和适用性。</p>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        },
        {
            "id": "https://enjundu.github.io/recommendation/Self-Supervised%20Learning%20for%20Sequential%20Recommendation%20with%20Mutual%20Information%20/",
            "url": "https://enjundu.github.io/recommendation/Self-Supervised%20Learning%20for%20Sequential%20Recommendation%20with%20Mutual%20Information%20/",
            "title": "S3-Rec:Self-Supervised Learning for Sequential Recommendation with Mutual Information Maximization",
            "date_published": "2024-07-29T11:25:31.000Z",
            "content_html": "<h1 id=\"基于互信息最大化的自监督学习序列推荐\"><a class=\"anchor\" href=\"#基于互信息最大化的自监督学习序列推荐\">#</a> 基于互信息最大化的自监督学习序列推荐</h1>\n<h2 id=\"相关知识\"><a class=\"anchor\" href=\"#相关知识\">#</a> 相关知识</h2>\n<ul>\n<li>互信息最大化 (MIM) 原理来学习属性、项目、子序列和序列之间的相关性</li>\n<li>MIM 提供了一种统一的方法来表征不同类型数据之间的相关性</li>\n<li>连续推荐任务</li>\n<li>自注意力机制</li>\n<li>自监督学习</li>\n<li>语言建模</li>\n<li>相互信息最大化</li>\n</ul>\n<h2 id=\"其他文章不足\"><a class=\"anchor\" href=\"#其他文章不足\">#</a> 其他文章不足</h2>\n<p>依赖于项目预测损失来学习整个模型。当加入上下文数据时，所涉及的参数也是通过唯一的优化目标来学习的。研究发现，这种优化方式很容易受到数据稀疏性等问题的困扰</p>\n<h2 id=\"本文内容\"><a class=\"anchor\" href=\"#本文内容\">#</a> 本文内容</h2>\n<ul>\n<li>新颖的自监督学习方法，以改进具有 MIM 的序列推荐</li>\n<li>精心设计了四个自监督优化目标，分别用于捕获项目 - 属性、序列 - 项目、序列 - 属性和序列子序列相关性</li>\n<li>将 MIM 的自监督学习应用于改进顺序推荐任务</li>\n<li>提出了四个自监督优化目标，以最大化不同形式或粒度的上下文信息的互信息</li>\n<li>首次将上下文信息中的相关性视为顺序推荐中的自监督信号。</li>\n</ul>\n<h2 id=\"keywords\"><a class=\"anchor\" href=\"#keywords\">#</a> Keywords</h2>\n<p><strong>自监督学习、顺序推荐、相互信息最大化</strong></p>\n<h2 id=\"大纲\"><a class=\"anchor\" href=\"#大纲\">#</a> 大纲</h2>\n<h4 id=\"模型概述\"><a class=\"anchor\" href=\"#模型概述\">#</a> 模型概述:</h4>\n<ul>\n<li>\n<p><strong>架构:</strong> 基于自注意力神经网络。</p>\n</li>\n<li>\n<p>预训练:</p>\n<p>包含四个辅助自监督学习目标，以改进数据表示：</p>\n<ol>\n<li><strong>关联属性预测 (AAP)</strong></li>\n<li><strong>掩码项预测 (MIP)</strong></li>\n<li><strong>掩码属性预测 (MAP)</strong></li>\n<li><strong>片段预测 (SP)</strong></li>\n</ol>\n</li>\n<li>\n<p><strong>微调:</strong> 使用预训练阶段学到的参数进行推荐任务的微调。</p>\n</li>\n</ul>\n<h4 id=\"自监督学习目标\"><a class=\"anchor\" href=\"#自监督学习目标\">#</a> 自监督学习目标:</h4>\n<ol>\n<li><strong>关联属性预测 (AAP):</strong>\n<ul>\n<li>最大化物品和其属性之间的互信息。</li>\n<li>促进模型学习更好的属性感知的物品表示。</li>\n</ul>\n</li>\n<li><strong>掩码项预测 (MIP):</strong>\n<ul>\n<li>使用双向上下文预测序列中的掩码项。</li>\n<li>增强序列和物品之间的关联。</li>\n</ul>\n</li>\n<li><strong>掩码属性预测 (MAP):</strong>\n<ul>\n<li>使用序列上下文预测掩码项的属性。</li>\n<li>直接融合属性信息和序列上下文。</li>\n</ul>\n</li>\n<li><strong>片段预测 (SP):</strong>\n<ul>\n<li>预测序列中的掩码片段。</li>\n<li>帮助捕捉更稳定的用户偏好。</li>\n</ul>\n</li>\n</ol>\n<h4 id=\"实验\"><a class=\"anchor\" href=\"#实验\">#</a> 实验:</h4>\n<ul>\n<li><strong>数据集:</strong> 在六个不同领域的数据集上进行实验。</li>\n<li><strong>基准:</strong> 与十一种基准模型进行比较。</li>\n<li><strong>评估指标:</strong> 命中率 (HR)，归一化折扣累积增益 (NDCG)，以及平均倒排等级 (MRR)。</li>\n</ul>\n<h4 id=\"结果\"><a class=\"anchor\" href=\"#结果\">#</a> 结果:</h4>\n<ul>\n<li><strong>性能:</strong> S3-Rec 始终优于基准方法。</li>\n<li><strong>消融研究:</strong> 每个自监督目标都对性能提升有贡献。</li>\n<li><strong>广泛适用性:</strong> 自监督学习不仅能改进 S3-Rec，还能改进其他模型。</li>\n<li><strong>数据稀疏:</strong> S3-Rec 即使在训练数据有限的情况下也表现出色。</li>\n<li><strong>收敛速度:</strong> 由于预训练表示的增强，模型收敛速度更快。</li>\n</ul>\n<h4 id=\"结论\"><a class=\"anchor\" href=\"#结论\">#</a> 结论:</h4>\n<ul>\n<li>S3-Rec 利用自监督学习和互信息最大化原则，通过增强数据表示改进序列推荐。</li>\n<li>未来工作包括探索其他形式的自监督优化目标，并将该方法应用于更复杂的推荐任务。</li>\n</ul>\n<h1 id=\"有关概念解释\"><a class=\"anchor\" href=\"#有关概念解释\">#</a> 有关概念解释</h1>\n<h2 id=\"互信息最大化-mim-原理\"><a class=\"anchor\" href=\"#互信息最大化-mim-原理\">#</a> 互信息最大化 (MIM) 原理</h2>\n<h3 id=\"概念介绍\"><a class=\"anchor\" href=\"#概念介绍\">#</a> 概念介绍</h3>\n<p><strong>互信息（Mutual Information, MI）</strong> 是一种用来衡量两个随机变量之间相互依赖程度的度量。互信息可以反映一个随机变量对另一个随机变量的不确定性减少的程度。形式上，互信息<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo separator=\"true\">;</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">I(X;Y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span></span></span></span> 定义为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>I</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo separator=\"true\">;</mo><mi>Y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">∣</mi><mi>Y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>Y</mi><mi mathvariant=\"normal\">∣</mi><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">I(X;Y)=H(X)-H(X|Y)=H(Y)-H(Y|X)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>其中，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">H(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span> 是随机变量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 的熵，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">∣</mi><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">H(X|Y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span></span></span></span> 是在给定<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 条件下<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 的条件熵。</p>\n<p><strong>互信息最大化</strong> 的基本思想是通过最大化两个变量的互信息来学习数据表示，这可以有效地捕捉数据的内在结构和依赖关系。在机器学习和深度学习中，互信息最大化常用于自监督学习，通过利用数据本身的结构来生成训练信号，而不需要额外的标签数据。</p>\n<h4 id=\"熵\"><a class=\"anchor\" href=\"#熵\">#</a> 熵</h4>\n<p>熵是用于衡量一个随机变量不确定性的度量。对于离散随机变量 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>, 其熵定义为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi mathvariant=\"script\">X</mi></mrow></munder><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">H(X)=-\\sum_{x\\in\\mathcal{X}}p(x)\\log p(x)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3717110000000003em;vertical-align:-1.321706em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8556639999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.14643em;\">X</span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.321706em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">X</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{X}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.14643em;\">X</span></span></span></span></span> 是随机变量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 的所有可能取值的集合</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> 是<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 取值为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 的概率</li>\n<li>熵越大表示随机变量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 的不确定性越高，信息量也就越大</li>\n</ul>\n<h4 id=\"条件熵\"><a class=\"anchor\" href=\"#条件熵\">#</a> 条件熵</h4>\n<p>条件熵是指在已知另一个随机变量 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 已知的情况下，随机变量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 的不确定性。对于离散随机变量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 和<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span>，其条件熵定义为:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">∣</mi><mi>Y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><mi>y</mi><mo>∈</mo><mi mathvariant=\"script\">Y</mi></mrow></munder><mi>p</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi mathvariant=\"script\">X</mi></mrow></munder><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mi mathvariant=\"normal\">∣</mi><mi>y</mi><mo stretchy=\"false\">)</mo><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mi mathvariant=\"normal\">∣</mi><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">H(X|Y)=-\\sum_{y\\in\\mathcal{Y}}p(y)\\sum_{x\\in\\mathcal{X}}p(x|y)\\log p(x|y)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.480449em;vertical-align:-1.430444em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8556639999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.08222em;\">Y</span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.430444em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8556639999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.14643em;\">X</span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.321706em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">X</mi><mtext>和</mtext><mi mathvariant=\"script\">Y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{X}和\\mathcal{Y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78055em;vertical-align:-0.09722em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.14643em;\">X</span></span><span class=\"mord cjk_fallback\">和</span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.08222em;\">Y</span></span></span></span></span> 分别是随机变量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mtext>和</mtext><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">X和Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord cjk_fallback\">和</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 的所有可能取值的集合</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span> 是<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 取值为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> 的概率</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mi mathvariant=\"normal\">∣</mi><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(x|y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span> 是在<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">Y=y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> 条件下<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 取值为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 的条件概率</li>\n<li>条件熵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">∣</mi><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">H(X|Y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span></span></span></span> 衡量了在已知<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 的条件下，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 的剩余不确定性。如果<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mtext>和</mtext><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">X和Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord cjk_fallback\">和</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 完全独立，条件熵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">∣</mi><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">H(X|Y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span></span></span></span> 就等于<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 的熵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">H(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span></li>\n</ul>\n<h3 id=\"实现互信息最大化的方法\"><a class=\"anchor\" href=\"#实现互信息最大化的方法\">#</a> 实现互信息最大化的方法</h3>\n<p>直接最大化互信息通常是不可行的，因为计算互信息需要知道数据的真实分布，这在实际中很难获得。因此，研究人员提出了一些变分方法来近似最大化互信息。常用的方法之一是基于 <strong>Noise Contrastive Estimation (NCE)</strong> 的 <strong>InfoNCE</strong> 损失函数。</p>\n<h4 id=\"infonce损失函数\"><a class=\"anchor\" href=\"#infonce损失函数\">#</a> InfoNCE 损失函数</h4>\n<p>InfoNCE 是一种有效的变分下界，用于估计和最大化互信息。其定义如下：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>InfoNCE</mtext><mo>=</mo><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></msub><mrow><mo fence=\"true\">[</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></msub><mrow><mo fence=\"true\">[</mo><munder><mo>∑</mo><msup><mi>y</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></munder><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><msup><mi>y</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><mo fence=\"true\">]</mo></mrow><mo>+</mo><mi>log</mi><mo>⁡</mo><mi mathvariant=\"normal\">∣</mi><mi>Y</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">\\text{InfoNCE}=\\mathbb{E}_{p(x,y)}\\left[f_\\theta(x,y)-\\log\\mathbb{E}_{q(y)}\\left[\\sum_{y&#x27;}\\exp(f_\\theta(x,y&#x27;))\\right]\\right]+\\log|Y|\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord text\"><span class=\"mord\">InfoNCE</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.6010299999999997em;vertical-align:-1.55002em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">E</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0510099999999998em;\"><span style=\"top:-2.2500000000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.8099900000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎢</span></span></span><span style=\"top:-4.05101em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55002em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">E</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0510099999999998em;\"><span style=\"top:-2.2500000000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.8099900000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎢</span></span></span><span style=\"top:-4.05101em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55002em;\"><span></span></span></span></span></span></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8560149999999997em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6828285714285715em;\"><span style=\"top:-2.786em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.430093em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.801892em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0510099999999998em;\"><span style=\"top:-2.2500000000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.8099900000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎥</span></span></span><span style=\"top:-4.05101em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55002em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0510099999999998em;\"><span style=\"top:-2.2500000000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.8099900000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎥</span></span></span><span style=\"top:-4.05101em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55002em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mord\">∣</span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>θ</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_{\\theta}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是一个参数化的打分函数（例如两个嵌入的点积）</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 是负样本的集合</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{E}_{p(x,y)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04409em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">E</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span></span></span></span> 是期望值，表示对联合分布<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span> 的期望值</li>\n</ul>\n<h3 id=\"代码实现\"><a class=\"anchor\" href=\"#代码实现\">#</a> 代码实现</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> torch</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch.nn <span class=\"keyword\">as</span> nn</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch.optim <span class=\"keyword\">as</span> optim</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义打分函数</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ScoreFunction</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, input_dim</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(ScoreFunction, self).__init__()</span><br><span class=\"line\">        self.linear = nn.Linear(input_dim, input_dim)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x, y</span>):</span><br><span class=\"line\">        <span class=\"comment\"># 计算 x 和 y 之间的打分</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> torch.<span class=\"built_in\">sum</span>(x * self.linear(y), dim=-<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># InfoNCE 损失函数</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">info_nce_loss</span>(<span class=\"params\">x, y, neg_samples</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    x: 正样本的嵌入</span></span><br><span class=\"line\"><span class=\"string\">    y: 目标正样本的嵌入</span></span><br><span class=\"line\"><span class=\"string\">    neg_samples: 负样本的嵌入集合</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    pos_score = score_fn(x, y)</span><br><span class=\"line\">    neg_scores = torch.stack([score_fn(x, neg_y) <span class=\"keyword\">for</span> neg_y <span class=\"keyword\">in</span> neg_samples], dim=<span class=\"number\">0</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 计算 InfoNCE 损失</span></span><br><span class=\"line\">    loss = -torch.mean(pos_score - torch.logsumexp(neg_scores, dim=<span class=\"number\">0</span>))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> loss</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 示例数据</span></span><br><span class=\"line\">batch_size = <span class=\"number\">32</span></span><br><span class=\"line\">embedding_dim = <span class=\"number\">128</span></span><br><span class=\"line\">x = torch.randn(batch_size, embedding_dim)  <span class=\"comment\"># 正样本</span></span><br><span class=\"line\">y = torch.randn(batch_size, embedding_dim)  <span class=\"comment\"># 目标正样本</span></span><br><span class=\"line\">neg_samples = [torch.randn(batch_size, embedding_dim) <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">5</span>)]  <span class=\"comment\"># 负样本集合</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始化打分函数</span></span><br><span class=\"line\">score_fn = ScoreFunction(embedding_dim)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义优化器</span></span><br><span class=\"line\">optimizer = optim.Adam(score_fn.parameters(), lr=<span class=\"number\">0.001</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 训练步骤</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> epoch <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">100</span>):</span><br><span class=\"line\">    optimizer.zero_grad()</span><br><span class=\"line\">    loss = info_nce_loss(x, y, neg_samples)</span><br><span class=\"line\">    loss.backward()</span><br><span class=\"line\">    optimizer.step()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (epoch + <span class=\"number\">1</span>) % <span class=\"number\">10</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Epoch [<span class=\"subst\">&#123;epoch + <span class=\"number\">1</span>&#125;</span>/100], Loss: <span class=\"subst\">&#123;loss.item():<span class=\"number\">.4</span>f&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"连续推荐任务概述\"><a class=\"anchor\" href=\"#连续推荐任务概述\">#</a> 连续推荐任务概述</h2>\n<h3 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h3>\n<p>连续推荐任务（Sequential Recommendation）是推荐系统中的一个重要分支，旨在根据用户的历史行为序列来预测用户接下来可能感兴趣的物品。这类任务通常应用于电子商务、视频推荐、音乐推荐等领域，通过捕捉用户行为的时间序列模式来提高推荐的准确性和相关性。</p>\n<h3 id=\"典型方法\"><a class=\"anchor\" href=\"#典型方法\">#</a> 典型方法</h3>\n<ol>\n<li><strong>基于 Markov Chain 的方法</strong>：使用马尔可夫链来建模用户行为的转移概率。</li>\n<li><strong>基于 RNN 的方法</strong>：使用递归神经网络（如 GRU、LSTM）来捕捉用户行为序列中的长短期依赖关系。</li>\n<li><strong>基于 Transformer 的方法</strong>：使用自注意力机制来建模用户行为序列，能够更好地捕捉全局依赖关系。</li>\n</ol>\n<h2 id=\"自注意力机制-self-attention-mechanism\"><a class=\"anchor\" href=\"#自注意力机制-self-attention-mechanism\">#</a> 自注意力机制 Self-Attention Mechanism</h2>\n<h3 id=\"概念介绍-2\"><a class=\"anchor\" href=\"#概念介绍-2\">#</a> 概念介绍</h3>\n<p>自注意力机制是一种在序列建模任务中广泛应用的技术，它能够在处理输入序列时，动态地为序列中的每个元素分配不同的权重，从而捕捉全局的依赖关系。自注意力机制通过计算序列中每个位置的输入对其他所有位置输入的相关性，来决定各个位置的重要性。</p>\n<h3 id=\"公式\"><a class=\"anchor\" href=\"#公式\">#</a> 公式</h3>\n<p><img data-src=\"https://s2.loli.net/2024/07/29/RagSuCB8ULHpPst.png\" alt=\"QQ_1722266181765.png\" /></p>\n<h3 id=\"示例代码\"><a class=\"anchor\" href=\"#示例代码\">#</a> 示例代码</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> torch</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch.nn <span class=\"keyword\">as</span> nn</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch.nn.functional <span class=\"keyword\">as</span> F</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">SelfAttention</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, embed_size, heads</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(SelfAttention, self).__init__()</span><br><span class=\"line\">        self.embed_size = embed_size</span><br><span class=\"line\">        self.heads = heads</span><br><span class=\"line\">        self.head_dim = embed_size // heads</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> (</span><br><span class=\"line\">            self.head_dim * heads == embed_size</span><br><span class=\"line\">        ), <span class=\"string\">&quot;Embedding size needs to be divisible by heads&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        self.values = nn.Linear(self.head_dim, self.head_dim, bias=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        self.keys = nn.Linear(self.head_dim, self.head_dim, bias=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        self.queries = nn.Linear(self.head_dim, self.head_dim, bias=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        self.fc_out = nn.Linear(heads * self.head_dim, embed_size)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, values, keys, query, mask</span>):</span><br><span class=\"line\">        N = query.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">        value_len, key_len, query_len = values.shape[<span class=\"number\">1</span>], keys.shape[<span class=\"number\">1</span>], query.shape[<span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Split the embedding into self.heads different pieces</span></span><br><span class=\"line\">        values = values.reshape(N, value_len, self.heads, self.head_dim)</span><br><span class=\"line\">        keys = keys.reshape(N, key_len, self.heads, self.head_dim)</span><br><span class=\"line\">        queries = query.reshape(N, query_len, self.heads, self.head_dim)</span><br><span class=\"line\"></span><br><span class=\"line\">        values = self.values(values)</span><br><span class=\"line\">        keys = self.keys(keys)</span><br><span class=\"line\">        queries = self.queries(queries)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Scaled dot-product attention</span></span><br><span class=\"line\">        energy = torch.einsum(<span class=\"string\">&quot;nqhd,nkhd-&gt;nhqk&quot;</span>, [queries, keys])</span><br><span class=\"line\">        <span class=\"keyword\">if</span> mask <span class=\"keyword\">is</span> <span class=\"keyword\">not</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">            energy = energy.masked_fill(mask == <span class=\"number\">0</span>, <span class=\"built_in\">float</span>(<span class=\"string\">&quot;-1e20&quot;</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        attention = torch.softmax(energy / (self.embed_size ** (<span class=\"number\">1</span> / <span class=\"number\">2</span>)), dim=<span class=\"number\">3</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        out = torch.einsum(<span class=\"string\">&quot;nhql,nlhd-&gt;nqhd&quot;</span>, [attention, values]).reshape(</span><br><span class=\"line\">            N, query_len, self.heads * self.head_dim</span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        out = self.fc_out(out)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> out</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">TransformerBlock</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, embed_size, heads, dropout, forward_expansion</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(TransformerBlock, self).__init__()</span><br><span class=\"line\">        self.attention = SelfAttention(embed_size, heads)</span><br><span class=\"line\">        self.norm1 = nn.LayerNorm(embed_size)</span><br><span class=\"line\">        self.norm2 = nn.LayerNorm(embed_size)</span><br><span class=\"line\"></span><br><span class=\"line\">        self.feed_forward = nn.Sequential(</span><br><span class=\"line\">            nn.Linear(embed_size, forward_expansion * embed_size),</span><br><span class=\"line\">            nn.ReLU(),</span><br><span class=\"line\">            nn.Linear(forward_expansion * embed_size, embed_size),</span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        self.dropout = nn.Dropout(dropout)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, value, key, query, mask</span>):</span><br><span class=\"line\">        attention = self.attention(value, key, query, mask)</span><br><span class=\"line\"></span><br><span class=\"line\">        x = self.dropout(self.norm1(attention + query))</span><br><span class=\"line\">        forward = self.feed_forward(x)</span><br><span class=\"line\">        out = self.dropout(self.norm2(forward + x))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> out</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Transformer</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\">        self,</span></span><br><span class=\"line\"><span class=\"params\">        embed_size,</span></span><br><span class=\"line\"><span class=\"params\">        num_layers,</span></span><br><span class=\"line\"><span class=\"params\">        heads,</span></span><br><span class=\"line\"><span class=\"params\">        device,</span></span><br><span class=\"line\"><span class=\"params\">        forward_expansion,</span></span><br><span class=\"line\"><span class=\"params\">        dropout,</span></span><br><span class=\"line\"><span class=\"params\">        vocab_size,</span></span><br><span class=\"line\"><span class=\"params\">        max_length,</span></span><br><span class=\"line\"><span class=\"params\">    </span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(Transformer, self).__init__()</span><br><span class=\"line\">        self.embed_size = embed_size</span><br><span class=\"line\">        self.device = device</span><br><span class=\"line\">        self.word_embedding = nn.Embedding(vocab_size, embed_size)</span><br><span class=\"line\">        self.position_embedding = nn.Embedding(max_length, embed_size)</span><br><span class=\"line\"></span><br><span class=\"line\">        self.layers = nn.ModuleList(</span><br><span class=\"line\">            [</span><br><span class=\"line\">                TransformerBlock(</span><br><span class=\"line\">                    embed_size,</span><br><span class=\"line\">                    heads,</span><br><span class=\"line\">                    dropout=dropout,</span><br><span class=\"line\">                    forward_expansion=forward_expansion,</span><br><span class=\"line\">                )</span><br><span class=\"line\">                <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(num_layers)</span><br><span class=\"line\">            ]</span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        self.fc_out = nn.Linear(embed_size, vocab_size)</span><br><span class=\"line\">        self.dropout = nn.Dropout(dropout)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x, mask</span>):</span><br><span class=\"line\">        N, seq_length = x.shape</span><br><span class=\"line\">        positions = torch.arange(<span class=\"number\">0</span>, seq_length).expand(N, seq_length).to(self.device)</span><br><span class=\"line\">        out = self.dropout(self.word_embedding(x) + self.position_embedding(positions))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> layer <span class=\"keyword\">in</span> self.layers:</span><br><span class=\"line\">            out = layer(out, out, out, mask)</span><br><span class=\"line\"></span><br><span class=\"line\">        out = self.fc_out(out)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> out</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 示例用法</span></span><br><span class=\"line\">device = torch.device(<span class=\"string\">&quot;cuda&quot;</span> <span class=\"keyword\">if</span> torch.cuda.is_available() <span class=\"keyword\">else</span> <span class=\"string\">&quot;cpu&quot;</span>)</span><br><span class=\"line\">vocab_size = <span class=\"number\">10000</span></span><br><span class=\"line\">embed_size = <span class=\"number\">256</span></span><br><span class=\"line\">num_layers = <span class=\"number\">6</span></span><br><span class=\"line\">heads = <span class=\"number\">8</span></span><br><span class=\"line\">dropout = <span class=\"number\">0.1</span></span><br><span class=\"line\">forward_expansion = <span class=\"number\">4</span></span><br><span class=\"line\">max_length = <span class=\"number\">100</span></span><br><span class=\"line\">batch_size = <span class=\"number\">32</span></span><br><span class=\"line\">seq_length = <span class=\"number\">50</span></span><br><span class=\"line\"></span><br><span class=\"line\">model = Transformer(embed_size, num_layers, heads, device, forward_expansion, dropout, vocab_size, max_length).to(device)</span><br><span class=\"line\">x = torch.randint(<span class=\"number\">0</span>, vocab_size, (batch_size, seq_length)).to(device)</span><br><span class=\"line\">mask = <span class=\"literal\">None</span>  <span class=\"comment\"># 示例中没有使用mask</span></span><br><span class=\"line\">out = model(x, mask)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(out.shape)</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"自监督学习self-supervised-learning\"><a class=\"anchor\" href=\"#自监督学习self-supervised-learning\">#</a> 自监督学习（Self-Supervised Learning）</h2>\n<h3 id=\"简介-2\"><a class=\"anchor\" href=\"#简介-2\">#</a> 简介</h3>\n<p>自监督学习是一种机器学习方法，<strong>通过从未标注的数据中生成监督信号来训练模型</strong>。与监督学习不同，自监督学习不依赖于人工标注的数据集，而是通过设计预训练任务（如预测输入数据的一部分）来生成训练信号。自监督学习广泛应用于图像处理、自然语言处理等领域，能够有效地利用大量未标注数据进行模型预训练，从而在下游任务中实现更好的性能。</p>\n<h3 id=\"公式-2\"><a class=\"anchor\" href=\"#公式-2\">#</a> 公式</h3>\n<p>自监督学习的目标是通过预训练任务来学习数据的有效表示。假设我们有一个输入数据 $ x<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>，自监督学习通过设计预训练任务</mtext></mrow><annotation encoding=\"application/x-tex\">，自监督学习通过设计预训练任务</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">，</span><span class=\"mord cjk_fallback\">自</span><span class=\"mord cjk_fallback\">监</span><span class=\"mord cjk_fallback\">督</span><span class=\"mord cjk_fallback\">学</span><span class=\"mord cjk_fallback\">习</span><span class=\"mord cjk_fallback\">通</span><span class=\"mord cjk_fallback\">过</span><span class=\"mord cjk_fallback\">设</span><span class=\"mord cjk_fallback\">计</span><span class=\"mord cjk_fallback\">预</span><span class=\"mord cjk_fallback\">训</span><span class=\"mord cjk_fallback\">练</span><span class=\"mord cjk_fallback\">任</span><span class=\"mord cjk_fallback\">务</span></span></span></span> T<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>，从</mtext></mrow><annotation encoding=\"application/x-tex\">，从</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">，</span><span class=\"mord cjk_fallback\">从</span></span></span></span> x <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>中生成目标</mtext></mrow><annotation encoding=\"application/x-tex\">中生成目标</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">中</span><span class=\"mord cjk_fallback\">生</span><span class=\"mord cjk_fallback\">成</span><span class=\"mord cjk_fallback\">目</span><span class=\"mord cjk_fallback\">标</span></span></span></span> y$，并通过最小化以下损失函数来训练模型：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"script\">L</mi><mo>=</mo><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>∼</mo><mi>D</mi></mrow></msub><mrow><mo fence=\"true\">[</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}=\\mathbb{E}_{(x,y)\\sim D}\\left[\\ell(f(x),y)\\right]\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">L</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1052em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">E</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose mtight\">)</span><span class=\"mrel mtight\">∼</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">[</span><span class=\"mord\">ℓ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\">]</span></span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">L</span></span></span></span></span> 是数据分布</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">ℓ</mi></mrow><annotation encoding=\"application/x-tex\">\\ell</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord\">ℓ</span></span></span></span> 是损失函数</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> 是模型</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> 是通过预训练任务从<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 中生成的目标</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>∼</mo><mi>D</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{E}_{(x,y)\\sim D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04409em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">E</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose mtight\">)</span><span class=\"mrel mtight\">∼</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span></span></span></span> 表示对联合分布<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span> 上的期望值。\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">E</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{E}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68889em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">E</span></span></span></span></span> 表示期望值</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>∼</mo><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">(x,y)\\sim D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span> 表示从联合分布<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span> 中抽取的样本对<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>。这里的<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 表示输入数据，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> 表示输入数据生成的目标。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"示例代码-2\"><a class=\"anchor\" href=\"#示例代码-2\">#</a> 示例代码</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> torch</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch.nn <span class=\"keyword\">as</span> nn</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch.optim <span class=\"keyword\">as</span> optim</span><br><span class=\"line\"><span class=\"keyword\">from</span> torch.utils.data <span class=\"keyword\">import</span> DataLoader, Dataset</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义数据集</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">TextDataset</span>(<span class=\"title class_ inherited__\">Dataset</span>):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, text, seq_length</span>):</span><br><span class=\"line\">        chars = <span class=\"built_in\">sorted</span>(<span class=\"built_in\">list</span>(<span class=\"built_in\">set</span>(text)))</span><br><span class=\"line\">        self.char_to_idx = &#123;ch: idx <span class=\"keyword\">for</span> idx, ch <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(chars)&#125;</span><br><span class=\"line\">        self.idx_to_char = &#123;idx: ch <span class=\"keyword\">for</span> idx, ch <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(chars)&#125;</span><br><span class=\"line\">        self.vocab_size = <span class=\"built_in\">len</span>(chars)</span><br><span class=\"line\">        self.data = [self.char_to_idx[ch] <span class=\"keyword\">for</span> ch <span class=\"keyword\">in</span> text]</span><br><span class=\"line\">        self.seq_length = seq_length</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__len__</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">len</span>(self.data) - self.seq_length</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__getitem__</span>(<span class=\"params\">self, idx</span>):</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (</span><br><span class=\"line\">            torch.tensor(self.data[idx:idx+self.seq_length], dtype=torch.long),</span><br><span class=\"line\">            torch.tensor(self.data[idx+<span class=\"number\">1</span>:idx+self.seq_length+<span class=\"number\">1</span>], dtype=torch.long),</span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义模型</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">CharRNN</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, vocab_size, embed_size, hidden_size, num_layers</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(CharRNN, self).__init__()</span><br><span class=\"line\">        self.embedding = nn.Embedding(vocab_size, embed_size)</span><br><span class=\"line\">        self.rnn = nn.LSTM(embed_size, hidden_size, num_layers, batch_first=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        self.fc = nn.Linear(hidden_size, vocab_size)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x</span>):</span><br><span class=\"line\">        x = self.embedding(x)</span><br><span class=\"line\">        output, _ = self.rnn(x)</span><br><span class=\"line\">        output = self.fc(output)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> output</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 示例文本数据</span></span><br><span class=\"line\">text = <span class=\"string\">&quot;hello world&quot;</span></span><br><span class=\"line\">seq_length = <span class=\"number\">5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建数据集和数据加载器</span></span><br><span class=\"line\">dataset = TextDataset(text, seq_length)</span><br><span class=\"line\">dataloader = DataLoader(dataset, batch_size=<span class=\"number\">2</span>, shuffle=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 模型、损失函数和优化器</span></span><br><span class=\"line\">vocab_size = dataset.vocab_size</span><br><span class=\"line\">embed_size = <span class=\"number\">8</span></span><br><span class=\"line\">hidden_size = <span class=\"number\">16</span></span><br><span class=\"line\">num_layers = <span class=\"number\">2</span></span><br><span class=\"line\">model = CharRNN(vocab_size, embed_size, hidden_size, num_layers)</span><br><span class=\"line\">criterion = nn.CrossEntropyLoss()</span><br><span class=\"line\">optimizer = optim.Adam(model.parameters(), lr=<span class=\"number\">0.001</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 训练过程</span></span><br><span class=\"line\">num_epochs = <span class=\"number\">100</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> epoch <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(num_epochs):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> inputs, targets <span class=\"keyword\">in</span> dataloader:</span><br><span class=\"line\">        outputs = model(inputs)</span><br><span class=\"line\">        loss = criterion(outputs.view(-<span class=\"number\">1</span>, vocab_size), targets.view(-<span class=\"number\">1</span>))</span><br><span class=\"line\">        optimizer.zero_grad()</span><br><span class=\"line\">        loss.backward()</span><br><span class=\"line\">        optimizer.step()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (epoch + <span class=\"number\">1</span>) % <span class=\"number\">10</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Epoch [<span class=\"subst\">&#123;epoch + <span class=\"number\">1</span>&#125;</span>/<span class=\"subst\">&#123;num_epochs&#125;</span>], Loss: <span class=\"subst\">&#123;loss.item():<span class=\"number\">.4</span>f&#125;</span>&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 推断示例</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">generate_text</span>(<span class=\"params\">model, start_seq, length, dataset</span>):</span><br><span class=\"line\">    model.<span class=\"built_in\">eval</span>()</span><br><span class=\"line\">    <span class=\"keyword\">with</span> torch.no_grad():</span><br><span class=\"line\">        input_seq = torch.tensor([dataset.char_to_idx[ch] <span class=\"keyword\">for</span> ch <span class=\"keyword\">in</span> start_seq], dtype=torch.long).unsqueeze(<span class=\"number\">0</span>)</span><br><span class=\"line\">        generated_text = start_seq</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(length):</span><br><span class=\"line\">            output = model(input_seq)</span><br><span class=\"line\">            _, predicted_idx = torch.<span class=\"built_in\">max</span>(output[:, -<span class=\"number\">1</span>, :], dim=<span class=\"number\">1</span>)</span><br><span class=\"line\">            predicted_char = dataset.idx_to_char[predicted_idx.item()]</span><br><span class=\"line\">            generated_text += predicted_char</span><br><span class=\"line\">            input_seq = torch.cat((input_seq[:, <span class=\"number\">1</span>:], predicted_idx.unsqueeze(<span class=\"number\">0</span>).unsqueeze(<span class=\"number\">1</span>)), dim=<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> generated_text</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 生成文本</span></span><br><span class=\"line\">start_seq = <span class=\"string\">&quot;hello&quot;</span></span><br><span class=\"line\">generated_text = generate_text(model, start_seq, <span class=\"number\">5</span>, dataset)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Generated text: <span class=\"subst\">&#123;generated_text&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"cloze学习策略\"><a class=\"anchor\" href=\"#cloze学习策略\">#</a> Cloze 学习策略</h2>\n<p>Cloze 学习策略是一种基于填空任务的自然语言处理技术，通常用于训练语言模型和增强文本理解能力。其核心思想是从文本中随机掩盖（或移除）某些词汇，并要求模型根据上下文来预测这些被掩盖的词汇。Cloze 任务的主要目的是让模型学习语言的上下文信息，提高其在文本生成和理解任务中的表现。</p>\n<h3 id=\"cloze-学习策略的原理\"><a class=\"anchor\" href=\"#cloze-学习策略的原理\">#</a> Cloze 学习策略的原理</h3>\n<p><strong>数据预处理</strong>：从大量文本数据中随机选择一些词汇进行掩盖，形成训练样本。</p>\n<p><strong>模型训练</strong>：使用语言模型（如 BERT、GPT 等）对这些掩盖的词汇进行预测，训练模型根据上下文信息来填补这些缺失的部分。</p>\n<p><strong>损失函数计算</strong>：计算模型预测的词汇与实际词汇之间的差异，通常使用交叉熵损失函数。</p>\n<p><strong>模型优化</strong>：通过反向传播算法更新模型参数，使得模型能够更好地根据上下文信息进行词汇预测。</p>\n<h3 id=\"代码实现基于bert模型\"><a class=\"anchor\" href=\"#代码实现基于bert模型\">#</a> 代码实现（基于 BERT 模型）</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> torch</span><br><span class=\"line\"><span class=\"keyword\">from</span> transformers <span class=\"keyword\">import</span> BertTokenizer, BertForMaskedLM</span><br><span class=\"line\"><span class=\"keyword\">from</span> torch.utils.data <span class=\"keyword\">import</span> DataLoader, Dataset</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 自定义数据集</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ClozeDataset</span>(<span class=\"title class_ inherited__\">Dataset</span>):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, texts, tokenizer, max_length=<span class=\"number\">512</span></span>):</span><br><span class=\"line\">        self.texts = texts</span><br><span class=\"line\">        self.tokenizer = tokenizer</span><br><span class=\"line\">        self.max_length = max_length</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__len__</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">len</span>(self.texts)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__getitem__</span>(<span class=\"params\">self, idx</span>):</span><br><span class=\"line\">        text = self.texts[idx]</span><br><span class=\"line\">        encoding = self.tokenizer(text, return_tensors=<span class=\"string\">&#x27;pt&#x27;</span>, max_length=self.max_length, truncation=<span class=\"literal\">True</span>, padding=<span class=\"string\">&#x27;max_length&#x27;</span>)</span><br><span class=\"line\">        input_ids = encoding[<span class=\"string\">&#x27;input_ids&#x27;</span>].squeeze()</span><br><span class=\"line\">        attention_mask = encoding[<span class=\"string\">&#x27;attention_mask&#x27;</span>].squeeze()</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># 随机掩盖一些词</span></span><br><span class=\"line\">        labels = input_ids.clone()</span><br><span class=\"line\">        rand = torch.rand(input_ids.shape)</span><br><span class=\"line\">        mask_arr = (rand &lt; <span class=\"number\">0.15</span>) * (input_ids != <span class=\"number\">101</span>) * (input_ids != <span class=\"number\">102</span>) * (input_ids != <span class=\"number\">0</span>)  <span class=\"comment\"># 不掩盖特殊标记</span></span><br><span class=\"line\">        selection = torch.flatten(mask_arr.nonzero()).tolist()</span><br><span class=\"line\">        input_ids[selection] = <span class=\"number\">103</span>  <span class=\"comment\"># 掩盖的词替换为 [MASK] 标记</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">            <span class=\"string\">&#x27;input_ids&#x27;</span>: input_ids,</span><br><span class=\"line\">            <span class=\"string\">&#x27;attention_mask&#x27;</span>: attention_mask,</span><br><span class=\"line\">            <span class=\"string\">&#x27;labels&#x27;</span>: labels</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 准备数据</span></span><br><span class=\"line\">texts = [<span class=\"string\">&quot;Hello, how are you?&quot;</span>, <span class=\"string\">&quot;I am fine, thank you.&quot;</span>, <span class=\"string\">&quot;What is your name?&quot;</span>]</span><br><span class=\"line\">tokenizer = BertTokenizer.from_pretrained(<span class=\"string\">&#x27;bert-base-uncased&#x27;</span>)</span><br><span class=\"line\">dataset = ClozeDataset(texts, tokenizer)</span><br><span class=\"line\">dataloader = DataLoader(dataset, batch_size=<span class=\"number\">2</span>, shuffle=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 加载模型</span></span><br><span class=\"line\">model = BertForMaskedLM.from_pretrained(<span class=\"string\">&#x27;bert-base-uncased&#x27;</span>)</span><br><span class=\"line\">model.train()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义优化器</span></span><br><span class=\"line\">optimizer = torch.optim.AdamW(model.parameters(), lr=<span class=\"number\">1e-5</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 训练模型</span></span><br><span class=\"line\">epochs = <span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> epoch <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(epochs):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> batch <span class=\"keyword\">in</span> dataloader:</span><br><span class=\"line\">        optimizer.zero_grad()</span><br><span class=\"line\">        input_ids = batch[<span class=\"string\">&#x27;input_ids&#x27;</span>]</span><br><span class=\"line\">        attention_mask = batch[<span class=\"string\">&#x27;attention_mask&#x27;</span>]</span><br><span class=\"line\">        labels = batch[<span class=\"string\">&#x27;labels&#x27;</span>]</span><br><span class=\"line\">        </span><br><span class=\"line\">        outputs = model(input_ids=input_ids, attention_mask=attention_mask, labels=labels)</span><br><span class=\"line\">        loss = outputs.loss</span><br><span class=\"line\">        loss.backward()</span><br><span class=\"line\">        optimizer.step()</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;Epoch: <span class=\"subst\">&#123;epoch + <span class=\"number\">1</span>&#125;</span>, Loss: <span class=\"subst\">&#123;loss.item()&#125;</span>&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;Training complete&quot;</span>)</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"s3-rec\"><a class=\"anchor\" href=\"#s3-rec\">#</a> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>S</mi><mn>3</mn></msup><mo>−</mo><mi>R</mi><mi>e</mi><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">S^3-Rec</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.897438em;vertical-align:-0.08333em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">c</span></span></span></span></h1>\n<h2 id=\"基础符号概念\"><a class=\"anchor\" href=\"#基础符号概念\">#</a> 基础符号概念</h2>\n<ul>\n<li>用户<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.09931em;\">U</span></span></span></span></span> 和物品<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">I</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{I}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.07382em;\">I</span></span></span></span></span> 按时间顺序排列的互动序列为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">{i_1,...,i_n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>，其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 是互动次数，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80952em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是与用户<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> 互动的第 t 个物品</li>\n<li i_j,...,i_k\\=\"\">用<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mrow><mi>j</mi><mo>:</mo><mi>k</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">i_{j:k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9456279999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">:</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 表示子序列\\</li>\n<li>每个项目<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 与多个属性<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"script\">A</mi><mi>i</mi></msub><mo>=</mo><mo stretchy=\"false\">{</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>a</mi><mi>m</mi></msub><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal A_i=\\{a_1,...,a_m\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">}</span></span></span></span> 相关（例如，一首歌曲通常带有艺术家、专辑、音乐推荐器流行度等辅助信息）</li>\n<li>所有的属性构成属性集<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathcal\">A</span></span></span></span></li>\n<li>如果给定用户的历史行为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{i_1,...,i_n\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">}</span></span></span></span> 和每个项目<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 的属性<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">A_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，顺序推荐的任务是预测用户在第<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 步可能与之交互的下一个项目</li>\n</ul>\n<h2 id=\"mim相互信息最大化\"><a class=\"anchor\" href=\"#mim相互信息最大化\">#</a> MIM—— 相互信息最大化</h2>\n<ul>\n<li>\n<p>简单理解：给定两个随机变量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mtext>和</mtext><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">X和Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord cjk_fallback\">和</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span>，MIM 可以理解为如果知道了<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 可以减少多少<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 的不确定性</p>\n</li>\n<li>\n<p>公式如下:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>I</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo separator=\"true\">,</mo><mi>Y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">∣</mi><mi>Y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>Y</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>Y</mi><mi mathvariant=\"normal\">∣</mi><mi>X</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">I(X,Y)=H(X)-H(X|Y)=H(Y)-H(Y|X).\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mord\">.</span></span></span></span></span></p>\n<p><strong>熵</strong>是用于衡量一个随机变量不确定性的度量。对于离散随机变量 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>, 其熵定义为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi mathvariant=\"script\">X</mi></mrow></munder><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">H(X)=-\\sum_{x\\in\\mathcal{X}}p(x)\\log p(x)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3717110000000003em;vertical-align:-1.321706em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8556639999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.14643em;\">X</span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.321706em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">X</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{X}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.14643em;\">X</span></span></span></span></span> 是随机变量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 的所有可能取值的集合</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> 是<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 取值为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 的概率</li>\n<li>熵越大表示随机变量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 的不确定性越高，信息量也就越大</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"infonce\"><a class=\"anchor\" href=\"#infonce\">#</a> InfoNCE</h3>\n<p>实践证明，一个特定下限<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mi>n</mi><mi>f</mi><mi>o</mi><mi>N</mi><mi>C</mi><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">InfoNCE</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span> 对于求 MIM 表现很好，其基于噪声对比估计（NCE）</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>I</mi><mi>n</mi><mi>f</mi><mi>o</mi><mi>N</mi><mi>C</mi><mi>E</mi><mo>=</mo><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo separator=\"true\">,</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">[</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>Y</mi><mo>~</mo></mover><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">[</mo><mi>log</mi><mo>⁡</mo><munder><mo>∑</mo><mrow><mover accent=\"true\"><mi>y</mi><mo>~</mo></mover><mo>∈</mo><mover accent=\"true\"><mi>Y</mi><mo>~</mo></mover></mrow></munder><mi>exp</mi><mo>⁡</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mover accent=\"true\"><mi>y</mi><mo>~</mo></mover><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">]</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mi mathvariant=\"normal\">∣</mi><mover accent=\"true\"><mi>Y</mi><mo>~</mo></mover><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">InfoNCE=\\mathbb{E}_{p(X,Y)}[f_{\\theta}(x,y)-\\mathbb{E}_{q(\\tilde{Y})}[\\log\\sum_{\\tilde{y}\\in\\tilde{Y}}\\exp f_{\\theta}(x,\\tilde{y})]]+\\log|\\tilde{Y}|\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1052em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">E</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.6462510000000004em;vertical-align:-1.5962459999999998em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">E</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.4006670000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen mtight\">(</span><span class=\"mord accent mtight\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-2.7em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">Y</span></span></span><span style=\"top:-3.3023300000000004em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord mtight\">~</span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.47433299999999984em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0500050000000003em;\"><span style=\"top:-1.689862em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord accent mtight\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-2.7em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.0500000000000003em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord mtight\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mrel mtight\">∈</span><span class=\"mord accent mtight\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-2.7em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">Y</span></span></span><span style=\"top:-3.3023300000000004em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord mtight\">~</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5962459999999998em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">]</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1701899999999998em;vertical-align:-0.25em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">∣</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span><span style=\"top:-3.6023300000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span></span></p>\n<ul>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>θ</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_{\\theta}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是一个参数化的打分函数（例如两个嵌入的点积），用于计算<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 和<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> 之间的相关性</p>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 是负样本的集合</p>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{E}_{p(x,y)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04409em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">E</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span></span></span></span> 是期望值，表示对联合分布<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span> 的期望值，即在整个数据分布上计算平均值。</p>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>Y</mi><mo>~</mo></mover><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">[</mo><mi>log</mi><mo>⁡</mo><msub><mo>∑</mo><mrow><mover accent=\"true\"><mi>y</mi><mo>~</mo></mover><mo>∈</mo><mover accent=\"true\"><mi>Y</mi><mo>~</mo></mover></mrow></msub><mi>exp</mi><mo>⁡</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mover accent=\"true\"><mi>y</mi><mo>~</mo></mover><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{E}_{q(\\tilde{Y})}[\\log\\sum_{\\tilde{y}\\in\\tilde{Y}}\\exp f_{\\theta}(x,\\tilde{y})]]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.224333em;vertical-align:-0.47433299999999984em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">E</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.4006670000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen mtight\">(</span><span class=\"mord accent mtight\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-2.7em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">Y</span></span></span><span style=\"top:-3.3023300000000004em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord mtight\">~</span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.47433299999999984em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3444229999999998em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord accent mtight\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-2.7em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.0500000000000003em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord mtight\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mrel mtight\">∈</span><span class=\"mord accent mtight\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-2.7em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">Y</span></span></span><span style=\"top:-3.3023300000000004em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord mtight\">~</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.43581800000000004em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">]</span><span class=\"mclose\">]</span></span></span></span>：表示对负样本分布<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>y</mi><mo>~</mo></mover><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q(\\tilde y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 上的期望值</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"script\">Y</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathcal {Y}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.01741em;vertical-align:-0.09722em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.08222em;\">Y</span></span></span></span><span style=\"top:-3.6023300000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.09722em;\"><span></span></span></span></span></span></span></span></span> 表示负样本集合，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8622999999999998em;vertical-align:-0.19444em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span></span></span></span> 是从负样本集合中抽取的样本</li>\n<li>这部分用于衡量 x 与负样本集合 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"script\">Y</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathcal{Y}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.01741em;vertical-align:-0.09722em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.08222em;\">Y</span></span></span></span><span style=\"top:-3.6023300000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.09722em;\"><span></span></span></span></span></span></span></span></span> 中每个负样本 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8622999999999998em;vertical-align:-0.19444em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span></span></span></span> 之间的相似度之和，通过对数归一化处理。</li>\n</ul>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi mathvariant=\"normal\">∣</mi><mover accent=\"true\"><mi mathvariant=\"script\">Y</mi><mo>~</mo></mover><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">log|\\tilde{\\mathcal {Y}}|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1701899999999998em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord\">∣</span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.08222em;\">Y</span></span></span></span><span style=\"top:-3.6023300000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.09722em;\"><span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span>:</p>\n<ul>\n<li>是一个归一化常数，表示负样本集合<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"script\">Y</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\mathcal {Y}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.01741em;vertical-align:-0.09722em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.08222em;\">Y</span></span></span></span><span style=\"top:-3.6023300000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.09722em;\"><span></span></span></span></span></span></span></span></span> 的大小</li>\n<li>用于平衡不同大小的负样本集合带来的影响</li>\n</ul>\n<h4 id=\"概念解释\"><a class=\"anchor\" href=\"#概念解释\">#</a> 概念解释</h4>\n<h5 id=\"正样本\"><a class=\"anchor\" href=\"#正样本\">#</a> 正样本</h5>\n<p>正样本是指在特定任务中符合目标或条件的数据样本。换句话说，正样本是模型应该识别或预测的目标。例如：</p>\n<ul>\n<li>在二分类任务中，正样本是被分类为目标类别的数据。例如，在垃圾邮件检测任务中，正样本是那些被标记为垃圾邮件的邮件。</li>\n<li>在推荐系统中，正样本是用户实际点击或购买的物品。例如，某用户点击了一部电影，那么这部电影对于该用户来说就是正样本。</li>\n<li>在图像识别任务中，如果目标是识别狗的图像，那么所有被标记为狗的图像都是正样本。</li>\n</ul>\n<h5 id=\"负样本\"><a class=\"anchor\" href=\"#负样本\">#</a> 负样本</h5>\n<p>负样本是指在特定任务中不符合目标或条件的数据样本。负样本是模型应该排除或不识别为目标的数据。例如：</p>\n<ul>\n<li>在二分类任务中，负样本是被分类为非目标类别的数据。例如，在垃圾邮件检测任务中，负样本是那些被标记为非垃圾邮件的邮件。</li>\n<li>在推荐系统中，负样本是用户没有点击或购买的物品。例如，某用户没有点击的一部电影，那么这部电影对于该用户来说就是负样本。</li>\n<li>在图像识别任务中，如果目标是识别狗的图像，那么所有被标记为非狗的图像都是负样本。</li>\n</ul>\n</li>\n</ul>\n<p>由于<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mi>n</mi><mi>f</mi><mi>o</mi><mi>N</mi><mi>C</mi><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">InfoNCE</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span> 与交叉熵相关，如果<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>Y</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9201899999999998em;vertical-align:0em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span><span style=\"top:-3.6023300000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span> 始终包含随机变量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> 的所有可能值，即<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>Y</mi><mo>~</mo></mover><mo>=</mo><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">\\tilde Y=Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9201899999999998em;vertical-align:0em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span><span style=\"top:-3.6023300000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span>, 并且它们是均匀分布，那么最大化<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mi>n</mi><mi>f</mi><mi>o</mi><mi>N</mi><mi>C</mi><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">InfoNCE</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span> 就类似于交叉熵损失了：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo separator=\"true\">,</mo><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo stretchy=\"false\">[</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><munder><mo>∑</mo><mrow><mover accent=\"true\"><mi>x</mi><mo>~</mo></mover><mo>∈</mo><mi>V</mi></mrow></munder><mi>exp</mi><mo>⁡</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mover accent=\"true\"><mi>y</mi><mo>~</mo></mover><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{E}_{p(X,Y)}[f_\\theta(x,y)-\\log\\sum_{\\tilde{x}\\in V}\\exp f_\\theta(x,\\tilde{y})].\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1052em;vertical-align:-0.3551999999999999em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">E</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3717110000000003em;vertical-align:-1.321706em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8556639999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord accent mtight\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-2.7em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span><span style=\"top:-3.0500000000000003em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"accent-body\" style=\"left:-0.22222em;\"><span class=\"mord mtight\">~</span></span></span></span></span></span></span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.321706em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">]</span><span class=\"mord\">.</span></span></span></span></span></p>\n<p>该方程表明<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mi>n</mi><mi>f</mi><mi>o</mi><mi>N</mi><mi>C</mi><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">InfoNCE</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span> 与最大化的<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mi mathvariant=\"normal\">∣</mi><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p_\\theta(y|x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> 有关，该式为在模型参数为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span> 的情况下<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> 在条件<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 下的概率分布函数。</p>\n<h2 id=\"方法\"><a class=\"anchor\" href=\"#方法\">#</a> 方法</h2>\n<ul>\n<li>结合几个精心设计的自监督学习目标来增强原始模型</li>\n<li>利用输入的内在特征中反映的有效相关信号</li>\n<li>考虑不同粒度级别的信息，包括属性、项目、段（即子序列）和序列，它们被视为输入的不同视图</li>\n<li>通过堆叠嵌入层、自注意力块和预测层来开发顺序推荐模型的基本框架。</li>\n</ul>\n<h3 id=\"嵌入层\"><a class=\"anchor\" href=\"#嵌入层\">#</a> 嵌入层</h3>\n<ul k\\times=\"\" d=\"\">\n<li>在嵌入映射阶段维护一个项目嵌入矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">M</mi><mi>I</mi></msub><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi mathvariant=\"normal\">∣</mi><mi>I</mi><mi mathvariant=\"normal\">∣</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}_{I}\\in\\mathbb{R}^{|I|\\times d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83611em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">M</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8879999999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">∣</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mtight\">∣</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span> 和一个属性嵌入矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">M</mi><mi>A</mi></msub><mo><mover><mo><mo>∈</mo></mo><mrow></mrow></mover></mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"script\">A</mi><mi mathvariant=\"normal\">∣</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}_{A}\\stackrel{}{\\in}\\mathbb{R}^{|\\mathcal{A}|\\times d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9891000000000001em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">M</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\"><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8391000000000001em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">∈</span></span></span><span style=\"top:-3.7391em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0391em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8879999999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">∣</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\">A</span></span><span class=\"mord mtight\">∣</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span></li>\n<li n\\times=\"\" d=\"\">当给定一个长度为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 的序列时，在<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>M</mi><mi>I</mi></msub></mrow><annotation encoding=\"application/x-tex\">M_I</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 上应用查找操作来形成输入嵌入矩阵E{\\in}\\mathbb{R}^</li>\n<li>引入可学习的位置编码矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo lspace=\"0em\" rspace=\"0em\">∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>n</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">P{\\in}\\mathbb{R}^{n\\times d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8882079999999999em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mrel\">∈</span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span> 来增强项目序列的输入表示</li>\n<li>基于此，序列表示<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>E</mi><mi>I</mi></msub><mo lspace=\"0em\" rspace=\"0em\">∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>n</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">E_I{\\in}\\mathbb{R}^{n\\times d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9991079999999999em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mrel\">∈</span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span> 可以表示为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>E</mi><mi>I</mi></msub><mo>=</mo><mi>E</mi><mo>+</mo><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">E_I=E+P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span></li>\n<li>由于任务利用了辅助上下文数据，我们还需要从整个属性嵌入矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>M</mi><mi>A</mi></msub></mrow><annotation encoding=\"application/x-tex\">M_A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 中为每个项目形成一个嵌入矩阵E_A{\\in}\\mathbb{R}^</li>\n</ul>\n<h3 id=\"自注意力块\"><a class=\"anchor\" href=\"#自注意力块\">#</a> 自注意力块</h3>\n<ul>\n<li>\n<p>在嵌入层的基础上通过堆叠多个自注意力块来开发项目编码器。</p>\n</li>\n<li>\n<p>自注意力块通常由两个子层组成 —— 多头自注意力层和逐点前馈网络</p>\n</li>\n<li>\n<p>采用多头自注意力机制，可以有效地从不同的表示子空间中选择性地提取信息，定义如下：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow><mi mathvariant=\"normal\">M</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">H</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">d</mi><mi mathvariant=\"normal\">A</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">n</mi></mrow><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">F</mi><mi>l</mi></msup><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">[</mo><mi>h</mi><mi>e</mi><mi>a</mi><msub><mi>d</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi>h</mi><mi>e</mi><mi>a</mi><msub><mi>d</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><mi>h</mi><mi>e</mi><mi>a</mi><msub><mi>d</mi><mi>h</mi></msub><mo stretchy=\"false\">]</mo><msup><mi mathvariant=\"bold\">W</mi><mi>O</mi></msup><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>h</mi><mi>e</mi><mi>a</mi><msub><mi>d</mi><mi>i</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mrow><mi mathvariant=\"normal\">A</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">n</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">n</mi></mrow><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">F</mi><mi>l</mi></msup><msubsup><mi mathvariant=\"bold\">W</mi><mi>i</mi><mi>Q</mi></msubsup><mo separator=\"true\">,</mo><msup><mi mathvariant=\"bold\">F</mi><mi>l</mi></msup><msubsup><mi mathvariant=\"bold\">W</mi><mi>i</mi><mi>K</mi></msubsup><mo separator=\"true\">,</mo><msup><mi mathvariant=\"bold\">F</mi><mi>l</mi></msup><msubsup><mi mathvariant=\"bold\">W</mi><mi>i</mi><mi>V</mi></msubsup><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n\\mathrm{MultiHeadAttn}(\\mathbf{F}^{l})&amp; =[head_{1},head_{2},...,head_{h}]\\mathbf{W}^{O}, \\\\\nhead_{i}&amp; =\\mathrm{Attention}(\\mathbf{F}^{l}\\mathbf{W}_{i}^{Q},\\mathbf{F}^{l}\\mathbf{W}_{i}^{K},\\mathbf{F}^{l}\\mathbf{W}_{i}^{V}), \n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.178347em;vertical-align:-1.3391734999999998em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8391735000000002em;\"><span style=\"top:-3.9400655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">M</span><span class=\"mord mathrm\">u</span><span class=\"mord mathrm\">l</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">i</span><span class=\"mord mathrm\">H</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\">d</span><span class=\"mord mathrm\">A</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">n</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.3208265000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3391734999999998em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8391735000000002em;\"><span style=\"top:-3.9400655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">O</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span><span style=\"top:-2.3208265000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">A</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">n</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">i</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">n</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9592389999999998em;\"><span style=\"top:-2.4231360000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.180908em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">Q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.276864em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3391734999999998em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>F</mi><mi>l</mi></msup></mrow><annotation encoding=\"application/x-tex\">F^l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.849108em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span></span></span> 是第<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span> 层的输入</li>\n<li>当<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">l=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span> 的时候我们设<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>F</mi><mn>0</mn></msup><mo>=</mo><msub><mi>E</mi><mi>I</mi></msub></mrow><annotation encoding=\"application/x-tex\">F^0=E_I</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></li>\n<li>投影矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi mathvariant=\"bold\">W</mi><mi>i</mi><mi>Q</mi></msubsup><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>d</mi><mo>×</mo><mi>d</mi><mi mathvariant=\"normal\">/</mi><mi>h</mi></mrow></msup><mo separator=\"true\">,</mo><msubsup><mi mathvariant=\"bold\">W</mi><mi>i</mi><mi>K</mi></msubsup><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>d</mi><mo>×</mo><mi>d</mi><mi mathvariant=\"normal\">/</mi><mi>h</mi></mrow></msup><mo separator=\"true\">,</mo><msubsup><mi mathvariant=\"bold\">W</mi><mi>V</mi><mi>Q</mi></msubsup><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>d</mi><mo>×</mo><mi>d</mi><mi mathvariant=\"normal\">/</mi><mi>h</mi></mrow></msup><mrow><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">n</mi><mi mathvariant=\"normal\">d</mi></mrow><msup><mi mathvariant=\"bold\">W</mi><mi>O</mi></msup><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{W}_{i}^{Q}\\in\\mathbb{R}^{d\\times d/h},\\mathbf{W}_{i}^{K}\\in\\mathbb{R}^{d\\times d/h},\\mathbf{W}_{V}^{Q}\\in\\mathbb{R}^{d\\times d/h} \\mathrm{and} \\mathbf{W}^{O}\\in\\mathbb{R}^{d\\times d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.236103em;vertical-align:-0.276864em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.959239em;\"><span style=\"top:-2.4231360000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.1809080000000005em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">Q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.276864em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.146664em;vertical-align:-0.258664em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mtight\">/</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-2.441336em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.258664em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.25277em;vertical-align:-0.293531em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mtight\">/</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.959239em;\"><span style=\"top:-2.4064690000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span><span style=\"top:-3.1809080000000005em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">Q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.293531em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9270999999999999em;vertical-align:-0.0391em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mtight\">/</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\">n</span><span class=\"mord mathrm\">d</span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">O</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span> 是每个注意力头对应的可学习参数</li>\n</ul>\n</li>\n<li>\n<p>注意力函数通过缩放的点积运算实现：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mi mathvariant=\"normal\">A</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">n</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">n</mi></mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">Q</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">K</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">V</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mi mathvariant=\"normal\">s</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">f</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">x</mi></mrow><mo stretchy=\"false\">(</mo><mfrac><msup><mrow><mi mathvariant=\"bold\">Q</mi><mi mathvariant=\"bold\">K</mi></mrow><mi mathvariant=\"normal\">⊤</mi></msup><msqrt><mrow><mi>d</mi><mi mathvariant=\"normal\">/</mi><mi>h</mi></mrow></msqrt></mfrac><mo stretchy=\"false\">)</mo><mi mathvariant=\"bold\">V</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\mathrm{Attention}(\\mathbf{Q},\\mathbf{K},\\mathbf{V})=\\mathrm{softmax}(\\frac{\\mathbf{QK}^{\\top}}{\\sqrt{d/h}})\\mathbf{V},\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">A</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">n</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">i</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">n</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">Q</span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">K</span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.732118em;vertical-align:-1.13em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">s</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\" style=\"margin-right:0.07778em;\">f</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">m</span><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\">x</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.602118em;\"><span style=\"top:-2.175em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.935em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord mathnormal\">d</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">h</span></span></span><span style=\"top:-2.8950000000000005em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30499999999999994em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">Q</span><span class=\"mord mathbf\">K</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9251179999999999em;\"><span style=\"top:-3.1390100000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.13em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span><span class=\"mpunct\">,</span></span></span></span></span></p>\n<ul>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi><mo>=</mo><msup><mi mathvariant=\"bold\">F</mi><mi>l</mi></msup><msubsup><mi mathvariant=\"bold\">W</mi><mi>i</mi><mi>Q</mi></msubsup><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">K</mi><mo>=</mo><msup><mi mathvariant=\"bold\">F</mi><mi>l</mi></msup><msubsup><mi mathvariant=\"bold\">W</mi><mi>i</mi><mi>K</mi></msubsup><mo separator=\"true\">,</mo><mrow><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">n</mi><mi mathvariant=\"normal\">d</mi></mrow><mi mathvariant=\"bold\">V</mi><mo>=</mo><msup><mi mathvariant=\"bold\">F</mi><mi>l</mi></msup><msubsup><mi mathvariant=\"bold\">W</mi><mi>i</mi><mi>V</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q} = \\mathbf{F}^{l}\\mathbf{W}_{i}^{Q} , \\mathbf{K} = \\mathbf{F}^{l}\\mathbf{W}_{i}^{K} , \\mathrm{and} \\mathbf{V} = \\mathbf{F}^{l}\\mathbf{W}_{i}^{V}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805499999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">Q</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.236103em;vertical-align:-0.276864em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.959239em;\"><span style=\"top:-2.4231360000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.1809080000000005em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">Q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.276864em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">K</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.107772em;vertical-align:-0.258664em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-2.441336em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.258664em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\">n</span><span class=\"mord mathrm\">d</span></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.107772em;vertical-align:-0.258664em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-2.441336em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.258664em;\"><span></span></span></span></span></span></span></span></span></span> 是输入嵌入矩阵的线性变换，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mrow><mi>d</mi><mi mathvariant=\"normal\">/</mi><mi>h</mi></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt {d/h}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.24em;vertical-align:-0.30499999999999994em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.935em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord mathnormal\">d</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">h</span></span></span><span style=\"top:-2.8950000000000005em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30499999999999994em;\"><span></span></span></span></span></span></span></span></span> 是比例因子，避免内积的值过大。</p>\n</li>\n<li>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>公式定义</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>给定一个实数向量 </mtext><mi mathvariant=\"bold\">z</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>z</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>z</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>z</mi><mi>n</mi></msub><mo stretchy=\"false\">]</mo><mtext>,Softmax函数将其转换为一个概率向量</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi mathvariant=\"bold\">p</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>p</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>p</mi><mi>n</mi></msub><mo stretchy=\"false\">]</mo><mtext>,其中每个元素 </mtext><msub><mi>p</mi><mi>i</mi></msub><mtext> 表示该位置对应的类别的概率,计算公式</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>如下</mtext><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mrow><mi mathvariant=\"normal\">f</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">r</mi><mtext> </mtext></mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>其中:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>∙</mo><mspace width=\"1em\"/><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mtext> 是 </mtext><msub><mi>z</mi><mi>i</mi></msub><mtext> 的指数函数。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>∙</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mtext> 是所有 </mtext><msub><mi>z</mi><mi>i</mi></msub><mtext> 指数函数值的总和,用于归一化。</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n&amp;\\text{公式定义} \\\\\n&amp;\\text{给定一个实数向量 }\\mathbf{z}=[z_1,z_2,\\ldots,z_n]\\text{,Softmax函数将其转换为一个概率向量} \\\\\n&amp;\\mathbf{p}=[p_1,p_2,\\ldots,p_n]\\text{,其中每个元素 }p_i\\text{ 表示该位置对应的类别的概率,计算公式} \\\\\n&amp;如下: \\\\\n&amp;p_{i}=\\frac{\\exp(z_{i})}{\\sum_{j=1}^{n}\\exp(z_{j})},\\quad\\mathrm{for~}i=1,2,\\ldots,n \\\\\n&amp;\\text{其中:} \\\\\n&amp;\\bullet\\quad\\exp(z_i)\\text{ 是 }z_i\\text{ 的指数函数。} \\\\\n&amp;\\bullet\\sum_{j=1}^n\\exp(z_j)\\text{ 是所有 }z_i\\text{ 指数函数值的总和,用于归一化。}\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:15.222284000000004em;vertical-align:-7.361142000000002em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:7.861142000000002em;\"><span style=\"top:-10.672539000000002em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"></span></span><span style=\"top:-9.172539000000002em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"></span></span><span style=\"top:-7.672539000000002em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"></span></span><span style=\"top:-6.172539000000002em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.085539000000002em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.8154290000000004em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.3154290000000004em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"></span></span><span style=\"top:1.9959680000000013em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:7.361142000000002em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:7.861142000000002em;\"><span style=\"top:-10.672539000000002em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">公式定义</span></span></span></span><span style=\"top:-9.172539000000002em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">给定一个实数向量</span><span class=\"mord\"> </span></span><span class=\"mord\"><span class=\"mord mathbf\">z</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mord text\"><span class=\"mord\">,Softmax</span><span class=\"mord cjk_fallback\">函数将其转换为一个概率向量</span></span></span></span><span style=\"top:-7.672539000000002em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathbf\">p</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mord text\"><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">其中每个元素</span><span class=\"mord\"> </span></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">表示该位置对应的类别的概率</span><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">计算公式</span></span></span></span><span style=\"top:-6.172539000000002em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord cjk_fallback\">如</span><span class=\"mord cjk_fallback\">下</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span></span><span style=\"top:-4.085539000000002em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.305708em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.804292em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.43581800000000004em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1301100000000002em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathrm\" style=\"margin-right:0.07778em;\">f</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">r</span><span class=\"mspace nobreak\"> </span></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-1.8154290000000004em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">其中</span><span class=\"mord\">:</span></span></span></span><span style=\"top:-0.3154290000000004em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∙</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">是</span><span class=\"mord\"> </span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">的指数函数。</span></span></span></span><span style=\"top:1.9959680000000013em;\"><span class=\"pstrut\" style=\"height:3.6513970000000007em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∙</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">是所有</span><span class=\"mord\"> </span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">指数函数值的总和</span><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">用于归一化。</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:7.361142000000002em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n</li>\n</ul>\n</li>\n<li>\n<p>应用逐点前馈网络赋予自注意力块非线性：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi mathvariant=\"bold\">F</mi><mi>l</mi></msup><mo>=</mo><mo stretchy=\"false\">[</mo><mrow><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">N</mi></mrow><mo stretchy=\"false\">(</mo><msubsup><mi mathvariant=\"bold\">F</mi><mn>1</mn><mi>l</mi></msubsup><msup><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">⊤</mi></msup><mo separator=\"true\">;</mo><mo>⋯</mo><mtext> </mtext><mo separator=\"true\">;</mo><mrow><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">N</mi></mrow><mo stretchy=\"false\">(</mo><msubsup><mi mathvariant=\"bold\">F</mi><mi>n</mi><mi>l</mi></msubsup><msup><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">⊤</mi></msup><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mspace linebreak=\"newline\"></mspace><mrow><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">N</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">R</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">U</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><msub><mi mathvariant=\"bold\">W</mi><mn>1</mn></msub><mo>+</mo><msub><mi mathvariant=\"bold\">b</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><msub><mi mathvariant=\"bold\">W</mi><mn>2</mn></msub><mo>+</mo><msub><mi mathvariant=\"bold\">b</mi><mn>2</mn></msub><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{F}^{l}=[\\mathrm{FFN}(\\mathbf{F}_{1}^{l})^{\\top};\\cdots;\\mathrm{FFN}(\\mathbf{F}_{n}^{l})^{\\top}],\\\\\\mathrm{FFN}(x)=(\\mathrm{ReLU}(x\\mathbf{W}_{1}+\\mathbf{b}_{1}))\\mathbf{W}_{2}+\\mathbf{b}_{2},\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8991079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.149108em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathrm\">F</span><span class=\"mord mathrm\">F</span><span class=\"mord mathrm\">N</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999998em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">F</span><span class=\"mord mathrm\">F</span><span class=\"mord mathrm\">N</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999998em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">F</span><span class=\"mord mathrm\">F</span><span class=\"mord mathrm\">N</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathrm\">R</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">L</span><span class=\"mord mathrm\">U</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">b</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">b</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>W</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">W_1,b_1,W_2,b_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 都是可训练参数</li>\n<li>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>R</mi><mi>e</mi><mi>L</mi><mi>U</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">ReLU(x)=max(0,x)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span></p>\n</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>F</mi><mi>N</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>x</mi><msub><mi>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><msub><mi>W</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">FFN(x)=max(0,xW_1+b_1)W_2+b_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></li>\n</ul>\n</li>\n<li>\n<p>在序列推荐中，只能利用当前时间步骤之前的信息，故对多头自注意力函数的输出应用掩码操作，以删除<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>i</mi></msub><mtext>和</mtext><msub><mi>K</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_i和K_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">和</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 之间的所有连接。</p>\n</li>\n<li>\n<p>在预训练阶段删除所有掩码机制，以获取项目序列中每个项目的双向上下文感知表示。</p>\n</li>\n</ul>\n<h3 id=\"预测层\"><a class=\"anchor\" href=\"#预测层\">#</a> 预测层</h3>\n<ul>\n<li>在<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>S</mi><mi>e</mi></msup><mo>−</mo><mi>R</mi><mi>e</mi><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">S^e-Rec</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">c</span></span></span></span> 最后一层根据用户历史上下文来计算用户在步骤<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69841em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 时对项目<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 的偏好分数<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>i</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>i</mi><mi mathvariant=\"normal\">∣</mi><msub><mi>i</mi><mrow><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mi mathvariant=\"bold\">e</mi><mi>i</mi><mi mathvariant=\"normal\">⊤</mi></msubsup><mo>⋅</mo><msubsup><mi mathvariant=\"bold\">F</mi><mi>t</mi><mi>L</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">P(i_{t+1}=i|i_{1:t})=\\mathbf{e}_i^\\top\\cdot\\mathbf{F}_t^L\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mrel mtight\">:</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.146108em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">e</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999998em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.138331em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<img data-src=\"https://s2.loli.net/2024/07/30/KZv2LMpOskGanTo.png\" alt=\"image.png\" /></li>\n</ul>\n<h2 id=\"使用-mim-进行自监督学习\"><a class=\"anchor\" href=\"#使用-mim-进行自监督学习\">#</a> 使用 MIM 进行自监督学习</h2>\n<ul>\n<li>将额外的自监督信号与 MIM 结合起来，以增强输入数据的表示</li>\n<li>采用预训练的方式，根据多视角相关性构建不同的损失函数</li>\n</ul>\n<h3 id=\"属性相关性建模\"><a class=\"anchor\" href=\"#属性相关性建模\">#</a> 属性相关性建模</h3>\n<ul>\n<li>\n<p>最大化项目和属性之间的相互信息。</p>\n</li>\n<li>\n<p>通过建模项目属性相关性来融合项目和属性级别的信息</p>\n</li>\n<li>\n<p>将有用的属性信息注入到项目表示中</p>\n</li>\n<li a_1,...,a_k\\=\"\">\n<p>给定项目<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 和属性集\\mathcal A_i=\\</p>\n</li>\n<li>\n<p>令<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>e</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">e_{i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 表示嵌入层获得的项目嵌入，并且令<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>e</mi><mrow><mi>a</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">e_{aj}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 表示第<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 个属性<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>j</mi></msub><mo>∈</mo><msub><mi mathvariant=\"script\">A</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_j \\in \\mathcal A_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8252079999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 的嵌入</p>\n</li>\n<li>\n<p>我们通过以下方式最小化关联属性预测（AAP）损失：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>L</mi><mrow><mi>A</mi><mi>A</mi><mi>P</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><msub><mi mathvariant=\"script\">H</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi mathvariant=\"double-struck\">E</mi><mrow><msub><mi>a</mi><mi>j</mi></msub><mo>∈</mo><msub><mi mathvariant=\"script\">H</mi><mi>i</mi></msub></mrow></msub><mo stretchy=\"false\">[</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><munder><mo>∑</mo><mrow><mover accent=\"true\"><mi>a</mi><mo>~</mo></mover><mo>∈</mo><mi mathvariant=\"script\">H</mi><mo>∖</mo><msub><mi mathvariant=\"script\">H</mi><mi>i</mi></msub></mrow></munder><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mover accent=\"true\"><mi>a</mi><mo>~</mo></mover><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">L_{AAP}(i,\\mathcal{H}_{i})=\\mathbb{E}_{a_{j}\\in\\mathcal{H}_{i}}[f(i,a_{j})-\\log\\sum_{\\tilde{a}\\in\\mathcal{H}\\setminus\\mathcal{H}_{i}}\\exp(f(i,\\tilde{a}))]\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.00965em;\">H</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0973199999999999em;vertical-align:-0.34731999999999996em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">E</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833100000000004em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.00965em;\">H</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34731999999999996em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.5660100000000003em;vertical-align:-1.516005em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.808995em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord accent mtight\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-2.7em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span><span style=\"top:-3.0500000000000003em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord mtight\">~</span></span></span></span></span></span></span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.00965em;\">H</span></span><span class=\"mbin mtight\">∖</span><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.00965em;\">H</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.516005em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mclose\">]</span></span></span></span></span></p>\n<ul>\n<li>\n<p>采用负属性<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>a</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6678599999999999em;vertical-align:0em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">a</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span> 来增强项目<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 与真实属性之间的关联</p>\n</li>\n<li>\n<p><code>\\</code>  是定义的集合减法运算</p>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(.,.)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mclose\">)</span></span></span></span> 用一个简单的双线性网络实现:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>σ</mi><mo fence=\"false\">(</mo><msubsup><mi mathvariant=\"bold\">e</mi><mi>i</mi><mi mathvariant=\"normal\">⊤</mi></msubsup><mo>⋅</mo><msub><mi mathvariant=\"bold\">W</mi><mrow><mi>A</mi><mi>A</mi><mi>P</mi></mrow></msub><mo>⋅</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>a</mi><mi>j</mi></msub></msub><mo fence=\"false\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">f(i,a_j)=\\sigma\\big(\\mathbf{e}_i^\\top\\cdot\\mathbf{W}_{AAP}\\cdot\\mathbf{e}_{a_j}\\big),\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2491179999999997em;vertical-align:-0.35001em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">e</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999998em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83611em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.20001em;vertical-align:-0.35001em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">e</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.34731999999999996em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"delimsizing size1\">)</span></span><span class=\"mpunct\">,</span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mrow><mi>A</mi><mi>A</mi><mi>P</mi></mrow></msub><mo>∈</mo><msup><mi mathvariant=\"script\">R</mi><mrow><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">W_{AAP} \\in \\mathcal R^{d \\times d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span> 是一个可学习矩阵</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">.</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma(.)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\">.</span><span class=\"mclose\">)</span></span></span></span> 是<strong> sigmoid</strong> 激活函数</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"序列项相关性建模\"><a class=\"anchor\" href=\"#序列项相关性建模\">#</a> 序列项相关性建模</h3>\n<ul>\n<li>\n<p>在每个训练步骤中，我们随机屏蔽输入序列中的一部分项目（即，用特殊标记 “[mask]” 替换它们）</p>\n</li>\n<li>\n<p>然后根据两个方向的周围上下文从原始序列中预测被掩盖的项目</p>\n</li>\n<li>\n<p>考虑的第二个损失是从输入序列中恢复具有双向上下文的实际项目</p>\n</li>\n<li>\n<p>基础模型的预训练版本是一个双向 Transformer 架构</p>\n</li>\n<li i_t=\"\">\n<p>在序列<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>t</mi></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{i_1,...,i_t,...,i_n\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">}</span></span></span></span> 中屏蔽第<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.61508em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span> 个项目<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80952em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，将其余序列<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><mi>m</mi><mi>a</mi><mi>s</mi><mi>k</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">{i_1,...,mask,...,i_n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span> 视为其周围的上下文，表示为\\mathcal C_</p>\n</li>\n<li>\n<p>当我们给定<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"script\">C</mi><msub><mi>i</mi><mi>t</mi></msub></msub></mrow><annotation encoding=\"application/x-tex\">\\mathcal C_{i_t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.93343em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.05834em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span></span></span></span> 和被掩码的项目<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80952em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 时，将它们视为不同的视图，以融合来学习数据表示</p>\n</li>\n<li>\n<p>我们以一下公式最小化掩蔽项目预测（MIP）损失:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>L</mi><mrow><mi>M</mi><mi>I</mi><mi>P</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>C</mi><msub><mi>i</mi><mi>t</mi></msub></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>C</mi><msub><mi>i</mi><mi>t</mi></msub></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><munder><mo>∑</mo><mrow><mover accent=\"true\"><mi>i</mi><mo>~</mo></mover><mo>∈</mo><mi>I</mi><mo>∖</mo><mo stretchy=\"false\">{</mo><msub><mi>i</mi><mi>t</mi></msub><mo stretchy=\"false\">}</mo></mrow></munder><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>C</mi><msub><mi>i</mi><mi>t</mi></msub></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">L_{MIP}(C_{i_t},i_t)=f(C_{i_t},i_t)-\\log[\\sum_{\\tilde{i}\\in I\\setminus\\{i_t\\}}f(C_{i_t},i_t)]\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0001em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0001em;vertical-align:-0.2501em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.668476em;vertical-align:-1.618471em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">[</span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.706529em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord accent mtight\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.89638em;\"><span style=\"top:-2.7em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.2785200000000003em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord mtight\">~</span></span></span></span></span></span></span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mbin mtight\">∖</span><span class=\"mopen mtight\">{</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">}</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.618471em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">]</span></span></span></span></span></p>\n<ul>\n<li>\n<p>其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>i</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.89638em;vertical-align:0em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.89638em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">i</span></span><span style=\"top:-3.57852em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span> 表示不相关项，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(.,.)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mclose\">)</span></span></span></span> 根据以下公式实现</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>C</mi><msub><mi>i</mi><mi>t</mi></msub></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>σ</mi><mo stretchy=\"false\">(</mo><msubsup><mi mathvariant=\"bold\">F</mi><mi>t</mi><mi mathvariant=\"normal\">⊤</mi></msubsup><mo>⋅</mo><msub><mi mathvariant=\"bold\">W</mi><mrow><mi>M</mi><mi>I</mi><mi>P</mi></mrow></msub><mo>⋅</mo><msub><mi mathvariant=\"bold\">e</mi><msub><mi>i</mi><mi>t</mi></msub></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(C_{i_t},i_t)=\\sigma(\\mathbf{F}_t^\\top\\cdot\\mathbf{W}_{MIP}\\cdot\\mathbf{e}_{i_t})\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0001em;vertical-align:-0.2501em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1491079999999998em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999998em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83611em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0001em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">e</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<ul>\n<li>其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mrow><mi>M</mi><mi>I</mi><mi>P</mi></mrow></msub><mo>∈</mo><msup><mi mathvariant=\"script\">R</mi><mrow><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">W_{MIP}\\in \\mathcal R^{d×d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span> 是需要学习的参数矩阵，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>F</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">F_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是使用双向 Transformer 架构来与式 [13] 相同的方式获得的第<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.61508em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span> 个位置的学习到的表示</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"建模序列-属性相关性\"><a class=\"anchor\" href=\"#建模序列-属性相关性\">#</a> 建模序列 - 属性相关性</h3>\n<ul>\n<li>\n<p>将属性信息与序列上下文直接融合</p>\n</li>\n<li>\n<p>根据周围环境恢复被屏蔽项目的属性</p>\n</li>\n<li>\n<p>给定一个被屏蔽的项目<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">i_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80952em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，我们将其周围的上下文<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><msub><mi>i</mi><mi>t</mi></msub></msub></mrow><annotation encoding=\"application/x-tex\">C_{i_t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.93343em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span></span></span></span> 和其属性集<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"script\">A</mi><msub><mi>i</mi><mi>t</mi></msub></msub></mrow><annotation encoding=\"application/x-tex\">\\mathcal A_{i_t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.93343em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span></span></span></span> 视为 MIM 的两个不同视图，故开发掩蔽属性损失 MAP 如下：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><msub><mi>L</mi><mrow><mi>M</mi><mi>A</mi><mi>P</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>C</mi><msub><mi>i</mi><mi>t</mi></msub></msub><mo separator=\"true\">,</mo><msub><mi mathvariant=\"script\">H</mi><msub><mi>i</mi><mi>t</mi></msub></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mi>a</mi><mo>∈</mo><msub><mi mathvariant=\"script\">H</mi><msub><mi>i</mi><mi>t</mi></msub></msub></mrow></msub><mo stretchy=\"false\">[</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>C</mi><msub><mi>i</mi><mi>t</mi></msub></msub><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><munder><mo>∑</mo><mrow><mover accent=\"true\"><mi>a</mi><mo>~</mo></mover><mo>∈</mo><mi mathvariant=\"script\">H</mi><mo>∖</mo><msub><mi mathvariant=\"script\">H</mi><mi>i</mi></msub></mrow></munder><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>C</mi><msub><mi>i</mi><mi>t</mi></msub></msub><mo separator=\"true\">,</mo><mover accent=\"true\"><mi>a</mi><mo>~</mo></mover><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}&amp;L_{MAP}(C_{i_{t}},\\mathcal{H}_{i_{t}})=\\mathbb{E}_{a\\in\\mathcal{H}_{i_{t}}}[f(C_{i_{t}},a)-\\log\\sum_{\\tilde{a}\\in\\mathcal{H}\\setminus\\mathcal{H}_{i}}\\exp(f(C_{i_{t}},\\tilde{a}))],\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.86601em;vertical-align:-1.183005em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.683005em;\"><span style=\"top:-3.683005em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.183005em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.683005em;\"><span style=\"top:-3.683005em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.00965em;\">H</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">E</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.328331em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.00965em;\">H</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:0em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.61508em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.27027999999999996em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33605714285714283em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.38523999999999997em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.808995em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord accent mtight\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-2.7em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span><span style=\"top:-3.0500000000000003em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord mtight\">~</span></span></span></span></span></span></span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.00965em;\">H</span></span><span class=\"mbin mtight\">∖</span><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.00965em;\">H</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.516005em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.183005em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li>\n<p>其中的<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(.,.)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mclose\">)</span></span></span></span> 可以通过以下公式实现：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>C</mi><msub><mi>i</mi><mi>t</mi></msub></msub><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>σ</mi><mo fence=\"false\">(</mo><msubsup><mi mathvariant=\"bold\">F</mi><mi>t</mi><mi mathvariant=\"normal\">⊤</mi></msubsup><mo>⋅</mo><msub><mi mathvariant=\"bold\">W</mi><mrow><mi>M</mi><mi>A</mi><mi>P</mi></mrow></msub><mo>⋅</mo><msub><mi mathvariant=\"bold\">e</mi><mi>a</mi></msub><mo fence=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(C_{i_t},a)=\\sigma\\big(\\mathbf{F}_t^\\top\\cdot\\mathbf{W}_{MAP}\\cdot\\mathbf{e}_a\\big)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0001em;vertical-align:-0.2501em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2491179999999997em;vertical-align:-0.35001em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999998em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83611em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.20001em;vertical-align:-0.35001em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">e</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"delimsizing size1\">)</span></span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mrow><mi>M</mi><mi>A</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">W_{MAP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是可学习参数矩阵</li>\n</ul>\n</li>\n<li>\n<p>我们希望明确地对相关性进行建模，以得出更有意义的监督信号</p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"序列-片段相关性建模\"><a class=\"anchor\" href=\"#序列-片段相关性建模\">#</a> 序列 - 片段相关性建模</h3>\n<ul>\n<li>\n<p>项目序列与单词序列之间的主要区别在于，单个目标项目可能与周围上下文没有高度相关性 (如用户购买一个商品只是因为其在打折)</p>\n</li>\n<li>\n<p>基于此，我们将 Cloze 策略从单个条目扩展为条目子序列（即称为段）</p>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub></mrow><annotation encoding=\"application/x-tex\">i_{j_1:j_2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9456279999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 表示从项目<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><msub><mi>j</mi><mn>1</mn></msub></msub><mtext>到</mtext><msub><mi>i</mi><msub><mi>j</mi><mn>2</mn></msub></msub></mrow><annotation encoding=\"application/x-tex\">i_{j_1}到i_{j_2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">到</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 的子序列，并且让<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><msub><mi>i</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub></msub></mrow><annotation encoding=\"application/x-tex\">C_{i_{j_1:j_2}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.08325em;vertical-align:-0.39992em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.3569999999999998em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\">1</span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\">2</span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3570285714285715em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.39992em;\"><span></span></span></span></span></span></span></span></span></span> 表示整个序列中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub></mrow><annotation encoding=\"application/x-tex\">{i_{j_1:j_2}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9456279999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span> 的上下文</p>\n</li>\n<li>\n<p>我们可以利用 MIN 公式里的段预测损失（SP）来回复缺失的项目段:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><msub><mi>L</mi><mrow><mi>S</mi><mi>P</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>C</mi><msub><mi>i</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>C</mi><msub><mi>i</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><munder><mo>∑</mo><msub><mover accent=\"true\"><mi>i</mi><mo>~</mo></mover><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub></munder><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>C</mi><msub><mi>i</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub></msub><mo separator=\"true\">,</mo><msub><mover accent=\"true\"><mi>i</mi><mo>~</mo></mover><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}&amp;L_{SP}(C_{i_{j_{1}:j_{2}}},i_{j_{1}:j_{2}})=f(C_{i_{j_{1}:j_{2}}},i_{j_{1}:j_{2}})-\\log\\sum_{\\tilde{i}_{j_{1}:j_{2}}}\\exp{(f(C_{i_{j_{1}:j_{2}}},\\tilde{i}_{j_{1}:j_{2}}))},\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.0433960000000004em;vertical-align:-1.271698em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7716980000000004em;\"><span style=\"top:-3.771698em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.271698em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7716980000000004em;\"><span style=\"top:-3.771698em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.3569999999999998em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3570285714285715em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.39992em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.3569999999999998em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3570285714285715em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.39992em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.7065289999999997em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord accent mtight\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.89638em;\"><span style=\"top:-2.7em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.2785200000000003em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord mtight\">~</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.3569999999999998em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3570285714285715em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.693391em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.3569999999999998em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3570285714285715em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.39992em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.89638em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span></span></span><span style=\"top:-3.57852em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span><span class=\"mpunct\">,</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.271698em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi>i</mi><mo>~</mo></mover><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\tilde i_{j_1:j_2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.182488em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.89638em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">i</span></span><span style=\"top:-3.57852em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 为损坏的负子序列，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(.,.)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mclose\">)</span></span></span></span> 表示为:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>C</mi><msub><mi>i</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub></msub><mo separator=\"true\">,</mo><msub><mi>i</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>σ</mi><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">s</mi><mi mathvariant=\"normal\">⊤</mi></msup><mo>⋅</mo><msub><mi mathvariant=\"bold\">W</mi><mrow><mi>S</mi><mi>P</mi></mrow></msub><mo>⋅</mo><mover accent=\"true\"><mi mathvariant=\"bold\">s</mi><mo>~</mo></mover><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(C_{i_{j_1:j_2}},i_{j_1:j_2})=\\sigma(\\mathbf{s}^\\top\\cdot\\mathbf{W}_{SP}\\cdot\\tilde{\\mathbf{s}})\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.14992em;vertical-align:-0.39992em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.3569999999999998em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\">1</span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\">2</span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3570285714285715em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.39992em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.149108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">s</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83611em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6812999999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">s</span></span></span></span><span style=\"top:-3.36344em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<ul>\n<li>其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mrow><mi>S</mi><mi>P</mi></mrow></msub><mo>∈</mo><msup><mi mathvariant=\"script\">R</mi><mrow><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">W_{SP}\\in \\mathcal R^{d \\times d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span> 是需要学习的参数矩阵</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mtext>和</mtext><mover accent=\"true\"><mi>s</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">s和\\tilde s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord cjk_fallback\">和</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6678599999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">s</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span> 分别是上下文<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><msub><mi>i</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub></msub></mrow><annotation encoding=\"application/x-tex\">C_{i_{j_1:j_2}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.08325em;vertical-align:-0.39992em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.3569999999999998em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\">1</span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3447999999999998em;margin-left:-0.05724em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.64444em;\"></span><span class=\"mord mtight\">2</span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29964em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3570285714285715em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.39992em;\"><span></span></span></span></span></span></span></span></span></span> 和子序列<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>i</mi><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>:</mo><msub><mi>j</mi><mn>2</mn></msub></mrow></msub></mrow><annotation encoding=\"application/x-tex\">i_{j_1:j_2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9456279999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">:</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:-0.05724em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 学习到的表示</li>\n<li>应用双向 Transformer 来获取序列中最后一个位置的状态表示</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"学习和讨论\"><a class=\"anchor\" href=\"#学习和讨论\">#</a> 学习和讨论</h2>\n<p>在本部分中，我们介绍了用于顺序推荐的 $ S^3-Rec $ 的学习和相关讨论</p>\n<h3 id=\"学习部分\"><a class=\"anchor\" href=\"#学习部分\">#</a> 学习部分</h3>\n<ul>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>S</mi><mn>3</mn></msup><mo>−</mo><mi>R</mi><mi>e</mi><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">S^3-Rec</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.897438em;vertical-align:-0.08333em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">c</span></span></span></span> 包含两个重要阶段 ——<strong> 预训练</strong>和<strong>微调</strong>阶段</p>\n</li>\n<li>\n<p>对两个阶段分别采用双向和单向 Transformer 架构</p>\n</li>\n<li>\n<p>在预训练阶段，考虑四种不同的类型的相关性来优化自监督学习目标</p>\n</li>\n<li>\n<p>在微调阶段利用预训练阶段学习到的参数来初始化单向 Transformer 的参数，然后利用从左到右的监督信号来训练网络</p>\n</li>\n<li>\n<p>采用成对秩损失来优化其参数:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>L</mi><mrow><mi>m</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi mathvariant=\"script\">U</mi></mrow></munder><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>log</mi><mo>⁡</mo><mi>σ</mi><mo fence=\"true\">(</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>i</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant=\"normal\">∣</mi><msub><mi>i</mi><mrow><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msubsup><mi>i</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mo>−</mo></msubsup><mi mathvariant=\"normal\">∣</mi><msub><mi>i</mi><mrow><mn>1</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">L_{main}=-\\sum_{u\\in\\mathcal{U}}\\sum_{t=1}^n\\log\\sigma\\biggl(P(i_{t+1}|i_{1:t})-P(i_{t+1}^-|i_{1:t})\\biggr),\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.973103em;vertical-align:-1.321706em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8556639999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.09931em;\">U</span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.321706em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6513970000000002em;\"><span style=\"top:-1.882887em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.267113em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mrel mtight\">:</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.821331em;\"><span style=\"top:-2.443561em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">−</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31477em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mrel mtight\">:</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size3\">)</span></span><span class=\"mpunct\">,</span></span></span></span></span></p>\n<ul>\n<li>我们将每个真实项 $ i_<ruby>t+1 }$ 与随机抽样的负项 $ i<rp>(</rp><rt>-_{t+1 </rt><rp>)</rp></ruby>$ 配对。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"讨论\"><a class=\"anchor\" href=\"#讨论\">#</a> 讨论</h3>\n<ul>\n<li>通过预训练模型从输入中捕获内在数据相关性作为附加信号</li>\n<li>这种方法非常通用，因此许多现有方法都可以纳入此框架</li>\n</ul>\n<h4 id=\"基于特征的方法\"><a class=\"anchor\" href=\"#基于特征的方法\">#</a> 基于特征的方法</h4>\n<ul>\n<li>主要通过上下文特征的交互来学习数据表示</li>\n<li>根据用户与物品特征的实际交互结果进行最终预测</li>\n<li>在本文中相关属性预测损失为公式<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mrow><mi>A</mi><mi>A</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">L_{AAP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, 与公式<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mrow><mi>M</mi><mi>A</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">L_{MAP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal mtight\">A</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 在特征交互中具有类似效果</li>\n<li>专注于捕捉属性信息与项目 / 序列上下文之间的关联</li>\n<li>主要区别是利用特征交互作为额外的监督信号来增强数据表示，而不是进行预测</li>\n</ul>\n<h4 id=\"顺序模型\"><a class=\"anchor\" href=\"#顺序模型\">#</a> 顺序模型</h4>\n<ul>\n<li>包含一个预训练阶段，利用四种不同类型的自监督学习信号来增强数据表示</li>\n<li>具体来说<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mrow><mi>M</mi><mi>I</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">L_{MIP}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 在捕获序列依赖性方面具有比较好的效果，并且还可以利用双向序列信息</li>\n</ul>\n<h4 id=\"属性感知序列模型\"><a class=\"anchor\" href=\"#属性感知序列模型\">#</a> 属性感知序列模型</h4>\n<ul>\n<li>现有方法通过上下文特征来改进序列推荐模型，在这些模型中，这些特征被视为辅助信息，以增强项目或序列的表示</li>\n<li>本模型中 $L_{AAP} <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>损失和</mtext></mrow><annotation encoding=\"application/x-tex\">损失和</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">损</span><span class=\"mord cjk_fallback\">失</span><span class=\"mord cjk_fallback\">和</span></span></span></span> L_{MAP}$ 损失旨在将属性与项目或序列上下文融合，这能够达到与以前的方法相同的效果</li>\n<li>此外，预先训练的数据表示也可以应用于改进现有方法</li>\n</ul>\n<h2 id=\"实验-2\"><a class=\"anchor\" href=\"#实验-2\">#</a> 实验</h2>\n<h3 id=\"实验装置\"><a class=\"anchor\" href=\"#实验装置\">#</a> 实验装置</h3>\n<h4 id=\"数据\"><a class=\"anchor\" href=\"#数据\">#</a> 数据</h4>\n<ul>\n<li>对来自四个真实平台的六个数据集进行了实验</li>\n<li>美团 美容 运动 玩具 Yelp  LastFM</li>\n<li>对于所有数据集，我们按用户对交互记录进行分组，并按交互时间戳升序排序，只保留 5 个核心数据集，并过滤掉互动记录少于 5 条的冷门商品和不活跃用户</li>\n<li>将真实项目与 99 个随机抽样的负项目配对，这些负项目是用户未与之交互的。我们根据项目的排名计算所有指标，并报告所有测试用户的平均得分。</li>\n</ul>\n<h4 id=\"评估指标\"><a class=\"anchor\" href=\"#评估指标\">#</a> 评估指标</h4>\n<p><strong>HR@K</strong> 关注的是推荐系统能否在前 K 个推荐项中命中用户实际喜欢的物品。</p>\n<p><strong>NDCG@K</strong> 不仅关注命中，还关注命中的推荐项在推荐列表中的位置，位置越靠前，得分越高。</p>\n<p><strong>MRR</strong> 关注第一个相关项在推荐列表中的排名，排名越靠前，得分越高。</p>\n<h5 id=\"top-k-命中率hrk\"><a class=\"anchor\" href=\"#top-k-命中率hrk\">#</a> Top-K 命中率（HR@K）</h5>\n<p>HR@K 衡量推荐系统在前 K 个推荐项中有多少个是用户实际喜欢的物品。它是一种二元评价指标，要么命中要么未命中。</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left right\" columnspacing=\"0em 1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mrow><mi mathvariant=\"normal\">H</mi><mi mathvariant=\"normal\">R</mi><mi mathvariant=\"normal\">@</mi><mi mathvariant=\"normal\">K</mi></mrow><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mfrac><mn>1</mn><mrow><mi mathvariant=\"normal\">∣</mi><mi>U</mi><mi mathvariant=\"normal\">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi>U</mi></mrow></munder><mn mathvariant=\"bold\">1</mn><mtext>(Top-K Recommendations for </mtext><mi>u</mi><mo>∩</mo><mtext>True Items for </mtext><mi>u</mi><mo mathvariant=\"normal\">≠</mo><mi mathvariant=\"normal\">∅</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}&amp;\\mathrm{HR@K}=&amp;\\frac{1}{|U|}\\sum_{u\\in U}\\mathbf{1}\\text{(Top-K Recommendations for }u\\cap\\text{True Items for }u\\neq\\emptyset)\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.943146em;vertical-align:-1.221573em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.721573em;\"><span style=\"top:-3.721573em;\"><span class=\"pstrut\" style=\"height:3.32144em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.221573em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.721573em;\"><span style=\"top:-3.721573em;\"><span class=\"pstrut\" style=\"height:3.32144em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathrm\">H</span><span class=\"mord mathrm\">R</span><span class=\"mord mathrm\">@</span><span class=\"mord mathrm\">K</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.221573em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.721573em;\"><span style=\"top:-3.721573em;\"><span class=\"pstrut\" style=\"height:3.32144em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\">∣</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8556639999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.321706em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">1</span></span><span class=\"mord text\"><span class=\"mord\">(Top-K Recommendations for </span></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∩</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord text\"><span class=\"mord\">True Items for </span></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"inner\"><span class=\"mrel\"></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">∅</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.221573em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li><strong>U</strong>: 用户集合。</li>\n<li><strong>Top-K Recommendations</strong>: 推荐系统为用户推荐的前 K 个物品。</li>\n<li><strong>True Items</strong>: 用户实际喜欢的物品。</li>\n<li><strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn mathvariant=\"bold\">1</mn><mo stretchy=\"false\">(</mo><mo>⋅</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{1}(\\cdot)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">1</span></span><span class=\"mopen\">(</span><span class=\"mord\">⋅</span><span class=\"mclose\">)</span></span></span></span></strong>: 指示函数，如果条件为真，则值为 1，否则为 0。</li>\n</ul>\n<p>HR@K 值越高，说明推荐系统越能够将用户感兴趣的物品排在前 K 名</p>\n<h5 id=\"top-k-归一化折扣累积增益ndcgk\"><a class=\"anchor\" href=\"#top-k-归一化折扣累积增益ndcgk\">#</a> Top-K 归一化折扣累积增益（NDCG@K）</h5>\n<p>NDCG@K 衡量推荐系统的推荐结果在前 K 个推荐项中的排序质量。它不仅考虑推荐物品的相关性，还考虑相关物品在推荐列表中的位置。</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mrow><mi mathvariant=\"normal\">N</mi><mi mathvariant=\"normal\">D</mi><mi mathvariant=\"normal\">C</mi><mi mathvariant=\"normal\">G</mi><mi mathvariant=\"normal\">@</mi><mi mathvariant=\"normal\">K</mi></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant=\"normal\">∣</mi><mi>U</mi><mi mathvariant=\"normal\">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi>U</mi></mrow></munder><mfrac><mrow><mi>D</mi><mi>C</mi><mi>G</mi><mi mathvariant=\"normal\">@</mi><msub><mi>K</mi><mi>u</mi></msub></mrow><mrow><mi>I</mi><mi>D</mi><mi>C</mi><mi>G</mi><mi mathvariant=\"normal\">@</mi><msub><mi>K</mi><mi>u</mi></msub></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>其中</mtext><mo separator=\"true\">,</mo><mi>D</mi><mi>C</mi><mi>G</mi><mi mathvariant=\"normal\">@</mi><mi>K</mi><mtext>和</mtext><mi>I</mi><mi>D</mi><mi>C</mi><mi>G</mi><mi mathvariant=\"normal\">@</mi><mi>K</mi><mtext>的计算公式分别为</mtext><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>D</mi><mi>C</mi><mi>G</mi><mi mathvariant=\"normal\">@</mi><mi>K</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mfrac><mrow><msup><mn>2</mn><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>I</mi><mi>D</mi><mi>C</mi><mi>G</mi><mi mathvariant=\"normal\">@</mi><mi>K</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi mathvariant=\"normal\">∣</mi><mi>R</mi><mi>E</mi><msub><mi>L</mi><mi>u</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow></munderover><mfrac><mrow><msup><mn>2</mn><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n&amp;\\mathrm{NDCG@K}=\\frac{1}{|U|}\\sum_{u\\in U}\\frac{DCG@K_{u}}{IDCG@K_{u}} \\\\\n&amp;其中,DCG@K和IDCG@K的计算公式分别为: \\\\\n&amp;DCG@K=\\sum_{i=1}^{K}\\frac{2^{rel_{i}}-1}{\\log_{2}(i+1)} \\\\\n&amp;IDCG@K=\\sum_{i=1}^{|REL_{u}|}\\frac{2^{rel_{i}}-1}{\\log_{2}(i+1)}\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:11.437825000000004em;vertical-align:-5.468912500000001em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.968912500000002em;\"><span style=\"top:-8.5584775em;\"><span class=\"pstrut\" style=\"height:3.961005em;\"></span><span class=\"mord\"></span></span><span style=\"top:-6.096771500000001em;\"><span class=\"pstrut\" style=\"height:3.961005em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.6084355000000006em;\"><span class=\"pstrut\" style=\"height:3.961005em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.06976149999999914em;\"><span class=\"pstrut\" style=\"height:3.961005em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.468912500000001em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.968912500000002em;\"><span style=\"top:-8.5584775em;\"><span class=\"pstrut\" style=\"height:3.961005em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathrm\">N</span><span class=\"mord mathrm\">D</span><span class=\"mord mathrm\">C</span><span class=\"mord mathrm\">G</span><span class=\"mord mathrm\">@</span><span class=\"mord mathrm\">K</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\">∣</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8556639999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.321706em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.3139999999999996em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8360000000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-6.096771500000001em;\"><span class=\"pstrut\" style=\"height:3.961005em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord cjk_fallback\">其</span><span class=\"mord cjk_fallback\">中</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord cjk_fallback\">和</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">计</span><span class=\"mord cjk_fallback\">算</span><span class=\"mord cjk_fallback\">公</span><span class=\"mord cjk_fallback\">式</span><span class=\"mord cjk_fallback\">分</span><span class=\"mord cjk_fallback\">别</span><span class=\"mord cjk_fallback\">为</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span></span><span style=\"top:-3.6084355000000006em;\"><span class=\"pstrut\" style=\"height:3.961005em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.526108em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.20696799999999996em;\"><span style=\"top:-2.4558600000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24414em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.01968em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-0.06976149999999914em;\"><span class=\"pstrut\" style=\"height:3.961005em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9610050000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.386005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">∣</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.16454285714285719em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mord mtight\">∣</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.526108em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.20696799999999996em;\"><span style=\"top:-2.4558600000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24414em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.01968em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.468912500000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li><strong>rel_i</strong>: 第 i 个推荐项的相关性得分。</li>\n<li><strong>REL_u</strong>: 用户 u 实际喜欢的物品的理想排序。</li>\n<li><strong>DCG@K</strong>: 累积增益，考虑位置的推荐质量。</li>\n<li><strong>IDCG@K</strong>: 理想情况下的累积增益，用于归一化。</li>\n</ul>\n<p>NDCG@K 的值介于 0 和 1 之间，越接近 1 说明推荐系统的排序质量越好。</p>\n<h5 id=\"平均倒数排名mrr\"><a class=\"anchor\" href=\"#平均倒数排名mrr\">#</a> 平均倒数排名（MRR）</h5>\n<p>MRR 衡量推荐系统在推荐列表中第一个相关项的排名。它是排名位置的倒数的平均值。</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">M</mi><mi mathvariant=\"normal\">R</mi><mi mathvariant=\"normal\">R</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant=\"normal\">∣</mi><mi>U</mi><mi mathvariant=\"normal\">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi>U</mi></mrow></munder><mfrac><mn>1</mn><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>u</mi></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\mathrm M\\mathrm R\\mathrm R=\\frac{1}{|U|}\\sum_{u\\in U}\\frac{1}{rank_u}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathrm\">M</span><span class=\"mord mathrm\">R</span><span class=\"mord mathrm\">R</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.6431459999999998em;vertical-align:-1.321706em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\">∣</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8556639999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.321706em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.3139999999999996em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">n</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8360000000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<ul>\n<li><strong>rank_u</strong>: 对于用户 u，推荐列表中第一个相关项的排名。</li>\n</ul>\n<p><strong>MRR</strong> 的值越高，说明推荐系统越能够将用户感兴趣的物品排在推荐列表的前列。</p>\n<h4 id=\"实验细节\"><a class=\"anchor\" href=\"#实验细节\">#</a> 实验细节</h4>\n<ul>\n<li>对于我们提出的 $ S^3 -Rec$，我们将自注意力块和注意力头的数量设置为 2。嵌入的维度为 64，最大序列长度为 50</li>\n<li>训练阶段包含两个阶段（即预训练和微调阶段）</li>\n<li>在预训练阶段学习到的参数用于在微调阶段初始化我们模型的嵌入层和自注意力层</li>\n<li>在预训练阶段，根据我们的经验实验，项目的掩码比例设置为 0.2，四个损失（即 AAP、MIP、MAP 和 SP）的权重分别设置为 0.2、1.0、1.0 和 0.5</li>\n<li>我们使用 Adam 优化器 [9]，学习率为 0.001</li>\n<li>其中在预训练和微调阶段，批处理大小分别设置为 200 和 256。我们对模型进行了 100 次预训练，并在推荐任务上对其进行了微调。</li>\n</ul>\n<h3 id=\"深入实验\"><a class=\"anchor\" href=\"#深入实验\">#</a> 深入实验</h3>\n<h4 id=\"消融研究\"><a class=\"anchor\" href=\"#消融研究\">#</a> 消融研究</h4>\n<ul>\n<li>删除任何自监督目标都会导致性能下降</li>\n</ul>\n<h1 id=\"代码\"><a class=\"anchor\" href=\"#代码\">#</a> 代码</h1>\n<h2 id=\"modulespy\"><a class=\"anchor\" href=\"#modulespy\">#</a> <span class=\"exturl\" data-url=\"aHR0cDovL21vZHVsZXMucHk=\">modules.py</span></h2>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">gelu</span>(<span class=\"params\">x</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * <span class=\"number\">0.5</span> * (<span class=\"number\">1.0</span> + torch.erf(x / math.sqrt(<span class=\"number\">2.0</span>)))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">swish</span>(<span class=\"params\">x</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * torch.sigmoid(x)</span><br><span class=\"line\"></span><br><span class=\"line\">ACT2FN = &#123;<span class=\"string\">&quot;gelu&quot;</span>: gelu, <span class=\"string\">&quot;relu&quot;</span>: F.relu, <span class=\"string\">&quot;swish&quot;</span>: swish&#125;</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>\n<p>均为激活函数</p>\n</li>\n<li>\n<p><code>gelu</code>  函数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>⋅</mo><mn>0.5</mn><mo>⋅</mo><mo stretchy=\"false\">(</mo><mn>1.0</mn><mo>+</mo><mi>e</mi><mi>r</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mfrac><mi>x</mi><msqrt><mn>2.0</mn></msqrt></mfrac><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x⋅0.5⋅(1.0+erf(\\frac x {\\sqrt  {2.0} }))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.44445em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2879999999999998em;vertical-align:-0.5379999999999999em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.695392em;\"><span style=\"top:-2.5510085em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord sqrt mtight\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.912845em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mtight\" style=\"padding-left:0.833em;\"><span class=\"mord mtight\">2</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">0</span></span></span><span style=\"top:-2.872845em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail mtight\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.12715500000000002em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5379999999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">erf</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>2</mn><msqrt><mi>π</mi></msqrt></mfrac><msubsup><mo>∫</mo><mn>0</mn><mi>x</mi></msubsup><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></msup><mi>d</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">\\operatorname{erf}(x)=\\frac{2}{\\sqrt{\\pi}}\\int_0^xe^{-t^2} dt\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\" style=\"margin-right:0.07778em;\">f</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3442920000000003em;vertical-align:-0.9300000000000002em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.30972em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8002800000000001em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span><span style=\"top:-2.76028em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.23972em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9300000000000002em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.414292em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129000000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119499999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0369199999999998em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913142857142857em;\"><span style=\"top:-2.931em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span></span></span></span></span></p>\n<ul>\n<li>误差函数</li>\n</ul>\n</li>\n<li>\n<p><code>swish</code>  函数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>⋅</mo><mi>σ</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x⋅σ(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.44445em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></p>\n</li>\n</ul>\n<h3 id=\"层归一化\"><a class=\"anchor\" href=\"#层归一化\">#</a> 层归一化</h3>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left right\" columnspacing=\"0em 1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>1.计算均值:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>μ</mi><mo>=</mo><mfrac><mn>1</mn><mi>D</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></munderover><msub><mi>x</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>2. 计算方差:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mi>D</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>3. 归一化:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi></mrow><msqrt><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi></mrow></msqrt></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>其中</mtext><mo separator=\"true\">,</mo><mi>ϵ</mi><mtext>是一个小常数</mtext><mo separator=\"true\">,</mo><mtext>用于防止除以零。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>4缩放和平移:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>γ</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub><mo>+</mo><mi>β</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>其中</mtext><mo separator=\"true\">,</mo><mi>γ</mi><mtext>和</mtext><mi>β</mi><mtext>是可学习的参数</mtext><mo separator=\"true\">,</mo><mtext>分别用于缩放和平移。</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n&amp;\\text{1.计算均值:} \\\\\n&amp;&amp;\\mu=\\frac{1}{D}\\sum_{i=1}^{D}x_{i} \\\\\n&amp;\\text{2. 计算方差:} \\\\\n&amp;&amp; \\sigma^{2}=\\frac{1}{D}\\sum_{i=1}^{D}(x_{i}-\\mu)^{2} \\\\\n&amp;\\text{3. 归一化:} \\\\\n&amp;&amp;\\hat{x}_{i}=\\frac{x_{i}-\\mu}{\\sqrt{\\sigma^{2}+\\epsilon}} \\\\\n&amp;其中,\\epsilon 是一个小常数,用于防止除以零。 \\\\\n&amp;\\text{4}\\text{缩放和平移:} \\\\\n&amp;&amp;y_{i}=\\gamma\\hat{x}_{i}+\\beta \\\\\n&amp;其中,\\gamma 和\\beta 是可学习的参数,分别用于缩放和平移。\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:19.80234em;vertical-align:-9.65117em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:10.15117em;\"><span style=\"top:-13.139506em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"></span></span><span style=\"top:-10.65117em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"></span></span><span style=\"top:-8.233501em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"></span></span><span style=\"top:-5.745165em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.327496em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.4071659999999997em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.6628340000000001em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"></span></span><span style=\"top:2.162834em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"></span></span><span style=\"top:3.662834em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"></span></span><span style=\"top:5.162834em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:9.65117em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:10.15117em;\"><span style=\"top:-13.139506em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord\">1.</span><span class=\"mord cjk_fallback\">计算均值</span><span class=\"mord\">:</span></span></span></span><span style=\"top:-10.65117em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"></span></span></span><span style=\"top:-8.233501em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord\">2. </span><span class=\"mord cjk_fallback\">计算方差</span><span class=\"mord\">:</span></span></span></span><span style=\"top:-5.745165em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"></span></span></span><span style=\"top:-3.327496em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord\">3. </span><span class=\"mord cjk_fallback\">归一化</span><span class=\"mord\">:</span></span></span></span><span style=\"top:-1.4071659999999997em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"></span></span></span><span style=\"top:0.6628340000000001em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord cjk_fallback\">其</span><span class=\"mord cjk_fallback\">中</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mord cjk_fallback\">是</span><span class=\"mord cjk_fallback\">一</span><span class=\"mord cjk_fallback\">个</span><span class=\"mord cjk_fallback\">小</span><span class=\"mord cjk_fallback\">常</span><span class=\"mord cjk_fallback\">数</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord cjk_fallback\">用</span><span class=\"mord cjk_fallback\">于</span><span class=\"mord cjk_fallback\">防</span><span class=\"mord cjk_fallback\">止</span><span class=\"mord cjk_fallback\">除</span><span class=\"mord cjk_fallback\">以</span><span class=\"mord cjk_fallback\">零</span><span class=\"mord cjk_fallback\">。</span></span></span><span style=\"top:2.162834em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord\">4</span></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">缩放和平移</span><span class=\"mord\">:</span></span></span></span><span style=\"top:3.662834em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"></span></span></span><span style=\"top:5.162834em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord cjk_fallback\">其</span><span class=\"mord cjk_fallback\">中</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mord cjk_fallback\">和</span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mord cjk_fallback\">是</span><span class=\"mord cjk_fallback\">可</span><span class=\"mord cjk_fallback\">学</span><span class=\"mord cjk_fallback\">习</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">参</span><span class=\"mord cjk_fallback\">数</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord cjk_fallback\">分</span><span class=\"mord cjk_fallback\">别</span><span class=\"mord cjk_fallback\">用</span><span class=\"mord cjk_fallback\">于</span><span class=\"mord cjk_fallback\">缩</span><span class=\"mord cjk_fallback\">放</span><span class=\"mord cjk_fallback\">和</span><span class=\"mord cjk_fallback\">平</span><span class=\"mord cjk_fallback\">移</span><span class=\"mord cjk_fallback\">。</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:9.65117em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:8.65117em;\"><span style=\"top:-10.65117em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-5.745165em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-1.4071659999999997em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.22222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603300000000002em;\"><span style=\"top:-2.196611em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.913389em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.873389em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.12661100000000003em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:3.662834em;\"><span class=\"pstrut\" style=\"height:3.828336em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.22222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:8.15117em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">LayerNorm</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, hidden_size, eps=<span class=\"number\">1e-12</span></span>):</span><br><span class=\"line\">        <span class=\"string\">&quot;&quot;&quot;Construct a layernorm module in the TF style (epsilon inside the square root).</span></span><br><span class=\"line\"><span class=\"string\">        &quot;&quot;&quot;</span></span><br><span class=\"line\">        <span class=\"built_in\">super</span>(LayerNorm, self).__init__()</span><br><span class=\"line\">        self.weight = nn.Parameter(torch.ones(hidden_size))</span><br><span class=\"line\">        self.bias = nn.Parameter(torch.zeros(hidden_size))</span><br><span class=\"line\">        self.variance_epsilon = eps</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x</span>):</span><br><span class=\"line\">        u = x.mean(-<span class=\"number\">1</span>, keepdim=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        s = (x - u).<span class=\"built_in\">pow</span>(<span class=\"number\">2</span>).mean(-<span class=\"number\">1</span>, keepdim=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        x = (x - u) / torch.sqrt(s + self.variance_epsilon)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> self.weight * x + self.bias</span><br></pre></td></tr></table></figure></p>\n<ol>\n<li><strong>前向传播函数  <code>forward</code> </strong>:\n<ul>\n<li><code>u = x.mean(-1, keepdim=True)</code> ：计算输入  <code>x</code>  在最后一个维度上的均值  <code>u</code> 。</li>\n<li><code>s = (x - u).pow(2).mean(-1, keepdim=True)</code> ：计算输入  <code>x</code>  在最后一个维度上的方差  <code>s</code> 。</li>\n<li><code>x = (x - u) / torch.sqrt(s + self.variance_epsilon)</code> ：对输入  <code>x</code>  进行归一化。</li>\n<li><code>return self.weight * x + self.bias</code> ：应用缩放和偏移参数。</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"嵌入层-2\"><a class=\"anchor\" href=\"#嵌入层-2\">#</a> 嵌入层</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Embeddings</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;Construct the embeddings from item, position.</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, args</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(Embeddings, self).__init__()</span><br><span class=\"line\"></span><br><span class=\"line\">        self.item_embeddings = nn.Embedding(args.item_size, args.hidden_size, padding_idx=<span class=\"number\">0</span>) <span class=\"comment\"># 不要乱用padding_idx</span></span><br><span class=\"line\">        self.position_embeddings = nn.Embedding(args.max_seq_length, args.hidden_size)</span><br><span class=\"line\"></span><br><span class=\"line\">        self.LayerNorm = LayerNorm(args.hidden_size, eps=<span class=\"number\">1e-12</span>)</span><br><span class=\"line\">        self.dropout = nn.Dropout(args.hidden_dropout_prob)</span><br><span class=\"line\"></span><br><span class=\"line\">        self.args = args</span><br></pre></td></tr></table></figure></p>\n<p><strong>项目嵌入层  <code>self.item_embeddings</code> </strong>：</p>\n<ul>\n<li>使用  <code>nn.Embedding</code>  创建一个嵌入层，用于将项目 ID 映射到高维向量表示。</li>\n<li><code>args.item_size</code> ：项目的总数。</li>\n<li><code>args.hidden_size</code> ：每个嵌入向量的维度。</li>\n<li><code>padding_idx=0</code> ：指定填充索引为 0，以便模型可以忽略填充值。</li>\n</ul>\n<p><strong>位置嵌入层  <code>self.position_embeddings</code> </strong>：</p>\n<ul>\n<li>使用  <code>nn.Embedding</code>  创建一个嵌入层，用于将位置 ID 映射到高维向量表示。</li>\n<li><code>args.max_seq_length</code> ：序列的最大长度。</li>\n<li><code>args.hidden_size</code> ：每个嵌入向量的维度。</li>\n</ul>\n<p><strong>层归一化  <code>self.LayerNorm</code> </strong>：</p>\n<ul>\n<li>使用自定义的  <code>LayerNorm</code>  类对嵌入进行标准化，以提高训练的稳定性。</li>\n</ul>\n<p><strong>丢弃层  <code>self.dropout</code> </strong>：</p>\n<ul>\n<li>使用  <code>nn.Dropout</code>  对嵌入进行随机丢弃，以防止过拟合。</li>\n<li><code>args.hidden_dropout_prob</code> ：丢弃的概率。</li>\n</ul>\n<p><strong>参数  <code>self.args</code> </strong>：</p>\n<ul>\n<li>保存传入的参数  <code>args</code> 。</li>\n</ul>\n<h4 id=\"前向传播函数-forward\"><a class=\"anchor\" href=\"#前向传播函数-forward\">#</a> 前向传播函数  <code>forward</code></h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, input_ids</span>):</span><br><span class=\"line\">    seq_length = input_ids.size(<span class=\"number\">1</span>)</span><br><span class=\"line\">    position_ids = torch.arange(seq_length, dtype=torch.long, device=input_ids.device)</span><br><span class=\"line\">    position_ids = position_ids.unsqueeze(<span class=\"number\">0</span>).expand_as(input_ids)</span><br><span class=\"line\">    items_embeddings = self.item_embeddings(input_ids)</span><br><span class=\"line\">    position_embeddings = self.position_embeddings(position_ids)</span><br><span class=\"line\">    embeddings = items_embeddings + position_embeddings</span><br><span class=\"line\">    <span class=\"comment\"># 修改属性</span></span><br><span class=\"line\">    embeddings = self.LayerNorm(embeddings)</span><br><span class=\"line\">    embeddings = self.dropout(embeddings)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> embeddings</span><br></pre></td></tr></table></figure></p>\n<p>该函数定义了输入通过嵌入层时的计算流程。</p>\n<ol>\n<li><strong>计算序列长度  <code>seq_length</code> </strong>：\n<ul>\n<li><code>input_ids.size(1)</code>  获取输入序列的长度。</li>\n</ul>\n</li>\n<li><strong>生成位置 ID  <code>position_ids</code> </strong>：\n<ul>\n<li><code>torch.arange(seq_length, dtype=torch.long, device=input_ids.device)</code>  创建一个从 0 到  <code>seq_length-1</code>  的位置 ID 张量。</li>\n<li><code>position_ids.unsqueeze(0).expand_as(input_ids)</code>  将位置 ID 扩展为与输入 ID 相同的形状。</li>\n</ul>\n</li>\n<li><strong>计算项目嵌入  <code>items_embeddings</code> </strong>：\n<ul>\n<li><code>self.item_embeddings(input_ids)</code>  使用项目嵌入层将输入 ID 映射到嵌入向量。</li>\n</ul>\n</li>\n<li><strong>计算位置嵌入  <code>position_embeddings</code> </strong>：\n<ul>\n<li><code>self.position_embeddings(position_ids)</code>  使用位置嵌入层将位置 ID 映射到嵌入向量。</li>\n</ul>\n</li>\n<li><strong>合并嵌入  <code>embeddings</code> </strong>：\n<ul>\n<li><code>embeddings = items_embeddings + position_embeddings</code>  将项目嵌入和位置嵌入相加，得到最终的嵌入向量。</li>\n</ul>\n</li>\n<li><strong>层归一化  <code>embeddings = self.LayerNorm(embeddings)</code> </strong>：\n<ul>\n<li>对合并后的嵌入向量进行层归一化。</li>\n</ul>\n</li>\n<li><strong>丢弃处理  <code>embeddings = self.dropout(embeddings)</code> </strong>：\n<ul>\n<li>对归一化后的嵌入向量进行随机丢弃。</li>\n</ul>\n</li>\n<li><strong>返回结果  <code>return embeddings</code> </strong>：\n<ul>\n<li>返回处理后的嵌入向量。</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"自注意力层\"><a class=\"anchor\" href=\"#自注意力层\">#</a> 自注意力层</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">SelfAttention</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, args</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(SelfAttention, self).__init__()</span><br><span class=\"line\">        <span class=\"keyword\">if</span> args.hidden_size % args.num_attention_heads != <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"keyword\">raise</span> ValueError(<span class=\"string\">&quot;The hidden size is not a multiple of the number of attention heads&quot;</span>)</span><br><span class=\"line\">        self.num_attention_heads = args.num_attention_heads</span><br><span class=\"line\">        self.attention_head_size = <span class=\"built_in\">int</span>(args.hidden_size / args.num_attention_heads)</span><br><span class=\"line\">        self.all_head_size = self.num_attention_heads * self.attention_head_size</span><br><span class=\"line\">        self.query = nn.Linear(args.hidden_size, self.all_head_size)</span><br><span class=\"line\">        self.key = nn.Linear(args.hidden_size, self.all_head_size)</span><br><span class=\"line\">        self.value = nn.Linear(args.hidden_size, self.all_head_size)</span><br><span class=\"line\">        self.attn_dropout = nn.Dropout(args.attention_probs_dropout_prob)</span><br><span class=\"line\">        <span class=\"comment\"># 做完self-attention 做一个前馈全连接 LayerNorm 输出</span></span><br><span class=\"line\">        self.dense = nn.Linear(args.hidden_size, args.hidden_size)</span><br><span class=\"line\">        self.LayerNorm = LayerNorm(args.hidden_size, eps=<span class=\"number\">1e-12</span>)</span><br><span class=\"line\">        self.out_dropout = nn.Dropout(args.hidden_dropout_prob)</span><br></pre></td></tr></table></figure></p>\n<p><strong>检查 hidden_size 和 num_attention_heads</strong>:</p>\n<ul>\n<li>如果  <code>hidden_size</code>  不能被  <code>num_attention_heads</code>  整除，抛出一个错误。</li>\n</ul>\n<p><strong>定义参数</strong>:</p>\n<ul>\n<li><code>self.num_attention_heads</code> ：注意力头的数量。</li>\n<li><code>self.attention_head_size</code> ：每个注意力头的大小。</li>\n<li><code>self.all_head_size</code> ：所有注意力头的总大小，即  <code>num_attention_heads * attention_head_size</code> 。</li>\n</ul>\n<p><strong>定义线性变换层</strong>:</p>\n<ul>\n<li><code>self.query</code> ：用于生成查询向量。</li>\n<li><code>self.key</code> ：用于生成键向量。</li>\n<li><code>self.value</code> ：用于生成值向量。</li>\n</ul>\n<p><strong>定义丢弃层</strong>:</p>\n<ul>\n<li><code>self.attn_dropout</code> ：用于注意力概率的丢弃。</li>\n<li><code>self.out_dropout</code> ：用于输出的丢弃。</li>\n</ul>\n<p><strong>定义层归一化</strong>:</p>\n<ul>\n<li><code>self.LayerNorm</code> ：用于输出的层归一化。</li>\n</ul>\n<h4 id=\"转置函数\"><a class=\"anchor\" href=\"#转置函数\">#</a> 转置函数</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">transpose_for_scores</span>(<span class=\"params\">self, x</span>):</span><br><span class=\"line\">    new_x_shape = x.size()[:-<span class=\"number\">1</span>] + (self.num_attention_heads, self.attention_head_size)</span><br><span class=\"line\">    x = x.view(*new_x_shape)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x.permute(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>)</span><br></pre></td></tr></table></figure></p>\n<p><code>new_x_shape</code> ：新的形状为  <code>(batch_size, seq_length, num_attention_heads, attention_head_size)</code> 。</p>\n<p><code>x.view(*new_x_shape)</code> ：调整  <code>x</code>  的形状为新的形状。</p>\n<p><code>x.permute(0, 2, 1, 3)</code> ：调整维度顺序为  <code>(batch_size, num_attention_heads, seq_length, attention_head_size)</code> 。</p>\n<h4 id=\"前向传播函数\"><a class=\"anchor\" href=\"#前向传播函数\">#</a> 前向传播函数</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, input_tensor, attention_mask</span>):</span><br><span class=\"line\">     mixed_query_layer = self.query(input_tensor)</span><br><span class=\"line\">     mixed_key_layer = self.key(input_tensor)</span><br><span class=\"line\">     mixed_value_layer = self.value(input_tensor)</span><br><span class=\"line\"></span><br><span class=\"line\">     query_layer = self.transpose_for_scores(mixed_query_layer)</span><br><span class=\"line\">     key_layer = self.transpose_for_scores(mixed_key_layer)</span><br><span class=\"line\">     value_layer = self.transpose_for_scores(mixed_value_layer)</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"comment\"># Take the dot product between &quot;query&quot; and &quot;key&quot; to get the raw attention scores.</span></span><br><span class=\"line\">     attention_scores = torch.matmul(query_layer, key_layer.transpose(-<span class=\"number\">1</span>, -<span class=\"number\">2</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">     attention_scores = attention_scores / math.sqrt(self.attention_head_size)</span><br><span class=\"line\">     <span class=\"comment\"># Apply the attention mask is (precomputed for all layers in BertModel forward() function)</span></span><br><span class=\"line\">     <span class=\"comment\"># [batch_size heads seq_len seq_len] scores</span></span><br><span class=\"line\">     <span class=\"comment\"># [batch_size 1 1 seq_len]</span></span><br><span class=\"line\">     attention_scores = attention_scores + attention_mask</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"comment\"># Normalize the attention scores to probabilities.</span></span><br><span class=\"line\">     attention_probs = nn.Softmax(dim=-<span class=\"number\">1</span>)(attention_scores)</span><br><span class=\"line\">     <span class=\"comment\"># This is actually dropping out entire tokens to attend to, which might</span></span><br><span class=\"line\">     <span class=\"comment\"># seem a bit unusual, but is taken from the original Transformer paper.</span></span><br><span class=\"line\">     <span class=\"comment\"># Fixme</span></span><br><span class=\"line\">     attention_probs = self.attn_dropout(attention_probs)</span><br><span class=\"line\">     context_layer = torch.matmul(attention_probs, value_layer)</span><br><span class=\"line\">     context_layer = context_layer.permute(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>).contiguous()</span><br><span class=\"line\">     new_context_layer_shape = context_layer.size()[:-<span class=\"number\">2</span>] + (self.all_head_size,)</span><br><span class=\"line\">     context_layer = context_layer.view(*new_context_layer_shape)</span><br><span class=\"line\">     hidden_states = self.dense(context_layer)</span><br><span class=\"line\">     hidden_states = self.out_dropout(hidden_states)</span><br><span class=\"line\">     hidden_states = self.LayerNorm(hidden_states + input_tensor)</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"keyword\">return</span> hidden_states</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><strong>计算查询、键和值向量</strong></li>\n<li>使用  <code>transpose_for_scores</code>  函数调整查询、键和值向量的形状。</li>\n</ul>\n<p><strong>计算注意力分数</strong>：</p>\n<ul>\n<li><code>attention_scores = torch.matmul(query_layer, key_layer.transpose(-1, -2))</code> ：计算查询和键向量的点积，得到注意力分数。</li>\n<li><code>attention_scores = attention_scores / math.sqrt(self.attention_head_size)</code> ：将注意力分数缩放，以减小数值范围。</li>\n<li><code>attention_scores = attention_scores + attention_mask</code> ：将注意力掩码添加到注意力分数中，以避免关注填充位置。</li>\n</ul>\n<p><strong>计算注意力概率</strong>：</p>\n<ul>\n<li><code>attention_probs = nn.Softmax(dim=-1)(attention_scores)</code> ：对注意力分数应用 <strong>softmax</strong> 函数，得到注意力概率。</li>\n<li><code>attention_probs = self.attn_dropout(attention_probs)</code> ：对注意力概率应用丢弃。</li>\n</ul>\n<p><strong>计算上下文层</strong>：</p>\n<ul>\n<li><code>context_layer = torch.matmul(attention_probs, value_layer)</code> ：使用注意力概率加权值向量，得到上下文层。</li>\n<li><code>context_layer = context_layer.permute(0, 2, 1, 3).contiguous()</code> ：调整上下文层的形状。</li>\n<li><code>new_context_layer_shape = context_layer.size()[:-2] + (self.all_head_size,)</code> ：计算新的上下文层形状。</li>\n<li><code>context_layer = context_layer.view(*new_context_layer_shape)</code> ：调整上下文层的形状为新的形状。</li>\n</ul>\n<p><strong>应用线性变换和丢弃</strong>：</p>\n<ul>\n<li><code>hidden_states = self.dense(context_layer)</code> ：对上下文层应用线性变换。</li>\n<li><code>hidden_states = self.out_dropout(hidden_states)</code> ：对线性变换后的结果应用丢弃。</li>\n</ul>\n<p><strong>应用层归一化</strong>：</p>\n<ul>\n<li><code>hidden_states = self.LayerNorm(hidden_states + input_tensor)</code> ：对结果应用层归一化，并添加输入张量（残差连接）。</li>\n</ul>\n<p><strong>返回结果</strong>：</p>\n<ul>\n<li>返回处理后的隐状态（hidden states）。</li>\n</ul>\n<h3 id=\"前馈神经网络fnn\"><a class=\"anchor\" href=\"#前馈神经网络fnn\">#</a> 前馈神经网络 FNN</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Intermediate</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, args</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(Intermediate, self).__init__()</span><br><span class=\"line\">        self.dense_1 = nn.Linear(args.hidden_size, args.hidden_size * <span class=\"number\">4</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">isinstance</span>(args.hidden_act, <span class=\"built_in\">str</span>):</span><br><span class=\"line\">            self.intermediate_act_fn = ACT2FN[args.hidden_act]</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            self.intermediate_act_fn = args.hidden_act</span><br><span class=\"line\"></span><br><span class=\"line\">        self.dense_2 = nn.Linear(args.hidden_size * <span class=\"number\">4</span>, args.hidden_size)</span><br><span class=\"line\">        self.LayerNorm = LayerNorm(args.hidden_size, eps=<span class=\"number\">1e-12</span>)</span><br><span class=\"line\">        self.dropout = nn.Dropout(args.hidden_dropout_prob)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, input_tensor</span>):</span><br><span class=\"line\"></span><br><span class=\"line\">        hidden_states = self.dense_1(input_tensor)</span><br><span class=\"line\">        hidden_states = self.intermediate_act_fn(hidden_states)</span><br><span class=\"line\"></span><br><span class=\"line\">        hidden_states = self.dense_2(hidden_states)</span><br><span class=\"line\">        hidden_states = self.dropout(hidden_states)</span><br><span class=\"line\">        hidden_states = self.LayerNorm(hidden_states + input_tensor)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> hidden_states</span><br></pre></td></tr></table></figure></p>\n<p><strong>线性变换层  <code>dense_1</code> </strong>:</p>\n<ul>\n<li><code>self.dense_1 = nn.Linear(args.hidden_size, args.hidden_size * 4)</code> ：定义第一层线性变换，将输入的维度从  <code>hidden_size</code>  扩展到  <code>hidden_size * 4</code> 。</li>\n</ul>\n<p><strong>激活函数  <code>intermediate_act_fn</code> </strong>:</p>\n<ul>\n<li><code>if isinstance(args.hidden_act, str): self.intermediate_act_fn = ACT2FN[args.hidden_act]</code> ：如果  <code>args.hidden_act</code>  是字符串，从  <code>ACT2FN</code>  字典中查找对应的激活函数。</li>\n<li><code>else: self.intermediate_act_fn = args.hidden_act</code> ：否则直接使用传入的激活函数。</li>\n</ul>\n<p><strong>线性变换层  <code>dense_2</code> </strong>:</p>\n<ul>\n<li><code>self.dense_2 = nn.Linear(args.hidden_size * 4, args.hidden_size)</code> ：定义第二层线性变换，将维度从  <code>hidden_size * 4</code>  缩小回  <code>hidden_size</code> 。</li>\n</ul>\n<p><strong>层归一化  <code>LayerNorm</code> </strong>:</p>\n<ul>\n<li><code>self.LayerNorm = LayerNorm(args.hidden_size, eps=1e-12)</code> ：定义层归一化模块，用于归一化输出。</li>\n</ul>\n<p><strong>丢弃层  <code>dropout</code> </strong>:</p>\n<ul>\n<li><code>self.dropout = nn.Dropout(args.hidden_dropout_prob)</code> ：定义丢弃层，用于防止过拟合。</li>\n</ul>\n<p><strong>第一层线性变换</strong>：</p>\n<ul>\n<li><code>hidden_states = self.dense_1(input_tensor)</code> ：将输入  <code>input_tensor</code>  通过第一层线性变换，得到  <code>hidden_states</code> ，维度从  <code>hidden_size</code>  扩展到  <code>hidden_size * 4</code> 。</li>\n</ul>\n<p><strong>激活函数</strong>：</p>\n<ul>\n<li><code>hidden_states = self.intermediate_act_fn(hidden_states)</code> ：对  <code>hidden_states</code>  应用激活函数，增加非线性。</li>\n</ul>\n<p><strong>第二层线性变换</strong>：</p>\n<ul>\n<li><code>hidden_states = self.dense_2(hidden_states)</code> ：将  <code>hidden_states</code>  通过第二层线性变换，维度从  <code>hidden_size * 4</code>  缩小回  <code>hidden_size</code> 。</li>\n</ul>\n<p><strong>丢弃层</strong>：</p>\n<ul>\n<li><code>hidden_states = self.dropout(hidden_states)</code> ：对  <code>hidden_states</code>  应用丢弃层，防止过拟合。</li>\n</ul>\n<p><strong>层归一化</strong>：</p>\n<ul>\n<li><code>hidden_states = self.LayerNorm(hidden_states + input_tensor)</code> ：将归一化后的  <code>hidden_states</code>  与输入  <code>input_tensor</code>  相加（残差连接），并进行层归一化。</li>\n</ul>\n<p><strong>返回结果</strong>：</p>\n<ul>\n<li>返回处理后的  <code>hidden_states</code> 。</li>\n</ul>\n<h3 id=\"layer-类\"><a class=\"anchor\" href=\"#layer-类\">#</a> Layer 类</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Layer</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, args</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(Layer, self).__init__()</span><br><span class=\"line\">        self.attention = SelfAttention(args)</span><br><span class=\"line\">        self.intermediate = Intermediate(args)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, hidden_states, attention_mask</span>):</span><br><span class=\"line\">        attention_output = self.attention(hidden_states, attention_mask)</span><br><span class=\"line\">        intermediate_output = self.intermediate(attention_output)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> intermediate_output</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>初始化自注意模块和前馈神经网络</li>\n<li>注意力输出  <code>attention_output</code>  传递给前馈神经网络模块  <code>self.intermediate</code> 。</li>\n<li>前馈神经网络模块进一步处理注意力输出，得到中间输出  <code>intermediate_output</code> 。</li>\n</ul>\n<h3 id=\"编码层transformer\"><a class=\"anchor\" href=\"#编码层transformer\">#</a> 编码层（Transformer）</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Encoder</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, args</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(Encoder, self).__init__()</span><br><span class=\"line\">        layer = Layer(args)</span><br><span class=\"line\">        self.layer = nn.ModuleList([copy.deepcopy(layer)</span><br><span class=\"line\">                                    <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(args.num_hidden_layers)])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, hidden_states, attention_mask, output_all_encoded_layers=<span class=\"literal\">True</span></span>):</span><br><span class=\"line\">        all_encoder_layers = []</span><br><span class=\"line\">        <span class=\"keyword\">for</span> layer_module <span class=\"keyword\">in</span> self.layer:</span><br><span class=\"line\">            hidden_states = layer_module(hidden_states, attention_mask)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> output_all_encoded_layers:</span><br><span class=\"line\">                all_encoder_layers.append(hidden_states)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> output_all_encoded_layers:</span><br><span class=\"line\">            all_encoder_layers.append(hidden_states)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> all_encoder_layers</span><br></pre></td></tr></table></figure></p>\n<p><strong>创建单层  <code>Layer</code>  实例</strong>：</p>\n<ul>\n<li><code>layer = Layer(args)</code> ：创建一个  <code>Layer</code>  实例， <code>Layer</code>  类在前面已经定义过，包含自注意力和前馈神经网络模块。</li>\n</ul>\n<p><strong>堆叠多层  <code>Layer</code>  实例</strong>：</p>\n<ul>\n<li>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>self<span class=\"token punctuation\">.</span>layer <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>ModuleList<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>copy<span class=\"token punctuation\">.</span>deepcopy<span class=\"token punctuation\">(</span>layer<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">.</span>num_hidden_layers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>code￼<span class=\"token number\">14</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr></table></figure></li>\n</ul>\n<ul>\n<li>初始化模型，包括嵌入层（物品嵌入、属性嵌入、位置嵌入）、编码器、层归一化和 Dropout。</li>\n<li>初始化用于不同损失计算的全连接层和损失函数（BCELoss）。</li>\n</ul>\n<h3 id=\"添加位置嵌入\"><a class=\"anchor\" href=\"#添加位置嵌入\">#</a> 添加位置嵌入</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">add_position_embedding</span>(<span class=\"params\">self, sequence</span>):</span><br><span class=\"line\">    seq_length = sequence.size(<span class=\"number\">1</span>)</span><br><span class=\"line\">    position_ids = torch.arange(seq_length, dtype=torch.long, device=sequence.device)</span><br><span class=\"line\">    position_ids = position_ids.unsqueeze(<span class=\"number\">0</span>).expand_as(sequence)</span><br><span class=\"line\">    item_embeddings = self.item_embeddings(sequence)</span><br><span class=\"line\">    position_embeddings = self.position_embeddings(position_ids)</span><br><span class=\"line\">    sequence_emb = item_embeddings + position_embeddings</span><br><span class=\"line\">    sequence_emb = self.LayerNorm(sequence_emb)</span><br><span class=\"line\">    sequence_emb = self.dropout(sequence_emb)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sequence_emb</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>计算位置嵌入并与物品嵌入相加，随后进行层归一化和 Dropout。</li>\n<li>先获取输入序列的长度</li>\n<li><code>torch.arange(seq_length, dtype=torch.long, device=sequence.device)</code> ：生成一个从  <code>0</code>  到  <code>seq_length-1</code>  的位置 ID 张量，数据类型为  <code>long</code> ，并且与输入序列的设备相同（CPU 或 GPU）。</li>\n<li><code>position_ids.unsqueeze(0)</code> ：在第一个维度上增加一个维度，使其形状变为  <code>(1, seq_length)</code> 。</li>\n<li><code>position_ids.expand_as(sequence)</code> ：将位置 ID 张量扩展为与输入序列形状相同的张量  <code>(batch_size, seq_length)</code> 。</li>\n<li><strong>获取项目嵌入</strong>： <code>self.item_embeddings(sequence)</code> ：使用项目嵌入层将输入序列中的项目 ID 映射到嵌入向量，得到的  <code>item_embeddings</code>  形状为  <code>(batch_size, seq_length, hidden_size)</code> 。</li>\n<li><strong>获取位置嵌入</strong>： <code>self.position_embeddings(position_ids)</code> ：使用位置嵌入层将位置 ID 映射到嵌入向量，得到的  <code>position_embeddings</code>  形状为  <code>(batch_size, seq_length, hidden_size)</code> 。</li>\n<li>将项目嵌入和位置嵌入相加，得到最终的序列嵌入  <code>sequence_emb</code> ，形状为  <code>(batch_size, seq_length, hidden_size)</code> 。</li>\n<li>使用层归一化模块对序列嵌入进行归一化，保证每个样本的特征分布稳定。</li>\n<li>使用丢弃层对归一化后的序列嵌入进行随机丢弃，以防止过拟合。</li>\n<li>返回处理后的序列嵌入  <code>sequence_emb</code> 。</li>\n</ul>\n<h3 id=\"自监督学习目标-2\"><a class=\"anchor\" href=\"#自监督学习目标-2\">#</a> 自监督学习目标</h3>\n<h4 id=\"aap-associated-attribute-prediction-预测与物品相关的属性\"><a class=\"anchor\" href=\"#aap-associated-attribute-prediction-预测与物品相关的属性\">#</a> AAP (Associated Attribute Prediction) 预测与物品相关的属性</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">associated_attribute_prediction</span>(<span class=\"params\">self, sequence_output, attribute_embedding</span>):</span><br><span class=\"line\">    sequence_output = self.aap_norm(sequence_output)</span><br><span class=\"line\">    sequence_output = sequence_output.view([-<span class=\"number\">1</span>, self.args.hidden_size, <span class=\"number\">1</span>])</span><br><span class=\"line\">    score = torch.matmul(attribute_embedding, sequence_output)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> torch.sigmoid(score.squeeze(-<span class=\"number\">1</span>))</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>归一化序列输出</li>\n<li>使用  <code>view</code>  方法调整  <code>sequence_output</code>  的形状，使其变为三维张量，形状为  <code>[batch_size * seq_length, hidden_size, 1]</code> 。</li>\n<li><code>score = torch.matmul(attribute_embedding, sequence_output)</code>  使用矩阵乘法  <code>torch.matmul</code>  计算  <code>attribute_embedding</code>  和  <code>sequence_output</code>  之间的乘积。</li>\n<li>使用  <code>squeeze(-1)</code>  移除最后一个维度，将  <code>score</code>  的形状从  <code>[batch_size * seq_length, num_attributes, 1]</code>  变为  <code>[batch_size * seq_length, num_attributes]</code> 。</li>\n<li>使用 torch.sigmoid 函数将得分转换为概率，返回最终的预测结果。</li>\n</ul>\n<h4 id=\"mip-masked-item-prediction-预测被掩码的物品\"><a class=\"anchor\" href=\"#mip-masked-item-prediction-预测被掩码的物品\">#</a> MIP (Masked Item Prediction) 预测被掩码的物品</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">masked_item_prediction</span>(<span class=\"params\">self, sequence_output, target_item</span>):</span><br><span class=\"line\">    sequence_output = self.mip_norm(sequence_output.view([-<span class=\"number\">1</span>, self.args.hidden_size]))</span><br><span class=\"line\">    target_item = target_item.view([-<span class=\"number\">1</span>, self.args.hidden_size])</span><br><span class=\"line\">    score = torch.mul(sequence_output, target_item)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> torch.sigmoid(torch.<span class=\"built_in\">sum</span>(score, -<span class=\"number\">1</span>))</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>归一化</li>\n<li>使用  <code>view</code>  方法将  <code>target_item</code>  的形状调整为  <code>[batch_size * seq_length, hidden_size]</code> ，与  <code>sequence_output</code>  的形状匹配。</li>\n<li>使用  <code>torch.mul</code>  进行逐元素相乘，计算  <code>sequence_output</code>  和  <code>target_item</code>  之间的点乘，得到  <code>score</code> ，形状为  <code>[batch_size * seq_length, hidden_size]</code> 。</li>\n<li><code>torch.sum(score, -1)</code>  对  <code>score</code>  的最后一个维度（即  <code>hidden_size</code>  维度）求和，得到形状为  <code>[batch_size * seq_length]</code>  的张量。</li>\n<li>使用 torch.sigmoid 函数将求和结果转换为概率，返回最终的预测结果。</li>\n</ul>\n<h4 id=\"sp-segment-prediction-预测被掩码的段落\"><a class=\"anchor\" href=\"#sp-segment-prediction-预测被掩码的段落\">#</a> SP (Segment Prediction) 预测被掩码的段落。</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">segment_prediction</span>(<span class=\"params\">self, context, segment</span>):</span><br><span class=\"line\">    context = self.sp_norm(context)</span><br><span class=\"line\">    score = torch.mul(context, segment)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> torch.sigmoid(torch.<span class=\"built_in\">sum</span>(score, dim=-<span class=\"number\">1</span>))</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>归一化</li>\n<li>使用  <code>torch.mul</code>  进行逐元素相乘，计算  <code>context</code>  和  <code>segment</code>  之间的点乘，得到  <code>score</code> 。</li>\n<li><code>context</code>  和  <code>segment</code>  的形状通常为  <code>[batch_size, hidden_size]</code> ，点乘结果  <code>score</code>  的形状也为  <code>[batch_size, hidden_size]</code> 。</li>\n<li><code>torch.sum(score, dim=-1)</code>  对  <code>score</code>  的最后一个维度（即  <code>hidden_size</code>  维度）求和，得到形状为  <code>[batch_size]</code>  的张量。</li>\n<li>使用  <code>torch.sigmoid</code>  函数将求和结果转换为概率，返回最终的预测结果。</li>\n</ul>\n<h3 id=\"预训练\"><a class=\"anchor\" href=\"#预训练\">#</a> 预训练</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">pretrain</span>(<span class=\"params\">self, attributes, masked_item_sequence, pos_items, neg_items,</span></span><br><span class=\"line\"><span class=\"params\">             masked_segment_sequence, pos_segment, neg_segment</span>):</span><br><span class=\"line\">    sequence_emb = self.add_position_embedding(masked_item_sequence)</span><br><span class=\"line\">    sequence_mask = (masked_item_sequence == <span class=\"number\">0</span>).<span class=\"built_in\">float</span>() * -<span class=\"number\">1e8</span></span><br><span class=\"line\">    sequence_mask = torch.unsqueeze(torch.unsqueeze(sequence_mask, <span class=\"number\">1</span>), <span class=\"number\">1</span>)</span><br><span class=\"line\">    encoded_layers = self.item_encoder(sequence_emb, sequence_mask, output_all_encoded_layers=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    sequence_output = encoded_layers[-<span class=\"number\">1</span>]</span><br><span class=\"line\">    attribute_embeddings = self.attribute_embeddings.weight</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># AAP</span></span><br><span class=\"line\">    aap_score = self.associated_attribute_prediction(sequence_output, attribute_embeddings)</span><br><span class=\"line\">    aap_loss = self.criterion(aap_score, attributes.view(-<span class=\"number\">1</span>, self.args.attribute_size).<span class=\"built_in\">float</span>())</span><br><span class=\"line\">    aap_mask = (masked_item_sequence != self.args.mask_id).<span class=\"built_in\">float</span>() * (masked_item_sequence != <span class=\"number\">0</span>).<span class=\"built_in\">float</span>()</span><br><span class=\"line\">    aap_loss = torch.<span class=\"built_in\">sum</span>(aap_loss * aap_mask.flatten().unsqueeze(-<span class=\"number\">1</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># MIP</span></span><br><span class=\"line\">    pos_item_embs = self.item_embeddings(pos_items)</span><br><span class=\"line\">    neg_item_embs = self.item_embeddings(neg_items)</span><br><span class=\"line\">    pos_score = self.masked_item_prediction(sequence_output, pos_item_embs)</span><br><span class=\"line\">    neg_score = self.masked_item_prediction(sequence_output, neg_item_embs)</span><br><span class=\"line\">    mip_distance = torch.sigmoid(pos_score - neg_score)</span><br><span class=\"line\">    mip_loss = self.criterion(mip_distance, torch.ones_like(mip_distance, dtype=torch.float32))</span><br><span class=\"line\">    mip_mask = (masked_item_sequence == self.args.mask_id).<span class=\"built_in\">float</span>()</span><br><span class=\"line\">    mip_loss = torch.<span class=\"built_in\">sum</span>(mip_loss * mip_mask.flatten())</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># MAP</span></span><br><span class=\"line\">    map_score = self.masked_attribute_prediction(sequence_output, attribute_embeddings)</span><br><span class=\"line\">    map_loss = self.criterion(map_score, attributes.view(-<span class=\"number\">1</span>, self.args.attribute_size).<span class=\"built_in\">float</span>())</span><br><span class=\"line\">    map_mask = (masked_item_sequence == self.args.mask_id).<span class=\"built_in\">float</span>()</span><br><span class=\"line\">    map_loss = torch.<span class=\"built_in\">sum</span>(map_loss * map_mask.flatten().unsqueeze(-<span class=\"number\">1</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># SP</span></span><br><span class=\"line\">    segment_context = self.add_position_embedding(masked_segment_sequence)</span><br><span class=\"line\">    segment_mask = (masked_segment_sequence == <span class=\"number\">0</span>).<span class=\"built_in\">float</span>() * -<span class=\"number\">1e8</span></span><br><span class=\"line\">    segment_mask = torch.unsqueeze(torch.unsqueeze(segment_mask, <span class=\"number\">1</span>), <span class=\"number\">1</span>)</span><br><span class=\"line\">    segment_encoded_layers = self.item_encoder(segment_context, segment_mask, output_all_encoded_layers=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    segment_context = segment_encoded_layers[-<span class=\"number\">1</span>][:, -<span class=\"number\">1</span>, :]</span><br><span class=\"line\"></span><br><span class=\"line\">    pos_segment_emb = self.add_position_embedding(pos_segment)</span><br><span class=\"line\">    pos_segment_mask = (pos_segment == <span class=\"number\">0</span>).<span class=\"built_in\">float</span>() * -<span class=\"number\">1e8</span></span><br><span class=\"line\">    pos_segment_mask = torch.unsqueeze(torch.unsqueeze(pos_segment_mask, <span class=\"number\">1</span>), <span class=\"number\">1</span>)</span><br><span class=\"line\">    pos_segment_encoded_layers = self.item_encoder(pos_segment_emb, pos_segment_mask, output_all_encoded_layers=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    pos_segment_emb = pos_segment_encoded_layers[-<span class=\"number\">1</span>][:, -<span class=\"number\">1</span>, :]</span><br><span class=\"line\"></span><br><span class=\"line\">    neg_segment_emb = self.add_position_embedding(neg_segment)</span><br><span class=\"line\">    neg_segment_mask = (neg_segment == <span class=\"number\">0</span>).<span class=\"built_in\">float</span>() * -<span class=\"number\">1e8</span></span><br><span class=\"line\">    neg_segment_mask = torch.unsqueeze(torch.unsqueeze(neg_segment_mask, <span class=\"number\">1</span>), <span class=\"number\">1</span>)</span><br><span class=\"line\">    neg_segment_encoded_layers = self.item_encoder(neg_segment_emb, neg_segment_mask, output_all_encoded_layers=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    neg_segment_emb = neg_segment_encoded_layers[-<span class=\"number\">1</span>][:, -<span class=\"number\">1</span>, :]</span><br><span class=\"line\"></span><br><span class=\"line\">    pos_segment_score = self.segment_prediction(segment_context, pos_segment_emb)</span><br><span class=\"line\">    neg_segment_score = self.segment_prediction(segment_context, neg_segment_emb)</span><br><span class=\"line\">    sp_distance = torch.sigmoid(pos_segment_score - neg_segment_score)</span><br><span class=\"line\">    sp_loss = torch.<span class=\"built_in\">sum</span>(self.criterion(sp_distance, torch.ones_like(sp_distance, dtype=torch.float32)))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> aap_loss, mip_loss, map_loss, sp_loss</span><br></pre></td></tr></table></figure></p>\n<p><strong>添加位置嵌入并计算序列输出</strong>：</p>\n<ul>\n<li><code>sequence_emb = self.add_position_embedding(masked_item_sequence)</code> ：对掩码的项目序列添加位置嵌入。</li>\n<li><code>sequence_mask = (masked_item_sequence == 0).float() * -1e8</code> ：生成序列掩码，填充值为  <code>0</code>  的位置设置为一个大负数，以便在注意力计算时忽略这些位置。</li>\n<li><code>sequence_mask = torch.unsqueeze(torch.unsqueeze(sequence_mask, 1), 1)</code> ：调整掩码的形状。</li>\n<li><code>encoded_layers = self.item_encoder(sequence_emb, sequence_mask, output_all_encoded_layers=True)</code> ：通过编码器计算序列的编码层。</li>\n<li><code>sequence_output = encoded_layers[-1]</code> ：获取最后一层的输出。</li>\n</ul>\n<p><strong>关联属性预测 (AAP)</strong>：</p>\n<ul>\n<li><code>aap_score = self.associated_attribute_prediction(sequence_output, attribute_embeddings)</code> ：计算关联属性预测得分。</li>\n<li><code>aap_loss = self.criterion(aap_score, attributes.view(-1, self.args.attribute_size).float())</code> ：计算 AAP 损失。</li>\n<li><code>aap_mask = (masked_item_sequence != self.args.mask_id).float() * (masked_item_sequence != 0).float()</code> ：生成 AAP 掩码。</li>\n<li><code>aap_loss = torch.sum(aap_loss * aap_mask.flatten().unsqueeze(-1))</code> ：加权计算 AAP 损失。</li>\n</ul>\n<p><strong>掩码项目预测 (MIP)</strong>：</p>\n<ul>\n<li><code>pos_item_embs = self.item_embeddings(pos_items)</code> ：获取正样本的项目嵌入。</li>\n<li><code>neg_item_embs = self.item_embeddings(neg_items)</code> ：获取负样本的项目嵌入。</li>\n<li><code>pos_score = self.masked_item_prediction(sequence_output, pos_item_embs)</code> ：计算正样本得分。</li>\n<li><code>neg_score = self.masked_item_prediction(sequence_output, neg_item_embs)</code> ：计算负样本得分。</li>\n<li><code>mip_distance = torch.sigmoid(pos_score - neg_score)</code> ：计算正负样本得分差的 Sigmoid 值。</li>\n<li><code>mip_loss = self.criterion(mip_distance, torch.ones_like(mip_distance, dtype=torch.float32))</code> ：计算 MIP 损失。</li>\n<li><code>mip_mask = (masked_item_sequence == self.args.mask_id).float()</code> ：生成 MIP 掩码。</li>\n<li><code>mip_loss = torch.sum(mip_loss * mip_mask.flatten())</code> ：加权计算 MIP 损失。</li>\n</ul>\n<p><strong>掩码属性预测 (MAP)</strong>：</p>\n<ul>\n<li><code>map_score = self.masked_attribute_prediction(sequence_output, attribute_embeddings)</code> ：计算掩码属性预测得分。</li>\n<li><code>map_loss = self.criterion(map_score, attributes.view(-1, self.args.attribute_size).float())</code> ：计算 MAP 损失。</li>\n<li><code>map_mask = (masked_item_sequence == self.args.mask_id).float()</code> ：生成 MAP 掩码。</li>\n<li><code>map_loss = torch.sum(map_loss * map_mask.flatten().unsqueeze(-1))</code> ：加权计算 MAP 损失。</li>\n</ul>\n<p><strong>段落预测 (SP)</strong>：</p>\n<ul>\n<li>\n<p><code>segment_context = self.add_position_embedding(masked_segment_sequence)</code> ：对掩码的段落序列添加位置嵌入。</p>\n</li>\n<li>\n<p><code>segment_mask = (masked_segment_sequence == 0).float() * -1e8</code> ：生成段落掩码。</p>\n</li>\n<li>\n<p><code>segment_mask = torch.unsqueeze(torch.unsqueeze(segment_mask, 1), 1)</code> ：调整掩码的形状。</p>\n</li>\n<li>\n<p><code>segment_encoded_layers = self.item_encoder(segment_context, segment_mask, output_all_encoded_layers=True)</code> ：通过编码器计算段落的编码层。</p>\n</li>\n<li>\n<p><code>segment_context = segment_encoded_layers[-1][:, -1, :]</code> ：获取最后一层的段落上下文。</p>\n</li>\n<li>\n<p>对正样本和负样本重复上述步骤：</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pos_segment_emb = self.add_position_embedding(pos_segment)</span><br><span class=\"line\">pos_segment_mask = (pos_segment == <span class=\"number\">0</span>).<span class=\"built_in\">float</span>() * -<span class=\"number\">1e8</span></span><br><span class=\"line\">pos_segment_mask = torch.unsqueeze(torch.unsqueeze(pos_segment_mask, <span class=\"number\">1</span>), <span class=\"number\">1</span>)</span><br><span class=\"line\">pos_segment_encoded_layers = self.item_encoder(pos_segment_emb, pos_segment_mask, output_all_encoded_layers=<span class=\"literal\">True</span>)</span><br><span class=\"line\">pos_segment_emb = pos_segment_encoded_layers[-<span class=\"number\">1</span>][:, -<span class=\"number\">1</span>, :]</span><br><span class=\"line\">neg_segment_emb = self.add_position_embedding(neg_segment)</span><br><span class=\"line\">neg_segment_mask = (neg_segment == <span class=\"number\">0</span>).<span class=\"built_in\">float</span>() * -<span class=\"number\">1e8</span></span><br><span class=\"line\">neg_segment_mask = torch.unsqueeze(torch.unsqueeze(neg_segment_mask, <span class=\"number\">1</span>), <span class=\"number\">1</span>)</span><br><span class=\"line\">neg_segment_encoded_layers = self.item_encoder(neg_segment_emb, neg_segment_mask, output_all_encoded_layers=<span class=\"literal\">True</span>)</span><br><span class=\"line\">neg_segment_emb = neg_segment_encoded_layers[-<span class=\"number\">1</span>][:, -<span class=\"number\">1</span>, :]</span><br><span class=\"line\">pos_segment_score = self.segment_prediction(segment_context, pos_segment_emb)</span><br><span class=\"line\">neg_segment_score = self.segment_prediction(segment_context, neg_segment_emb)</span><br><span class=\"line\">sp_distance = torch.sigmoid(pos_segment_score - neg_segment_score)</span><br><span class=\"line\">sp_loss = torch.<span class=\"built_in\">sum</span>(self.criterion(sp_distance, torch.ones_like(sp_distance, dtype=torch.float32)))</span><br></pre></td></tr></table></figure></p>\n</li>\n</ul>\n<h3 id=\"微调\"><a class=\"anchor\" href=\"#微调\">#</a> 微调</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">finetune</span>(<span class=\"params\">self, input_ids</span>):</span><br><span class=\"line\">    attention_mask = (input_ids &gt; <span class=\"number\">0</span>).long()</span><br><span class=\"line\">    extended_attention_mask = attention_mask.unsqueeze(<span class=\"number\">1</span>).unsqueeze(<span class=\"number\">2</span>)</span><br><span class=\"line\">    max_len = attention_mask.size(-<span class=\"number\">1</span>)</span><br><span class=\"line\">    attn_shape = (<span class=\"number\">1</span>, max_len, max_len)</span><br><span class=\"line\">    subsequent_mask = torch.triu(torch.ones(attn_shape), diagonal=<span class=\"number\">1</span>)</span><br><span class=\"line\">    subsequent_mask = (subsequent_mask == <span class=\"number\">0</span>).unsqueeze(<span class=\"number\">1</span>).long()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> self.args.cuda_condition:</span><br><span class=\"line\">        subsequent_mask = subsequent_mask.cuda()</span><br><span class=\"line\"></span><br><span class=\"line\">    extended_attention_mask = extended_attention_mask * subsequent_mask</span><br><span class=\"line\">    extended_attention_mask = extended_attention_mask.to(dtype=<span class=\"built_in\">next</span>(self.parameters()).dtype)</span><br><span class=\"line\">    extended_attention_mask = (<span class=\"number\">1.0</span> - extended_attention_mask) * -<span class=\"number\">10000.0</span></span><br><span class=\"line\"></span><br><span class=\"line\">    sequence_emb = self.add_position_embedding(input_ids)</span><br><span class=\"line\">    item_encoded_layers = self.item_encoder(sequence_emb, extended_attention_mask, output_all_encoded_layers=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    sequence_output = item_encoded_layers[-<span class=\"number\">1</span>]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sequence_output</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>\n<p><strong>生成注意力掩码</strong>：对输入的  <code>input_ids</code>  生成掩码，填充值为  <code>0</code>  的位置设置为  <code>0</code> ，其他位置设置为  <code>1</code> 。</p>\n</li>\n<li>\n<p><strong>扩展注意力掩码</strong>：对注意力掩码进行扩展，使其形状变为  <code>[batch_size, 1, 1, seq_length]</code> 。</p>\n</li>\n<li>\n<p><strong>生成后续掩码</strong>：</p>\n<ul>\n<li><code>max_len</code>  获取序列的最大长度。</li>\n<li><code>attn_shape</code>  定义了掩码的形状  <code>[1, max_len, max_len]</code> 。</li>\n<li><code>subsequent_mask</code>  使用  <code>torch.triu</code>  生成上三角矩阵，用于屏蔽后续的时间步。</li>\n<li>将  <code>subsequent_mask</code>  的形状扩展为  <code>[1, 1, max_len, max_len]</code> 。如果使用 CUDA，将掩码移动到 GPU。</li>\n</ul>\n</li>\n<li>\n<p><strong>组合掩码</strong>：<br />\n将扩展的注意力掩码与后续掩码相乘。</p>\n<p>将掩码转换为与模型参数相同的数据类型。</p>\n<p>将掩码从  <code>1</code>  转换为  <code>0</code> ，从  <code>0</code>  转换为  <code>-10000.0</code> ，这样可以在注意力计算时有效地屏蔽那些位置。</p>\n</li>\n<li>\n<p>对输入的  <code>input_ids</code>  添加位置嵌入。</p>\n</li>\n<li>\n<p>使用编码器处理嵌入后的序列和扩展的注意力掩码。</p>\n</li>\n<li>\n<p>获取编码器的最后一层输出  <code>sequence_output</code> 。</p>\n</li>\n</ul>\n<h3 id=\"初始化权重\"><a class=\"anchor\" href=\"#初始化权重\">#</a> 初始化权重</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">init_weights</span>(<span class=\"params\">self, module</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">isinstance</span>(module, (nn.Linear, nn.Embedding)):</span><br><span class=\"line\">        module.weight.data.normal_(mean=<span class=\"number\">0.0</span>, std=self.args.initializer_range)</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"built_in\">isinstance</span>(module, LayerNorm):</span><br><span class=\"line\">        module.bias.data.zero_()</span><br><span class=\"line\">        module.weight.data.fill_(<span class=\"number\">1.0</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">isinstance</span>(module, nn.Linear) <span class=\"keyword\">and</span> module.bias <span class=\"keyword\">is</span> <span class=\"keyword\">not</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">        module.bias.data.zero_()</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><strong>判断模块类型并初始化权重</strong>\n<ul>\n<li>检查模块是否是  <code>nn.Linear</code>  或  <code>nn.Embedding</code>  类型。</li>\n<li>如果是，将其权重初始化为均值为 0.0，标准差为  <code>self.args.initializer_range</code>  的正态分布。</li>\n<li>这样做的目的是确保网络在初始时具有适当的权重分布，避免梯度消失或爆炸问题。</li>\n</ul>\n</li>\n<li>检查模块是否是  <code>LayerNorm</code>  类型。</li>\n<li>如果是，将其偏置初始化为 0，将其权重初始化为 1。</li>\n<li>这样做是因为层归一化通常希望初始时对输入数据不进行任何缩放或平移。</li>\n<li>检查模块是否是  <code>nn.Linear</code>  类型，并且其偏置不为空。</li>\n<li>如果是，将其偏置初始化为 0。</li>\n<li>这样做可以确保线性层的偏置在初始时不会对输入数据产生任何偏移。</li>\n</ul>\n\\begin{equation}\nL_{\\text{local}} = \\sum_{u \\in U} -\\log \\frac{\\exp(\\text{sim}(x_{u,1}, x_{u,2}) / \\tau)}{\\sum_{u' \\in U, u' \\neq u} \\exp(\\text{sim}(x_{u,1}, x_{u',2}) / \\tau)} + \\sum_{i \\in I} -\\log \\frac{\\exp(\\text{sim}(x_{i,1}, x_{i,2}) / \\tau)}{\\sum_{i' \\in I, i' \\neq i} \\exp(\\text{sim}(x_{i,1}, x_{i',2}) / \\tau)}\n\\end{equation}\n\n\\begin{equation}\nL_{\\text{global}} = \\sum_{(u,v) \\in S} -\\log \\frac{\\exp(\\text{sim}(x_{u,1}, x_{v,2}) / \\tau)}{\\sum_{v' \\in U, v' \\neq v} \\exp(\\text{sim}(x_{u,1}, x_{v',2}) / \\tau)}\n\\end{equation}\n\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mrow><mi mathvariant=\"normal\">N</mi><mi mathvariant=\"normal\">D</mi><mi mathvariant=\"normal\">C</mi><mi mathvariant=\"normal\">G</mi><mi mathvariant=\"normal\">@</mi><mi mathvariant=\"normal\">K</mi></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant=\"normal\">∣</mi><mi>U</mi><mi mathvariant=\"normal\">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi>U</mi></mrow></munder><mfrac><mrow><mi>D</mi><mi>C</mi><mi>G</mi><mi mathvariant=\"normal\">@</mi><msub><mi>K</mi><mi>u</mi></msub></mrow><mrow><mi>I</mi><mi>D</mi><mi>C</mi><mi>G</mi><mi mathvariant=\"normal\">@</mi><msub><mi>K</mi><mi>u</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant=\"normal\">∣</mi><mi>U</mi><mi mathvariant=\"normal\">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi>U</mi></mrow></munder><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mfrac><mrow><msup><mn>2</mn><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi mathvariant=\"normal\">∣</mi><mi>R</mi><mi>E</mi><msub><mi>L</mi><mi>u</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow></munderover><mfrac><mrow><msup><mn>2</mn><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>其中</mtext><mo separator=\"true\">,</mo><mi>D</mi><mi>C</mi><mi>G</mi><mi mathvariant=\"normal\">@</mi><mi>K</mi><mtext>和</mtext><mi>I</mi><mi>D</mi><mi>C</mi><mi>G</mi><mi mathvariant=\"normal\">@</mi><mi>K</mi><mtext>的计算公式分别为</mtext><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>D</mi><mi>C</mi><mi>G</mi><mi mathvariant=\"normal\">@</mi><mi>K</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mfrac><mrow><msup><mn>2</mn><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>I</mi><mi>D</mi><mi>C</mi><mi>G</mi><mi mathvariant=\"normal\">@</mi><mi>K</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi mathvariant=\"normal\">∣</mi><mi>R</mi><mi>E</mi><msub><mi>L</mi><mi>u</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow></munderover><mfrac><mrow><msup><mn>2</mn><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n&amp;\\mathrm{NDCG@K}=\\frac{1}{|U|}\\sum_{u\\in U}\\frac{DCG@K_{u}}{IDCG@K_{u}} =\\frac{1}{|U|}\\sum_{u\\in U}\\frac{\\sum_{i=1}^{K}\\frac{2^{rel_{i}}-1}{\\log_{2}(i+1)}}{\\sum_{i=1}^{|REL_{u}|}\\frac{2^{rel_{i}}-1}{\\log_{2}(i+1)}}\\\\\n&amp;其中,DCG@K和IDCG@K的计算公式分别为: \\\\\n&amp;DCG@K=\\sum_{i=1}^{K}\\frac{2^{rel_{i}}-1}{\\log_{2}(i+1)} \\\\\n&amp;IDCG@K=\\sum_{i=1}^{|REL_{u}|}\\frac{2^{rel_{i}}-1}{\\log_{2}(i+1)}\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:12.157715em;vertical-align:-5.8288575em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:6.3288575em;\"><span style=\"top:-8.3288575em;\"><span class=\"pstrut\" style=\"height:3.964028em;\"></span><span class=\"mord\"></span></span><span style=\"top:-5.7398495em;\"><span class=\"pstrut\" style=\"height:3.964028em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.2515134999999997em;\"><span class=\"pstrut\" style=\"height:3.964028em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.28716049999999993em;\"><span class=\"pstrut\" style=\"height:3.964028em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.8288575em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:6.3288575em;\"><span style=\"top:-8.3288575em;\"><span class=\"pstrut\" style=\"height:3.964028em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathrm\">N</span><span class=\"mord mathrm\">D</span><span class=\"mord mathrm\">C</span><span class=\"mord mathrm\">G</span><span class=\"mord mathrm\">@</span><span class=\"mord mathrm\">K</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\">∣</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8556639999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.321706em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.3139999999999996em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8360000000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\">∣</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8556639999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.321706em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9640279999999999em;\"><span style=\"top:-2.12502em;\"><span class=\"pstrut\" style=\"height:3.0429199999999996em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0278999999999998em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">∣</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.16454285714285719em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mord mtight\">∣</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9740049999999999em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mop mtight\"><span class=\"mtight\">l</span><span class=\"mtight\">o</span><span class=\"mtight\" style=\"margin-right:0.01389em;\">g</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444571428571428em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8285785714285714em;\"><span style=\"top:-2.8325500000000003em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3448em;margin-left:-0.01968em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.65952em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31472em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5311079999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.2729199999999996em;\"><span class=\"pstrut\" style=\"height:3.0429199999999996em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.964028em;\"><span class=\"pstrut\" style=\"height:3.0429199999999996em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0429199999999998em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mop mtight\"><span class=\"mtight\">l</span><span class=\"mtight\">o</span><span class=\"mtight\" style=\"margin-right:0.01389em;\">g</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444571428571428em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9270285714285713em;\"><span style=\"top:-2.931em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3448em;margin-left:-0.01968em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.65952em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31472em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5311079999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4490079999999996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-5.7398495em;\"><span class=\"pstrut\" style=\"height:3.964028em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord cjk_fallback\">其</span><span class=\"mord cjk_fallback\">中</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord cjk_fallback\">和</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">计</span><span class=\"mord cjk_fallback\">算</span><span class=\"mord cjk_fallback\">公</span><span class=\"mord cjk_fallback\">式</span><span class=\"mord cjk_fallback\">分</span><span class=\"mord cjk_fallback\">别</span><span class=\"mord cjk_fallback\">为</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span></span><span style=\"top:-3.2515134999999997em;\"><span class=\"pstrut\" style=\"height:3.964028em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.526108em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.20696799999999996em;\"><span style=\"top:-2.4558600000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24414em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.01968em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:0.28716049999999993em;\"><span class=\"pstrut\" style=\"height:3.964028em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9610050000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.386005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">∣</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.16454285714285719em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mord mtight\">∣</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.526108em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.20696799999999996em;\"><span style=\"top:-2.4558600000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24414em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.01968em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.8288575em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        },
        {
            "id": "https://enjundu.github.io/recommendation/basic_knowledge/",
            "url": "https://enjundu.github.io/recommendation/basic_knowledge/",
            "title": "basic_knowledge",
            "date_published": "2024-07-14T01:41:31.000Z",
            "content_html": "<h1 id=\"gcn\"><a class=\"anchor\" href=\"#gcn\">#</a> GCN</h1>\n<h2 id=\"卷积\"><a class=\"anchor\" href=\"#卷积\">#</a> 卷积</h2>\n<p>卷积是两个函数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> 和<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span> 的数学运算，产生第三个函数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span></p>\n<p>卷积定义公式：</p>\n<p>​\t连续情况：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo>∗</mo><mi>g</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo><mover><mo><mo>=</mo></mo><mrow><mi mathvariant=\"normal\">d</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></mover></mo><mo>∫</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo>−</mo><mi>τ</mi><mo stretchy=\"false\">)</mo><mi>d</mi><mi>τ</mi></mrow><annotation encoding=\"application/x-tex\">h(t)=(f*g)(t)\\stackrel{\\mathrm{def}}{=}\\int f(t)g(t-\\tau) d\\tau\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.402978em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\"><span class=\"mop op-limits\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.152978em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">=</span></span></span><span style=\"top:-3.5668699999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">d</span><span class=\"mord mathrm mtight\">e</span><span class=\"mord mathrm mtight\" style=\"margin-right:0.07778em;\">f</span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.22225em;vertical-align:-0.86225em;\"></span><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span></span></span></span></span></p>\n<p>​\t离散情况：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo>∗</mo><mi>g</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo><mover><mo><mo>=</mo></mo><mrow><mi mathvariant=\"normal\">d</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></mover></mo><munder><mo>∑</mo><mrow><mi>m</mi><mo separator=\"true\">,</mo><mi>n</mi></mrow></munder><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>m</mi><mo separator=\"true\">,</mo><mi>y</mi><mo>−</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n&amp;h(x,y) \\\\\n&amp;=(f*g)(x,y) \\\\\n&amp;\\stackrel{\\mathrm{def}}{=}\\sum_{m,n}f(x-m,y-n)g(m,n)\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:5.839091000000001em;vertical-align:-2.669545500000001em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.1695455em;\"><span style=\"top:-5.4825235em;\"><span class=\"pstrut\" style=\"height:3.152978em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.9825235em;\"><span class=\"pstrut\" style=\"height:3.152978em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.169545499999999em;\"><span class=\"pstrut\" style=\"height:3.152978em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.669545500000001em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.1695455em;\"><span style=\"top:-5.4825235em;\"><span class=\"pstrut\" style=\"height:3.152978em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.9825235em;\"><span class=\"pstrut\" style=\"height:3.152978em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.169545499999999em;\"><span class=\"pstrut\" style=\"height:3.152978em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\"><span class=\"mop op-limits\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.152978em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">=</span></span></span><span style=\"top:-3.5668699999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">d</span><span class=\"mord mathrm mtight\">e</span><span class=\"mord mathrm mtight\" style=\"margin-right:0.07778em;\">f</span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0500050000000003em;\"><span style=\"top:-1.8999949999999999em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">n</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.386113em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.669545500000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<h3 id=\"定义卷积的两个方法\"><a class=\"anchor\" href=\"#定义卷积的两个方法\">#</a> 定义卷积的两个方法</h3>\n<h4 id=\"谱方法\"><a class=\"anchor\" href=\"#谱方法\">#</a> 谱方法</h4>\n<p>基于傅里叶变换用卷积订立将卷积操作转化为频域中的乘法操作：</p>\n<ul>\n<li>\n<p><strong>傅里叶变换</strong>：将输入信号和卷积核从时域转到频域，分别得到它们的傅里叶变换：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"script\">F</mi><mo stretchy=\"false\">{</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">}</mo><mspace linebreak=\"newline\"></mspace><mi>H</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"script\">F</mi><mo stretchy=\"false\">{</mo><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">F(u)=\\mathcal{F}\\{f(x)\\}\\\\H(u)=\\mathcal{F}\\{h(x)\\}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.09931em;\">F</span></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mclose\">}</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.09931em;\">F</span></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mclose\">}</span></span></span></span></span></p>\n</li>\n<li>\n<p><strong>频域乘法</strong>：在频域中对两个傅里叶变换结果进行逐点相乘：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>G</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>F</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G(u)=F(u)\\cdot H(u)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span></span></span></span></span></p>\n</li>\n<li>\n<p><strong>逆傅里叶变换</strong>：将乘积结果通过逆傅里叶变换转换回时域：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi mathvariant=\"script\">F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">{</mo><mi>G</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">g(x)=\\mathcal{F}^{-1}\\{G(u)\\}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.09931em;\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.864108em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">G</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mclose\">}</span></span></span></span></span></p>\n</li>\n</ul>\n<h4 id=\"空间方法\"><a class=\"anchor\" href=\"#空间方法\">#</a> 空间方法</h4>\n<p>​\t空间方法直接在信号或图像的空间域中进行卷积运算，通过滑动窗口逐点计算卷积结果。</p>\n<ul>\n<li>\n<p>** 翻转卷积核：** 将卷积核在空间域内翻转：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mo>−</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h(-x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></p>\n</li>\n<li>\n<p><strong>滑动窗口</strong>：将翻转后的卷积核逐点滑动到输入信号的每一个位置</p>\n</li>\n<li>\n<p><strong>加权求和</strong>：对每一个位置上的输入信号与卷积核对应元素进行加权求和：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo>∗</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><mi>f</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(x)=(f*h)(x)=\\sum_af(a)h(x-a)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3000100000000003em;vertical-align:-1.250005em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8999949999999999em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.250005em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>对于二维图像，卷积计算也可以表示为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>∑</mo><mi>m</mi></munder><munder><mo>∑</mo><mi>n</mi></munder><mi>f</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo>−</mo><mi>m</mi><mo separator=\"true\">,</mo><mi>j</mi><mo>−</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mi>h</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(i,j)=\\sum_m\\sum_nf(i-m,j-n)h(m,n)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3000100000000003em;vertical-align:-1.250005em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8999949999999999em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.250005em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8999949999999999em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.250005em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span></p>\n</li>\n</ul>\n<h2 id=\"图节点\"><a class=\"anchor\" href=\"#图节点\">#</a> 图节点</h2>\n<h3 id=\"普通图\"><a class=\"anchor\" href=\"#普通图\">#</a> 普通图</h3>\n<p>给定一个图<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>V</mi><mo separator=\"true\">,</mo><mi>E</mi><mo separator=\"true\">,</mo><mi>W</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G=(V,E,W)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mclose\">)</span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 是节点特征矩阵，那么可以定义如下：</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> 是节点集，包含<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mi mathvariant=\"normal\">∣</mi><mi>V</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">n=|V|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord\">∣</span></span></span></span> 个节点</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span> 是边集，表示节点之间的连接关系</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> 是<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^{n\\times n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.771331em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.771331em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span></span> 中的加权邻接矩阵，表示节点之间边的权重</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 是<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>n</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^{n\\times d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span> 中的节点特征矩阵，每个节点关联<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span> 个特征。矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> 的每一列是定义在节点上的一个信号。</li>\n</ul>\n<h3 id=\"图拉普拉斯\"><a class=\"anchor\" href=\"#图拉普拉斯\">#</a> 图拉普拉斯</h3>\n<p><strong>普通图拉普拉斯矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> 定义为</strong>:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>L</mi><mo>=</mo><mi>D</mi><mo>−</mo><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">L=D-W\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span></span></p>\n<p>其中:</p>\n<ul>\n<li>$D <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>是度矩阵（</mtext><mi>D</mi><mi>e</mi><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>M</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi><mtext>），是一个对角矩阵，且</mtext></mrow><annotation encoding=\"application/x-tex\">是度矩阵（Degree Matrix），是一个对角矩阵，且</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord cjk_fallback\">是</span><span class=\"mord cjk_fallback\">度</span><span class=\"mord cjk_fallback\">矩</span><span class=\"mord cjk_fallback\">阵</span><span class=\"mord cjk_fallback\">（</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">x</span><span class=\"mord cjk_fallback\">）</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord cjk_fallback\">是</span><span class=\"mord cjk_fallback\">一</span><span class=\"mord cjk_fallback\">个</span><span class=\"mord cjk_fallback\">对</span><span class=\"mord cjk_fallback\">角</span><span class=\"mord cjk_fallback\">矩</span><span class=\"mord cjk_fallback\">阵</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord cjk_fallback\">且</span></span></span></span> D_{ii}=\\sum_{j} W_{ij}<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>，表示节点</mtext></mrow><annotation encoding=\"application/x-tex\">，表示节点</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">，</span><span class=\"mord cjk_fallback\">表</span><span class=\"mord cjk_fallback\">示</span><span class=\"mord cjk_fallback\">节</span><span class=\"mord cjk_fallback\">点</span></span></span></span> i$ 的度数，即与节点<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 相连的边的权重总和。</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> 是权重邻接矩阵，其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">W_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 表示节点<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 和节点<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 直接的边的权重</li>\n</ul>\n<p>普通图拉普拉斯矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> 的对角元素<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">L_{ii}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是节点<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 的度数，非对角矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">L_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 是节点<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 和节点<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 之间边的负权重，如果两个节点<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 和<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 之间没有边，那么<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">L_{ij}=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span></p>\n<p><strong>归一化图拉普拉斯矩阵 L 定义为</strong>：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>L</mi><mo>=</mo><mi>I</mi><mo>−</mo><msup><mi>D</mi><mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mi>W</mi><msup><mi>D</mi><mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup></mrow><annotation encoding=\"application/x-tex\">L=I-D^{-\\frac{1}{2}}WD^{-\\frac{1}{2}}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0040200000000001em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0040200000000001em;\"><span style=\"top:-3.4130000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8443142857142858em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.2255000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0040200000000001em;\"><span style=\"top:-3.4130000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8443142857142858em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.2255000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">I</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span> 是单位矩阵</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>D</mi><mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup></mrow><annotation encoding=\"application/x-tex\">D^{- \\frac{1}{2}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9540200000000001em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9540200000000001em;\"><span style=\"top:-3.363em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8443142857142858em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.2255000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span></span></span></span></span></span></span></span></span></span></span></span> 是度矩阵的平方根的逆矩阵。度矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span> 的对角元素是各节点的度数，取其平方根再取逆矩阵</li>\n</ul>\n<h3 id=\"图傅里叶变换\"><a class=\"anchor\" href=\"#图傅里叶变换\">#</a> 图傅里叶变换</h3>\n<p>图傅里叶变换是一种将传统傅里叶变换推广到图结构数据的方法。在图信号处理（Graph Signal Processing）中，它用于分析和处理定义在图节点上的信号。</p>\n<h4 id=\"图的傅里叶基\"><a class=\"anchor\" href=\"#图的傅里叶基\">#</a> 图的傅里叶基</h4>\n<p>图<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> 的傅里叶基是图拉普拉斯矩阵的正交归一特征向量的集合，具体步骤：</p>\n<ul>\n<li l=\"1\">\n<p>** 特征向量和特征值：** 计算拉普拉斯矩阵 L 的特征向量和特征值。设<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><msub><mi>u</mi><mi>l</mi></msub><msubsup><mo stretchy=\"false\">}</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\{u_l\\}_{l=1}^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.033108em;vertical-align:-0.2831079999999999em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">}</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-2.4168920000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831079999999999em;\"><span></span></span></span></span></span></span></span></span></span> 是<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> 的一组正交归一特征向量，对应的特征值为\\{\\lambda _l \\}^n_</p>\n</li>\n<li>\n<p>** 拉普拉斯矩阵对角化：** 将图拉普拉斯矩阵对角化为:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>L</mi><mo>=</mo><mi>U</mi><mi mathvariant=\"normal\">Λ</mi><msup><mi>U</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">L=U\\Lambda U^T\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8913309999999999em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\">Λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span> 是由特征向量构成的矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>u</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>u</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>u</mi><mi>n</mi></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[u_1,u_2,...,u_n]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Λ</mi></mrow><annotation encoding=\"application/x-tex\">\\Lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Λ</span></span></span></span> 是对角矩阵，对角线上的对应的特征值<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>λ</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>λ</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>λ</mi><mi>n</mi></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[\\lambda_1,\\lambda_2,...,\\lambda_n]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>.</p>\n</li>\n</ul>\n<h4 id=\"图傅里叶变换-2\"><a class=\"anchor\" href=\"#图傅里叶变换-2\">#</a> 图傅里叶变换</h4>\n<ul>\n<li>\n<p>定义：图上信号<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">x\\in\\mathbb{R}^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68889em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> 的图傅里叶变换定义为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mo>=</mo><msup><mi>U</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\hat{x}=U^Tx\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.22222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8913309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">x</span></span></span></span></span></p>\n<p>这里，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>U</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">U^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span> 是特征向量矩阵的转置，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 是图上的信号（每个节点上的值构成的向量），<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.22222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span></span></span></span> 是信号的图傅里叶变换（频域表示）</p>\n</li>\n<li>\n<p>逆变换：图傅里叶逆变换将频域表示的信号转换回时域表示，定义为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>U</mi><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">x=U \\hat x\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.22222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span></span></span></span></span></p>\n<p>这里，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span> 是特征向量矩阵，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat  x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.22222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span></span></span></span> 是频域表示的信号</p>\n</li>\n</ul>\n<h3 id=\"图卷积\"><a class=\"anchor\" href=\"#图卷积\">#</a> 图卷积</h3>\n<p>在图信号处理（Graph Signal Processing）中，卷积操作可以通过谱域（频域）中的计算来简化。</p>\n<p>根据卷积定理，给定输入信号 x 和滤波信号 y，图卷积<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∗</mo><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">*G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">∗</span><span class=\"mord mathnormal\">G</span></span></span></span> 可以写成：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>x</mi><msub><mo>∗</mo><mi>G</mi></msub><mi>y</mi><mo>=</mo><mi>U</mi><mrow><mo fence=\"true\">(</mo><mo stretchy=\"false\">(</mo><msup><mi>U</mi><mi>T</mi></msup><mi>x</mi><mo stretchy=\"false\">)</mo><mo>⊙</mo><mo stretchy=\"false\">(</mo><msup><mi>U</mi><mi>T</mi></msup><mi>y</mi><mo stretchy=\"false\">)</mo><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">x *_G y=U\\left((U^Tx)\\odot(U^Ty)\\right)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.61528em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\"><span class=\"mbin\">∗</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">G</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2413409999999998em;vertical-align:-0.35001em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⊙</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span> 是图拉普拉斯矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> 的特征向量矩阵</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>U</mi><mi>x</mi><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">U^T_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.088331em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span> 是信号<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 的图傅里叶变换（频域表示）</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>U</mi><mi>y</mi><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">U^T_y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2244389999999998em;vertical-align:-0.383108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.383108em;\"><span></span></span></span></span></span></span></span></span></span> 是滤波器<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> 的图傅里叶变换（频域表示）</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>⊙</mo></mrow><annotation encoding=\"application/x-tex\">\\odot</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord\">⊙</span></span></span></span> 表示逐点乘积（点乘）</li>\n</ul>\n<p><strong>步骤</strong>：</p>\n<ul>\n<li>对信号<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> 进行图傅里叶变换<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>U</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">U^Tx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">x</span></span></span></span></li>\n<li>在频域中，对转换后的信号<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>U</mi><mi>x</mi><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">U_x^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.088331em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span> 和滤波器<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>U</mi><mi>y</mi><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">U^T_y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2244389999999998em;vertical-align:-0.383108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.383108em;\"><span></span></span></span></span></span></span></span></span></span> 进行逐点乘积，结果表示为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mrow></mrow><msub><mi>g</mi><mi>θ</mi></msub><msup><mi>U</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">{}{g_{\\theta}}U^{T}x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.035771em;vertical-align:-0.19444em;\"></span><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">x</span></span></span></span></li>\n<li>对频域结果进行图傅里叶逆变换，得到卷积结果<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><msub><mi>g</mi><mi>θ</mi></msub></msub><msubsup><mi>U</mi><mi>x</mi><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">U_{g _\\theta}U^T_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1274389999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span></li>\n</ul>\n<h4 id=\"逐点积\"><a class=\"anchor\" href=\"#逐点积\">#</a> 逐点积</h4>\n<p>逐点乘积是指两个相同维度的矩阵或向量之间的元素对应相乘。假设有两个向量 $ a$ 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>，其长度都为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>，则逐点乘积 $ c$ 的第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 个元素定义为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><msub><mi>a</mi><mi>i</mi></msub><mo>∗</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">c_i=a_i*b_i\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.61528em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>假设有两个向量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span> 和<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>a</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mn>3</mn></msub><mo stretchy=\"false\">]</mo><mspace linebreak=\"newline\"></mspace><mi>b</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mn>3</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">a=[a_1,a_2,a_3]\\\\b=[b_1,b_2,b_3]\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span></span></p>\n<p>它们的逐点乘积<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span> 为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>c</mi><mo>=</mo><mi>a</mi><mo>⊙</mo><mi>b</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>⋅</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mn>3</mn></msub><mo>⋅</mo><msub><mi>b</mi><mn>3</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">c=a\\odot b=[a_1\\cdot b_1,a_2\\cdot b_2,a_3\\cdot b_3]\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⊙</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span></span></p>\n<h2 id=\"光谱图卷积神经网络\"><a class=\"anchor\" href=\"#光谱图卷积神经网络\">#</a> 光谱图卷积神经网络</h2>\n<p>光谱图卷积神经网络（Spectral Graph Convolutional Neural Network, Spectral Graph CNN）是一种将卷积神经网络（CNN）的概念推广到图结构数据的方法。它利用图傅里叶变换在频域中进行卷积操作，从而有效地处理非欧几里得数据，如社交网络、分子结构等。以下是对图中内容的详细解释。</p>\n<p>首先介绍光谱图卷积神经网络中第 k 层的卷积操作：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mi>h</mi><mrow><mo fence=\"true\">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>f</mi><mi>k</mi></msub></munderover><mi>U</mi><msub><mi>F</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><msup><mi>U</mi><mi>T</mi></msup><msub><mi>x</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">x_{k+1,j}=h\\left(\\sum_{i=1}^{f_k}UF_{k,i,j}U^Tx_{k,i}\\right)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.16089em;vertical-align:-1.277669em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8832210000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.347113em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:-0.10764em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span></span></p>\n<p>其中：</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">x_{k+1,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>：第<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 层中第<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 个输出信号</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>: 激活函数</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 第<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 层中的滤波器数量</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span>：图拉普拉斯矩阵的特征向量矩阵</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>F</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">F_{k,i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>：第<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 层中的滤波器参数</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">x_{k,i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>：第 k 层中的第<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 个输入信号</li>\n</ul>\n<p><strong>详细步骤</strong></p>\n<ul>\n<li>\n<p>图傅里叶变换：将第 k 层中的输入信号<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">x_{k,i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 转到频域</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub><mo>=</mo><msup><mi>U</mi><mi>T</mi></msup><msub><mi>x</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{x}_{k,i}=U^Tx_{k,i}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.980548em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.22222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.177439em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n</li>\n<li>\n<p>频域卷积：对转换后的信号逐点乘积：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>F</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{y}_{k,i,j}=F_{k,i,j}\\hat{x}_{k,i}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.980548em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.980548em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.22222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n</li>\n<li>\n<p>逆图傅里叶变换：将频域结果转换回时域：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>y</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mi>U</mi><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">y_{k,i,j}=U\\hat{y}_{k,i,j}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.980548em;vertical-align:-0.286108em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n</li>\n<li>\n<p>信号叠加和激活函数：将所有滤波结果相加，并通过激活函数得到第<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 层的输出信号</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mi>h</mi><mrow><mo fence=\"true\">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>f</mi><mi>k</mi></msub></munderover><msub><mi>y</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">x_{k+1,j}=h\\left(\\sum_{i=1}^{f_k}y_{k,i,j}\\right)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.16089em;vertical-align:-1.277669em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8832210000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.347113em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3487714285714287em;margin-left:-0.10764em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15122857142857138em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span></span></p>\n</li>\n</ul>\n<h2 id=\"cnn的缺点\"><a class=\"anchor\" href=\"#cnn的缺点\">#</a> CNN 的缺点</h2>\n<ul>\n<li>需要拉普拉斯矩阵的特征分解（Requiring Eigen-Decomposition of Laplacian Matrix）</li>\n<li>高计算成本（High Computational Cost）</li>\n<li>在顶点域中不具备局部化特性（Not Localized in Vertex Domain）</li>\n</ul>\n<h2 id=\"chebynet通过多项式近似参数化滤波器\"><a class=\"anchor\" href=\"#chebynet通过多项式近似参数化滤波器\">#</a> ChebyNet：通过多项式近似参数化滤波器</h2>\n<p><strong>Parameterizing Filter via Polynomial Approximation</strong></p>\n<p>ChebyNet 是一种改进的光谱图卷积神经网络方法，通过多项式近似来参数化卷积滤波器，从而提高计算效率并减少参数数量。以下是对 ChebyNet 方法的详细解释：</p>\n<h4 id=\"背景\"><a class=\"anchor\" href=\"#背景\">#</a> 背景</h4>\n<p>在传统的光谱图卷积神经网络中，卷积滤波器需要显式地使用拉普拉斯矩阵的特征分解，这导致高计算成本和参数量。ChebyNet 通过多项式近似的方法来简化这一过程。</p>\n<h4 id=\"多项式近似\"><a class=\"anchor\" href=\"#多项式近似\">#</a> 多项式近似</h4>\n<p>ChebyNet 使用 Chebyshev 多项式来近似卷积滤波器。具体来说，卷积滤波器 $ g_\\theta<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>被表示为拉普拉斯矩阵特征值</mtext></mrow><annotation encoding=\"application/x-tex\">被表示为拉普拉斯矩阵特征值</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">被</span><span class=\"mord cjk_fallback\">表</span><span class=\"mord cjk_fallback\">示</span><span class=\"mord cjk_fallback\">为</span><span class=\"mord cjk_fallback\">拉</span><span class=\"mord cjk_fallback\">普</span><span class=\"mord cjk_fallback\">拉</span><span class=\"mord cjk_fallback\">斯</span><span class=\"mord cjk_fallback\">矩</span><span class=\"mord cjk_fallback\">阵</span><span class=\"mord cjk_fallback\">特</span><span class=\"mord cjk_fallback\">征</span><span class=\"mord cjk_fallback\">值</span></span></span></span> \\Lambda$ 的一个多项式：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>g</mi><mi>β</mi></msub><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">Λ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>K</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>β</mi><mi>k</mi></msub><msup><mi mathvariant=\"normal\">Λ</mi><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">g_\\beta(\\Lambda)=\\sum_{k=0}^{K-1}\\beta_k\\Lambda^k\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">Λ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.1304490000000005em;vertical-align:-1.302113em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.302113em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">Λ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>β</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\beta_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是多项式的系数，是需要学习的参数</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Λ</mi></mrow><annotation encoding=\"application/x-tex\">\\Lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Λ</span></span></span></span> 是拉普拉斯矩阵的特征值对角矩阵</li>\n</ul>\n<h4 id=\"chebynet-的卷积操作\"><a class=\"anchor\" href=\"#chebynet-的卷积操作\">#</a> ChebyNet 的卷积操作</h4>\n<p>通过多项式近似，ChebyNet 中的图卷积操作可以写成：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>x</mi><msub><mo>∗</mo><mi>G</mi></msub><mi>y</mi><mo>=</mo><mi>U</mi><msub><mi>g</mi><mi>β</mi></msub><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">Λ</mi><mo stretchy=\"false\">)</mo><msup><mi>U</mi><mi>T</mi></msup><mi>x</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>K</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>β</mi><mi>k</mi></msub><msup><mi>L</mi><mi>k</mi></msup><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x*_Gy=Ug_\\beta(\\Lambda)U^Tx=\\sum_{k=0}^{K-1}\\beta_kL^kx\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.61528em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\"><span class=\"mbin\">∗</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">G</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.177439em;vertical-align:-0.286108em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">Λ</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.1304490000000005em;vertical-align:-1.302113em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283360000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.302113em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">x</span></span></span></span></span></p>\n<ul>\n<li>$L $ 是图的拉普拉斯矩阵。</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>L</mi><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">L^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.849108em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span> 表示拉普拉斯矩阵的 k 次幂。</li>\n</ul>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        },
        {
            "id": "https://enjundu.github.io/bit/%E5%AF%86%E7%A0%81%E5%B7%A5%E7%A8%8B/",
            "url": "https://enjundu.github.io/bit/%E5%AF%86%E7%A0%81%E5%B7%A5%E7%A8%8B/",
            "title": "密码工程大作业",
            "date_published": "2024-07-08T07:39:23.000Z",
            "content_html": "<p>目录</p>\n<p><a href=\"#_Toc5215\">1 引言\t</a></p>\n<p><a href=\"#_Toc22057\">2. 符号\t</a></p>\n<p><a href=\"#_Toc14603\">2.1 uBlock 所用符号\t</a></p>\n<p><a href=\"#_Toc26774\">2.2 uBlock 术语解释\t</a></p>\n<p><a href=\"#_Toc7826\">2.2.1 并置\t</a><br />\n2.2.2 半字节（Nibble）\t4</p>\n<p><a href=\"#_Toc1851\">2.2.3 向量置换（Permutation of Vectors）\t</a></p>\n<p><a href=\"#_Toc25622\">2.2.4 轮密钥（Round Key）\t</a></p>\n<p><a href=\"#_Toc9457\">3.uBlock 分组密码及两种工作模式的来历\t</a></p>\n<p><a href=\"#_Toc18505\">3.1 uBlock 算法来历\t</a></p>\n<p><a href=\"#_Toc10233\">3.2 ECB 分组密码模式来历\t</a></p>\n<p><a href=\"#_Toc31089\">3.2.1 ECB 的设计背景\t</a></p>\n<p><a href=\"#_Toc2653\">3.2.2 ECB 的来历\t</a></p>\n<p><a href=\"#_Toc714\">3.2.3 ECB 的迭代过程\t</a></p>\n<p><a href=\"#_Toc9825\">3.2.4 ECB 的安全性讨论\t</a></p>\n<p>3.3 CBC 模式分析\t6<br />\n3.3.1 CBC 模式的设计背景\t6<br />\n3.3.2 CBC 模式的来历\t6<br />\n3.3.3 CBC 模式的迭代构成\t6<br />\n3.3.4 CBC 模式的安全性讨论\t7</p>\n<p><a href=\"#_Toc10676\">4. uBlock 加密算法的总体框架与数据结构\t</a></p>\n<p><a href=\"#_Toc22371\">4.1 uBlock 算法的总体框架\t</a><br />\n4.1.1 uBlock 加密算法\t7<br />\n4.1.2 uBlock 解密算法\t9<br />\n4.1.3 uBlock 密钥扩展算法\t10</p>\n<p>4.2 uBlock 算法的数据结构\t11</p>\n<p><a href=\"#_Toc24973\">4.2.1 S 盒 (Substitution boxes)\t</a></p>\n<p><a href=\"#_Toc6879\">4.2.2 向量置换 (Vector Permutations)\t</a></p>\n<p><a href=\"#_Toc29481\">4.2.3 轮密钥 (Round Keys)\t</a></p>\n<p><a href=\"#_Toc31348\">4.2.4 密钥扩展算法 (Key Schedule)\t</a></p>\n<p><a href=\"#_Toc7498\">4.2.5 数据块的处理\t</a></p>\n<p><a href=\"#_Toc3860\">5. uBlock 的算法实现\t</a><br />\n5.1 基础代码设计\t12<br />\n5.2 评估正确性\t16<br />\n5.3 评估吞吐量和速度\t17</p>\n<p><a href=\"#_Toc23937\">6 以 uBlock 的 ECB 和 CBC 模式加密朱鹮.bmp 文件\t</a><br />\n6.1 BMP 文件格式解析\t18<br />\n6.2 BMP 文件加密技巧\t18<br />\n6.3 ECE 和 CBC 模式加解密结果\t19<br />\n6.3.1 ECB 模式进行加解密\t19<br />\n6.3.2 CBC 模式进行加解密\t19<br />\n6.3.3 ECB 和 CBC 模式的分析和对比\t20</p>\n<p><a href=\"#_Toc11983\">7 总结\t</a></p>\n<h1 id=\"code\"><a class=\"anchor\" href=\"#code\">#</a> Code</h1>\n<h2 id=\"ublock_bmp加密代码cbc加密cpp\"><a class=\"anchor\" href=\"#ublock_bmp加密代码cbc加密cpp\">#</a> uBlock_bmp (加密代码)——CBC 加密.cpp</h2>\n<p><figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br><span class=\"line\">392</span><br><span class=\"line\">393</span><br><span class=\"line\">394</span><br><span class=\"line\">395</span><br><span class=\"line\">396</span><br><span class=\"line\">397</span><br><span class=\"line\">398</span><br><span class=\"line\">399</span><br><span class=\"line\">400</span><br><span class=\"line\">401</span><br><span class=\"line\">402</span><br><span class=\"line\">403</span><br><span class=\"line\">404</span><br><span class=\"line\">405</span><br><span class=\"line\">406</span><br><span class=\"line\">407</span><br><span class=\"line\">408</span><br><span class=\"line\">409</span><br><span class=\"line\">410</span><br><span class=\"line\">411</span><br><span class=\"line\">412</span><br><span class=\"line\">413</span><br><span class=\"line\">414</span><br><span class=\"line\">415</span><br><span class=\"line\">416</span><br><span class=\"line\">417</span><br><span class=\"line\">418</span><br><span class=\"line\">419</span><br><span class=\"line\">420</span><br><span class=\"line\">421</span><br><span class=\"line\">422</span><br><span class=\"line\">423</span><br><span class=\"line\">424</span><br><span class=\"line\">425</span><br><span class=\"line\">426</span><br><span class=\"line\">427</span><br><span class=\"line\">428</span><br><span class=\"line\">429</span><br><span class=\"line\">430</span><br><span class=\"line\">431</span><br><span class=\"line\">432</span><br><span class=\"line\">433</span><br><span class=\"line\">434</span><br><span class=\"line\">435</span><br><span class=\"line\">436</span><br><span class=\"line\">437</span><br><span class=\"line\">438</span><br><span class=\"line\">439</span><br><span class=\"line\">440</span><br><span class=\"line\">441</span><br><span class=\"line\">442</span><br><span class=\"line\">443</span><br><span class=\"line\">444</span><br><span class=\"line\">445</span><br><span class=\"line\">446</span><br><span class=\"line\">447</span><br><span class=\"line\">448</span><br><span class=\"line\">449</span><br><span class=\"line\">450</span><br><span class=\"line\">451</span><br><span class=\"line\">452</span><br><span class=\"line\">453</span><br><span class=\"line\">454</span><br><span class=\"line\">455</span><br><span class=\"line\">456</span><br><span class=\"line\">457</span><br><span class=\"line\">458</span><br><span class=\"line\">459</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;memory.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;time.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;windows.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;emmintrin.h&gt;</span><span class=\"comment\">//sse2 header file(include sse header file)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;pmmintrin.h&gt;</span> <span class=\"comment\">//SSE3(include emmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;tmmintrin.h&gt;</span><span class=\"comment\">//SSSE3(include pmmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;smmintrin.h&gt;</span><span class=\"comment\">//SSE4.1(include tmmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;nmmintrin.h&gt;</span><span class=\"comment\">//SSE4.2(include smmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;intrin.h&gt;</span><span class=\"comment\">//(include immintrin.h)  </span></span></span><br><span class=\"line\"></span><br><span class=\"line\">__m128i S     = _mm_setr_epi8(<span class=\"number\">0x7</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x5</span>);</span><br><span class=\"line\">__m128i S_Inv = _mm_setr_epi8(<span class=\"number\">0xc</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x8</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">__m128i con = _mm_set1_epi8(<span class=\"number\">0x0f</span>);</span><br><span class=\"line\">__m128i A1 = _mm_setr_epi8(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">9</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">8</span>);\t</span><br><span class=\"line\">__m128i A2 = _mm_setr_epi8(<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>);\t\t</span><br><span class=\"line\">__m128i A3 = _mm_setr_epi8(<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>);\t\t</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">unsigned</span> <span class=\"type\">char</span> Subkey[<span class=\"number\">17</span>][<span class=\"number\">32</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">unsigned</span> <span class=\"type\">char</span> RC[<span class=\"number\">16</span>][<span class=\"number\">16</span>] = &#123;<span class=\"number\">0x9</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xf</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x2</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x8</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xc</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x4</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x5</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x7</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xb</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xa</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x8</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xd</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x7</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x3</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xa</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">uBlock_128_KeySchedule</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key)</span><span class=\"comment\">// 密钥生成函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t__m128i SK = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">7</span>, <span class=\"number\">5</span>, <span class=\"number\">11</span>, <span class=\"number\">9</span>, <span class=\"number\">15</span>, <span class=\"number\">13</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c1 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c2 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>);\t\t</span><br><span class=\"line\">\t__m128i c3 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c4 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c5 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c6 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">11</span>, <span class=\"number\">12</span>, <span class=\"number\">13</span>, <span class=\"number\">14</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\">\t__m128i c7 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">11</span>, <span class=\"number\">12</span>, <span class=\"number\">13</span>, <span class=\"number\">14</span>, <span class=\"number\">15</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>);\t</span><br><span class=\"line\">\t__m128i c8 = _mm_setr_epi8(<span class=\"number\">6</span>,<span class=\"number\">0</span>,<span class=\"number\">8</span>,<span class=\"number\">13</span>,<span class=\"number\">1</span>,<span class=\"number\">15</span>,<span class=\"number\">5</span>,<span class=\"number\">10</span>,<span class=\"number\">4</span>,<span class=\"number\">9</span>,<span class=\"number\">12</span>,<span class=\"number\">2</span>,<span class=\"number\">11</span>,<span class=\"number\">3</span>,<span class=\"number\">7</span>,<span class=\"number\">14</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i state1, state2, k, t1, t2, t3, t4;  </span><br><span class=\"line\"></span><br><span class=\"line\">\tstate2 = _mm_loadu_si128((__m128i*)key);</span><br><span class=\"line\">\tstate1 = _mm_srli_epi16(state2, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_and_si128(state1, con);</span><br><span class=\"line\">\tstate2 = _mm_and_si128(state2, con);</span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c1);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c2);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c3);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c4);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)Subkey[<span class=\"number\">0</span>], state1);</span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)(Subkey[<span class=\"number\">0</span>] + <span class=\"number\">16</span>), state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">1</span>; i &lt;= <span class=\"number\">16</span>; i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(state1, c8);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)RC[i - <span class=\"number\">1</span>]);</span><br><span class=\"line\">\t\tk = _mm_xor_si128(k, state1);</span><br><span class=\"line\">\t\tt1 =  _mm_shuffle_epi8(S, k);</span><br><span class=\"line\">\t\tt2 = _mm_shuffle_epi8(SK, k);</span><br><span class=\"line\">\t\tt3 = _mm_shuffle_epi8(t1, c5);</span><br><span class=\"line\">\t\tt4 = _mm_shuffle_epi8(t2, c6);</span><br><span class=\"line\">\t\tk = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tk = _mm_xor_si128(k, state2);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(state1, c7);</span><br><span class=\"line\">\t\tstate1 = k;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t_mm_storeu_si128((__m128i*)Subkey[i], state1);</span><br><span class=\"line\">\t\t_mm_storeu_si128((__m128i*)(Subkey[i] + <span class=\"number\">16</span>), state2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">uBlock_128_Encrypt</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *plain, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *cipher, <span class=\"type\">int</span> round)</span><span class=\"comment\">//uBlock加密函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t__m128i L1 = _mm_setr_epi8(<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>);\t\t</span><br><span class=\"line\">\t__m128i L2 = _mm_setr_epi8(<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c1 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c2 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>);\t\t</span><br><span class=\"line\">\t__m128i c3 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c4 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c5 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c6 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>);\t\t</span><br><span class=\"line\">\t__m128i c7 = _mm_setr_epi8(<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c8 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>);\t\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i state1, state2, k, t1, t2, t3, t4;  </span><br><span class=\"line\"></span><br><span class=\"line\">\tstate2 = _mm_loadu_si128((__m128i*)plain);</span><br><span class=\"line\">\tstate1 = _mm_srli_epi16(state2, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_and_si128(state1, con);</span><br><span class=\"line\">\tstate2 = _mm_and_si128(state2, con);</span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c1);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c2);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c3);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c4);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; round; i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)Subkey[i]);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)(Subkey[i] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(S, state1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(S, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, state1);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A1);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A2);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A2);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A3);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(state1, L1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(state2, L2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(round == <span class=\"number\">16</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)Subkey[round]);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)(Subkey[round] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c5);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c6);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c7);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c8);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_slli_epi16(state1, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)cipher, state1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">uBlock_128_Decrypt</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *cipher, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *plain, <span class=\"type\">int</span> round)</span><span class=\"comment\">// uBlock解密函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t__m128i L1 = _mm_setr_epi8(<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>);\t\t</span><br><span class=\"line\">\t__m128i L2 = _mm_setr_epi8(<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c1 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c2 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>);\t\t</span><br><span class=\"line\">\t__m128i c3 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c4 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c5 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c6 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>);\t\t</span><br><span class=\"line\">\t__m128i c7 = _mm_setr_epi8(<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c8 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>);\t\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i state1, state2, k, t1, t2, t3, t4;  </span><br><span class=\"line\"></span><br><span class=\"line\">\tstate2 = _mm_loadu_si128((__m128i*)cipher);</span><br><span class=\"line\">\tstate1 = _mm_srli_epi16(state2, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_and_si128(state1, con);</span><br><span class=\"line\">\tstate2 = _mm_and_si128(state2, con);</span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c1);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c2);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c3);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c4);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = round; i &gt; <span class=\"number\">0</span>; i--)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)Subkey[i]);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)(Subkey[i] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(state1, L1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(state2, L2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A3);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A2);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A2);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A1);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, state1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(S_Inv, state1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(S_Inv, state2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tk = _mm_loadu_si128((__m128i*)Subkey[<span class=\"number\">0</span>]);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\tk = _mm_loadu_si128((__m128i*)(Subkey[<span class=\"number\">0</span>] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\"></span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c5);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c6);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c7);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c8);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_slli_epi16(state1, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)plain, state1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Encrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Dec_Block</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input,<span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output,<span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Decrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block_Round</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen, <span class=\"type\">int</span> cryptround)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Encrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, cryptround);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Key_Schedule</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *seedkey, <span class=\"type\">int</span> keylen, <span class=\"type\">int</span> direction, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *subkey)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">   <span class=\"type\">int</span> i, j;</span><br><span class=\"line\">   </span><br><span class=\"line\">   <span class=\"built_in\">uBlock_128_KeySchedule</span>(seedkey);</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span>(direction == <span class=\"number\">0</span>)</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">\t   <span class=\"keyword\">for</span>(i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">17</span>; i++)</span><br><span class=\"line\">\t   &#123;</span><br><span class=\"line\">\t\t   <span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t   &#123;</span><br><span class=\"line\">\t\t\t   subkey[i * <span class=\"number\">16</span> + j] = (Subkey[i][<span class=\"number\">2</span> * j] &lt;&lt; <span class=\"number\">4</span>) ^ Subkey[i][<span class=\"number\">2</span> * j + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t   &#125;</span><br><span class=\"line\">\t   &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span>(direction == <span class=\"number\">1</span>)</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">\t   <span class=\"keyword\">for</span>(i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">17</span>; i++)</span><br><span class=\"line\">\t   &#123;</span><br><span class=\"line\">\t\t   <span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t   &#123;</span><br><span class=\"line\">\t\t\t   subkey[i * <span class=\"number\">16</span> + j] = (Subkey[<span class=\"number\">16</span> - i][<span class=\"number\">2</span> * j] &lt;&lt; <span class=\"number\">4</span>) ^ Subkey[<span class=\"number\">16</span> - i][<span class=\"number\">2</span> * j + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t   &#125;</span><br><span class=\"line\">\t   &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block_CBC</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g, j;</span><br><span class=\"line\">\t<span class=\"type\">unsigned</span> <span class=\"type\">char</span> iv[<span class=\"number\">16</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tiv[j] ^= input[g * <span class=\"number\">16</span> + j];</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Encrypt</span>(iv, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t\t<span class=\"built_in\">memcpy</span>(iv, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Dec_Block_CBC</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input,<span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output,<span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g, j;</span><br><span class=\"line\">\t<span class=\"type\">unsigned</span> <span class=\"type\">char</span> iv[<span class=\"number\">16</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Decrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\toutput[g * <span class=\"number\">16</span> + j] ^= iv[j];</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">memcpy</span>(iv, input+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block_ECB</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> g;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">uBlock_128_Encrypt</span>(input + g * <span class=\"number\">16</span>, output + g * <span class=\"number\">16</span>, <span class=\"number\">16</span>); </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    *out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Dec_Block_ECB</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> g;    </span><br><span class=\"line\">    <span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">uBlock_128_Decrypt</span>(input + g * <span class=\"number\">16</span>, output + g * <span class=\"number\">16</span>, <span class=\"number\">16</span>); </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    *out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">char</span> key[<span class=\"number\">16</span>] = &#123;<span class=\"number\">0x01</span>, <span class=\"number\">0x23</span>, <span class=\"number\">0x45</span>, <span class=\"number\">0x67</span>, <span class=\"number\">0x89</span>, <span class=\"number\">0xAB</span>, <span class=\"number\">0xCD</span>, <span class=\"number\">0xEF</span>, <span class=\"number\">0xFE</span>, <span class=\"number\">0xDC</span>, <span class=\"number\">0xBA</span>, <span class=\"number\">0x98</span>, <span class=\"number\">0x76</span>, <span class=\"number\">0x54</span>, <span class=\"number\">0x32</span>, <span class=\"number\">0x10</span>&#125;;</span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">char</span> subkey[<span class=\"number\">272</span>];</span><br><span class=\"line\">    FILE *bmpFile, *encFile, *decFile;</span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">char</span> header[<span class=\"number\">54</span>]; <span class=\"comment\">// BMP 文件头大小为 54 字节</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 打开朱鹮.bmp文件</span></span><br><span class=\"line\">    bmpFile = <span class=\"built_in\">fopen</span>(<span class=\"string\">&quot;朱鹮.bmp&quot;</span>, <span class=\"string\">&quot;rb&quot;</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;open successfully！\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (bmpFile == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;open failed！\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;无法打开文件。\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 读取BMP文件头</span></span><br><span class=\"line\">    <span class=\"built_in\">fread</span>(header, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), <span class=\"number\">54</span>, bmpFile);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 创建加密文件和解密文件</span></span><br><span class=\"line\">    encFile = <span class=\"built_in\">fopen</span>(<span class=\"string\">&quot;朱鹮_CBC.bmp&quot;</span>, <span class=\"string\">&quot;wb&quot;</span>);</span><br><span class=\"line\">    decFile = <span class=\"built_in\">fopen</span>(<span class=\"string\">&quot;朱鹮_CBC_dec.bmp&quot;</span>, <span class=\"string\">&quot;wb&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// CBC加密</span></span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">char</span> buffer[<span class=\"number\">16</span>];</span><br><span class=\"line\">    <span class=\"type\">int</span> bytesRead;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> ((bytesRead = <span class=\"built_in\">fread</span>(buffer, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), <span class=\"number\">16</span>, bmpFile)) &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 执行CBC加密操作</span></span><br><span class=\"line\">        <span class=\"built_in\">Crypt_Enc_Block_CBC</span>(buffer, bytesRead, buffer, &amp;bytesRead, key, <span class=\"number\">16</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 将加密后的数据写入加密文件</span></span><br><span class=\"line\">        <span class=\"built_in\">fwrite</span>(buffer, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), bytesRead, encFile);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 关闭加密文件</span></span><br><span class=\"line\">    <span class=\"built_in\">fclose</span>(encFile);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 重新打开加密文件进行解密</span></span><br><span class=\"line\">    encFile = <span class=\"built_in\">fopen</span>(<span class=\"string\">&quot;朱鹮_CBC.bmp&quot;</span>, <span class=\"string\">&quot;rb&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (encFile == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;无法打开加密文件。\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 读取加密文件头</span></span><br><span class=\"line\">    <span class=\"built_in\">fread</span>(header, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), <span class=\"number\">54</span>, encFile);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// CBC解密</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> ((bytesRead = <span class=\"built_in\">fread</span>(buffer, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), <span class=\"number\">16</span>, encFile)) &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 执行CBC解密操作</span></span><br><span class=\"line\">        <span class=\"built_in\">Crypt_Dec_Block_CBC</span>(buffer, bytesRead, buffer, &amp;bytesRead, key, <span class=\"number\">16</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 将解密后的数据写入解密文件</span></span><br><span class=\"line\">        <span class=\"built_in\">fwrite</span>(buffer, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), bytesRead, decFile);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 关闭所有文件</span></span><br><span class=\"line\">    <span class=\"built_in\">fclose</span>(bmpFile);</span><br><span class=\"line\">    <span class=\"built_in\">fclose</span>(encFile);</span><br><span class=\"line\">    <span class=\"built_in\">fclose</span>(decFile);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"ublock_bmp加密代码ecb加密-cpp\"><a class=\"anchor\" href=\"#ublock_bmp加密代码ecb加密-cpp\">#</a> uBlock_bmp (加密代码)——ECB 加密 .cpp</h2>\n<p><figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br><span class=\"line\">392</span><br><span class=\"line\">393</span><br><span class=\"line\">394</span><br><span class=\"line\">395</span><br><span class=\"line\">396</span><br><span class=\"line\">397</span><br><span class=\"line\">398</span><br><span class=\"line\">399</span><br><span class=\"line\">400</span><br><span class=\"line\">401</span><br><span class=\"line\">402</span><br><span class=\"line\">403</span><br><span class=\"line\">404</span><br><span class=\"line\">405</span><br><span class=\"line\">406</span><br><span class=\"line\">407</span><br><span class=\"line\">408</span><br><span class=\"line\">409</span><br><span class=\"line\">410</span><br><span class=\"line\">411</span><br><span class=\"line\">412</span><br><span class=\"line\">413</span><br><span class=\"line\">414</span><br><span class=\"line\">415</span><br><span class=\"line\">416</span><br><span class=\"line\">417</span><br><span class=\"line\">418</span><br><span class=\"line\">419</span><br><span class=\"line\">420</span><br><span class=\"line\">421</span><br><span class=\"line\">422</span><br><span class=\"line\">423</span><br><span class=\"line\">424</span><br><span class=\"line\">425</span><br><span class=\"line\">426</span><br><span class=\"line\">427</span><br><span class=\"line\">428</span><br><span class=\"line\">429</span><br><span class=\"line\">430</span><br><span class=\"line\">431</span><br><span class=\"line\">432</span><br><span class=\"line\">433</span><br><span class=\"line\">434</span><br><span class=\"line\">435</span><br><span class=\"line\">436</span><br><span class=\"line\">437</span><br><span class=\"line\">438</span><br><span class=\"line\">439</span><br><span class=\"line\">440</span><br><span class=\"line\">441</span><br><span class=\"line\">442</span><br><span class=\"line\">443</span><br><span class=\"line\">444</span><br><span class=\"line\">445</span><br><span class=\"line\">446</span><br><span class=\"line\">447</span><br><span class=\"line\">448</span><br><span class=\"line\">449</span><br><span class=\"line\">450</span><br><span class=\"line\">451</span><br><span class=\"line\">452</span><br><span class=\"line\">453</span><br><span class=\"line\">454</span><br><span class=\"line\">455</span><br><span class=\"line\">456</span><br><span class=\"line\">457</span><br><span class=\"line\">458</span><br><span class=\"line\">459</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;memory.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;time.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;windows.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;emmintrin.h&gt;</span><span class=\"comment\">//sse2 header file(include sse header file)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;pmmintrin.h&gt;</span> <span class=\"comment\">//SSE3(include emmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;tmmintrin.h&gt;</span><span class=\"comment\">//SSSE3(include pmmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;smmintrin.h&gt;</span><span class=\"comment\">//SSE4.1(include tmmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;nmmintrin.h&gt;</span><span class=\"comment\">//SSE4.2(include smmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;intrin.h&gt;</span><span class=\"comment\">//(include immintrin.h)  </span></span></span><br><span class=\"line\"></span><br><span class=\"line\">__m128i S     = _mm_setr_epi8(<span class=\"number\">0x7</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x5</span>);</span><br><span class=\"line\">__m128i S_Inv = _mm_setr_epi8(<span class=\"number\">0xc</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x8</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">__m128i con = _mm_set1_epi8(<span class=\"number\">0x0f</span>);</span><br><span class=\"line\">__m128i A1 = _mm_setr_epi8(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">9</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">8</span>);\t</span><br><span class=\"line\">__m128i A2 = _mm_setr_epi8(<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>);\t\t</span><br><span class=\"line\">__m128i A3 = _mm_setr_epi8(<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>);\t\t</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">unsigned</span> <span class=\"type\">char</span> Subkey[<span class=\"number\">17</span>][<span class=\"number\">32</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">unsigned</span> <span class=\"type\">char</span> RC[<span class=\"number\">16</span>][<span class=\"number\">16</span>] = &#123;<span class=\"number\">0x9</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xf</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x2</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x8</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xc</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x4</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x5</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x7</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xb</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xa</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x8</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xd</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x7</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x3</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xa</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">uBlock_128_KeySchedule</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key)</span><span class=\"comment\">// 密钥生成函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t__m128i SK = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">7</span>, <span class=\"number\">5</span>, <span class=\"number\">11</span>, <span class=\"number\">9</span>, <span class=\"number\">15</span>, <span class=\"number\">13</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c1 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c2 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>);\t\t</span><br><span class=\"line\">\t__m128i c3 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c4 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c5 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c6 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">11</span>, <span class=\"number\">12</span>, <span class=\"number\">13</span>, <span class=\"number\">14</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\">\t__m128i c7 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">11</span>, <span class=\"number\">12</span>, <span class=\"number\">13</span>, <span class=\"number\">14</span>, <span class=\"number\">15</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>);\t</span><br><span class=\"line\">\t__m128i c8 = _mm_setr_epi8(<span class=\"number\">6</span>,<span class=\"number\">0</span>,<span class=\"number\">8</span>,<span class=\"number\">13</span>,<span class=\"number\">1</span>,<span class=\"number\">15</span>,<span class=\"number\">5</span>,<span class=\"number\">10</span>,<span class=\"number\">4</span>,<span class=\"number\">9</span>,<span class=\"number\">12</span>,<span class=\"number\">2</span>,<span class=\"number\">11</span>,<span class=\"number\">3</span>,<span class=\"number\">7</span>,<span class=\"number\">14</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i state1, state2, k, t1, t2, t3, t4;  </span><br><span class=\"line\"></span><br><span class=\"line\">\tstate2 = _mm_loadu_si128((__m128i*)key);</span><br><span class=\"line\">\tstate1 = _mm_srli_epi16(state2, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_and_si128(state1, con);</span><br><span class=\"line\">\tstate2 = _mm_and_si128(state2, con);</span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c1);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c2);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c3);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c4);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)Subkey[<span class=\"number\">0</span>], state1);</span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)(Subkey[<span class=\"number\">0</span>] + <span class=\"number\">16</span>), state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">1</span>; i &lt;= <span class=\"number\">16</span>; i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(state1, c8);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)RC[i - <span class=\"number\">1</span>]);</span><br><span class=\"line\">\t\tk = _mm_xor_si128(k, state1);</span><br><span class=\"line\">\t\tt1 =  _mm_shuffle_epi8(S, k);</span><br><span class=\"line\">\t\tt2 = _mm_shuffle_epi8(SK, k);</span><br><span class=\"line\">\t\tt3 = _mm_shuffle_epi8(t1, c5);</span><br><span class=\"line\">\t\tt4 = _mm_shuffle_epi8(t2, c6);</span><br><span class=\"line\">\t\tk = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tk = _mm_xor_si128(k, state2);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(state1, c7);</span><br><span class=\"line\">\t\tstate1 = k;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t_mm_storeu_si128((__m128i*)Subkey[i], state1);</span><br><span class=\"line\">\t\t_mm_storeu_si128((__m128i*)(Subkey[i] + <span class=\"number\">16</span>), state2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">uBlock_128_Encrypt</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *plain, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *cipher, <span class=\"type\">int</span> round)</span><span class=\"comment\">//uBlock加密函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t__m128i L1 = _mm_setr_epi8(<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>);\t\t</span><br><span class=\"line\">\t__m128i L2 = _mm_setr_epi8(<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c1 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c2 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>);\t\t</span><br><span class=\"line\">\t__m128i c3 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c4 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c5 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c6 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>);\t\t</span><br><span class=\"line\">\t__m128i c7 = _mm_setr_epi8(<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c8 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>);\t\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i state1, state2, k, t1, t2, t3, t4;  </span><br><span class=\"line\"></span><br><span class=\"line\">\tstate2 = _mm_loadu_si128((__m128i*)plain);</span><br><span class=\"line\">\tstate1 = _mm_srli_epi16(state2, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_and_si128(state1, con);</span><br><span class=\"line\">\tstate2 = _mm_and_si128(state2, con);</span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c1);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c2);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c3);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c4);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; round; i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)Subkey[i]);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)(Subkey[i] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(S, state1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(S, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, state1);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A1);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A2);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A2);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A3);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(state1, L1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(state2, L2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(round == <span class=\"number\">16</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)Subkey[round]);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)(Subkey[round] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c5);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c6);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c7);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c8);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_slli_epi16(state1, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)cipher, state1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">uBlock_128_Decrypt</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *cipher, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *plain, <span class=\"type\">int</span> round)</span><span class=\"comment\">// uBlock解密函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t__m128i L1 = _mm_setr_epi8(<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>);\t\t</span><br><span class=\"line\">\t__m128i L2 = _mm_setr_epi8(<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c1 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c2 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>);\t\t</span><br><span class=\"line\">\t__m128i c3 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c4 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c5 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c6 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>);\t\t</span><br><span class=\"line\">\t__m128i c7 = _mm_setr_epi8(<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c8 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>);\t\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i state1, state2, k, t1, t2, t3, t4;  </span><br><span class=\"line\"></span><br><span class=\"line\">\tstate2 = _mm_loadu_si128((__m128i*)cipher);</span><br><span class=\"line\">\tstate1 = _mm_srli_epi16(state2, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_and_si128(state1, con);</span><br><span class=\"line\">\tstate2 = _mm_and_si128(state2, con);</span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c1);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c2);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c3);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c4);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = round; i &gt; <span class=\"number\">0</span>; i--)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)Subkey[i]);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)(Subkey[i] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(state1, L1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(state2, L2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A3);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A2);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A2);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A1);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, state1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(S_Inv, state1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(S_Inv, state2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tk = _mm_loadu_si128((__m128i*)Subkey[<span class=\"number\">0</span>]);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\tk = _mm_loadu_si128((__m128i*)(Subkey[<span class=\"number\">0</span>] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\"></span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c5);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c6);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c7);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c8);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_slli_epi16(state1, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)plain, state1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Encrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Dec_Block</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input,<span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output,<span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Decrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block_Round</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen, <span class=\"type\">int</span> cryptround)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Encrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, cryptround);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Key_Schedule</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *seedkey, <span class=\"type\">int</span> keylen, <span class=\"type\">int</span> direction, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *subkey)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">   <span class=\"type\">int</span> i, j;</span><br><span class=\"line\">   </span><br><span class=\"line\">   <span class=\"built_in\">uBlock_128_KeySchedule</span>(seedkey);</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span>(direction == <span class=\"number\">0</span>)</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">\t   <span class=\"keyword\">for</span>(i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">17</span>; i++)</span><br><span class=\"line\">\t   &#123;</span><br><span class=\"line\">\t\t   <span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t   &#123;</span><br><span class=\"line\">\t\t\t   subkey[i * <span class=\"number\">16</span> + j] = (Subkey[i][<span class=\"number\">2</span> * j] &lt;&lt; <span class=\"number\">4</span>) ^ Subkey[i][<span class=\"number\">2</span> * j + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t   &#125;</span><br><span class=\"line\">\t   &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span>(direction == <span class=\"number\">1</span>)</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">\t   <span class=\"keyword\">for</span>(i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">17</span>; i++)</span><br><span class=\"line\">\t   &#123;</span><br><span class=\"line\">\t\t   <span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t   &#123;</span><br><span class=\"line\">\t\t\t   subkey[i * <span class=\"number\">16</span> + j] = (Subkey[<span class=\"number\">16</span> - i][<span class=\"number\">2</span> * j] &lt;&lt; <span class=\"number\">4</span>) ^ Subkey[<span class=\"number\">16</span> - i][<span class=\"number\">2</span> * j + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t   &#125;</span><br><span class=\"line\">\t   &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block_CBC</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g, j;</span><br><span class=\"line\">\t<span class=\"type\">unsigned</span> <span class=\"type\">char</span> iv[<span class=\"number\">16</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tiv[j] ^= input[g * <span class=\"number\">16</span> + j];</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Encrypt</span>(iv, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t\t<span class=\"built_in\">memcpy</span>(iv, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Dec_Block_CBC</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input,<span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output,<span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g, j;</span><br><span class=\"line\">\t<span class=\"type\">unsigned</span> <span class=\"type\">char</span> iv[<span class=\"number\">16</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Decrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\toutput[g * <span class=\"number\">16</span> + j] ^= iv[j];</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">memcpy</span>(iv, input+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block_ECB</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> g;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">uBlock_128_Encrypt</span>(input + g * <span class=\"number\">16</span>, output + g * <span class=\"number\">16</span>, <span class=\"number\">16</span>); </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    *out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Dec_Block_ECB</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> g;    </span><br><span class=\"line\">    <span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">uBlock_128_Decrypt</span>(input + g * <span class=\"number\">16</span>, output + g * <span class=\"number\">16</span>, <span class=\"number\">16</span>); </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    *out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">char</span> key[<span class=\"number\">16</span>] = &#123;<span class=\"number\">0x01</span>, <span class=\"number\">0x23</span>, <span class=\"number\">0x45</span>, <span class=\"number\">0x67</span>, <span class=\"number\">0x89</span>, <span class=\"number\">0xAB</span>, <span class=\"number\">0xCD</span>, <span class=\"number\">0xEF</span>, <span class=\"number\">0xFE</span>, <span class=\"number\">0xDC</span>, <span class=\"number\">0xBA</span>, <span class=\"number\">0x98</span>, <span class=\"number\">0x76</span>, <span class=\"number\">0x54</span>, <span class=\"number\">0x32</span>, <span class=\"number\">0x10</span>&#125;;</span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">char</span> subkey[<span class=\"number\">272</span>];</span><br><span class=\"line\">    FILE *bmpFile, *encFile, *decFile;</span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">char</span> header[<span class=\"number\">54</span>]; <span class=\"comment\">// BMP 文件头大小为 54 字节</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 打开朱鹮.bmp文件</span></span><br><span class=\"line\">    bmpFile = <span class=\"built_in\">fopen</span>(<span class=\"string\">&quot;朱鹮.bmp&quot;</span>, <span class=\"string\">&quot;rb&quot;</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;open successfully！\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (bmpFile == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;open failed！\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;无法打开文件。\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 读取BMP文件头</span></span><br><span class=\"line\">    <span class=\"built_in\">fread</span>(header, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), <span class=\"number\">54</span>, bmpFile);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 创建加密文件和解密文件</span></span><br><span class=\"line\">    encFile = <span class=\"built_in\">fopen</span>(<span class=\"string\">&quot;朱鹮_ECB.bmp&quot;</span>, <span class=\"string\">&quot;wb&quot;</span>);</span><br><span class=\"line\">    decFile = <span class=\"built_in\">fopen</span>(<span class=\"string\">&quot;朱鹮_ECB_dec.bmp&quot;</span>, <span class=\"string\">&quot;wb&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ECB加密</span></span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">char</span> buffer[<span class=\"number\">16</span>];</span><br><span class=\"line\">    <span class=\"type\">int</span> bytesRead;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> ((bytesRead = <span class=\"built_in\">fread</span>(buffer, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), <span class=\"number\">16</span>, bmpFile)) &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 执行ECB加密操作</span></span><br><span class=\"line\">        Crypt_Enc_Block_ECBbuffer, bytesRead, buffer, &amp;bytesRead, key, <span class=\"number\">16</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 将加密后的数据写入加密文件</span></span><br><span class=\"line\">        <span class=\"built_in\">fwrite</span>(buffer, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), bytesRead, encFile);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 关闭加密文件</span></span><br><span class=\"line\">    <span class=\"built_in\">fclose</span>(encFile);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 重新打开加密文件进行解密</span></span><br><span class=\"line\">    encFile = <span class=\"built_in\">fopen</span>(<span class=\"string\">&quot;朱鹮_ECB.bmp&quot;</span>, <span class=\"string\">&quot;rb&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (encFile == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;无法打开加密文件。\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 读取加密文件头</span></span><br><span class=\"line\">    <span class=\"built_in\">fread</span>(header, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), <span class=\"number\">54</span>, encFile);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ECB解密</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> ((bytesRead = <span class=\"built_in\">fread</span>(buffer, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), <span class=\"number\">16</span>, encFile)) &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 执行ECB解密操作</span></span><br><span class=\"line\">        <span class=\"built_in\">Crypt_Dec_Block_ECB</span>(buffer, bytesRead, buffer, &amp;bytesRead, key, <span class=\"number\">16</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 将解密后的数据写入解密文件</span></span><br><span class=\"line\">        <span class=\"built_in\">fwrite</span>(buffer, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), bytesRead, decFile);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 关闭所有文件</span></span><br><span class=\"line\">    <span class=\"built_in\">fclose</span>(bmpFile);</span><br><span class=\"line\">    <span class=\"built_in\">fclose</span>(encFile);</span><br><span class=\"line\">    <span class=\"built_in\">fclose</span>(decFile);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"ublock_bmp加密代码ecb加密cpp\"><a class=\"anchor\" href=\"#ublock_bmp加密代码ecb加密cpp\">#</a> uBlock_bmp (加密代码)——ECB 加密.cpp</h2>\n<p><figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br><span class=\"line\">392</span><br><span class=\"line\">393</span><br><span class=\"line\">394</span><br><span class=\"line\">395</span><br><span class=\"line\">396</span><br><span class=\"line\">397</span><br><span class=\"line\">398</span><br><span class=\"line\">399</span><br><span class=\"line\">400</span><br><span class=\"line\">401</span><br><span class=\"line\">402</span><br><span class=\"line\">403</span><br><span class=\"line\">404</span><br><span class=\"line\">405</span><br><span class=\"line\">406</span><br><span class=\"line\">407</span><br><span class=\"line\">408</span><br><span class=\"line\">409</span><br><span class=\"line\">410</span><br><span class=\"line\">411</span><br><span class=\"line\">412</span><br><span class=\"line\">413</span><br><span class=\"line\">414</span><br><span class=\"line\">415</span><br><span class=\"line\">416</span><br><span class=\"line\">417</span><br><span class=\"line\">418</span><br><span class=\"line\">419</span><br><span class=\"line\">420</span><br><span class=\"line\">421</span><br><span class=\"line\">422</span><br><span class=\"line\">423</span><br><span class=\"line\">424</span><br><span class=\"line\">425</span><br><span class=\"line\">426</span><br><span class=\"line\">427</span><br><span class=\"line\">428</span><br><span class=\"line\">429</span><br><span class=\"line\">430</span><br><span class=\"line\">431</span><br><span class=\"line\">432</span><br><span class=\"line\">433</span><br><span class=\"line\">434</span><br><span class=\"line\">435</span><br><span class=\"line\">436</span><br><span class=\"line\">437</span><br><span class=\"line\">438</span><br><span class=\"line\">439</span><br><span class=\"line\">440</span><br><span class=\"line\">441</span><br><span class=\"line\">442</span><br><span class=\"line\">443</span><br><span class=\"line\">444</span><br><span class=\"line\">445</span><br><span class=\"line\">446</span><br><span class=\"line\">447</span><br><span class=\"line\">448</span><br><span class=\"line\">449</span><br><span class=\"line\">450</span><br><span class=\"line\">451</span><br><span class=\"line\">452</span><br><span class=\"line\">453</span><br><span class=\"line\">454</span><br><span class=\"line\">455</span><br><span class=\"line\">456</span><br><span class=\"line\">457</span><br><span class=\"line\">458</span><br><span class=\"line\">459</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;memory.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;time.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;windows.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;emmintrin.h&gt;</span><span class=\"comment\">//sse2 header file(include sse header file)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;pmmintrin.h&gt;</span> <span class=\"comment\">//SSE3(include emmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;tmmintrin.h&gt;</span><span class=\"comment\">//SSSE3(include pmmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;smmintrin.h&gt;</span><span class=\"comment\">//SSE4.1(include tmmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;nmmintrin.h&gt;</span><span class=\"comment\">//SSE4.2(include smmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;intrin.h&gt;</span><span class=\"comment\">//(include immintrin.h)  </span></span></span><br><span class=\"line\"></span><br><span class=\"line\">__m128i S     = _mm_setr_epi8(<span class=\"number\">0x7</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x5</span>);</span><br><span class=\"line\">__m128i S_Inv = _mm_setr_epi8(<span class=\"number\">0xc</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x8</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">__m128i con = _mm_set1_epi8(<span class=\"number\">0x0f</span>);</span><br><span class=\"line\">__m128i A1 = _mm_setr_epi8(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">9</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">8</span>);\t</span><br><span class=\"line\">__m128i A2 = _mm_setr_epi8(<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>);\t\t</span><br><span class=\"line\">__m128i A3 = _mm_setr_epi8(<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>);\t\t</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">unsigned</span> <span class=\"type\">char</span> Subkey[<span class=\"number\">17</span>][<span class=\"number\">32</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">unsigned</span> <span class=\"type\">char</span> RC[<span class=\"number\">16</span>][<span class=\"number\">16</span>] = &#123;<span class=\"number\">0x9</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xf</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x2</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x8</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xc</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x4</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x5</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x7</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xb</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xa</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x8</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xd</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x7</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x3</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xa</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">uBlock_128_KeySchedule</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key)</span><span class=\"comment\">// 密钥生成函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t__m128i SK = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">7</span>, <span class=\"number\">5</span>, <span class=\"number\">11</span>, <span class=\"number\">9</span>, <span class=\"number\">15</span>, <span class=\"number\">13</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c1 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c2 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>);\t\t</span><br><span class=\"line\">\t__m128i c3 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c4 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c5 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c6 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">11</span>, <span class=\"number\">12</span>, <span class=\"number\">13</span>, <span class=\"number\">14</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\">\t__m128i c7 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">11</span>, <span class=\"number\">12</span>, <span class=\"number\">13</span>, <span class=\"number\">14</span>, <span class=\"number\">15</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>);\t</span><br><span class=\"line\">\t__m128i c8 = _mm_setr_epi8(<span class=\"number\">6</span>,<span class=\"number\">0</span>,<span class=\"number\">8</span>,<span class=\"number\">13</span>,<span class=\"number\">1</span>,<span class=\"number\">15</span>,<span class=\"number\">5</span>,<span class=\"number\">10</span>,<span class=\"number\">4</span>,<span class=\"number\">9</span>,<span class=\"number\">12</span>,<span class=\"number\">2</span>,<span class=\"number\">11</span>,<span class=\"number\">3</span>,<span class=\"number\">7</span>,<span class=\"number\">14</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i state1, state2, k, t1, t2, t3, t4;  </span><br><span class=\"line\"></span><br><span class=\"line\">\tstate2 = _mm_loadu_si128((__m128i*)key);</span><br><span class=\"line\">\tstate1 = _mm_srli_epi16(state2, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_and_si128(state1, con);</span><br><span class=\"line\">\tstate2 = _mm_and_si128(state2, con);</span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c1);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c2);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c3);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c4);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)Subkey[<span class=\"number\">0</span>], state1);</span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)(Subkey[<span class=\"number\">0</span>] + <span class=\"number\">16</span>), state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">1</span>; i &lt;= <span class=\"number\">16</span>; i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(state1, c8);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)RC[i - <span class=\"number\">1</span>]);</span><br><span class=\"line\">\t\tk = _mm_xor_si128(k, state1);</span><br><span class=\"line\">\t\tt1 =  _mm_shuffle_epi8(S, k);</span><br><span class=\"line\">\t\tt2 = _mm_shuffle_epi8(SK, k);</span><br><span class=\"line\">\t\tt3 = _mm_shuffle_epi8(t1, c5);</span><br><span class=\"line\">\t\tt4 = _mm_shuffle_epi8(t2, c6);</span><br><span class=\"line\">\t\tk = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tk = _mm_xor_si128(k, state2);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(state1, c7);</span><br><span class=\"line\">\t\tstate1 = k;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t_mm_storeu_si128((__m128i*)Subkey[i], state1);</span><br><span class=\"line\">\t\t_mm_storeu_si128((__m128i*)(Subkey[i] + <span class=\"number\">16</span>), state2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">uBlock_128_Encrypt</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *plain, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *cipher, <span class=\"type\">int</span> round)</span><span class=\"comment\">//uBlock加密函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t__m128i L1 = _mm_setr_epi8(<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>);\t\t</span><br><span class=\"line\">\t__m128i L2 = _mm_setr_epi8(<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c1 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c2 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>);\t\t</span><br><span class=\"line\">\t__m128i c3 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c4 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c5 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c6 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>);\t\t</span><br><span class=\"line\">\t__m128i c7 = _mm_setr_epi8(<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c8 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>);\t\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i state1, state2, k, t1, t2, t3, t4;  </span><br><span class=\"line\"></span><br><span class=\"line\">\tstate2 = _mm_loadu_si128((__m128i*)plain);</span><br><span class=\"line\">\tstate1 = _mm_srli_epi16(state2, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_and_si128(state1, con);</span><br><span class=\"line\">\tstate2 = _mm_and_si128(state2, con);</span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c1);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c2);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c3);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c4);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; round; i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)Subkey[i]);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)(Subkey[i] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(S, state1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(S, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, state1);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A1);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A2);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A2);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A3);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(state1, L1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(state2, L2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(round == <span class=\"number\">16</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)Subkey[round]);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)(Subkey[round] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c5);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c6);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c7);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c8);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_slli_epi16(state1, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)cipher, state1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">uBlock_128_Decrypt</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *cipher, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *plain, <span class=\"type\">int</span> round)</span><span class=\"comment\">// uBlock解密函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t__m128i L1 = _mm_setr_epi8(<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>);\t\t</span><br><span class=\"line\">\t__m128i L2 = _mm_setr_epi8(<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c1 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c2 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>);\t\t</span><br><span class=\"line\">\t__m128i c3 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c4 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c5 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c6 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>);\t\t</span><br><span class=\"line\">\t__m128i c7 = _mm_setr_epi8(<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c8 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>);\t\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i state1, state2, k, t1, t2, t3, t4;  </span><br><span class=\"line\"></span><br><span class=\"line\">\tstate2 = _mm_loadu_si128((__m128i*)cipher);</span><br><span class=\"line\">\tstate1 = _mm_srli_epi16(state2, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_and_si128(state1, con);</span><br><span class=\"line\">\tstate2 = _mm_and_si128(state2, con);</span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c1);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c2);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c3);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c4);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = round; i &gt; <span class=\"number\">0</span>; i--)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)Subkey[i]);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)(Subkey[i] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(state1, L1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(state2, L2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A3);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A2);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A2);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A1);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, state1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(S_Inv, state1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(S_Inv, state2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tk = _mm_loadu_si128((__m128i*)Subkey[<span class=\"number\">0</span>]);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\tk = _mm_loadu_si128((__m128i*)(Subkey[<span class=\"number\">0</span>] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\"></span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c5);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c6);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c7);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c8);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_slli_epi16(state1, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)plain, state1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Encrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Dec_Block</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input,<span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output,<span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Decrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block_Round</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen, <span class=\"type\">int</span> cryptround)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Encrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, cryptround);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Key_Schedule</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *seedkey, <span class=\"type\">int</span> keylen, <span class=\"type\">int</span> direction, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *subkey)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">   <span class=\"type\">int</span> i, j;</span><br><span class=\"line\">   </span><br><span class=\"line\">   <span class=\"built_in\">uBlock_128_KeySchedule</span>(seedkey);</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span>(direction == <span class=\"number\">0</span>)</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">\t   <span class=\"keyword\">for</span>(i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">17</span>; i++)</span><br><span class=\"line\">\t   &#123;</span><br><span class=\"line\">\t\t   <span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t   &#123;</span><br><span class=\"line\">\t\t\t   subkey[i * <span class=\"number\">16</span> + j] = (Subkey[i][<span class=\"number\">2</span> * j] &lt;&lt; <span class=\"number\">4</span>) ^ Subkey[i][<span class=\"number\">2</span> * j + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t   &#125;</span><br><span class=\"line\">\t   &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span>(direction == <span class=\"number\">1</span>)</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">\t   <span class=\"keyword\">for</span>(i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">17</span>; i++)</span><br><span class=\"line\">\t   &#123;</span><br><span class=\"line\">\t\t   <span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t   &#123;</span><br><span class=\"line\">\t\t\t   subkey[i * <span class=\"number\">16</span> + j] = (Subkey[<span class=\"number\">16</span> - i][<span class=\"number\">2</span> * j] &lt;&lt; <span class=\"number\">4</span>) ^ Subkey[<span class=\"number\">16</span> - i][<span class=\"number\">2</span> * j + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t   &#125;</span><br><span class=\"line\">\t   &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block_CBC</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g, j;</span><br><span class=\"line\">\t<span class=\"type\">unsigned</span> <span class=\"type\">char</span> iv[<span class=\"number\">16</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tiv[j] ^= input[g * <span class=\"number\">16</span> + j];</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Encrypt</span>(iv, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t\t<span class=\"built_in\">memcpy</span>(iv, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Dec_Block_CBC</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input,<span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output,<span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g, j;</span><br><span class=\"line\">\t<span class=\"type\">unsigned</span> <span class=\"type\">char</span> iv[<span class=\"number\">16</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Decrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\toutput[g * <span class=\"number\">16</span> + j] ^= iv[j];</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">memcpy</span>(iv, input+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block_ECB</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> g;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">uBlock_128_Encrypt</span>(input + g * <span class=\"number\">16</span>, output + g * <span class=\"number\">16</span>, <span class=\"number\">16</span>); </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    *out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Dec_Block_ECB</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> g;    </span><br><span class=\"line\">    <span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">uBlock_128_Decrypt</span>(input + g * <span class=\"number\">16</span>, output + g * <span class=\"number\">16</span>, <span class=\"number\">16</span>); </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    *out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">char</span> key[<span class=\"number\">16</span>] = &#123;<span class=\"number\">0x01</span>, <span class=\"number\">0x23</span>, <span class=\"number\">0x45</span>, <span class=\"number\">0x67</span>, <span class=\"number\">0x89</span>, <span class=\"number\">0xAB</span>, <span class=\"number\">0xCD</span>, <span class=\"number\">0xEF</span>, <span class=\"number\">0xFE</span>, <span class=\"number\">0xDC</span>, <span class=\"number\">0xBA</span>, <span class=\"number\">0x98</span>, <span class=\"number\">0x76</span>, <span class=\"number\">0x54</span>, <span class=\"number\">0x32</span>, <span class=\"number\">0x10</span>&#125;;</span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">char</span> subkey[<span class=\"number\">272</span>];</span><br><span class=\"line\">    FILE *bmpFile, *encFile, *decFile;</span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">char</span> header[<span class=\"number\">54</span>]; <span class=\"comment\">// BMP 文件头大小为 54 字节</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 打开朱鹮.bmp文件</span></span><br><span class=\"line\">    bmpFile = <span class=\"built_in\">fopen</span>(<span class=\"string\">&quot;朱鹮.bmp&quot;</span>, <span class=\"string\">&quot;rb&quot;</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;open successfully！\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (bmpFile == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;open failed！\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;无法打开文件。\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 读取BMP文件头</span></span><br><span class=\"line\">    <span class=\"built_in\">fread</span>(header, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), <span class=\"number\">54</span>, bmpFile);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 创建加密文件和解密文件</span></span><br><span class=\"line\">    encFile = <span class=\"built_in\">fopen</span>(<span class=\"string\">&quot;朱鹮_CBC.bmp&quot;</span>, <span class=\"string\">&quot;wb&quot;</span>);</span><br><span class=\"line\">    decFile = <span class=\"built_in\">fopen</span>(<span class=\"string\">&quot;朱鹮_CBC_dec.bmp&quot;</span>, <span class=\"string\">&quot;wb&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// CBC加密</span></span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">char</span> buffer[<span class=\"number\">16</span>];</span><br><span class=\"line\">    <span class=\"type\">int</span> bytesRead;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> ((bytesRead = <span class=\"built_in\">fread</span>(buffer, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), <span class=\"number\">16</span>, bmpFile)) &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 执行CBC加密操作</span></span><br><span class=\"line\">        <span class=\"built_in\">Crypt_Enc_Block_CBC</span>(buffer, bytesRead, buffer, &amp;bytesRead, key, <span class=\"number\">16</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 将加密后的数据写入加密文件</span></span><br><span class=\"line\">        <span class=\"built_in\">fwrite</span>(buffer, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), bytesRead, encFile);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 关闭加密文件</span></span><br><span class=\"line\">    <span class=\"built_in\">fclose</span>(encFile);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 重新打开加密文件进行解密</span></span><br><span class=\"line\">    encFile = <span class=\"built_in\">fopen</span>(<span class=\"string\">&quot;朱鹮_CBC.bmp&quot;</span>, <span class=\"string\">&quot;rb&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (encFile == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;无法打开加密文件。\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 读取加密文件头</span></span><br><span class=\"line\">    <span class=\"built_in\">fread</span>(header, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), <span class=\"number\">54</span>, encFile);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// CBC解密</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> ((bytesRead = <span class=\"built_in\">fread</span>(buffer, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), <span class=\"number\">16</span>, encFile)) &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 执行CBC解密操作</span></span><br><span class=\"line\">        <span class=\"built_in\">Crypt_Dec_Block_CBC</span>(buffer, bytesRead, buffer, &amp;bytesRead, key, <span class=\"number\">16</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 将解密后的数据写入解密文件</span></span><br><span class=\"line\">        <span class=\"built_in\">fwrite</span>(buffer, <span class=\"built_in\">sizeof</span>(<span class=\"type\">unsigned</span> <span class=\"type\">char</span>), bytesRead, decFile);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 关闭所有文件</span></span><br><span class=\"line\">    <span class=\"built_in\">fclose</span>(bmpFile);</span><br><span class=\"line\">    <span class=\"built_in\">fclose</span>(encFile);</span><br><span class=\"line\">    <span class=\"built_in\">fclose</span>(decFile);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"ublock_windows_128_128-_测试时间cpp\"><a class=\"anchor\" href=\"#ublock_windows_128_128-_测试时间cpp\">#</a> uBlock_Windows_128_128 _测试时间.cpp</h2>\n<p><figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br><span class=\"line\">392</span><br><span class=\"line\">393</span><br><span class=\"line\">394</span><br><span class=\"line\">395</span><br><span class=\"line\">396</span><br><span class=\"line\">397</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;memory.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;time.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;windows.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;emmintrin.h&gt;</span><span class=\"comment\">//sse2 header file(include sse header file)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;pmmintrin.h&gt;</span> <span class=\"comment\">//SSE3(include emmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;tmmintrin.h&gt;</span><span class=\"comment\">//SSSE3(include pmmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;smmintrin.h&gt;</span><span class=\"comment\">//SSE4.1(include tmmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;nmmintrin.h&gt;</span><span class=\"comment\">//SSE4.2(include smmintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;intrin.h&gt;</span><span class=\"comment\">//(include immintrin.h)  </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;chrono&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;thread&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">__m128i S     = _mm_setr_epi8(<span class=\"number\">0x7</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x5</span>);</span><br><span class=\"line\">__m128i S_Inv = _mm_setr_epi8(<span class=\"number\">0xc</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x8</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">__m128i con = _mm_set1_epi8(<span class=\"number\">0x0f</span>);</span><br><span class=\"line\">__m128i A1 = _mm_setr_epi8(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">9</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">8</span>);\t</span><br><span class=\"line\">__m128i A2 = _mm_setr_epi8(<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>);\t\t</span><br><span class=\"line\">__m128i A3 = _mm_setr_epi8(<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">13</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>);\t\t</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">unsigned</span> <span class=\"type\">char</span> Subkey[<span class=\"number\">17</span>][<span class=\"number\">32</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">unsigned</span> <span class=\"type\">char</span> RC[<span class=\"number\">16</span>][<span class=\"number\">16</span>] = &#123;<span class=\"number\">0x9</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xf</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x2</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x8</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xc</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x4</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x5</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x7</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x3</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xb</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xa</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x8</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0xa</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xd</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x7</span>,<span class=\"number\">0x8</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0xc</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x9</span>,<span class=\"number\">0x3</span>,<span class=\"number\">0xd</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0x3</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0x2</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x6</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0x7</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>,</span><br><span class=\"line\"><span class=\"number\">0xa</span>,<span class=\"number\">0x1</span>,<span class=\"number\">0xb</span>,<span class=\"number\">0x5</span>,<span class=\"number\">0xf</span>,<span class=\"number\">0x0</span>,<span class=\"number\">0xe</span>,<span class=\"number\">0x4</span>,<span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>, <span class=\"number\">0x0</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">uBlock_128_KeySchedule</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key)</span><span class=\"comment\">// 密钥生成函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t__m128i SK = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">7</span>, <span class=\"number\">5</span>, <span class=\"number\">11</span>, <span class=\"number\">9</span>, <span class=\"number\">15</span>, <span class=\"number\">13</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c1 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c2 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>);\t\t</span><br><span class=\"line\">\t__m128i c3 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c4 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c5 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c6 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">11</span>, <span class=\"number\">12</span>, <span class=\"number\">13</span>, <span class=\"number\">14</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\">\t__m128i c7 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">11</span>, <span class=\"number\">12</span>, <span class=\"number\">13</span>, <span class=\"number\">14</span>, <span class=\"number\">15</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>);\t</span><br><span class=\"line\">\t__m128i c8 = _mm_setr_epi8(<span class=\"number\">6</span>,<span class=\"number\">0</span>,<span class=\"number\">8</span>,<span class=\"number\">13</span>,<span class=\"number\">1</span>,<span class=\"number\">15</span>,<span class=\"number\">5</span>,<span class=\"number\">10</span>,<span class=\"number\">4</span>,<span class=\"number\">9</span>,<span class=\"number\">12</span>,<span class=\"number\">2</span>,<span class=\"number\">11</span>,<span class=\"number\">3</span>,<span class=\"number\">7</span>,<span class=\"number\">14</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i state1, state2, k, t1, t2, t3, t4;  </span><br><span class=\"line\"></span><br><span class=\"line\">\tstate2 = _mm_loadu_si128((__m128i*)key);</span><br><span class=\"line\">\tstate1 = _mm_srli_epi16(state2, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_and_si128(state1, con);</span><br><span class=\"line\">\tstate2 = _mm_and_si128(state2, con);</span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c1);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c2);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c3);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c4);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)Subkey[<span class=\"number\">0</span>], state1);</span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)(Subkey[<span class=\"number\">0</span>] + <span class=\"number\">16</span>), state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">1</span>; i &lt;= <span class=\"number\">16</span>; i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(state1, c8);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)RC[i - <span class=\"number\">1</span>]);</span><br><span class=\"line\">\t\tk = _mm_xor_si128(k, state1);</span><br><span class=\"line\">\t\tt1 =  _mm_shuffle_epi8(S, k);</span><br><span class=\"line\">\t\tt2 = _mm_shuffle_epi8(SK, k);</span><br><span class=\"line\">\t\tt3 = _mm_shuffle_epi8(t1, c5);</span><br><span class=\"line\">\t\tt4 = _mm_shuffle_epi8(t2, c6);</span><br><span class=\"line\">\t\tk = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tk = _mm_xor_si128(k, state2);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(state1, c7);</span><br><span class=\"line\">\t\tstate1 = k;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t_mm_storeu_si128((__m128i*)Subkey[i], state1);</span><br><span class=\"line\">\t\t_mm_storeu_si128((__m128i*)(Subkey[i] + <span class=\"number\">16</span>), state2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">uBlock_128_Encrypt</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *plain, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *cipher, <span class=\"type\">int</span> round)</span><span class=\"comment\">//uBlock加密函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t__m128i L1 = _mm_setr_epi8(<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>);\t\t</span><br><span class=\"line\">\t__m128i L2 = _mm_setr_epi8(<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c1 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c2 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>);\t\t</span><br><span class=\"line\">\t__m128i c3 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c4 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c5 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c6 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>);\t\t</span><br><span class=\"line\">\t__m128i c7 = _mm_setr_epi8(<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c8 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>);\t\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i state1, state2, k, t1, t2, t3, t4;  </span><br><span class=\"line\"></span><br><span class=\"line\">\tstate2 = _mm_loadu_si128((__m128i*)plain);</span><br><span class=\"line\">\tstate1 = _mm_srli_epi16(state2, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_and_si128(state1, con);</span><br><span class=\"line\">\tstate2 = _mm_and_si128(state2, con);</span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c1);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c2);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c3);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c4);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; round; i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)Subkey[i]);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)(Subkey[i] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(S, state1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(S, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, state1);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A1);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A2);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A2);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A3);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(state1, L1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(state2, L2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(round == <span class=\"number\">16</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)Subkey[round]);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)(Subkey[round] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c5);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c6);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c7);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c8);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_slli_epi16(state1, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)cipher, state1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">uBlock_128_Decrypt</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *cipher, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *plain, <span class=\"type\">int</span> round)</span><span class=\"comment\">// uBlock解密函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t__m128i L1 = _mm_setr_epi8(<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>);\t\t</span><br><span class=\"line\">\t__m128i L2 = _mm_setr_epi8(<span class=\"number\">6</span>,<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">14</span>,<span class=\"number\">15</span>,<span class=\"number\">12</span>,<span class=\"number\">13</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c1 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c2 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">0x80</span>, <span class=\"number\">2</span>, <span class=\"number\">0x80</span>, <span class=\"number\">3</span>, <span class=\"number\">0x80</span>, <span class=\"number\">4</span>, <span class=\"number\">0x80</span>, <span class=\"number\">5</span>, <span class=\"number\">0x80</span>, <span class=\"number\">6</span>, <span class=\"number\">0x80</span>, <span class=\"number\">7</span>);\t\t</span><br><span class=\"line\">\t__m128i c3 = _mm_setr_epi8(<span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c4 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">8</span>, <span class=\"number\">0x80</span>, <span class=\"number\">9</span>, <span class=\"number\">0x80</span>, <span class=\"number\">10</span>, <span class=\"number\">0x80</span>, <span class=\"number\">11</span>, <span class=\"number\">0x80</span>, <span class=\"number\">12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">13</span>, <span class=\"number\">0x80</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">15</span>);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i c5 = _mm_setr_epi8(<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t</span><br><span class=\"line\">\t__m128i c6 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>);\t\t</span><br><span class=\"line\">\t__m128i c7 = _mm_setr_epi8(<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>);\t\t</span><br><span class=\"line\">\t__m128i c8 = _mm_setr_epi8(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">15</span>);\t\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t__m128i state1, state2, k, t1, t2, t3, t4;  </span><br><span class=\"line\"></span><br><span class=\"line\">\tstate2 = _mm_loadu_si128((__m128i*)cipher);</span><br><span class=\"line\">\tstate1 = _mm_srli_epi16(state2, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_and_si128(state1, con);</span><br><span class=\"line\">\tstate2 = _mm_and_si128(state2, con);</span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c1);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c2);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c3);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c4);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = round; i &gt; <span class=\"number\">0</span>; i--)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)Subkey[i]);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_loadu_si128((__m128i*)(Subkey[i] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(state1, L1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(state2, L2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A3);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A2);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state1, A2);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\">\t\tk = _mm_shuffle_epi8(state2, A1);</span><br><span class=\"line\">\t\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\t\tstate2 = _mm_xor_si128(state2, state1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tstate1 = _mm_shuffle_epi8(S_Inv, state1);</span><br><span class=\"line\">\t\tstate2 = _mm_shuffle_epi8(S_Inv, state2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tk = _mm_loadu_si128((__m128i*)Subkey[<span class=\"number\">0</span>]);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(state1, k);</span><br><span class=\"line\">\tk = _mm_loadu_si128((__m128i*)(Subkey[<span class=\"number\">0</span>] + <span class=\"number\">16</span>));</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(state2, k);</span><br><span class=\"line\"></span><br><span class=\"line\">\tt1 = _mm_shuffle_epi8(state1, c5);</span><br><span class=\"line\">\tt2 = _mm_shuffle_epi8(state2, c6);</span><br><span class=\"line\">\tt3 = _mm_shuffle_epi8(state1, c7);</span><br><span class=\"line\">\tt4 = _mm_shuffle_epi8(state2, c8);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_xor_si128(t1, t2);</span><br><span class=\"line\">\tstate2 = _mm_xor_si128(t3, t4);</span><br><span class=\"line\"></span><br><span class=\"line\">\tstate1 = _mm_slli_epi16(state1, <span class=\"number\">4</span>);</span><br><span class=\"line\">\tstate1 = _mm_xor_si128(state1, state2);</span><br><span class=\"line\"></span><br><span class=\"line\">\t_mm_storeu_si128((__m128i*)plain, state1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Encrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Dec_Block</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input,<span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output,<span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Decrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block_Round</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen, <span class=\"type\">int</span> cryptround)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Encrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, cryptround);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Key_Schedule</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *seedkey, <span class=\"type\">int</span> keylen, <span class=\"type\">int</span> direction, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *subkey)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">   <span class=\"type\">int</span> i, j;</span><br><span class=\"line\">   </span><br><span class=\"line\">   <span class=\"built_in\">uBlock_128_KeySchedule</span>(seedkey);</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span>(direction == <span class=\"number\">0</span>)</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">\t   <span class=\"keyword\">for</span>(i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">17</span>; i++)</span><br><span class=\"line\">\t   &#123;</span><br><span class=\"line\">\t\t   <span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t   &#123;</span><br><span class=\"line\">\t\t\t   subkey[i * <span class=\"number\">16</span> + j] = (Subkey[i][<span class=\"number\">2</span> * j] &lt;&lt; <span class=\"number\">4</span>) ^ Subkey[i][<span class=\"number\">2</span> * j + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t   &#125;</span><br><span class=\"line\">\t   &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span>(direction == <span class=\"number\">1</span>)</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">\t   <span class=\"keyword\">for</span>(i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">17</span>; i++)</span><br><span class=\"line\">\t   &#123;</span><br><span class=\"line\">\t\t   <span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t   &#123;</span><br><span class=\"line\">\t\t\t   subkey[i * <span class=\"number\">16</span> + j] = (Subkey[<span class=\"number\">16</span> - i][<span class=\"number\">2</span> * j] &lt;&lt; <span class=\"number\">4</span>) ^ Subkey[<span class=\"number\">16</span> - i][<span class=\"number\">2</span> * j + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t   &#125;</span><br><span class=\"line\">\t   &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Enc_Block_CBC</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input, <span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output, <span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g, j;</span><br><span class=\"line\">\t<span class=\"type\">unsigned</span> <span class=\"type\">char</span> iv[<span class=\"number\">16</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tiv[j] ^= input[g * <span class=\"number\">16</span> + j];</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Encrypt</span>(iv, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t\t<span class=\"built_in\">memcpy</span>(iv, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Crypt_Dec_Block_CBC</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">char</span> *input,<span class=\"type\">int</span> in_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *output,<span class=\"type\">int</span> *out_len, <span class=\"type\">unsigned</span> <span class=\"type\">char</span> *key, <span class=\"type\">int</span> keylen)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> g, j;</span><br><span class=\"line\">\t<span class=\"type\">unsigned</span> <span class=\"type\">char</span> iv[<span class=\"number\">16</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"built_in\">uBlock_128_KeySchedule</span>(key);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (g = <span class=\"number\">0</span>; g &lt; in_len / <span class=\"number\">16</span>; g++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">uBlock_128_Decrypt</span>(input+g*<span class=\"number\">16</span>, output+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">16</span>; j++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\toutput[g * <span class=\"number\">16</span> + j] ^= iv[j];</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">memcpy</span>(iv, input+g*<span class=\"number\">16</span>, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t*out_len = in_len - in_len % <span class=\"number\">16</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t    <span class=\"keyword\">auto</span> start = std::chrono::high_resolution_clock::<span class=\"built_in\">now</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"type\">int</span> i, j, r;</span><br><span class=\"line\">\t<span class=\"type\">unsigned</span> <span class=\"type\">char</span> key[<span class=\"number\">16</span>]   = &#123;<span class=\"number\">0x01</span>,<span class=\"number\">0x23</span>,<span class=\"number\">0x45</span>,<span class=\"number\">0x67</span>,<span class=\"number\">0x89</span>,<span class=\"number\">0xAB</span>,<span class=\"number\">0xCD</span>,<span class=\"number\">0xEF</span>,<span class=\"number\">0xFE</span>,<span class=\"number\">0xDC</span>,<span class=\"number\">0xBA</span>,<span class=\"number\">0x98</span>,<span class=\"number\">0x76</span>,<span class=\"number\">0x54</span>,<span class=\"number\">0x32</span>,<span class=\"number\">0x10</span>&#125;;</span><br><span class=\"line\">\t<span class=\"type\">unsigned</span> <span class=\"type\">char</span> plain[<span class=\"number\">16</span>]   = &#123;<span class=\"number\">0x01</span>,<span class=\"number\">0x23</span>,<span class=\"number\">0x45</span>,<span class=\"number\">0x67</span>,<span class=\"number\">0x89</span>,<span class=\"number\">0xAB</span>,<span class=\"number\">0xCD</span>,<span class=\"number\">0xEF</span>,<span class=\"number\">0xFE</span>,<span class=\"number\">0xDC</span>,<span class=\"number\">0xBA</span>,<span class=\"number\">0x98</span>,<span class=\"number\">0x76</span>,<span class=\"number\">0x54</span>,<span class=\"number\">0x32</span>,<span class=\"number\">0x10</span>&#125;;</span><br><span class=\"line\">\t<span class=\"type\">unsigned</span> <span class=\"type\">char</span> cipher[<span class=\"number\">16</span>], subkey[<span class=\"number\">272</span>];</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(r = <span class=\"number\">0</span>; r &lt; <span class=\"number\">1000000</span>; r++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">Crypt_Enc_Block</span>(plain, <span class=\"number\">16</span>, cipher, &amp;j, key, <span class=\"number\">16</span>);\t</span><br><span class=\"line\">\t\t<span class=\"built_in\">memcpy</span>(plain, cipher, <span class=\"number\">16</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">16</span>; i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%02x &quot;</span>, cipher[i]);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> end = std::chrono::high_resolution_clock::<span class=\"built_in\">now</span>();</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> duration = std::chrono::<span class=\"built_in\">duration_cast</span>&lt;std::chrono::milliseconds&gt;(end - start);</span><br><span class=\"line\">    std::cout &lt;&lt; <span class=\"string\">&quot;Execution time: &quot;</span> &lt;&lt; duration.<span class=\"built_in\">count</span>() &lt;&lt; <span class=\"string\">&quot; milliseconds&quot;</span> &lt;&lt; std::endl;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"关于ublock加密算法的调研分析\"><a class=\"anchor\" href=\"#关于ublock加密算法的调研分析\">#</a> <strong>关于 uBlock 加密算法的调研分析</strong></h1>\n<p>目录</p>\n<p><a href=\"#_Toc5215\">1 引言\t</a></p>\n<p><a href=\"#_Toc22057\">2. 符号\t</a></p>\n<p><a href=\"#_Toc14603\">2.1 uBlock 所用符号\t</a></p>\n<p><a href=\"#_Toc26774\">2.2 uBlock 术语解释\t</a></p>\n<p><a href=\"#_Toc7826\">2.2.1 并置\t</a><br />\n2.2.2 半字节（Nibble）\t4</p>\n<p><a href=\"#_Toc1851\">2.2.3 向量置换（Permutation of Vectors）\t</a></p>\n<p><a href=\"#_Toc25622\">2.2.4 轮密钥（Round Key）\t</a></p>\n<p><a href=\"#_Toc9457\">3.uBlock 分组密码及两种工作模式的来历\t</a></p>\n<p><a href=\"#_Toc18505\">3.1 uBlock 算法来历\t</a></p>\n<p><a href=\"#_Toc10233\">3.2 ECB 分组密码模式来历\t</a></p>\n<p><a href=\"#_Toc31089\">3.2.1 ECB 的设计背景\t</a></p>\n<p><a href=\"#_Toc2653\">3.2.2 ECB 的来历\t</a></p>\n<p><a href=\"#_Toc714\">3.2.3 ECB 的迭代过程\t</a></p>\n<p><a href=\"#_Toc9825\">3.2.4 ECB 的安全性讨论\t</a></p>\n<p>3.3 CBC 模式分析\t6<br />\n3.3.1 CBC 模式的设计背景\t6<br />\n3.3.2 CBC 模式的来历\t6<br />\n3.3.3 CBC 模式的迭代构成\t6<br />\n3.3.4 CBC 模式的安全性讨论\t7</p>\n<p><a href=\"#_Toc10676\">4. uBlock 加密算法的总体框架与数据结构\t</a></p>\n<p><a href=\"#_Toc22371\">4.1 uBlock 算法的总体框架\t</a><br />\n4.1.1 uBlock 加密算法\t7<br />\n4.1.2 uBlock 解密算法\t9<br />\n4.1.3 uBlock 密钥扩展算法\t10</p>\n<p>4.2 uBlock 算法的数据结构\t11</p>\n<p><a href=\"#_Toc24973\">4.2.1 S 盒 (Substitution boxes)\t</a></p>\n<p><a href=\"#_Toc6879\">4.2.2 向量置换 (Vector Permutations)\t</a></p>\n<p><a href=\"#_Toc29481\">4.2.3 轮密钥 (Round Keys)\t</a></p>\n<p><a href=\"#_Toc31348\">4.2.4 密钥扩展算法 (Key Schedule)\t</a></p>\n<p><a href=\"#_Toc7498\">4.2.5 数据块的处理\t</a></p>\n<p><a href=\"#_Toc3860\">5. uBlock 的算法实现\t</a><br />\n5.1 基础代码设计\t12<br />\n5.2 评估正确性\t16<br />\n5.3 评估吞吐量和速度\t17</p>\n<p><a href=\"#_Toc23937\">6 以 uBlock 的 ECB 和 CBC 模式加密朱鹮.bmp 文件\t</a><br />\n6.1 BMP 文件格式解析\t18<br />\n6.2 BMP 文件加密技巧\t18<br />\n6.3 ECE 和 CBC 模式加解密结果\t19<br />\n6.3.1 ECB 模式进行加解密\t19<br />\n6.3.2 CBC 模式进行加解密\t19<br />\n6.3.3 ECB 和 CBC 模式的分析和对比\t20</p>\n<p><a href=\"#_Toc11983\">7 总结\t</a></p>\n<h1 id=\"关于ublock加密算法的调研分析-2\"><a class=\"anchor\" href=\"#关于ublock加密算法的调研分析-2\">#</a> <strong>关于 uBlock 加密算法的调研分析</strong></h1>\n<p>**** 摘要：**** 本文深入研究了 uBlock 和 ECB 两种分组密码算法，介绍了这两种算法的起源、设计原理、实现方法以及应用场景。通过对 uBlock 算法的详细剖析，解释了其设计的技术标准、密钥扩展机制以及加解密流程。此外，还探讨了 ECB 模式的设计背景与安全性讨论，指出了其在特定应用中的局限性。文章还包括了使用 C++ 实现的算法编程实例，验证了算法的正确性，并通过加密图像文件的实验，评估了两种算法在不同工作模式下的性能和安全性。通过实际应用案例，本文展示了分组密码在信息安全领域的重要性和实用价值。</p>\n<p>**** 关键词：**** 分组密码，uBlock，ECB 模式，密钥扩展，算法安全性，图像加密</p>\n<h2 id=\"1-引言\"><a class=\"anchor\" href=\"#1-引言\">#</a> <strong>1 引言</strong></h2>\n<p>随着信息技术的迅速发展，数据安全和隐私保护成为了网络空间安全的重要组成部分。分组密码作为保护电子数据的基本手段，承担着加密重要信息、防止数据泄露的关键角色。本文选择了两种具有代表性的分组密码算法：uBlock 和 ECB 模式，对它们的设计理念、实现过程以及安全性能进行了全面的分析和评估。</p>\n<p>uBlock 算法源于全国密码算法设计竞赛，它使用复杂的密钥扩展和多轮加密机制来提高安全性。这种算法设计考虑到了抵抗差分攻击和线性攻击的需求，适合于需要高安全标准的应用场景。而 ECB 模式，作为一种基础的加密模式，因其实现的简单性，在某些低安全需求的场合中仍被广泛使用，尽管它在处理大量具有重复模式的数据时存在安全隐患。</p>\n<p>在此基础上，本文还实现了这两种算法的编程模拟，并通过加密和解密图像文件的方法，直观地展示了它们在实际应用中的效果和性能，旨在为读者提供对分组密码在现实世界中应用的深入理解。通过对比分析和实验验证，本文不仅增强了对这两种算法性能和安全性的认识，也为未来选择和设计更加安全高效的加密方案提供了宝贵的经验和见解。</p>\n<p><strong>2. 符号</strong></p>\n<p><strong>2.1 uBlock 所用符号</strong></p>\n<p>表 1 uBlock 符号表</p>\n<table>\n<thead>\n<tr>\n<th><strong>X</strong></th>\n<th><strong>n</strong> 比特明文</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Y</strong></td>\n<td>n 比特密文</td>\n</tr>\n<tr>\n<td><strong>K</strong></td>\n<td>k 比特密钥</td>\n</tr>\n<tr>\n<td><strong>PK****i</strong></td>\n<td>n 比特轮密钥</td>\n</tr>\n<tr>\n<td><strong>PL<strong><strong>n</strong></strong>，PR<strong><strong>n</strong></strong>，PL****-1****，PR<strong><strong>n</strong></strong>-1</strong></td>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps13.png)</td>\n</tr>\n<tr>\n<td><strong>s</strong></td>\n<td>4 比特 S 盒</td>\n</tr>\n<tr>\n<td><strong>S<strong><strong>n</strong></strong>，S<strong><strong>n</strong></strong>-1</strong></td>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps14.png)</td>\n</tr>\n<tr>\n<td><strong>S****k</strong></td>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps15.png)</td>\n</tr>\n<tr>\n<td><strong>PK****1</strong></td>\n<td>16 个半字节的向量置换</td>\n</tr>\n<tr>\n<td><strong>PK<strong><strong>2</strong></strong>，PK****3</strong></td>\n<td>32 个半字节的向量置换</td>\n</tr>\n<tr>\n<td>⊕</td>\n<td>模 2 加运算</td>\n</tr>\n<tr>\n<td>&lt;&lt;&lt;b</td>\n<td>循环左移 b 比特</td>\n</tr>\n<tr>\n<td>&lt;&lt;&lt;b 32</td>\n<td>分款 32 比特循环左移 b 比特</td>\n</tr>\n<tr>\n<td>||</td>\n<td>表示比特串的连接</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"22-ublock术语解释\"><a class=\"anchor\" href=\"#22-ublock术语解释\">#</a> <strong>2.2 uBlock 术语解释</strong></h4>\n<h5 id=\"221-并置\"><a class=\"anchor\" href=\"#221-并置\">#</a> <strong>2.2.1 并置</strong></h5>\n<p>在密码学和算法设计中，&quot;并置&quot;（Concatenation）通常指的是将多个数据元素或操作按顺序排列在一起，形成一个连续的整体。在 uBlock 算法的上下文中，这个术语特别指向几个方面：<br />\nS 盒并置：在 uBlock 算法中，一个 S 盒操作通常处理 4 比特的输入，输出也是 4 比特。当我们谈到 &quot;S 盒并置&quot; 时，这意味着将多个 S 盒操作排列在一起，以并行处理更多的数据位。</p>\n<p>例如，如果有一个 128 比特的数据块，而每个 S 盒处理 4 比特，那么需要 32 个这样的 S 盒并置在一起，以便同时处理所有 128 比特。这 32 个 S 盒可以是相同的（即使用相同的替换规则），或者各不相同，具体取决于算法设计。</p>\n<p>数据并置：数据并置是指将多个较小的数据块（如多个 4 比特的输出）结合成一个较大的数据块。在 uBlock 中，经过 S 盒处理的数据通常需要进行进一步的变换，如置换或与轮密钥进行 XOR 操作，这时候并置的数据可以直接用于这些操作。</p>\n<p><strong>2.2.2 半字节（Nibble）</strong><br />\n半字节通常指的是 4 比特的数据块。在一个字节（通常为 8 比特）中包含两个半字节。在许多加密算法中，尤其是在对数据执行 S 盒变换时，常常以半字节为单位来处理数据。使用半字节是因为它允许在较小的数据单位上进行高效的非线性变换，这在很多加密标准（如 AES 的前身 DES）中是一种常见的做法。</p>\n<h5 id=\"223-向量置换permutation-of-vectors\"><a class=\"anchor\" href=\"#223-向量置换permutation-of-vectors\">#</a> <strong>2.2.3 向量置换（Permutation of Vectors）</strong></h5>\n<p>向量置换涉及对一个数据向量（可以理解为一系列数据元素的数组）进行重新排序或置换。在密码学中，这种操作用于打乱数据元素的顺序，增加密码算法的扩散性质。扩散是指输入的一个小变化（比如改变一个比特）会影响输出中多个或大部分比特的属性，从而提高了算法的安全性。</p>\n<p>向量置换的具体实例包括 PL 和 PR 操作：这些是特定的置换操作，它们以某种特定的顺序重新排列输入向量的元素。这些置换规则通常事先定义好，并用于算法的各个阶段来增加复杂性和安全性。</p>\n<h5 id=\"224轮密钥round-key\"><a class=\"anchor\" href=\"#224轮密钥round-key\">#</a> <strong>2.2.4 轮密钥（Round Key）</strong></h5>\n<p>在循环结构的密码算法中（如 AES 或 uBlock），轮密钥是密钥扩展过程生成的一系列密钥，每一轮加密使用一种不同的轮密钥。使用不同的轮密钥是为了防止某些攻击技术，比如差分攻击和线性攻击，它们可能在多轮中利用相同密钥的重复使用来推导出密钥信息。</p>\n<h2 id=\"3ublock分组密码及两种工作模式的来历\"><a class=\"anchor\" href=\"#3ublock分组密码及两种工作模式的来历\">#</a> <strong>3.uBlock 分组密码及两种工作模式的来历</strong></h2>\n<h4 id=\"31-ublock算法来历\"><a class=\"anchor\" href=\"#31-ublock算法来历\">#</a> <strong>3.1 uBlock 算法来历</strong></h4>\n<p>中国全国密码算法设计竞赛是一个旨在推动密码学领域技术进步的活动。为贯彻落实习近平网络强国战略思想和党的十九大精神，繁荣我国密码理论和应用研究，推动密码算法设计和实现技术进步，促进密码人才成长，学会决定举办全国密码算法设计竞赛。在 2019 年 10 月 25 日，中国密码学会发出了全国密码算法设计竞赛通知。在这个竞赛中，密码学家们提交自己设计的密码算法，经过评审和测试，优秀的算法将进入下一轮评选。</p>\n<p>该分组密码算法的设计和提交必须符合一系列详尽的技术标准，以确保算法的安全性、高效性及实用性。首先，算法需提供完整的描述，包括所有必要的数学公式、图表和参数，并附上充分的测试实例来验证算法的正确性。设计原理部分应详细阐述算法的构思、主要策略及关键设计决策。安全性分析要详细评估算法对抗各种已知攻击的能力，包括理论上的安全证明及特殊密钥条件的分析。性能分析需考虑算法在不同的软硬件环境下的运行效率和资源消耗。此外，还必须清楚地声明算法的优点和可能的不足，包括创新性和在各种平台上的表现。算法还需要提供标准的 ANSI C 编程接口，确保其实现的标准化和可移植性。最后，参赛者必须提交一套完整的材料，包括算法描述、代码实现、支持文档及原创性声明，所有提交材料需用中文撰写，以满足比赛的形式规范。这些严格的要求确保了提交的分组密码算法既安全可靠，又具备实际应用的可行性和效率。</p>\n<p>而 uBlock 分组密码算法是本次密码算法设计竞赛的获奖作品，由来自中国科学院软件研究所的吴文玲、张 蕾、郑雅菲、李灵琛共同设计而来。</p>\n<h4 id=\"32-ecb分组密码模式来历\"><a class=\"anchor\" href=\"#32-ecb分组密码模式来历\">#</a> <strong>3.2 ECB 分组密码模式来历</strong></h4>\n<p>ECB（电子密码本模式，Electronic Codebook Mode）是一种基础的加密算法模式，其设计背景和迭代过程可以追溯到早期的计算机安全需求。</p>\n<h5 id=\"321-ecb的设计背景\"><a class=\"anchor\" href=\"#321-ecb的设计背景\">#</a> <strong>3.2.1 ECB 的设计背景</strong></h5>\n<p>在早期计算机网络和系统中，数据安全开始受到关注，特别是在商业和政府通信中。随着信息技术的发展，保护数据免受未经授权的访问变得尤为重要。在此背景下，ECB 模式作为一种基本的加密模式应运而生，其主要目的是提供一种简单直接的方法来加密固定大小的数据块。</p>\n<h5 id=\"322-ecb的来历\"><a class=\"anchor\" href=\"#322-ecb的来历\">#</a> <strong>3.2.2 ECB 的来历</strong></h5>\n<p>ECB 模式的核心概念非常简单：将明文分割成多个等长的块，每个块独立加密。这种模式的一个关键特点是它不涉及复杂的初始化向量（IV）或状态维护，这使得实现起来相对简单直接。ECB 模式可以使用任何固定长度的块密码来加密数据，如 DES（数据加密标准）或后来的 AES（高级加密标准）。</p>\n<h5 id=\"323-ecb的迭代过程\"><a class=\"anchor\" href=\"#323-ecb的迭代过程\">#</a> <strong>3.2.3 ECB 的迭代过程</strong></h5>\n<p>ECB 模式的设计没有经历复杂的迭代过程，因为它本质上是最简单的块密码加密模式。然而，随着对加密技术的理解加深，安全社区逐渐认识到 ECB 模式在安全性方面的局限性，尤其是其在处理大量数据时容易泄露模式信息的问题。因此，出现了更为复杂的加密模式，如 CBC（密码块链接模式）、CFB（密码反馈模式）和 OFB（输出反馈模式），这些模式通过引入 IV 和更复杂的运算过程来增强安全性，从而克服了 ECB 的一些安全缺陷。</p>\n<h5 id=\"324-ecb的安全性讨论\"><a class=\"anchor\" href=\"#324-ecb的安全性讨论\">#</a> <strong>3.2.4 ECB 的安全性讨论</strong></h5>\n<p>尽管 ECB 因其实现简单而在某些应用中仍然被使用，但它通常不推荐用于需要高安全性的场景。因为 ECB 模式对于相同的明文块总是生成相同的密文块，这使得它对于某些类型的数据（尤其是那些包含重复模式的数据）来说，可能会暴露出明显的模式，从而容易被攻击者利用。</p>\n<p><strong>3.3 CBC 模式分析</strong><br />\n CBC（Cipher Block Chaining）模式是一种广泛使用的块加密操作模式，它通过链式反馈机制增加了加密过程的复杂性和安全性。以下是 CBC 模式的详细介绍，包括设计背景、来历、迭代过程和安全性讨论。</p>\n<h5 id=\"331-cbc模式的设计背景\"><a class=\"anchor\" href=\"#331-cbc模式的设计背景\">#</a> <strong>3.3.1 CBC 模式的设计背景</strong></h5>\n<p>CBC 模式在 1970 年代被 IBM 开发，目的是为了克服电子密码本（ECB）模式的一些显著安全缺陷。在 ECB 模式中，相同的明文块加密后会产生相同的密文块，这使得模式信息可能被泄露。这种特性特别不适用于加密大量数据或具有重复数据块的文件。因此，需要一种更安全的模式来提供更好的数据保密性，尤其是在数据块之间存在高度关联时。</p>\n<h5 id=\"332-cbc模式的来历\"><a class=\"anchor\" href=\"#332-cbc模式的来历\">#</a> <strong>3.3.2 CBC 模式的来历</strong></h5>\n<p>CBC 模式的设计利用了前一个块的密文来影响当前块的加密过程。这种设计首次在 IBM 的 Lucifer 加密算法中被提出并应用，后来这一概念被采纳并广泛应用于多种加密标准中，包括现代加密算法如 AES 和 DES。</p>\n<h5 id=\"333-cbc模式的迭代构成\"><a class=\"anchor\" href=\"#333-cbc模式的迭代构成\">#</a> <strong>3.3.3 CBC 模式的迭代构成</strong></h5>\n<p>CBC 模式的加密过程包括以下几个步骤：</p>\n<p>初始化向量（IV）：加密的第一个数据块需要一个初始化向量，这个向量通常是随机生成的，与明文一起发送，但不需要保密。</p>\n<p>链式反馈：每个明文块在加密之前，首先与前一个密文块进行 XOR 运算。对于第一个明文块，它与 IV 进行 XOR。</p>\n<p>块加密：XOR 运算后的结果使用加密算法和密钥进行加密。</p>\n<p>生成密文块：加密的输出形成当前的密文块，然后这个密文块被用于下一个块的加密过程。</p>\n<p>解密过程则是加密过程的逆操作：</p>\n<p>块解密：使用相同的密钥对密文块进行解密。</p>\n<p>XOR 运算：将解密后的输出与前一个密文块进行 XOR 运算，以恢复原始明文。对于第一个块，使用 IV 进行 XOR 运算。</p>\n<p>恢复明文块：输出最终的明文块。</p>\n<h5 id=\"334-cbc模式的安全性讨论\"><a class=\"anchor\" href=\"#334-cbc模式的安全性讨论\">#</a> <strong>3.3.4 CBC 模式的安全性讨论</strong></h5>\n<p>CBC 模式提供了比 ECB 更高的安全性，主要是因为它通过引入链式依赖机制抵消了明文中的模式。即便明文块完全相同，由于每个块与前一个块的密文相关联，因此相同的明文块不会生成相同的密文块。这种属性使得 CBC 模式对于模式分析和重放攻击具有很强的抵抗力。</p>\n<p>然而，CBC 模式并非完美无缺。例如，它容易受到填充攻击（如 Padding Oracle 攻击），因为加密过程依赖于块的完整性和正确的填充。此外，CBC 模式不提供身份验证，所以它可能受到篡改攻击，除非与消息认证码（MAC）或其他认证机制一起使用。</p>\n<p>总的来说，CBC 模式是一个在多个领域得到广泛应用的块加密模式，它提供了比 ECB 模式更高的安全保障，但需要正确实施和可能的安全增强来保护数据安全。</p>\n<h2 id=\"4-ublock加密算法的总体框架与数据结构\"><a class=\"anchor\" href=\"#4-ublock加密算法的总体框架与数据结构\">#</a> 4. <strong>uBlock 加密算法的总体框架与数据结构</strong></h2>\n<h4 id=\"41-ublock算法的总体框架\"><a class=\"anchor\" href=\"#41-ublock算法的总体框架\">#</a> 4.1 <strong>uBlock 算法的总体框架</strong></h4>\n<p>uBlock 一共包含 3 个版本，分组长度为 128 或 256 比特，密钥长度为 128 或者 256 比特，记为 uBlock-128/128 (明密文块 / 密钥)、uBlock-128/256、uBlock-256/256。三者的加解密基本一致，区别在于三个版本的迭代轮数 r 分别为 16,24,24。并且在轮密钥生成的时候，所用的向量置换分别为 16 字节的<strong> PK****1</strong>、32 字节的<strong> PK****2</strong>、32 字节的<strong> PK****3</strong>。<br />\n<strong>4.1.1 uBlock 加密算法</strong><br />\n下图是 uBlock 的加密伪代码与流程图示：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps16.jpg)![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps17.jpg)</p>\n<p>图 1（左）uBlock 的加密伪代码</p>\n<p>图 2（右）uBlock 加密轮变换流程图</p>\n<p>其中，我们可以由图示描述该加密算法即先把 n 比特明文 X 拆分成两个 n/2 比特的 X0 和 X1。根据明文 - 比特的关系选择合适的 r，并且在 0~r-1 范围内做 r 次加密其中每次加密:</p>\n<p>\\1. 先将 n 比特轮密钥 RKi 拆分成两个并置的密钥 RK0i 和 RK1i</p>\n<p>\\2. 调用一个 n/8 个 S 盒的并置 Sn。首先将 X0 异或 RK0i 后在 Sn 里查表得到新的 X0，然后将 X1 异或 RK1i 后在 Sn 里查表得到新的 X1</p>\n<p>\\3. X0 和 X1 异或后得到新的 X1。</p>\n<p>\\4. 将 32 位分块 X1 循环左移 4 比特后与 X0 异或得到新的 X0</p>\n<p>\\5. 将 32 位分块 X0 循环左移 8 比特后与 X1 异或得到新的 X1</p>\n<p>\\6. 将 32 位分块 X1 循环左移 8 比特后与 X0 异或得到新的 X0</p>\n<p>\\7. 将 32 位分块 X0 循环左移 20 比特后与 X1 异或得到新的 X1</p>\n<p>\\8. 将最终得到的 X0 和 X1 异或得到 X0</p>\n<p>\\9. 将 X0 在 n/16 向量置换 PLn (X0) 中进行置换</p>\n<p>\\10. 将 X1 在 n/16 向量置换 PRn (X1) 中进行置换<br />\n最终的密文 Y 即为第 r 轮密钥 RKr 与最终得到的 X0 和 X1 的并置进行异或。</p>\n<p>表 2  S 盒<br />\n！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps18.jpg)</p>\n<p>表 3 PLn 和 PRn</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps19.jpg)</p>\n<h5 id=\"412-ublock-解密算法\"><a class=\"anchor\" href=\"#412-ublock-解密算法\">#</a> <strong>4.1.2 uBlock 解密算法</strong></h5>\n<p>下图为 uBlock 的解密过程，即加密函数的逆变换，其中的 Sn-1、PLn-1、PRn-1 分别是 Sn、PLn 和 PRn 的逆，具体见表 3 和表 4.<br />\n![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps20.jpg)</p>\n<p>图 3 uBlock 解密算法伪代码</p>\n<p>表 4 s-1 盒</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps21.jpg)</p>\n<p>表 5 PLn-1 和 PRn-1<br />\n![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps22.jpg)</p>\n<h5 id=\"413-ublock密钥扩展算法\"><a class=\"anchor\" href=\"#413-ublock密钥扩展算法\">#</a> <strong>4.1.3 uBlock 密钥扩展算法</strong></h5>\n<p>将 k 比特密钥 K 放置在 k 比特寄存器，取寄存器的左 n 比特作为轮密钥 RK0 ，然后，对 1, 2,..., i r = ，更新寄存器，并取寄存器的左 n 比特作为轮密钥 RKi。具体更新方式如下：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps23.jpg)![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps24.jpg)</p>\n<p>图 4（左） 密钥扩展算法伪代码</p>\n<p>图 5（右） 密钥拓展算法流程图</p>\n<p>其中 Sk 是 k/16 个 4 比特 s 盒的并置，Tk 是对 K1 的每半字节⊗2，有限域 GF (24) 的不可约多项式 m (x)= x4+ x + 1:RCi 为 32 比特常数，作用在 K0 的左 32 比特。PKt 有三种情况，t =1, 2,3，PK1、PK2 和 PK3 分别用于 uBlock-128/128、uBlock-128/256 和 uBlock-256/256 的密钥扩展算法。PK1 是 16 个半字节的向量置换，PK2 和 PK3 都是 32 个半字节的向量置换，具体见下表。</p>\n<p>表 6 PKi 表</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps25.jpg)<br />\n 32 比特常数 RCi 生成具体是由 8 级 LFSR，初始条件为 c0=c3=c6=c7=0,c1=c2=c4=c5=1; 对于 i≥8，ci=ci-2⊕ci-3⊕ci-7⊕ci-8。令<br />\n！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps26.png)    ![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps27.png)        \t![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps28.png)   ![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps29.png)<br />\n 则 RCi=![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps30.png)</p>\n<p>常数 RCi（i=1,2.......24）的 16 进制如下表：</p>\n<p>表 7  RCi 表<br />\n！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps31.jpg)</p>\n<h4 id=\"42-ublock算法的数据结构\"><a class=\"anchor\" href=\"#42-ublock算法的数据结构\">#</a> 4.2 <strong>uBlock 算法的数据结构</strong></h4>\n<h5 id=\"421-s盒-substitution-boxes\"><a class=\"anchor\" href=\"#421-s盒-substitution-boxes\">#</a> 4.2.1 <strong>S 盒 (Substitution boxes)</strong></h5>\n<p>S 盒用于执行非线性变换，是密码算法中用于提高安全性的重要组件。它通过将输入的固定大小比特块映射到输出的操作来抵抗线性和差分密码分析。</p>\n<p>在 uBlock 中，S 盒是 4 比特的，即每个 S 盒将 4 比特的输入映射到 4 比特的输出。由于 uBlock 处理 128 比特或 256 比特的数据块，因此需要多个这样的 S 盒并置使用，以覆盖整个数据块。</p>\n<h5 id=\"422-向量置换-vector-permutations\"><a class=\"anchor\" href=\"#422-向量置换-vector-permutations\">#</a> 4.2.2 <strong>向量置换 (Vector Permutations)</strong></h5>\n<p>向量置换用于重新排列加密数据的比特，增强密码的扩散性。这种扩散确保了输入的微小变化可以影响到输出的多个比特，从而增加破解难度。</p>\n<p>uBlock 算法使用两种主要的向量置换，分别称为 PL 和 PR。这些置换是预定义的，并根据不同的加密需求（如 128 比特或 256 比特）进行调整。</p>\n<h5 id=\"423-轮密钥-round-keys\"><a class=\"anchor\" href=\"#423-轮密钥-round-keys\">#</a> 4.2.3 <strong>轮密钥 (Round Keys)</strong></h5>\n<p>轮密钥用于各加密轮中与数据进行 XOR 运算，是提供加密强度的关键。不同的轮使用不同的轮密钥，以防止重复使用相同密钥带来的安全风险。</p>\n<p>轮密钥通过密钥扩展算法从主密钥生成。在 uBlock 中，密钥扩展包括使用 S 盒、固定的置换模式（PK1, PK2, PK3）和轮常数，为每一轮生成唯一的轮密钥。</p>\n<h5 id=\"424-密钥扩展算法-key-schedule\"><a class=\"anchor\" href=\"#424-密钥扩展算法-key-schedule\">#</a> 4.2.4 <strong>密钥扩展算法 (Key Schedule)</strong></h5>\n<p>密钥扩展算法用于生成足够数量的轮密钥，支持加密过程中每一轮的需要。</p>\n<p>这一算法涉及到对原始密钥的多次变换，包括应用 S 盒、向量置换和与轮常数的 XOR 运算。这些操作增加了密钥的不可预测性和算法的整体安全性。</p>\n<h5 id=\"425-数据块的处理\"><a class=\"anchor\" href=\"#425-数据块的处理\">#</a> 4.2.5 <strong>数据块的处理</strong></h5>\n<p>在 uBlock 算法中，明文数据块根据算法版本（128 比特或 256 比特）被处理。每次加密操作对数据块进行分割、替换、置换和合并。</p>\n<p>数据在加密过程中经历多个阶段的处理，包括并置、分割和轮内操作，这些操作通过特定的加密逻辑紧密结合。</p>\n<p>这些组件共同构成了 uBlock 算法的核心，通过精心设计的数据处理步骤和算法结构，uBlock 能够有效地在保护信息安全的同时，维持处理效率。这种设计不仅使其在理论上安全，而且在实际应用中也表现出高效的执行能力，适应于各种硬件和软件环境。</p>\n<h2 id=\"5-ublock的算法实现\"><a class=\"anchor\" href=\"#5-ublock的算法实现\">#</a> 5. <strong>uBlock 的算法实现</strong></h2>\n<h4 id=\"51-基础代码设计\"><a class=\"anchor\" href=\"#51-基础代码设计\">#</a> <strong>5.1 基础代码设计</strong></h4>\n<p>通过综合考虑通用性和常用性，我们在这主要介绍 uBlock128/128 版本的加密算法代码实现。首先我根据设计文档和已给代码来编写出<strong> uBlock_Windows_128_128.cpp</strong> 文件，代码附于附件<br />\n主要函数包括：<br />\n（1）密钥调度（uBlock_128_KeySchedule 函数）：此函数接收一个密钥并生成多个轮次密钥，存储在 Subkey 数组中。它利用了 SIMD 指令来并行处理多个操作，提高了密钥生成的效率。</p>\n<p>（2）加密函数（uBlock_128_Encrypt）：此函数实现了加密过程，使用预先生成的轮次密钥对输入的明文进行加密，产生密文。加密过程包括多个轮次，每个轮次都使用不同的密钥和数据转换，例如置换和替代。</p>\n<p>（3）解密函数（uBlock_128_Decrypt）：与加密函数类似，但按相反顺序应用轮次密钥和转换，以从密文恢复明文</p>\n<p>（4）CBC 模式实现（Crypt_Enc_Block_CBC 和 Crypt_Dec_Block_CBC 函数）：这些函数实现了密码块链接（CBC）模式的加密和解密。在 CBC 模式中，每个块的加密依赖于前一个块的加密输出，提高了加密过程的安全性。</p>\n<p>（5）ECB 模式实现（Crypt_Enc_Block_ECB 和 Crypt_Dec_Block_ECB 函数）：这些函数实现了密码块链接（ECB）模式的加密和解密。</p>\n<p>首先我们给出在 vscode 上将<strong> uBlock_Windows_128_128.cpp</strong> 编译成 exe 的代码为 “<strong>g++ &quot;-msse4.1&quot; -o main uBlock_Windows_128_128.cpp</strong>”。<br />\n接下来我仅附 ECB 和 CBC 加解密代码，其余代码请参考附件：</p>\n<ol>\n<li>int Crypt_Enc_Block_CBC(unsigned char *input, int in_len, unsigned char *output, int <em>out_len, unsigned char <em>key, int keylen)2. <ruby>3. int g, j;4. unsigned char iv[16] = {0};5. uBlock_128_KeySchedule(key);6. for (g = 0; g &lt; in_len / 16; g++)7. {8.  for(j = 0; j &lt; 16; j++)9.  {10.  iv[j] <rp>(</rp><rt> input[g * 16 + j];11.  </rt><rp>)</rp></ruby>12.  uBlock_128_Encrypt(iv, output+g</em>16, 16);13.  memcpy(iv, output+g</em>16, 16);14. }15. *out_len = in_len - in_len % 16;16. 17. return 0;18. }19. 20. int Crypt_Dec_Block_CBC(unsigned char *input,int in_len, unsigned char *output,int *out_len, unsigned char <em>key, int keylen)21. <ruby>22. int g, j;23. unsigned char iv[16] = {0};24. 25. uBlock_128_KeySchedule(key);26. 27. for (g = 0; g &lt; in_len / 16; g++)28. {29.  uBlock_128_Decrypt(input+g*16, output+g*16, 16);30.  for(j = 0; j &lt; 16; j++)31.  {32.  output[g * 16 + j] <rp>(</rp><rt> iv[j];33.  </rt><rp>)</rp></ruby>34.  memcpy(iv, input+g</em>16, 16);35. }36. *out_len = in_len - in_len % 16;37. return 0;38. }39. int Crypt_Enc_Block_ECB(unsigned char *input, int in_len, unsigned char *output, int *out_len, unsigned char *key, int keylen)40. {41.   int g;42.   43.   uBlock_128_KeySchedule(key);44.   45.   for (g = 0; g &lt; in_len / 16; g++)46.   {47.     uBlock_128_Encrypt(input + g * 16, output + g * 16, 16); 48.   }49.   *out_len = in_len - in_len % 16;50.   return 0;51. }52. int Crypt_Dec_Block_ECB(unsigned char *input, int in_len, unsigned char *output, int *out_len, unsigned char *key, int keylen)53. {54.   int g;  55.   uBlock_128_KeySchedule(key);56.   for (g = 0; g &lt; in_len / 16; g++)57.   {58.     uBlock_128_Decrypt(input + g * 16, output + g * 16, 16); 59.   }60.   *out_len = in_len - in_len % 16;61.   return 0;62. }</li>\n</ol>\n<p>我的算法流程图如下：<br />\n![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps32.jpg)</p>\n<p>图 6 代码流程图（AI 识别代码生成）</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps33.jpg)</p>\n<p>图 7 uBlock 代码设计流程图</p>\n<h5 id=\"52-评估正确性\"><a class=\"anchor\" href=\"#52-评估正确性\">#</a> <strong>5.2 评估正确性</strong></h5>\n<p>依据官方文档中的测试函数，以：<br />\n明文：01 23 45 67 89 ab cd effe dc ba 98 76 54 32 10</p>\n<p>密钥：01 23 45 67 89 ab cd effe dc ba 98 76 54 32 10</p>\n<p>加密 1 次时，输出的密文应该是 32 12 2b ed d0 23 c4 29 02 34 70 e1 15 8c 14 7d</p>\n<p>加密 1000000 时，输出的密文应该是 9d 63 9e 31 06 2f fb 57 46 46 e4 28 f9 2e 08 d4</p>\n<p>根据我们的代码生成结果，如下图（中间部分为其他测试结果）：<br />\n![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps34.jpg)</p>\n<p>图 8 uBlock 代码输出结果</p>\n<p>如上图我们可以知道，代码的正确性良好。与官方文档符合。</p>\n<p>根据后续输出，我们可以发现代码生成的轮密钥也与官方文档一致，代码可行度高。</p>\n<h5 id=\"53-评估吞吐量和速度\"><a class=\"anchor\" href=\"#53-评估吞吐量和速度\">#</a> <strong>5.3 评估吞吐量和速度</strong></h5>\n<p>我的电脑使用的是 NVIDIA GeForce RTX 3070 Ti Laptop GPU、处理器\t12th Gen Intel (R) Core (TM) i9-12900H，2500 Mhz，14 个内核，20 个逻辑处理器、BIOS 版本 / 日期 American Megatrends International, LLC. G533ZW.324, 2023/2/21。其中我的 Python 解释器是 Python3.11，编译器是 pycharm2023.7 专业版。而我的 cpp 运行软件为 vscode。<br />\n这里我以将信息反复加密 1000000 次的时间作为标准。以其运行的时间作为评价的指标。当我们明文和密文均为 01 23 45 67 89 ab cd effe dc ba 98 76 54 32 10 时，多次运算测试代码取平均值可以得到：<br />\nuBlock 128-128 的运算时间为 1.162s![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps35.jpg)</p>\n<p>uBlock 128-256 的运算时间为 1.381s![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps36.jpg)</p>\n<p>uBlock 256-256 的运算时间为 1.605s![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps37.jpg)</p>\n<p>而在 Python 上运行的传统 AES 代码的运行时间为 29.93s![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps38.jpg)</p>\n<p>其中不排除 C++ 运行效率比 Python 高效等因素。但是总体来说，uBlock 在无论是吞吐量还是运行速度方向都表现出较高的效率和运算速度。相比于传统 AES 加密算法显得更加高效的同时准确率也表现得很优异。</p>\n<h2 id=\"6-以ublock的ecb和cbc模式加密朱鹮bmp文件\"><a class=\"anchor\" href=\"#6-以ublock的ecb和cbc模式加密朱鹮bmp文件\">#</a> <strong>6 以 uBlock 的 ECB 和 CBC 模式加密朱鹮.bmp 文件</strong></h2>\n<h4 id=\"61-bmp文件格式解析\"><a class=\"anchor\" href=\"#61-bmp文件格式解析\">#</a> <strong>6.1 BMP 文件格式解析</strong></h4>\n<p>BMP 文件格式，全称为 Bitmap Image File Format，是一种图像文件格式，广泛用于 Windows 操作系统中存储位图图像。这种格式简单、直观，支持多种色深，并可以无损地存储图像数据。BMP 文件主要由三部分组成：</p>\n<p><em><strong>*(1)*</strong></em><em><strong>* 文件头 *</strong></em>（Bitmap File Header）：<br />\n包含文件类型、文件大小和数据偏移等信息。</p>\n<p>bfType（2 字节）：文件类型，必须是 'BM'，用以标识文件为 BMP 格式。</p>\n<p>bfSize（4 字节）：整个文件的大小，包括文件头、信息头和位图数据。</p>\n<p>bfReserved1 和 bfReserved2（各 2 字节）：保留位，对齐用，通常为 0。</p>\n<p>bfOffBits（4 字节）：从文件开始到位图数据的偏移量。</p>\n<p><em><strong>*(2)*</strong></em><em><strong>* 信头 *</strong></em>（DIB Header，即 Device Independent Bitmap Header）：BMP 文件的信息头有几种不同的版本，最常见的包括 BITMAPINFOHEADER 和 BITMAPV5HEADER 等。以 BITMAPINFOHEADER 为例，其结构如下：</p>\n<p>提供图像宽度、高度、色深、压缩类型等详细信息。</p>\n<p>biSize（4 字节）：此结构体的大小。</p>\n<p>biWidth（4 字节）：图像的宽度（像素）。</p>\n<p>biHeight（4 字节）：图像的高度（像素）。如果为正，位图是倒向的；如果为负，位图是正向的。biPlanes（2 字节）：目标设备的级别，必须为 1。</p>\n<p>biBitCount（2 字节）：每个像素所需的位数，常见的有 1、4、8、16、24 和 32。</p>\n<p>biCompression（4 字节）：位图的压缩类型。</p>\n<p>biSizeImage（4 字节）：位图数据的大小，即像素数据部分的大小。</p>\n<p>biXPelsPerMeter, biYPelsPerMeter（各 4 字节）：水平和垂直分辨率（每米像素数）。</p>\n<p>biClrUsed（4 字节）：位图实际使用的颜色表中的颜色索引数（0 表示使用所有的颜色）。</p>\n<p>biClrImportant（4 字节）：重要颜色数，0 表示所有颜色都是重要的。</p>\n<p><em><strong>*(3)*</strong></em><em><strong>* 位图数据 *</strong></em>（Bitmap Data）：<br />\n实际的图像像素数据 —— 位图数据部分存储实际的图像像素值。这部分的存储格式依赖于 biBitCount 的值。数据可能需要根据行来进行填充，以确保每行的字节数是 4 的倍数（DWORD 对齐）。</p>\n<h4 id=\"62-bmp文件加密技巧\"><a class=\"anchor\" href=\"#62-bmp文件加密技巧\">#</a> <strong>6.2 bmp 文件加密技巧</strong></h4>\n<p>当使用 uBlock 或任何其他块加密算法对 BMP 文件进行加密时，主要关注的是位图数据部分。文件头和信息头通常不进行加密，以便保持文件格式的完整性，使图像文件仍然能被图像查看器识别。以下是一些注意事项和技巧：</p>\n<p>保持文件头和信息头不变：加密时应跳过这部分，直接从位图数据开始加密，这样不会破坏文件的结构 —— 在代码中体现为对 BMP 的前 54 个字节（文件头）不进行加密，以保证图片格式可以清晰显示</p>\n<p>处理数据填充：由于加密算法通常要求数据块大小固定，而 BMP 行可能不会恰好符合这种分块，所以加密前需要对数据进行适当的填充</p>\n<p>选择加密模式：使用 ECB 模式可能会导致图像中的模式被重复，使得加密不够安全。CBC 模式是一个更好的选择，因为它使用初始化向量（IV）来增加加密强度 —— 但是由于老师要求，这里使用 ECB 和 CBC 两种模式来进行加密。</p>\n<h4 id=\"63-ecb和cbc模式加解密结果\"><a class=\"anchor\" href=\"#63-ecb和cbc模式加解密结果\">#</a> <strong>6.3 ECB 和 CBC 模式加解密结果</strong></h4>\n<h5 id=\"631-ecb模式进行加解密\"><a class=\"anchor\" href=\"#631-ecb模式进行加解密\">#</a> <strong>6.3.1 ECB 模式进行加解密</strong></h5>\n<p>在附件中通过 vscode 启动 uBlock_bmp (加密代码)——ECB 加密 .cpp 代码，该代码以 {0x01, 0x23, 0x45, 0x67, 0x89, 0xAB, 0xCD, 0xEF, 0xFE, 0xDC, 0xBA, 0x98, 0x76, 0x54, 0x32, 0x10}; 为密钥，循环读入朱鹮.bmp 进行加解密。加密朱鹮.bmp 产生朱鹮_ECB.bmp。读入朱鹮_ECB.bmp 解密后产生朱鹮_ECB_dec.bmp。具体的加密算法请见附件。加密结果如下图:</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps39.jpg)![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps40.jpg)</p>\n<p>图 9（左）朱鹮_ECB.bmp</p>\n<p>图 10（右）朱鹮_ECB_dec.bmp</p>\n<h5 id=\"632-cbc模式进行加解密\"><a class=\"anchor\" href=\"#632-cbc模式进行加解密\">#</a> <strong>6.3.2 CBC 模式进行加解密</strong></h5>\n<p>在附件中通过 vscode 启动 uBlock_bmp (加密代码)——CBC 加密.cpp 代码，该代码以 {0x01, 0x23, 0x45, 0x67, 0x89, 0xAB, 0xCD, 0xEF, 0xFE, 0xDC, 0xBA, 0x98, 0x76, 0x54, 0x32, 0x10}; 为密钥，循环读入朱鹮.bmp 进行加解密。加密朱鹮.bmp 产生朱鹮_CBC.bmp。读入朱鹮_CBC.bmp 解密后产生朱鹮_CBC_dec.bmp。具体的加密算法请见附件。加密结果如下图：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps41.jpg)![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps42.jpg)</p>\n<p>图 11（左）朱鹮_CBC.bmp</p>\n<p>图 12（右）朱鹮_CBC_dec.bmp</p>\n<h5 id=\"633-ecb和cbc模式的分析与对比\"><a class=\"anchor\" href=\"#633-ecb和cbc模式的分析与对比\">#</a> <strong>6.3.3 ECB 和 CBC 模式的分析与对比</strong></h5>\n<p><em><strong>* 安全性：*</strong></em></p>\n<p>CBC 模式通常比 ECB 模式更安全，因为它避免了明文中的模式在密文中的重复 ——CBC 模式加密前，每个数据块都会与前一个密文块进行异或。第一块数据与一个初始向量（IV）进行异或。这种方法使得相同的明文块加密后的结果因其位置不同而不同，提高了安全性。同样的明文在不同的位置或在不同的文件中，即使使用相同的密钥，加密结果也会不同。</p>\n<p>而 ECB 模式将数据分割成块，每块数据独立加密。缺点是同一块明文在同一密钥下总是被加密成同样的密文块。这意味着模式可能会暴露明文的模式，特别是当处理大量具有重复模式的数据时（例如图片或某些类型的文档）。在图像加密（如本次的 bmp）中尤其明显，因为图像中经常包含大片相同颜色的区域。</p>\n<p><em><strong>* 性能：*</strong></em></p>\n<p>ECB 模式可以并行处理，因为每个数据块独立加密，提高了加密过程的速度。而 CBC 模式不能并行处理，因为每个块的加密依赖于前一个块的密文。这可能会在处理大量数据时导致性能下降。解密可以并行化，因为解密过程中，每个块的解密只依赖于它前面的一个块的密文。</p>\n<h2 id=\"7-总结\"><a class=\"anchor\" href=\"#7-总结\">#</a> <strong>7 总结</strong></h2>\n<p>在这篇论文中，我对 uBlock 和 ECB 两种加密算法进行了深入的研究与比较。通过细致的分析，我发现 uBlock 算法具有复杂的密钥扩展和多轮加密机制，这些设计显著增强了其加密强度和安全性，使其特别适用于对数据安全要求极高的场景。相比之下，ECB 模式因其简单的结构，在处理具有重复模式的大量数据时表现出安全性的不足，尤其在需要高安全性的应用中可能导致数据泄露风险。</p>\n<p>我还特别关注了这两种算法在不同硬件和软件环境中的性能表现。研究结果显示，uBlock 在现代处理器上具有出色的运行效率和较低的资源消耗，这使得它非常适合在需要快速数据处理和高吞吐量的系统中使用。此外，我也评估了 ECB 模式的实现简便性，这一特点使其在某些不需要高安全性的内部或封闭系统中仍具有应用价值。</p>\n<p>通过本研究，我进一步理解了在算法设计中安全性和效率的重要性以及如何在实际应用中做出适当的权衡。论文的这部分研究不仅增强了我对加密算法性能和安全性的认识，也为将来选择和设计加密方案提供了实用的指导。</p>\n<p>最后，展望未来，我认为加密算法的发展需要持续关注安全性的提升和性能的优化。随着计算资源的发展和安全威胁的演变，持续更新和改进加密技术将是确保信息安全的关键。因此，我期待在未来的工作中，进一步探索和实验新的加密技术，以应对更为复杂和多变的安全环境。这篇论文为我在密码学领域的研究提供了坚实的基础，并激励我继续在这一领域深入探索与创新。</p>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        },
        {
            "id": "https://enjundu.github.io/ctf/nscweb%E6%8E%88%E8%AF%BE/",
            "url": "https://enjundu.github.io/ctf/nscweb%E6%8E%88%E8%AF%BE/",
            "title": "NSC暑期培训——web",
            "date_published": "2024-07-07T01:41:31.000Z",
            "content_html": "<h1 id=\"攻防世界账号注册\"><a class=\"anchor\" href=\"#攻防世界账号注册\">#</a> 攻防世界账号注册</h1>\n<p>在<span class=\"exturl\" data-url=\"aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuLw==\">攻防世界</span>官网注册账号。<br />\n网址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuLw==\">https://adworld.xctf.org.cn/</span></p>\n<h1 id=\"vmware安装\"><a class=\"anchor\" href=\"#vmware安装\">#</a> VMware 安装</h1>\n<ol>\n<li>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudm13YXJlLmNvbS9jbi9wcm9kdWN0cy93b3Jrc3RhdGlvbi1wcm8vd29ya3N0YXRpb24tcHJvLWV2YWx1YXRpb24uaHRtbA==\">官网地址</span>:<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudm13YXJlLmNvbS9jbi9wcm9kdWN0cy93b3Jrc3RhdGlvbi1wcm8vd29ya3N0YXRpb24tcHJvLWV2YWx1YXRpb24uaHRtbA==\">https://www.vmware.com/cn/products/workstation-pro/workstation-pro-evaluation.html</span></p>\n</li>\n<li>\n<p>进入官网选择<strong> for windows</strong>.</p>\n</li>\n<li>\n<p>下载完后双击点开，点击下一步</p>\n</li>\n<li>\n<p>遇到安装路径请自定义【不要什么都堆到 C 盘！！】，然后选择增强型键盘驱动程序和将控制台工具添加到系统 PATH</p>\n</li>\n<li>\n<p>根据自身情况适当选择 “启动时检查产品更新” 与 “帮助完善 VMware Workstation Pro” 复选框，然后单击 “下一步”</p>\n</li>\n<li>\n<p>下一步，【建议点击添加到桌面】</p>\n</li>\n<li>\n<p>安装</p>\n</li>\n<li>\n<p>安装完成后输入许可证，VMware 16 的许可证如下<br />\n <code>YF390-0HF8P-M81RQ-2DXQE-M2UT6</code></p>\n<p>若不可用请自行百度可用版本</p>\n</li>\n<li>\n<p>安装完成后即可使用</p>\n</li>\n</ol>\n<h1 id=\"kaliubuntu安装\"><a class=\"anchor\" href=\"#kaliubuntu安装\">#</a> kali&amp;Ubuntu 安装</h1>\n<p>为 <code>我</code> 了 <code>懒</code> 锻 <code>得</code> 炼 <code>写</code> 同学们的自行搜索能力，请自行 csdn 或者百度搜索 Kali 或 Ubuntu 的下载</p>\n<p>确保<strong>至少</strong>成功在 VM 上安装一个！</p>\n<h1 id=\"java安装\"><a class=\"anchor\" href=\"#java安装\">#</a> Java 安装</h1>\n<ol>\n<li>打开点击链接进入下载界面</li>\n</ol>\n<p>​\t\t<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cub3JhY2xlLmNvbS9qYXZhL3RlY2hub2xvZ2llcy9qYXZhc2UvamF2YXNlOHUyMTEtbGF0ZXItYXJjaGl2ZS1kb3dubG9hZHMuaHRtbA==\">网页链接</span></p>\n<p>​\t\t<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cub3JhY2xlLmNvbS9qYXZhL3RlY2hub2xvZ2llcy9qYXZhc2UvamF2YXNlOHUyMTEtbGF0ZXItYXJjaGl2ZS1kb3dubG9hZHMuaHRtbA==\">https://www.oracle.com/java/technologies/javase/javase8u211-later-archive-downloads.html</span></p>\n<ol start=\"2\">\n<li>\n<p>选择制定版本 java jdk 下载</p>\n<ul>\n<li>Java SE Development Kit 8u211</li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb3dubG9hZC5vcmFjbGUuY29tL290bi9qYXZhL2pkay84dTIxMS1iMTIvNDc4YTYyYjdkNGUzNGI3OGI2NzFjNzU0ZWFhZjM4YWIvamRrLTh1MjExLXdpbmRvd3MteDY0LmV4ZQ==\">jdk-8u211-windows-x64.exe</span></li>\n<li>点击下载后注册登录 Oracle 即可下载</li>\n</ul>\n<p><img data-src=\"https://s2.loli.net/2024/07/07/WpQ5CIL8Hw1Olhs.png\" alt=\"image.png\" /></p>\n</li>\n<li>\n<p>点击下载包并且安装网页，记住你的下载地址【默认为 C:\\Program Files\\Java\\jdk1.8.0_211】<br />\n注：一般而言，计算机软件我们都<strong>不推荐在 C 盘安装</strong>。在 C 盘安装会影响计算机的运行。但是<strong> JAVA 特例</strong>，我们通常安在 C 盘，这样<strong>使得 Java 的优先级更高</strong>。无需去其他盘访问。</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/07/OiWJjsR1oPdkgGm.png\" alt=\"image.png\" /></p>\n</li>\n<li>\n<p>安装后就会出现一个<strong> jdk 文件夹和 jar 文件夹</strong></p>\n</li>\n<li>\n<p>jre 是 java runtime environment, 是 java 程序的运行环境。既然是运行，当然要包含 jvm，也就是虚拟机，还有所有 java 类库的 class 文件，都在 lib 目录下打包成了 jar。在 windows 上的虚拟机是 jre/bin/client 里面是一个 jvm.dll。</p>\n</li>\n<li>\n<p>jdk 是 java development kit，是 java 的开发工具包，主要是给 ide 用的，里面包含了各种类库和工具。当然也包括了另外一个 Jre.，而且 jdk/jre/bin 里面也有一个 server 文件夹， server 文件夹下面也有一个 jvm.dll 虚拟机。（这个虚拟机是什么后，面会涉及）</p>\n</li>\n<li>\n<p><strong>环境配置</strong>：Windows 下面搜索框搜索并打开<strong>编辑系统环境变量</strong><br />\n<img data-src=\"https://s2.loli.net/2024/07/07/jtxluQsB1YobrAV.png\" alt=\"image.png\" /></p>\n</li>\n<li>\n<p>用户变量界面新建<br />\n<strong> JAVA_HOME</strong> 变量名 (一定要大写！)</p>\n<p>变量值为<strong> C:\\Program Files\\Java\\jdk1.8.0_211</strong>（替换为你实际的 jdk 地址）</p>\n<p>再次新建：</p>\n<p>变量名：classpath（这次要小写）</p>\n<p>变量值：有点难你直接复制就行</p>\n<p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">,;%JAVA_HOME%\\lib\\dt.jar;%JAVA_HOME%\\lib\\tools.jar;</span><br></pre></td></tr></table></figure></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/07/36vYcZ2eFGgLQJS.png\" alt=\"image.png\" /></p>\n</li>\n<li>\n<p>在系统变量里找到 Path 目录然后点击进去添加 jdk 的 bin 目录（一般是 C:\\Program Files\\Java\\jdk1.8.0_211\\bin）<br />\n<img data-src=\"https://s2.loli.net/2024/07/07/mxUqTHKiAjgCz1y.png\" alt=\"image.png\" /><img data-src=\"https://s2.loli.net/2024/07/07/bP6WM1hAOcd49pt.png\" alt=\"image.png\" /></p>\n</li>\n<li>\n<p>Win+R 弹出运行窗口，输入 cmd 后弹出 DOS 命令窗口</p>\n<p>然后输入<strong> java -version</strong>，如果出现如下信息，说明已经安装完成<br />\n<img data-src=\"https://s2.loli.net/2024/07/07/shXN3tuDwxdrCWc.png\" alt=\"image.png\" /></p>\n</li>\n<li>\n<p>over</p>\n</li>\n<li>\n<p>**What's more:**java 编译器：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9taXJyb3Iua2FrYW8uY29tL2VjbGlwc2UvdGVjaG5vbG9neS9lcHAvZG93bmxvYWRzL3JlbGVhc2UvMjAyNC0wNi9SL2VjbGlwc2UtamVlLTIwMjQtMDYtUi13aW4zMi14ODZfNjQuemlwJUVGJUJDJThDJUU5JTgwJTg5JUU2JThCJUE5JUU2JTgwJUE3JUU0JUI4JThCJUU4JUJEJUJEJUVGJUJDJTg4JUU2JTlDJUFDJUU4JUFGJUJFJUU3JUE4JThCJUU0JUI4JThEJUU3JUExJUFDJUU2JTgwJUE3JUU4JUE2JTgxJUU2JUIxJTgyJUVGJUJDJTg5JUUzJTgwJTgy\">https://mirror.kakao.com/eclipse/technology/epp/downloads/release/2024-06/R/eclipse-jee-2024-06-R-win32-x86_64.zip，选择性下载（本课程不硬性要求）。</span></p>\n</li>\n</ol>\n<h1 id=\"火狐浏览器安装配置hackbar\"><a class=\"anchor\" href=\"#火狐浏览器安装配置hackbar\">#</a> 火狐浏览器安装 &amp; 配置 Hackbar</h1>\n<p>Hackbar 推荐使用火狐浏览器下载拓展，具体方法请 csdn，直接下载 Hackbar V2 即可。（原版 Hackbar 现在需要收费，如果你能通过破解教程成功破解也行。）<br />\n之后的课程中使用的拓展也是火狐浏览器里的 Hackbar V2</p>\n<h1 id=\"暂时不用\"><a class=\"anchor\" href=\"#暂时不用\">#</a> 暂时不用</h1>\n<h2 id=\"chorme浏览器安装\"><a class=\"anchor\" href=\"#chorme浏览器安装\">#</a> Chorme 浏览器安装</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9jaHJvbWUvI2V1bGE=\">最新稳定版（Stable Channel）Chrome 在线安装</span>:<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9jaHJvbWUvI2V1bGE=\">https://www.google.com/chrome/#eula</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9jaHJvbWUvP2V4dHJhPWJldGFjaGFubmVs\">最新测试版（Beta Channel）Chrome 在线安装</span>:<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9jaHJvbWUvP2V4dHJhPWJldGFjaGFubmVs\">https://www.google.com/chrome/?extra=betachannel</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2RsLmdvb2dsZS5jb20vY2hyb21lL2luc3RhbGwvMjY2LjAvY2hyb21lX2luc3RhbGxlci5leGU=\">离线下载地址</span>:<span class=\"exturl\" data-url=\"aHR0cDovL2RsLmdvb2dsZS5jb20vY2hyb21lL2luc3RhbGwvMjY2LjAvY2hyb21lX2luc3RhbGxlci5leGU=\">http://dl.google.com/chrome/install/266.0/chrome_installer.exe</span></p>\n<h2 id=\"hackbar安装\"><a class=\"anchor\" href=\"#hackbar安装\">#</a> Hackbar 安装</h2>\n<ul>\n<li>打开 Chrome 浏览器，然后打开 “<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9jYXRlZ29yeS9leHRlbnNpb25z\">chrome 网上应用店</span>”，在搜索框搜索 “<strong>hackbar</strong>”</li>\n<li>搜索完成后，选择 hackbar 插件，点击 “<strong>添加至 Chrome</strong>”，会弹出框询问 “<strong>要添加‘HackBar’吗？</strong>”，点击 “<strong>添加扩展程序</strong>”</li>\n<li>等待几秒钟后，添加完成，浏览器右上角会出现一个黑色的小图标，表示 HackBar 已添加成功！</li>\n<li>随便找一个可注入网站，比如 https://www.xuetangx.com/，进入后按 F12，如果出现 Harckbar 选项，说明安装完成</li>\n</ul>\n<p><img data-src=\"https://s2.loli.net/2024/07/08/aT2BLS6xV1dWmRE.png\" alt=\"image.png\" /></p>\n<h1 id=\"小明的表情包\"><a class=\"anchor\" href=\"#小明的表情包\">#</a> 小明的表情包</h1>\n<p>首先我们可以发现有一串密码为 “AVARGRRA AVARGL AVAR”，这个密码实在是太短了。我们上述才提到过的网站即可轻松爆破。</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/23/eD8uGs9vPMBYnZE.png\" alt=\"image.png\" /></p>\n<p>我们可以知道他的年份为 1999 年，而题目中是 “日月年”，故我们知道其压缩包密码为 xxxx1999, 根据这个原理我们采用 “zip 暴力破解器” 进行暴力破解，并设置格式为 xxxx1999，最终我们可以得到暴力破解后的压缩包密码为 “07071999”。解压该文件。</p>\n<p>密码 07071999</p>\n<p>解压后打开发现小明的表情包.jpg 为损坏文件，故我们需要使用 010editor 来分析他。</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/23/fx4QS5lkFVbK1sW.png\" alt=\"image.png\" /></p>\n<p>我们发现该 jpg 图片缺少头文件。由于 JPG 的头文件为 FFD8FFE1，我们检查发现下面小红框为 0000FFE1，故我们将其修改为 FFD8FFE1 后，删除前面的一行十六进制 data 后点击保存然后查看图片。即可得到图片。</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/23/d2BKH3qGZ1VEL9Y.png\" alt=\"image.png\" /></p>\n<h1 id=\"社会主义核心价值观\"><a class=\"anchor\" href=\"#社会主义核心价值观\">#</a> 社会主义核心价值观</h1>\n<p css-module=\".\">你对社会主义核心价值观学习得怎么样？ 下面来考考你吧～<br />\n 答案格式: flag</p>\n<p>自由友善敬业自由友善爱国和谐自由平等法治和谐自由和谐平等自由自由和谐和谐自由诚信平等自由文明平等和谐平等法治平等敬业平等敬业平等友善自由平等爱国自由法治自由文明平等富强平等自由自由和谐自由友善爱国自由诚信民主和谐法治自由法治自由公正平等民主平等法治自由友善敬业自由诚信和谐和谐和谐自由公正自由法治自由友善爱国平等自由自由自由自由友善敬业自由友善法治自由诚信文明自由文明自由诚信平等平等文明和谐公正平等民主和谐诚信和谐和谐诚信和谐和谐诚信和谐和谐友善法治</p>\n<ul>\n<li>\n<p>社会主义核心价值观解码</p>\n</li>\n<li>\n<p>base32</p>\n</li>\n<li>\n<p>单表代换：</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">shift_cipher</span>(<span class=\"params\">text</span>):</span><br><span class=\"line\">    result = []</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> char <span class=\"keyword\">in</span> text:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">&#x27;a&#x27;</span> &lt;= char &lt;= <span class=\"string\">&#x27;z&#x27;</span>:</span><br><span class=\"line\">            shifted = <span class=\"built_in\">chr</span>((<span class=\"built_in\">ord</span>(char) - <span class=\"built_in\">ord</span>(<span class=\"string\">&#x27;a&#x27;</span>) - <span class=\"number\">13</span>) % <span class=\"number\">26</span> + <span class=\"built_in\">ord</span>(<span class=\"string\">&#x27;a&#x27;</span>))</span><br><span class=\"line\">            result.append(shifted)</span><br><span class=\"line\">        <span class=\"keyword\">elif</span> <span class=\"string\">&#x27;A&#x27;</span> &lt;= char &lt;= <span class=\"string\">&#x27;Z&#x27;</span>:</span><br><span class=\"line\">            shifted = <span class=\"built_in\">chr</span>((<span class=\"built_in\">ord</span>(char) - <span class=\"built_in\">ord</span>(<span class=\"string\">&#x27;A&#x27;</span>) - <span class=\"number\">13</span>) % <span class=\"number\">26</span> + <span class=\"built_in\">ord</span>(<span class=\"string\">&#x27;A&#x27;</span>))</span><br><span class=\"line\">            result.append(shifted)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            result.append(char)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&#x27;&#x27;</span>.join(result)</span><br><span class=\"line\"></span><br><span class=\"line\">cipher_text = <span class=\"string\">&quot;synt&#123;pelc70_15_1ag3e3f71at&#125;&quot;</span></span><br><span class=\"line\">plain_text = shift_cipher(cipher_text)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(plain_text)</span><br></pre></td></tr></table></figure></p>\n</li>\n</ul>\n<p><strong>flag{cryp70_15_1nt3r3s71ng}</strong></p>\n<h1 id=\"virginia\"><a class=\"anchor\" href=\"#virginia\">#</a> Virginia</h1>\n<p>由题目可知该密码是维吉尼亚密码，试着用之前写的程序直接求密钥，可能是由于没啥规律或是密钥太长，失败了。所幸在找到了一个网站：Vigenere Solver | <span class=\"exturl\" data-url=\"aHR0cDovL2d1YmFsbGEuZGU=\">guballa.de</span>。将 ct.txt 里的原文粘贴进去，然后将 Key Length 改成 161，Break Cipher，得到破解后的原文，与 intro.txt 里的文本进行比较，发现一致，向下翻找到对应 flag。<br />\n<strong>lactf{known_plaintext_and_were_off_to_the_races}</strong></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ndWJhbGxhLmRlL3ZpZ2VuZXJlLXNvbHZlcg==\">https://guballa.de/vigenere-solver</span></p>\n<p>Key Length=161</p>\n<h1 id=\"http协议入门\"><a class=\"anchor\" href=\"#http协议入门\">#</a> HTTP 协议入门</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<ul>\n<li>\n<p>HTTP 协议是 Hyper TextTransfer Protocol (超文本传输协议) 的缩写，主要用于网页的传输，现在也常应用网络 API 的开发 (Restfu API)。</p>\n</li>\n<li>\n<p>HTTP 是一个 TCP/IP 通信协议的最上层的协议之一 (HTML 文件，图片文件，查询结果等)</p>\n</li>\n<li>\n<p>TCP/IP 协议有需要的可以自行了解</p>\n</li>\n</ul>\n<h2 id=\"示例\"><a class=\"anchor\" href=\"#示例\">#</a> 示例</h2>\n<p><strong>以访问北京理工大学数学实验中心为例</strong>：<span class=\"exturl\" data-url=\"aHR0cDovL21lYy5iaXQuZWR1LmNuLw==\">http://mec.bit.edu.cn/</span></p>\n<ul>\n<li>可以看到北京理工大学属性实验中心使用的是 http 协议传输而非通常的 https</li>\n<li>https 相当于对 http 添加了数字证书加密功能，（你可以理解为对传输内容进行加密），现在的大部分网站均用 https 进行传输，而身为顶尖学校的北理工官方网站却仍然使用 http，令人费解。（bushi）</li>\n<li>我们这里先介绍 http</li>\n</ul>\n<p><img data-src=\"https://s2.loli.net/2024/07/08/So9dnsr8j2v3feU.png\" alt=\"image.png\" /></p>\n<h2 id=\"基本工作原理\"><a class=\"anchor\" href=\"#基本工作原理\">#</a> 基本工作原理</h2>\n<ul>\n<li>HTTP 是浏览器或者其他客户端 (如手机 App) 和网站服务器之间沟通的协议。</li>\n<li>浏览器作为 HTTP 客户端通过 URL 向 HTTP 服务端即 WEB 服务器发送所有请求。</li>\n<li>常用的 Web 服务器有：Nginx，Apache，IlS 服务器 (微软的产品) 等。</li>\n<li>Web 服务器接收到的请求后，向客户端发送响应信息。</li>\n<li>HTTP 默认端口号为 80。（https 默认端口为 443）</li>\n</ul>\n<h2 id=\"http三个要点\"><a class=\"anchor\" href=\"#http三个要点\">#</a> HTTP 三个要点</h2>\n<ul>\n<li>\n<p><strong>HTTP 是无连接：</strong> 无连接的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。</p>\n</li>\n<li>\n<p><strong>HTTP 是媒体独立的：</strong> 这意味着，只要客户端和服务器知道如何处理的数据内容，任何类型的数据都可以通过 HTTP 发送。客户端以及服务器指定使用适合的 MIME-type 内容类型。</p>\n</li>\n<li>\n<p><strong>HTTP 是无状态：</strong> HTTP 协议是无状态协议。无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。</p>\n</li>\n</ul>\n<h2 id=\"http的消息结构\"><a class=\"anchor\" href=\"#http的消息结构\">#</a> HTTP 的消息结构</h2>\n<h3 id=\"请求\"><a class=\"anchor\" href=\"#请求\">#</a> 请求</h3>\n<ul>\n<li><strong>地址</strong>和<strong>动词</strong>：例如 <strong>GET <span class=\"exturl\" data-url=\"aHR0cDovL21lYy5iaXQuZWR1LmNuLw==\">http://mec.bit.edu.cn/</span></strong></li>\n<li><strong>请求头（header)</strong>：用来描述请求和发送者的一些信息</li>\n<li><strong>请求参数</strong>：以百度为例，要搜索的关键词。</li>\n</ul>\n<h3 id=\"响应\"><a class=\"anchor\" href=\"#响应\">#</a> 响应</h3>\n<ul>\n<li><strong>响应代码</strong>：200 表示成功，404 表示不存在等</li>\n<li><strong>响应头 header</strong>：描述相应内容的一些信息</li>\n<li><strong>响应内容</strong>：HTML, JSON, 图片等</li>\n</ul>\n<h3 id=\"示例-2\"><a class=\"anchor\" href=\"#示例-2\">#</a> 示例</h3>\n<h4 id=\"客户端请求\"><a class=\"anchor\" href=\"#客户端请求\">#</a> 客户端请求</h4>\n<p><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET http:<span class=\"comment\">//www.example.com/hello.txt HTTP/1.1</span></span><br><span class=\"line\">User-Agent: curl/<span class=\"number\">7.16</span>.<span class=\"number\">3</span> libcurl/<span class=\"number\">7.16</span>.<span class=\"number\">3</span> OpenSSL/<span class=\"number\">0.9</span>.<span class=\"number\">7</span>l zlib/<span class=\"number\">1.2</span>.<span class=\"number\">3</span></span><br><span class=\"line\">Accept-Language: en, mi</span><br><span class=\"line\">Host: www.example.com</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"知识介绍\"><a class=\"anchor\" href=\"#知识介绍\">#</a> 知识介绍</h5>\n<h6 id=\"请求行\"><a class=\"anchor\" href=\"#请求行\">#</a> 请求行</h6>\n<ul>\n<li>\n<p><code>GET</code> : 这是 HTTP 请求方法。 <code>GET</code>  方法请求服务器发送指定资源（在这里是 <code>hello.txt</code> ）的表示形式。</p>\n</li>\n<li>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5leGFtcGxlLmNvbS9oZWxsby50eHQqKjo=\">http://www.example.com/hello.txt**:</span> 这是请求的 URL，指向服务器上的资源 <code>hello.txt</code> 。</p>\n</li>\n<li>\n<p>HTTP/1.1**: 这是 HTTP 版本。HTTP/1.1 是目前最常用的版本，它支持持久连接、分块传输编码等功能。</p>\n</li>\n</ul>\n<h6 id=\"请求头\"><a class=\"anchor\" href=\"#请求头\">#</a> 请求头</h6>\n<ul>\n<li><strong>User-Agent</strong>: 这个头字段包含了发出请求的客户端程序的信息。这里的客户端是 <code>curl</code> ，版本是 <code>7.16.3</code> ，它使用了 <code>libcurl</code>  库（版本 <code>7.16.3</code> ），并且支持 <code>OpenSSL</code> （版本 <code>0.9.7l</code> ）和 <code>zlib</code> （版本 <code>1.2.3</code> ）。</li>\n<li><strong>Accept-Language</strong>: 这个头字段告诉服务器客户端希望接收的语言版本。这里客户端希望接收英文（ <code>en</code> ）和毛利语（ <code>mi</code> ）的内容。</li>\n<li><strong>Host</strong>: 这个头字段指定了请求的主机名。HTTP/1.1 要求所有请求必须包含这个头字段，以便服务器能够正确地处理请求，即使它是从多个虚拟主机中接收到的。3</li>\n</ul>\n<h6 id=\"完整解读\"><a class=\"anchor\" href=\"#完整解读\">#</a> 完整解读</h6>\n<p>这个 HTTP 请求的目的是从 <code>www.example.com</code>  服务器上获取 <code>hello.txt</code>  文件。它使用了 <code>GET</code>  方法，并提供了客户端的详细信息（包括使用的库和版本）。请求指定了客户端能够接受的语言，并且明确了请求的主机名。</p>\n<h4 id=\"服务端响应\"><a class=\"anchor\" href=\"#服务端响应\">#</a> 服务端响应:</h4>\n<p><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HTTP/<span class=\"number\">1.1</span> <span class=\"number\">200</span> OK</span><br><span class=\"line\">Date: Mon, <span class=\"number\">27</span> Jul <span class=\"number\">2009</span> <span class=\"number\">12</span>:<span class=\"number\">28</span>:<span class=\"number\">53</span> GMT</span><br><span class=\"line\">Server: Apache</span><br><span class=\"line\">Last-Modified: Wed, <span class=\"number\">22</span> Jul <span class=\"number\">2009</span> <span class=\"number\">19</span>:<span class=\"number\">15</span>:<span class=\"number\">56</span> GMT</span><br><span class=\"line\">ETag: <span class=\"string\">&quot;34aa387-d-1568eb00&quot;</span></span><br><span class=\"line\">Accept-Ranges: bytes</span><br><span class=\"line\">Content-Length: <span class=\"number\">51</span></span><br><span class=\"line\">Vary: Accept-Encoding</span><br><span class=\"line\">Content-Type: text/plain</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"知识介绍-2\"><a class=\"anchor\" href=\"#知识介绍-2\">#</a> 知识介绍</h5>\n<h6 id=\"状态行\"><a class=\"anchor\" href=\"#状态行\">#</a> 状态行</h6>\n<ul>\n<li><strong>HTTP/1.1</strong>: 这是 HTTP 版本。服务器使用 HTTP/1.1 版本来响应请求。</li>\n<li><strong>200 OK</strong>: 这是状态码和状态消息。状态码 200 表示请求成功，服务器已经成功处理了请求。</li>\n</ul>\n<h6 id=\"响应头\"><a class=\"anchor\" href=\"#响应头\">#</a> 响应头</h6>\n<ul>\n<li><strong>Date</strong>: 这个头字段表示响应消息生成的日期和时间。时间是格林威治标准时间（GMT）。</li>\n<li><strong>Server</strong>: 这个头字段包含处理请求的服务器软件的信息。在这里，服务器使用的是 Apache 服务器。</li>\n<li><strong>Last-Modified</strong>: 这个头字段表示服务器上资源最后修改的日期和时间。它用于缓存控制和条件请求。</li>\n<li><strong>ETag</strong>: 这个头字段提供了资源的实体标签（ETag），用于缓存验证。ETag 是一个唯一的标识符，表示特定版本的资源。</li>\n<li><strong>Accept-Ranges</strong>: 这个头字段表示服务器是否支持范围请求（partial requests），即请求资源的部分内容。在这里， <code>bytes</code>  表示服务器支持字节范围请求。</li>\n<li><strong>Content-Length</strong>: 这个头字段表示响应消息主体的字节长度。在这里，响应内容的长度为 51 字节。</li>\n<li><strong>Vary</strong>: 这个头字段用于内容协商，表示服务器响应可能基于请求的不同 <code>Accept-Encoding</code>  头字段值而变化。也就是说，服务器根据客户端支持的编码类型返回不同的内容。</li>\n<li><strong>Content-Type</strong>: 这个头字段表示响应主体的媒体类型。在这里，响应内容是纯文本格式（ <code>text/plain</code> ）。</li>\n</ul>\n<h4 id=\"响应内容\"><a class=\"anchor\" href=\"#响应内容\">#</a> 响应内容</h4>\n<p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hello World! My payload includes a trailing CRLF.</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"url介绍\"><a class=\"anchor\" href=\"#url介绍\">#</a> url 介绍</h1>\n<h2 id=\"基础知识介绍\"><a class=\"anchor\" href=\"#基础知识介绍\">#</a> 基础知识介绍</h2>\n<h3 id=\"ascii码\"><a class=\"anchor\" href=\"#ascii码\">#</a> ascii 码</h3>\n<p>ASCII (American Standard Code for Information Interchange) 美国信息互换标准代码：</p>\n<h4 id=\"概述\"><a class=\"anchor\" href=\"#概述\">#</a> 概述</h4>\n<ul>\n<li><strong>定义</strong>：ASCII 是一种字符编码标准，用于表示英文字符及一些控制字符。</li>\n<li><strong>范围</strong>：使用 7 位二进制数表示字符，共有 128 个字符。</li>\n</ul>\n<h4 id=\"字符集\"><a class=\"anchor\" href=\"#字符集\">#</a> 字符集</h4>\n<ul>\n<li><strong>控制字符 (0-31)</strong>：这些字符用于控制文本的格式，如换行、回车、制表等。例如，ASCII 值 10 表示换行（LF），ASCII 值 13 表示回车（CR）。</li>\n<li><strong>可打印字符 (32-126)</strong>：包括空格、标点符号、数字、大小写字母等。例如，ASCII 值 65 表示字母 'A'，ASCII 值 97 表示字母 'a'。</li>\n<li><strong>删除字符 (127)</strong>：用于表示删除操作（DEL）。</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>ASCII 值</th>\n<th>控制字符</th>\n<th>ASCII 值</th>\n<th>控制字符</th>\n<th>ASCII 值</th>\n<th>控制字符</th>\n<th>ASCII 值</th>\n<th>控制字符</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0</td>\n<td>NUT</td>\n<td>32</td>\n<td>(space)</td>\n<td>64</td>\n<td>@</td>\n<td>96</td>\n<td>、</td>\n</tr>\n<tr>\n<td>1</td>\n<td>SOH</td>\n<td>33</td>\n<td>!</td>\n<td>65</td>\n<td>A</td>\n<td>97</td>\n<td>a</td>\n</tr>\n<tr>\n<td>2</td>\n<td>STX</td>\n<td>34</td>\n<td>&quot;</td>\n<td>66</td>\n<td>B</td>\n<td>98</td>\n<td>b</td>\n</tr>\n<tr>\n<td>3</td>\n<td>ETX</td>\n<td>35</td>\n<td>#</td>\n<td>67</td>\n<td>C</td>\n<td>99</td>\n<td>c</td>\n</tr>\n<tr>\n<td>4</td>\n<td>EOT</td>\n<td>36</td>\n<td>$</td>\n<td>68</td>\n<td>D</td>\n<td>100</td>\n<td>d</td>\n</tr>\n<tr>\n<td>5</td>\n<td>ENQ</td>\n<td>37</td>\n<td>%</td>\n<td>69</td>\n<td>E</td>\n<td>101</td>\n<td>e</td>\n</tr>\n<tr>\n<td>6</td>\n<td>ACK</td>\n<td>38</td>\n<td>&amp;</td>\n<td>70</td>\n<td>F</td>\n<td>102</td>\n<td>f</td>\n</tr>\n<tr>\n<td>7</td>\n<td>BEL</td>\n<td>39</td>\n<td>,</td>\n<td>71</td>\n<td>G</td>\n<td>103</td>\n<td>g</td>\n</tr>\n<tr>\n<td>8</td>\n<td>BS</td>\n<td>40</td>\n<td>(</td>\n<td>72</td>\n<td>H</td>\n<td>104</td>\n<td>h</td>\n</tr>\n<tr>\n<td>9</td>\n<td>HT</td>\n<td>41</td>\n<td>)</td>\n<td>73</td>\n<td>I</td>\n<td>105</td>\n<td>i</td>\n</tr>\n<tr>\n<td>10</td>\n<td>LF</td>\n<td>42</td>\n<td>*</td>\n<td>74</td>\n<td>J</td>\n<td>106</td>\n<td>j</td>\n</tr>\n<tr>\n<td>11</td>\n<td>VT</td>\n<td>43</td>\n<td>+</td>\n<td>75</td>\n<td>K</td>\n<td>107</td>\n<td>k</td>\n</tr>\n<tr>\n<td>12</td>\n<td>FF</td>\n<td>44</td>\n<td>,</td>\n<td>76</td>\n<td>L</td>\n<td>108</td>\n<td>l</td>\n</tr>\n<tr>\n<td>13</td>\n<td>CR</td>\n<td>45</td>\n<td>-</td>\n<td>77</td>\n<td>M</td>\n<td>109</td>\n<td>m</td>\n</tr>\n<tr>\n<td>14</td>\n<td>SO</td>\n<td>46</td>\n<td>.</td>\n<td>78</td>\n<td>N</td>\n<td>110</td>\n<td>n</td>\n</tr>\n<tr>\n<td>15</td>\n<td>SI</td>\n<td>47</td>\n<td>/</td>\n<td>79</td>\n<td>O</td>\n<td>111</td>\n<td>o</td>\n</tr>\n<tr>\n<td>16</td>\n<td>DLE</td>\n<td>48</td>\n<td>0</td>\n<td>80</td>\n<td>P</td>\n<td>112</td>\n<td>p</td>\n</tr>\n<tr>\n<td>17</td>\n<td>DCI</td>\n<td>49</td>\n<td>1</td>\n<td>81</td>\n<td>Q</td>\n<td>113</td>\n<td>q</td>\n</tr>\n<tr>\n<td>18</td>\n<td>DC2</td>\n<td>50</td>\n<td>2</td>\n<td>82</td>\n<td>R</td>\n<td>114</td>\n<td>r</td>\n</tr>\n<tr>\n<td>19</td>\n<td>DC3</td>\n<td>51</td>\n<td>3</td>\n<td>83</td>\n<td>S</td>\n<td>115</td>\n<td>s</td>\n</tr>\n<tr>\n<td>20</td>\n<td>DC4</td>\n<td>52</td>\n<td>4</td>\n<td>84</td>\n<td>T</td>\n<td>116</td>\n<td>t</td>\n</tr>\n<tr>\n<td>21</td>\n<td>NAK</td>\n<td>53</td>\n<td>5</td>\n<td>85</td>\n<td>U</td>\n<td>117</td>\n<td>u</td>\n</tr>\n<tr>\n<td>22</td>\n<td>SYN</td>\n<td>54</td>\n<td>6</td>\n<td>86</td>\n<td>V</td>\n<td>118</td>\n<td>v</td>\n</tr>\n<tr>\n<td>23</td>\n<td>TB</td>\n<td>55</td>\n<td>7</td>\n<td>87</td>\n<td>W</td>\n<td>119</td>\n<td>w</td>\n</tr>\n<tr>\n<td>24</td>\n<td>CAN</td>\n<td>56</td>\n<td>8</td>\n<td>88</td>\n<td>X</td>\n<td>120</td>\n<td>x</td>\n</tr>\n<tr>\n<td>25</td>\n<td>EM</td>\n<td>57</td>\n<td>9</td>\n<td>89</td>\n<td>Y</td>\n<td>121</td>\n<td>y</td>\n</tr>\n<tr>\n<td>26</td>\n<td>SUB</td>\n<td>58</td>\n<td>:</td>\n<td>90</td>\n<td>Z</td>\n<td>122</td>\n<td>z</td>\n</tr>\n<tr>\n<td>27</td>\n<td>ESC</td>\n<td>59</td>\n<td>;</td>\n<td>91</td>\n<td>[</td>\n<td>123</td>\n<td>{</td>\n</tr>\n<tr>\n<td>28</td>\n<td>FS</td>\n<td>60</td>\n<td>&lt;</td>\n<td>92</td>\n<td>\\</td>\n<td>124</td>\n<td></td>\n</tr>\n<tr>\n<td>29</td>\n<td>GS</td>\n<td>61</td>\n<td>=</td>\n<td>93</td>\n<td>]</td>\n<td>125</td>\n<td>}</td>\n</tr>\n<tr>\n<td>30</td>\n<td>RS</td>\n<td>62</td>\n<td>&gt;</td>\n<td>94</td>\n<td>^</td>\n<td>126</td>\n<td>`        |</td>\n</tr>\n<tr>\n<td>31</td>\n<td>US</td>\n<td>63</td>\n<td>?</td>\n<td>95</td>\n<td>_</td>\n<td>127</td>\n<td>DEL</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"utf-8码\"><a class=\"anchor\" href=\"#utf-8码\">#</a> UTF-8 码</h3>\n<p>UTF-8 (Unicode Transformation Format - 8-bit)：</p>\n<h4 id=\"概述-2\"><a class=\"anchor\" href=\"#概述-2\">#</a> 概述</h4>\n<ul>\n<li><strong>定义</strong>：UTF-8 是 Unicode 的一种可变长度字符编码，用于表示全球范围内的所有字符。</li>\n<li><strong>范围</strong>：使用 1 到 4 个字节表示字符，覆盖所有 Unicode 字符（最多可表示 1,112,064 个字符）。</li>\n</ul>\n<h4 id=\"编码机制\"><a class=\"anchor\" href=\"#编码机制\">#</a> 编码机制</h4>\n<ul>\n<li><strong>单字节 (1 Byte)</strong>：用于表示标准 ASCII 字符（0-127），与 ASCII 完全兼容。</li>\n<li><strong>多字节 (2-4 Bytes)</strong>：用于表示其他 Unicode 字符，根据字符的位置不同，使用不同数量的字节。字节数越多，表示的字符范围越广。\n<ul>\n<li><strong>2 字节</strong>：用于表示基本多语言平面（BMP）中的字符，范围是 U+0800 到 U+FFFF。</li>\n<li><strong>3 字节</strong>：用于表示更多语言字符，范围是 U+0800 到 U+FFFF。</li>\n<li><strong>4 字节</strong>：用于表示补充字符平面中的字符，范围是 U+010000 到 U+10FFFF。</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"优点\"><a class=\"anchor\" href=\"#优点\">#</a> 优点</h4>\n<ul>\n<li><strong>向后兼容 ASCII</strong>：单字节字符与 ASCII 完全兼容，确保旧系统的兼容性。</li>\n<li><strong>可变长度编码</strong>：对于常用字符，节省存储空间；对于特殊字符，提供足够的表示能力。</li>\n<li><strong>无字节序问题</strong>：UTF-8 是字节序独立的，避免了多字节编码中的字节序问题。</li>\n</ul>\n<h2 id=\"组成成分\"><a class=\"anchor\" href=\"#组成成分\">#</a> 组成成分</h2>\n<p>现在给一个示例 url:</p>\n<p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://username:password@www.example.com:8080/path/to/resource.html?query1=value1&amp;query2=value2#section2</span><br></pre></td></tr></table></figure></p>\n<p>让我们来逐一解析这个 url 的组成成分</p>\n<ol>\n<li><strong>协议（Scheme）</strong>： <code>https</code> ：表示使用的是超文本传输安全协议（HTTPS）。</li>\n<li><strong>用户信息（User Information）</strong>（可选）： <code>username:password</code> ：用于身份验证的信息，包含用户名和密码。这个部分很少使用，因为它会暴露在 URL 中，存在安全风险。</li>\n<li><strong>主机名（Host）</strong>： <code>www.example.com</code> ：这是服务器的域名，指向存储资源的服务器。</li>\n<li><strong>端口（Port）</strong>（可选）： <code>8080</code> ：指定了使用的端口号。默认的 HTTPS 端口是 443，但如果使用了非默认端口，则需要在 URL 中明确指定。</li>\n<li><strong>路径（Path）</strong>： <code>/path/to/resource.html</code> ：这是服务器上的资源路径，指向具体的文件或资源。在这个例子中，它是 <code>resource.html</code>  文件，位于 <code>/path/to</code>  目录下。</li>\n<li><strong>查询字符串（Query String）</strong>（可选）： <code>?query1=value1&amp;query2=value2</code> ：这是查询参数，通常用于传递参数给服务器。查询字符串以 <code>?</code>  开始，多个参数之间用 <code>&amp;</code>  分隔。在这个例子中，查询字符串包含两个参数 <code>query1</code>  和 <code>query2</code> ，它们的值分别为 <code>value1</code>  和 <code>value2</code> 。</li>\n<li><strong>片段标识符（也称锚点）（Fragment Identifier）</strong>（可选）： <code>#section2</code> ：用于在资源内进行定位或跳转到特定的部分。在这个例子中，它表示跳转到资源中的 <code>section2</code>  部分。</li>\n</ol>\n<h2 id=\"字符与转义\"><a class=\"anchor\" href=\"#字符与转义\">#</a> 字符与转义</h2>\n<p>URL 的各个组成部分，只能使用以下这些字符：</p>\n<ul>\n<li>26 个英语字母（包括大写和小写）</li>\n<li>10 个阿拉伯数字</li>\n<li>连词号（-）</li>\n<li>句点（.）</li>\n<li>下划线（_）</li>\n</ul>\n<p>如果出现了这些字符外的符号，则需要进行转义，url 的转义规则如下：</p>\n<ul>\n<li>转义是通过使用百分号（%）后跟字符的 ASCII 十六进制值来实现的</li>\n<li><strong>空格</strong>：空格在 URL 中不允许，可以使用 <code>%20</code>  或加号（ <code>+</code> ）来表示（但加号仅在查询字符串中有效）。</li>\n<li><strong>特殊字符</strong>：如 <code>&lt;</code> ,  <code>&gt;</code> ,  <code>#</code> ,  <code>%</code> ,  <code>&#123;</code> ,  <code>&#125;</code> ,  <code>|</code> ,  <code>\\</code> ,  <code>^</code> ,  <code>~</code> ,  <code>[</code> ,  <code>]</code> , 和  <code>&quot;</code>  等，在 URL 中需要转义。\n<ul>\n<li><code>#</code> ： <code>%23</code></li>\n<li><code>%</code> ： <code>%25</code></li>\n<li><code>/</code> ： <code>%2F</code></li>\n<li><code>:</code> ： <code>%3A</code></li>\n<li><code>@</code> ： <code>%40</code></li>\n<li><code>&amp;</code> ： <code>%26</code></li>\n<li><code>=</code> ： <code>%3D</code></li>\n<li><code>?</code> ： <code>%3F</code></li>\n</ul>\n</li>\n<li><strong>非 ASCII 字符</strong>：所有非 ASCII 字符都必须进行转义，使用其 UTF-8 编码的字节，然后每个字节转换为 <code>%HH</code>  格式。</li>\n</ul>\n<h3 id=\"中文的转义\"><a class=\"anchor\" href=\"#中文的转义\">#</a> 中文的转义</h3>\n<p>中文字符在 URL 中也必须进行转义。它们首先被转换为 UTF-8 编码，然后每个字节转换为 <code>%HH</code>  格式。</p>\n<p>示例： <code>https://enjundu.github.io/IntroductiontoNetSecurityLab/应用安全/</code></p>\n<ol>\n<li><strong>将中文字符转换为 UTF-8 编码</strong>：\n<ul>\n<li><code>应</code> 的 UTF-8 编码为 <code>E5 BA 94</code></li>\n<li><code>用</code> 的 UTF-8 编码为 <code>E7 94 A8</code></li>\n<li><code>安</code> 的 UTF-8 编码为 <code>E5 AE 89</code></li>\n<li><code>全</code> 的 UTF-8 编码为 <code>E5 85 A8</code></li>\n</ul>\n</li>\n<li><strong>将 UTF-8 编码的每个字节表示为两个十六进制数字，并在前面加上百分号（%）</strong>:\n<ul>\n<li><code>应</code> ： <code>%E5%BA%94</code></li>\n<li><code>用</code> ： <code>%E7%94%A8</code></li>\n<li><code>安</code> ： <code>%E5%AE%89</code></li>\n<li><code>全</code> ： <code>%E5%85%A8</code></li>\n</ul>\n</li>\n<li>因此最终的转义结果为 <code>https://enjundu.github.io/IntroductiontoNetSecurityLab/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/</code></li>\n</ol>\n<h1 id=\"sql注入\"><a class=\"anchor\" href=\"#sql注入\">#</a> SQL 注入</h1>\n<p>**SQL 注入（SQL Injection）** 是一种代码注入技术，利用不当的输入处理来向应用程序的 SQL 查询中注入恶意的 SQL 代码，从而执行未经授权的数据库操作。</p>\n<h2 id=\"sql原理\"><a class=\"anchor\" href=\"#sql原理\">#</a> SQL 原理</h2>\n<ul>\n<li><strong>输入处理不当</strong>：当应用程序没有正确过滤或转义用户输入时，攻击者可以通过输入恶意的 SQL 代码来篡改应用程序生成的 SQL 查询。</li>\n<li><strong>注入 SQL 代码</strong>：攻击者在用户输入字段中插入特制的 SQL 片段，使得这些片段被直接包含在 SQL 查询中，从而改变查询的原意。</li>\n</ul>\n<h2 id=\"for-example\"><a class=\"anchor\" href=\"#for-example\">#</a> for example</h2>\n<p>假设有一个简单的登录表单，起 SQL 查询如下：</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM users WHERE username = <span class=\"string\">&#x27;user_input&#x27;</span> AND password = <span class=\"string\">&#x27;user_pass&#x27;</span>;</span><br></pre></td></tr></table></figure></p>\n<p>如果应用程序直接将用户输入的内容插入到 SQL 查询中，而没有任何处理，那么攻击者可以在用户名字段中输入如下内容：</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&#x27; OR &#x27;</span><span class=\"number\">1</span><span class=\"string\">&#x27;=&#x27;</span><span class=\"number\">1</span></span><br></pre></td></tr></table></figure></p>\n<p>这样生成的 SQL 查询如下：</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM users WHERE username = <span class=\"string\">&#x27;&#x27;</span> OR <span class=\"string\">&#x27;1&#x27;</span>=<span class=\"string\">&#x27;1&#x27;</span> AND password = <span class=\"string\">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"分析\"><a class=\"anchor\" href=\"#分析\">#</a> 分析</h3>\n<ul>\n<li><code>username = '' OR '1'='1'</code> ：由于 <code>'1'='1'</code>  总是为真，整个查询条件始终为真，导致查询返回所有用户记录。</li>\n<li><strong>结果</strong>：攻击者成功绕过了身份验证，可能访问到受保护的数据。</li>\n</ul>\n<h2 id=\"常见sql注入类型\"><a class=\"anchor\" href=\"#常见sql注入类型\">#</a> 常见 SQL 注入类型</h2>\n<ol>\n<li>\n<p>联合查询注入利用 SQL 的 <code>UNION</code>  关键字将恶意查询结果与合法查询结果合并。攻击者可以通过这种方式从数据库中获取额外的数据。</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT name, email FROM users WHERE <span class=\"built_in\">id</span> = <span class=\"number\">1</span> UNION SELECT username, password FROM admin;</span><br></pre></td></tr></table></figure></p>\n<p>​\t在这个示例中，攻击者试图获取 <code>admin</code>  表中的 <code>username</code>  和 <code>password</code> 。原始查询是从 <code>users</code>  表中根据 ID 获取用户的 <code>name</code>  和 <code>email</code> ，但通过使用 <code>UNION</code>  关键字，攻击者能够将两个查询的结果合并在一起。</p>\n<ul>\n<li><code>UNION</code>  关键字用于将两个或多个 SELECT 语句的结果组合成一个结果集。</li>\n<li>攻击者将合法查询的结果（如 <code>SELECT name, email FROM users WHERE id = 1</code> ）与恶意查询的结果（如 <code>SELECT username, password FROM admin</code> ）合并。</li>\n<li>这样一来，如果数据库执行了整个联合查询，攻击者就能获取到 admin 表中的用户名和密码等敏感信息。</li>\n</ul>\n</li>\n<li>\n<p><strong>错误注入（Error-based SQL Injection）</strong>：错误注入通过故意引发 SQL 错误来获取数据库结构信息。通过分析错误消息中的信息，攻击者可以推断出数据库的结构或版本等敏感信息。</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM users WHERE <span class=\"built_in\">id</span> = <span class=\"number\">1</span><span class=\"string\">&#x27; AND 1=CONVERT(int,(SELECT @@version)); --&#x27;</span></span><br></pre></td></tr></table></figure></p>\n<p>​\t在这个示例中，攻击者试图通过故意触发类型转换错误来获取数据库的版本信息。</p>\n<ul>\n<li><code>@@version</code>  是一个系统变量，返回数据库的版本信息。</li>\n<li>攻击者在原始查询的基础上加入一个引发错误的子查询，例如将 <code>@@version</code>  转换为整数。</li>\n<li>数据库在执行这个查询时会因为类型转换错误而返回一个错误消息。</li>\n<li>错误消息中通常包含有用的信息，攻击者可以利用这些信息来推断数据库的细节，如表结构、列名等。</li>\n</ul>\n</li>\n<li>\n<p><strong>盲注（Blind SQL Injection）</strong>：利用条件查询，通过判断应用程序响应的不同来推测数据库内容。</p>\n<p>​\t盲注利用条件查询，通过判断应用程序响应的不同来推测数据库内容。在盲注中，攻击者无法直接看到查询结果，但可以通过分析应用程序的响应（如页面是否正常加载、响应时间等）来推断数据。</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM users WHERE <span class=\"built_in\">id</span> = <span class=\"number\">1</span> AND (SELECT SUBSTRING(database(), <span class=\"number\">1</span>, <span class=\"number\">1</span>)) = <span class=\"string\">&#x27;a&#x27;</span>;</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>SUBSTRING(database(), 1, 1)</code>  函数提取当前数据库名的第一个字符。</li>\n<li>攻击者将这个字符与字母 <code>'a'</code>  进行比较。</li>\n<li>如果条件为真（即第一个字符是 <code>'a'</code> ），查询将返回结果，应用程序的响应将显示正常。</li>\n<li>如果条件为假（即第一个字符不是 <code>'a'</code> ），查询将不返回结果，应用程序的响应将有所不同（如显示错误消息或页面加载不完全）。</li>\n<li>通过不断改变条件（如尝试 <code>'b'</code> 、 <code>'c'</code>  等），攻击者可以逐字符猜测出数据库的名称或其他敏感信息。</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"防御措施\"><a class=\"anchor\" href=\"#防御措施\">#</a> 防御措施</h2>\n<ol>\n<li>\n<p><strong>使用参数化查询和预编译语句</strong>：避免将用户输入直接插入 SQL 查询中，使用预编译语句确保输入内容被当作数据处理。</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cursor.execute(<span class=\"string\">&quot;SELECT * FROM users WHERE username = %s AND password = %s&quot;</span>, (user_input, user_pass))</span><br></pre></td></tr></table></figure></p>\n</li>\n<li>\n<p><strong>输入验证和过滤</strong>：对用户输入进行严格的验证和过滤，确保输入符合预期格式。</p>\n</li>\n<li>\n<p><strong>最小权限原则</strong>：数据库用户仅应拥有最低权限，限制数据操作权限以减少被攻击后的损失。</p>\n</li>\n<li>\n<p><strong>使用 ORM 框架</strong>：利用 ORM 框架（如 Django ORM）生成 SQL 查询，自动防止 SQL 注入。</p>\n</li>\n<li>\n<p><strong>安全编码实践</strong>：遵循安全编码的最佳实践，定期进行安全审计和代码评审。</p>\n</li>\n</ol>\n<h2 id=\"动手感受\"><a class=\"anchor\" href=\"#动手感受\">#</a> 动手感受</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VuanVuRHUvU1FMLWV4YW1wbGU=\">源代码</span>：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VuanVuRHUvU1FMLWV4YW1wbGU=\">https://github.com/EnjunDu/SQL-example</span></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask, request, redirect, url_for, render_template, session</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_sqlalchemy <span class=\"keyword\">import</span> SQLAlchemy</span><br><span class=\"line\"><span class=\"keyword\">from</span> datetime <span class=\"keyword\">import</span> datetime</span><br><span class=\"line\"><span class=\"keyword\">from</span> sqlalchemy.sql <span class=\"keyword\">import</span> text</span><br><span class=\"line\"><span class=\"keyword\">from</span> functools <span class=\"keyword\">import</span> wraps</span><br><span class=\"line\"></span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\">app.config[<span class=\"string\">&#x27;SECRET_KEY&#x27;</span>] = <span class=\"string\">&#x27;zheshiyigeanquanmiyaoo~&#x27;</span></span><br><span class=\"line\">app.config[<span class=\"string\">&#x27;SQLALCHEMY_DATABASE_URI&#x27;</span>] = <span class=\"string\">&#x27;sqlite:///signin.db&#x27;</span></span><br><span class=\"line\">db = SQLAlchemy(app)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 用户模块</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">User</span>(db.Model):</span><br><span class=\"line\">    <span class=\"built_in\">id</span> = db.Column(db.Integer, primary_key=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    username = db.Column(db.String(<span class=\"number\">80</span>), unique=<span class=\"literal\">True</span>, nullable=<span class=\"literal\">False</span>)</span><br><span class=\"line\">    password = db.Column(db.String(<span class=\"number\">80</span>), nullable=<span class=\"literal\">False</span>)</span><br><span class=\"line\">    sign_ins = db.relationship(<span class=\"string\">&#x27;SignIn&#x27;</span>, backref=<span class=\"string\">&#x27;user&#x27;</span>, lazy=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 签到记录模块</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">SignIn</span>(db.Model):</span><br><span class=\"line\">    <span class=\"built_in\">id</span> = db.Column(db.Integer, primary_key=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    sign_in_time = db.Column(db.DateTime, default=datetime.utcnow)</span><br><span class=\"line\">    user_id = db.Column(db.Integer, db.ForeignKey(<span class=\"string\">&#x27;user.id&#x27;</span>), nullable=<span class=\"literal\">False</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建数据库表格</span></span><br><span class=\"line\"><span class=\"meta\">@app.before_request</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">create_tables</span>():</span><br><span class=\"line\">    db.create_all()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 登录检查装饰器</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">login_required</span>(<span class=\"params\">f</span>):</span><br><span class=\"line\"><span class=\"meta\">    @wraps(<span class=\"params\">f</span>)</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">decorated_function</span>(<span class=\"params\">*args, **kwargs</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">&#x27;user_id&#x27;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> session:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> redirect(url_for(<span class=\"string\">&#x27;login&#x27;</span>))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f(*args, **kwargs)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> decorated_function</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 管理员权限检查装饰器</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">admin_required</span>(<span class=\"params\">f</span>):</span><br><span class=\"line\"><span class=\"meta\">    @wraps(<span class=\"params\">f</span>)</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">decorated_function</span>(<span class=\"params\">*args, **kwargs</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> session.get(<span class=\"string\">&#x27;admin&#x27;</span>) != <span class=\"literal\">True</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> redirect(url_for(<span class=\"string\">&#x27;admin_login&#x27;</span>))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f(*args, **kwargs)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> decorated_function</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 主页</span></span><br><span class=\"line\"><span class=\"meta\">@app.route(<span class=\"params\"><span class=\"string\">&#x27;/&#x27;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">index</span>():</span><br><span class=\"line\">    <span class=\"keyword\">return</span> render_template(<span class=\"string\">&#x27;index.html&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 用户注册</span></span><br><span class=\"line\"><span class=\"meta\">@app.route(<span class=\"params\"><span class=\"string\">&#x27;/register&#x27;</span>, methods=[<span class=\"string\">&#x27;GET&#x27;</span>, <span class=\"string\">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">register</span>():</span><br><span class=\"line\">    <span class=\"keyword\">if</span> request.method == <span class=\"string\">&#x27;POST&#x27;</span>:</span><br><span class=\"line\">        username = request.form[<span class=\"string\">&#x27;username&#x27;</span>]</span><br><span class=\"line\">        password = request.form[<span class=\"string\">&#x27;password&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> username <span class=\"keyword\">or</span> <span class=\"keyword\">not</span> password:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&#x27;用户名和密码不能为空&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> User.query.filter_by(username=username).first():</span><br><span class=\"line\">            new_user = User(username=username, password=password)</span><br><span class=\"line\">            db.session.add(new_user)</span><br><span class=\"line\">            db.session.commit()</span><br><span class=\"line\">            <span class=\"keyword\">return</span> redirect(url_for(<span class=\"string\">&#x27;login&#x27;</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> render_template(<span class=\"string\">&#x27;register.html&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 用户登录</span></span><br><span class=\"line\"><span class=\"meta\">@app.route(<span class=\"params\"><span class=\"string\">&#x27;/login&#x27;</span>, methods=[<span class=\"string\">&#x27;GET&#x27;</span>, <span class=\"string\">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">login</span>():</span><br><span class=\"line\">    <span class=\"keyword\">if</span> request.method == <span class=\"string\">&#x27;POST&#x27;</span>:</span><br><span class=\"line\">        username = request.form[<span class=\"string\">&#x27;username&#x27;</span>]</span><br><span class=\"line\">        password = request.form[<span class=\"string\">&#x27;password&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> username <span class=\"keyword\">or</span> <span class=\"keyword\">not</span> password:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&#x27;用户名和密码不能为空&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        user = User.query.filter_by(username=username, password=password).first()</span><br><span class=\"line\">        <span class=\"keyword\">if</span> user:</span><br><span class=\"line\">            session[<span class=\"string\">&#x27;user_id&#x27;</span>] = user.<span class=\"built_in\">id</span></span><br><span class=\"line\">            session[<span class=\"string\">&#x27;admin&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> redirect(url_for(<span class=\"string\">&#x27;signin&#x27;</span>))</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&#x27;登录失败&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> render_template(<span class=\"string\">&#x27;login.html&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 签到</span></span><br><span class=\"line\"><span class=\"meta\">@app.route(<span class=\"params\"><span class=\"string\">&#x27;/signin&#x27;</span>, methods=[<span class=\"string\">&#x27;GET&#x27;</span>, <span class=\"string\">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class=\"line\"><span class=\"meta\">@login_required</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">signin</span>():</span><br><span class=\"line\">    <span class=\"keyword\">if</span> request.method == <span class=\"string\">&#x27;POST&#x27;</span>:</span><br><span class=\"line\">        new_sign_in = SignIn(user_id=session[<span class=\"string\">&#x27;user_id&#x27;</span>])</span><br><span class=\"line\">        db.session.add(new_sign_in)</span><br><span class=\"line\">        db.session.commit()</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (<span class=\"string\">&#x27;签到成功！&#x27;</span>)</span><br><span class=\"line\">                <span class=\"string\">&#x27;LFXXKIDNMF4SA3TFMVSCA5DPEB2XGZJAM5ZG65LQEBSW4Y3SPFYHI2LPNYQQ====&#x27;</span></span><br><span class=\"line\">                <span class=\"string\">&#x27;86,106,74,87,99,49,107,121,79,88,82,97,85,49,86,53,84,85,104,83,100,107,112,85,83,88,100,107,82,50,104,119,89,51,108,86,101,85,49,70,98,70,82,82,77,69,49,115,84,87,112,67,77,49,112,88,83,87,120,78,97,107,74,52,90,70,100,87,101,109,82,72,98,72,90,105,97,86,85,122,85,108,86,79,100,109,74,116,90,72,108,90,87,70,73,120,89,107,100,71,77,71,70,88,79,88,86,106,101,86,86,53,84,85,99,53,100,85,112,85,83,88,100,107,82,48,90,121,89,86,99,49,98,107,112,85,83,88,100,90,86,122,86,50,90,69,100,111,98,71,78,112,86,88,108,78,83,69,52,119,87,108,104,66,98,69,49,113,81,106,66,105,77,50,82,111,89,50,49,83,101,107,112,85,83,88,100,90,98,107,112,115,87,86,100,48,99,71,74,116,89,50,120,78,97,107,73,119,89,85,104,75,100,109,82,88,90,71,57,75,86,69,108,52,83,108,82,74,100,49,82,116,79,84,78,75,86,69,108,51,87,86,78,86,101,85,49,73,85,109,120,105,87,69,74,50,89,50,49,71,101,87,86,84,86,88,108,78,83,69,74,53,89,106,73,120,100,50,82,68,86,88,108,78,82,50,120,54,83,108,82,74,100,49,111,121,98,68,74,97,86,122,82,115,84,87,112,66,100,69,112,85,83,88,100,107,82,50,104,115,83,108,82,74,100,49,108,88,85,110,82,104,86,122,86,119,89,122,78,83,101,86,108,89,85,110,90,106,97,86,86,53,84,106,78,78,98,69,49,113,81,109,104,90,77,107,53,50,90,70,99,49,77,69,112,85,83,88,100,104,87,69,49,115,84,87,112,66,98,69,52,119,83,107,112,86,77,69,53,69,87,72,112,74,100,48,49,113,85,109,90,106,77,110,81,49,87,68,66,119,97,70,107,121,100,71,90,83,83,70,86,115,84,106,66,82,100,85,112,85,83,88,100,87,82,50,104,119,89,51,108,86,101,85,49,72,77,87,104,108,85,49,86,53,84,85,100,75,98,69,112,85,83,88,100,107,98,86,90,53,90,86,78,86,101,85,49,73,86,110,112,97,86,49,111,120,89,107,77,49,81,50,82,89,85,87,120,78,97,107,73,119,89,85,100,86,98,69,49,113,81,109,104,97,82,122,70,119,89,109,49,115,101,109,82,73,83,109,104,107,82,122,108,53,83,108,82,74,100,50,78,72,82,110,112,106,77,50,82,50,89,50,49,82,98,69,49,113,81,109,112,90,86,122,86,49,89,106,78,82,98,69,49,113,81,109,108,97,85,49,86,53,84,85,100,87,97,71,77,121,98,72,78,108,85,49,86,53,84,85,104,83,100,109,74,72,85,87,120,78,97,107,73,119,89,110,108,86,101,85,49,73,98,72,90,107,85,49,86,53,85,88,108,86,101,85,49,72,84,110,90,105,98,108,74,119,89,109,53,87,98,69,112,85,83,88,100,97,87,71,104,51,89,107,99,53,101,87,70,88,78,87,53,75,86,69,108,52&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> render_template(<span class=\"string\">&#x27;signin.html&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 管理员登录</span></span><br><span class=\"line\"><span class=\"meta\">@app.route(<span class=\"params\"><span class=\"string\">&#x27;/admin&#x27;</span>, methods=[<span class=\"string\">&#x27;GET&#x27;</span>, <span class=\"string\">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">admin_login</span>():</span><br><span class=\"line\">    <span class=\"keyword\">if</span> request.method == <span class=\"string\">&#x27;POST&#x27;</span>:</span><br><span class=\"line\">        username = request.form[<span class=\"string\">&#x27;username&#x27;</span>]</span><br><span class=\"line\">        password = request.form[<span class=\"string\">&#x27;password&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># 设置一个专门的管理员账号密码</span></span><br><span class=\"line\">        admin_username = <span class=\"string\">&#x27;ISCC_2024_sky_Jack_Du&#x27;</span></span><br><span class=\"line\">        admin_password = <span class=\"string\">&#x27;sky_1s_S0_h@NdsOme~_1234678910&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># 检查是否是特定管理员</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> username == admin_username:</span><br><span class=\"line\">            <span class=\"comment\"># 允许使用 SQL 注入，仅当用户名为 &quot;sky&quot;</span></span><br><span class=\"line\">            query = text(<span class=\"string\">f&quot;SELECT * FROM user WHERE username = &#x27;<span class=\"subst\">&#123;username&#125;</span>&#x27; AND password = &#x27;<span class=\"subst\">&#123;password&#125;</span>&#x27;&quot;</span>)</span><br><span class=\"line\">            result = db.session.execute(query).fetchone()</span><br><span class=\"line\">            <span class=\"keyword\">if</span> result:</span><br><span class=\"line\">                session[<span class=\"string\">&#x27;admin&#x27;</span>] = <span class=\"literal\">True</span></span><br><span class=\"line\">                session[<span class=\"string\">&#x27;user_id&#x27;</span>] = result.<span class=\"built_in\">id</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> redirect(url_for(<span class=\"string\">&#x27;admin_dashboard&#x27;</span>))</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"string\">&#x27;登录失败&#x27;</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"comment\"># 对于其他用户, 使用普通的安全验证</span></span><br><span class=\"line\">            user = User.query.filter_by(admin_username=username,admin_password=password).first()</span><br><span class=\"line\">            <span class=\"keyword\">if</span> user:</span><br><span class=\"line\">                session[<span class=\"string\">&#x27;admin&#x27;</span>] = <span class=\"literal\">True</span></span><br><span class=\"line\">                session[<span class=\"string\">&#x27;user_id&#x27;</span>] = user.<span class=\"built_in\">id</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> redirect(url_for(<span class=\"string\">&#x27;admin_dashboard&#x27;</span>))</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"string\">&#x27;登录失败&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> render_template(<span class=\"string\">&#x27;admin_login.html&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 后台面板</span></span><br><span class=\"line\"><span class=\"meta\">@app.route(<span class=\"params\"><span class=\"string\">&#x27;/admin/dashboard&#x27;</span></span>)</span></span><br><span class=\"line\"><span class=\"meta\">@login_required</span></span><br><span class=\"line\"><span class=\"meta\">@admin_required</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">admin_dashboard</span>():</span><br><span class=\"line\">    sign_ins = SignIn.query.<span class=\"built_in\">all</span>()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> render_template(<span class=\"string\">&#x27;admin_dashboard.html&#x27;</span>, sign_ins=sign_ins)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    app.run(debug=<span class=\"literal\">True</span>, host=<span class=\"string\">&#x27;0.0.0.0&#x27;</span>, port=<span class=\"number\">8848</span>)</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"详细步骤\"><a class=\"anchor\" href=\"#详细步骤\">#</a> 详细步骤</h3>\n<ol>\n<li>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS1weXRob25hcHAtNWI2bnk1MWZmeGR3NTBqNGt5Y3R0eGEucHk=\">在 python 环境下运行 app.py</span>。app.py 配置推荐使用 Pycharm,requirements 为：</p>\n<p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Flask==3.0.3</span><br><span class=\"line\">flask_sqlalchemy==3.1.1</span><br><span class=\"line\">SQLAlchemy==2.0.30</span><br></pre></td></tr></table></figure></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/09/b5QUaz2okmL8qSM.png\" alt=\"QQ_1720497160019.png\" /></p>\n</li>\n<li>\n<p>在浏览器输入 http://127.0.0.1:8848 或者 localhost:8848 登录页面</p>\n</li>\n<li>\n<p>点击管理员入口</p>\n</li>\n<li>\n<p>在管理员界面账号输入 <code>ISCC_2024_sky_Jack_Du</code></p>\n</li>\n<li>\n<p>密码输入 <code>' OR '1'='1</code></p>\n</li>\n<li>\n<p>点击登录，进入后台</p>\n</li>\n<li>\n<p><img data-src=\"https://s2.loli.net/2024/07/09/CyudBa3VrTSwqig.png\" alt=\"QQ_1720497597660.png\" /></p>\n</li>\n</ol>\n<h3 id=\"思考\"><a class=\"anchor\" href=\"#思考\">#</a> 思考</h3>\n<ul>\n<li>分析代码：为什么 username 不能使用 <code>' OR '1'='1</code>  进行注入？</li>\n<li>分析代码：为什么 password 进行注入的时候，username 必须为 <code>ISCC_2024_sky_Jack_Du</code> ？</li>\n<li>SQL 的原理是什么？你能把注入后代码判定的流程解释清楚吗？</li>\n</ul>\n<h1 id=\"xss攻击\"><a class=\"anchor\" href=\"#xss攻击\">#</a> XSS 攻击</h1>\n<p>XSS 攻击是通过在目标网站中注入恶意脚本，使得这些脚本在其他用户的浏览器中执行，通常用于窃取用户的敏感信息、劫持用户会话或者进行其他恶意操作。XSS 攻击主要分为三类：存储型 XSS、反射型 XSS 和基于 DOM 的 XSS。</p>\n<h3 id=\"存储型xssstored-xss\"><a class=\"anchor\" href=\"#存储型xssstored-xss\">#</a> 存储型 XSS（Stored XSS）</h3>\n<ul>\n<li>攻击者将恶意脚本提交到目标网站的数据库中。</li>\n<li>当其他用户访问包含恶意脚本的页面时，脚本会在用户的浏览器中执行。</li>\n<li>这种攻击常见于留言板、评论区或用户资料页面。</li>\n</ul>\n<h3 id=\"反射型xssreflected-xss\"><a class=\"anchor\" href=\"#反射型xssreflected-xss\">#</a> 反射型 XSS（Reflected XSS）</h3>\n<ul>\n<li>攻击者构造一个包含恶意脚本的 URL 并诱使用户点击。</li>\n<li>服务器将 URL 中的恶意脚本反射回响应中，直接在用户的浏览器中执行。</li>\n<li>这种攻击常见于搜索结果页面或错误信息页面。</li>\n</ul>\n<h3 id=\"基于dom的xssdom-based-xss\"><a class=\"anchor\" href=\"#基于dom的xssdom-based-xss\">#</a> 基于 DOM 的 XSS（DOM-based XSS）</h3>\n<ul>\n<li>恶意脚本在客户端通过修改 DOM（文档对象模型）直接执行。</li>\n<li>攻击者利用客户端的 JavaScript 代码动态生成恶意脚本，通常不经过服务器。</li>\n</ul>\n<h2 id=\"实验\"><a class=\"anchor\" href=\"#实验\">#</a> 实验</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VuanVuRHUvWFNTLWV4YW5wbGU=\">实验链接</span>:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VuanVuRHUvWFNTLWV4YW5wbGU=\">https://github.com/EnjunDu/XSS-exanple</span></p>\n<h3 id=\"前期准备\"><a class=\"anchor\" href=\"#前期准备\">#</a> 前期准备</h3>\n<ol>\n<li>download 实验材料</li>\n<li>fork and star</li>\n<li>安装 VMware 虚拟机</li>\n<li>安装 kali or Ubuntu</li>\n</ol>\n<h3 id=\"实验开始\"><a class=\"anchor\" href=\"#实验开始\">#</a> 实验开始</h3>\n<ol>\n<li>先打开终端运行 sudo apt install python3 安装 python3 环境</li>\n<li>采用 sudo apt update 和 sudo apt install python3-flask -y 来安装 Flask 框架</li>\n<li>在 kali 中创建 XSS_example 文件夹，包含已经给出的代码资料。</li>\n<li>打开到目录后右键，点击 Open Terminal Here 调用终端</li>\n<li>在终端上输入命令 python <span class=\"exturl\" data-url=\"aHR0cDovL2FwcC5weQ==\">app.py</span>，<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1hcHAtbzk5Zmg2Nmwyb2oucHk=\">来运行 app.py</span></li>\n<li>可通过在浏览器访问地址 localhost:5000 或者 127.0.0.1:5000 来访问该地址</li>\n</ol>\n<h3 id=\"正式操作\"><a class=\"anchor\" href=\"#正式操作\">#</a> 正式操作</h3>\n<h4 id=\"xss反射型实验\"><a class=\"anchor\" href=\"#xss反射型实验\">#</a> XSS 反射型实验</h4>\n<p>在浏览器 url 输入框里输入：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://127.0.0.1:5000/?content=&lt;script&gt;alert(&#x27;XSS反射实验成功！&#x27;)&lt;/script&gt;&amp;submit=提交</span><br></pre></td></tr></table></figure></p>\n<p>后回车，如果出现 “XSS 反射实验成功，则说明攻击成功”</p>\n<h4 id=\"xss存储型攻击\"><a class=\"anchor\" href=\"#xss存储型攻击\">#</a> XSS 存储型攻击</h4>\n<p>在评论栏输入：</p>\n<p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;#&quot;</span> <span class=\"attr\">onclick</span>=<span class=\"string\">&quot;window.location=&#x27;https://www.yuanshen.com&#x27;;&quot;</span>&gt;</span>XSS持久型攻击——原神，启动！<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>后回车点击提交，然后在评论框点击 “原神，启动！”，如果跳转至原神官网则说明攻击成功。</p>\n<h3 id=\"实验思考为何能成功\"><a class=\"anchor\" href=\"#实验思考为何能成功\">#</a> 实验思考 —— 为何能成功？</h3>\n<h4 id=\"xss反射型\"><a class=\"anchor\" href=\"#xss反射型\">#</a> XSS 反射型</h4>\n<p>反射型 XSS 攻击的成功原因主要是由于服务器<strong>没有对用户输入的内容进行任何过滤或编码处理</strong>，直接将其反射回页面。</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">query = request.args.get(<span class=\"string\">&quot;content&quot;</span>).strip()</span><br><span class=\"line\"><span class=\"keyword\">if</span> query:</span><br><span class=\"line\">    sub_dataset = [x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> dataset <span class=\"keyword\">if</span> query <span class=\"keyword\">in</span> x]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> render_template(<span class=\"string\">&quot;index.html&quot;</span>, query=query, comments=sub_dataset)</span><br></pre></td></tr></table></figure></p>\n<p>用户通过 URL 参数传递恶意脚本：</p>\n<p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://127.0.0.1:5000/?content=<span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"><span class=\"title function_\">alert</span>(<span class=\"string\">&#x27;XSS反射实验成功！&#x27;</span>)</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span>&amp;submit=提交</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>服务器将 URL 参数 <code>content</code>  的值直接传递给变量 <code>query</code> ，没有进行任何过滤或编码。服务器获取 <code>content</code>  参数的值（ <code>&lt;script&gt;alert('XSS反射实验成功！')&lt;/script&gt;</code> ），并将其赋值给变量 <code>query</code> 。</li>\n<li>在生成 HTML 页面时，变量 <code>query</code>  被直接渲染到模板中，这意味着任何 HTML 或 JavaScript 代码都会被浏览器解析和执行。</li>\n</ul>\n<h4 id=\"xss存储型\"><a class=\"anchor\" href=\"#xss存储型\">#</a> XSS 存储型</h4>\n<p>存储型 XSS 攻击的成功原因主要是由于服务器在处理用户提交的内容时，没有对其进行任何过滤或编码处理，直接将其存储并在页面中展示。</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">comment = request.form.get(<span class=\"string\">&quot;newComment&quot;</span>).strip()</span><br><span class=\"line\"><span class=\"keyword\">if</span> comment:</span><br><span class=\"line\">    dataset.append(comment)</span><br></pre></td></tr></table></figure></p>\n<p>用户通过表单提交恶意脚本：</p>\n<p><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;#&quot;</span> <span class=\"attr\">onclick</span>=<span class=\"string\">&quot;window.location=&#x27;https://www.yuanshen.com&#x27;;&quot;</span>&gt;</span>XSS持久型攻击——原神，启动！<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>服务器将用户提交的内容存储在 <code>dataset</code>  列表中，没有进行任何过滤或编码。</li>\n<li>当页面渲染时，所有评论（包括恶意脚本）都会被直接输出到 HTML 页面中，导致恶意脚本在用户浏览器中执行。</li>\n</ul>\n<h3 id=\"防御方法\"><a class=\"anchor\" href=\"#防御方法\">#</a> 防御方法</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask, render_template, request, escape</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_wtf.csrf <span class=\"keyword\">import</span> CSRFProtect</span><br><span class=\"line\"></span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\">app.secret_key = <span class=\"string\">&#x27;your_secret_key&#x27;</span></span><br><span class=\"line\">csrf = CSRFProtect(app)</span><br><span class=\"line\"></span><br><span class=\"line\">dataset = [<span class=\"string\">&quot;BIT网络安全课程真有趣&quot;</span>, <span class=\"string\">&quot;Web安全演示实验打卡&quot;</span>, <span class=\"string\">&quot;祝同学们都能取得好成绩!&quot;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route(<span class=\"params\"><span class=\"string\">&quot;/&quot;</span>, methods=[<span class=\"string\">&quot;GET&quot;</span>, <span class=\"string\">&quot;POST&quot;</span>]</span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">index</span>():</span><br><span class=\"line\">    query = <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> request.method == <span class=\"string\">&quot;POST&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> request.form.get(<span class=\"string\">&quot;submit&quot;</span>) == <span class=\"string\">&quot;提交新评论&quot;</span>:</span><br><span class=\"line\">            comment = escape(request.form.get(<span class=\"string\">&quot;newComment&quot;</span>).strip())</span><br><span class=\"line\">            <span class=\"keyword\">if</span> comment:</span><br><span class=\"line\">                dataset.append(comment)</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> request.method == <span class=\"string\">&quot;GET&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> request.args.get(<span class=\"string\">&quot;submit&quot;</span>) == <span class=\"string\">&quot;提交&quot;</span>:</span><br><span class=\"line\">            query = escape(request.args.get(<span class=\"string\">&quot;content&quot;</span>).strip())</span><br><span class=\"line\">            <span class=\"keyword\">if</span> query:</span><br><span class=\"line\">                sub_dataset = [x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> dataset <span class=\"keyword\">if</span> query <span class=\"keyword\">in</span> x]</span><br><span class=\"line\">                <span class=\"keyword\">return</span> render_template(<span class=\"string\">&quot;index.html&quot;</span>, query=query, comments=sub_dataset)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> render_template(<span class=\"string\">&quot;index.html&quot;</span>, query=query, comments=dataset)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&quot;__main__&quot;</span>:</span><br><span class=\"line\">    app.run()</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><strong>输入过滤和编码</strong>：对用户输入的数据进行 HTML 转义，防止恶意脚本的执行。</li>\n<li><strong>使用 Flask 的 <code>escape</code>  函数</strong>：对用户输入的内容进行 HTML 转义，如上代码所示，使用 <code>escape</code>  函数对 <code>query</code>  和 <code>comment</code>  进行处理。</li>\n<li><strong>内容安全策略（CSP）</strong>：配置 HTTP 响应头，限制浏览器只执行可信任的脚本。</li>\n</ul>\n<h1 id=\"实战\"><a class=\"anchor\" href=\"#实战\">#</a> 实战</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9idXVvai5jbg==\">BUUCTF</span></p>\n<h2 id=\"极客大挑战-2019easysql\"><a class=\"anchor\" href=\"#极客大挑战-2019easysql\">#</a> [极客大挑战 2019] EasySQL</h2>\n<ul>\n<li>admin' or 1=1 #</li>\n<li>密码随便写</li>\n</ul>\n<h2 id=\"havefun\"><a class=\"anchor\" href=\"#havefun\">#</a> Havefun</h2>\n<ul>\n<li>查看原代码: <code>if cat=dog</code>  输出原代码</li>\n<li><code>/?cat=dog</code></li>\n</ul>\n<h2 id=\"include\"><a class=\"anchor\" href=\"#include\">#</a> Include</h2>\n<ul>\n<li>点击<strong> tips</strong></li>\n<li><strong>include</strong>: 文件包含</li>\n<li><code>php://filter/read=convert.base64-encode/resource=要读取的文件</code></li>\n<li>Hackbar: <code>php://filter/read=convert.base64-encode/resource=flag.php</code></li>\n<li>最终输入 <code>/?file=php://filter/read=convert.base64-encode/resource=flag.php</code></li>\n</ul>\n<h2 id=\"actf2020-新生赛exec1\"><a class=\"anchor\" href=\"#actf2020-新生赛exec1\">#</a> [ACTF2020 新生赛] Exec1</h2>\n<ul>\n<li>ping  <code>127.0.0.1</code></li>\n<li><code>127.0.0.1 |ls /</code></li>\n<li><code>127.0.0.1|ls /flag</code></li>\n<li><code>127.0.0.1|cat /flag</code></li>\n</ul>\n<h2 id=\"actf2020-新生赛backupfile\"><a class=\"anchor\" href=\"#actf2020-新生赛backupfile\">#</a> [ACTF2020 新生赛] BackupFile</h2>\n<h3 id=\"备份文件后缀名\"><a class=\"anchor\" href=\"#备份文件后缀名\">#</a> 备份文件后缀名：</h3>\n<ul>\n<li><code>.git</code></li>\n<li><code>.svn</code></li>\n<li><code>.swp</code></li>\n<li><code>.~</code></li>\n<li><code>.bak</code> ☆</li>\n<li><code>.bash_history</code></li>\n<li><code>.bkf</code></li>\n</ul>\n<h3 id=\"indexphpbak\"><a class=\"anchor\" href=\"#indexphpbak\">#</a> /index.php.bak</h3>\n<p>打开下载到的东西后，<strong>代码审计</strong></p>\n<p>传值， <code>/?key=123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3</code> , 报错，审计代码！</p>\n<p><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(!<span class=\"title function_ invoke__\">is_numeric</span>(<span class=\"variable\">$key</span>)) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">exit</span>(<span class=\"string\">&quot;Just num!&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>故传值: <code>/?key=123</code></p>\n<h2 id=\"hctf-2018warmup\"><a class=\"anchor\" href=\"#hctf-2018warmup\">#</a> [HCTF 2018]WarmUp</h2>\n<ul>\n<li>\n<p>查看原代码 —— 注释 <code>source.php</code></p>\n</li>\n<li>\n<p>查看代码里的判断语句:</p>\n<p><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (! <span class=\"keyword\">empty</span>(<span class=\"variable\">$_REQUEST</span>[<span class=\"string\">&#x27;file&#x27;</span>])</span><br><span class=\"line\">     &amp;&amp; <span class=\"title function_ invoke__\">is_string</span>(<span class=\"variable\">$_REQUEST</span>[<span class=\"string\">&#x27;file&#x27;</span>])</span><br><span class=\"line\">     &amp;&amp; emmm::<span class=\"title function_ invoke__\">checkFile</span>(<span class=\"variable\">$_REQUEST</span>[<span class=\"string\">&#x27;file&#x27;</span>])</span><br><span class=\"line\"> )</span><br></pre></td></tr></table></figure></p>\n<p>文件包含漏洞</p>\n</li>\n<li>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$whitelist</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"source\"</span><span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"source.php\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"hint\"</span><span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"hint.php\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span>code￼<span class=\"token number\">24</span><span class=\"token operator\">--</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>取 <span class=\"token string backtick-quoted-string\">`page`</span>，然后问号加在其末尾，找出问号第一次出现的位置</pre></td></tr></table></figure></li>\n<li>\n<p>假如 file=source.php?../../flag?</p>\n</li>\n<li>\n<p>问号一定要传，但是对其进行了两次 <code>url</code>  解码，所以需要进行两次加码。%253F</p>\n</li>\n<li>\n<p><strong>file=source.php%253F../../ffffllllaaaagggg</strong></p>\n</li>\n<li>\n<p>一直到<strong><span class=\"exturl\" data-url=\"aHR0cDovLzYzZGI5MWE0LTZhZjktNDQ3Ni1hYTBlLTM5NjlkM2QwZTNiZS5ub2RlNS5idXVvai5jbjo4MS8/ZmlsZT1zb3VyY2UucGhwJTI1M0YuLi8uLi8uLi8uLi8uLi9mZmZmbGxsbGFhYWFnZ2dn\"> http://63db91a4-6af9-4476-aa0e-3969d3d0e3be.node5.buuoj.cn:81/?file=source.php%3F../../../../../ffffllllaaaagggg</span></strong></p>\n</li>\n<li>\n<p><strong>?file=source.php%253F../../../../../ffffllllaaaagggg</strong></p>\n</li>\n</ul>\n<h1 id=\"附加-攻防世界\"><a class=\"anchor\" href=\"#附加-攻防世界\">#</a> 附加 攻防世界</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuL2hvbWUvaW5kZXg=\">攻防世界</span>: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuL2hvbWUvaW5kZXg=\">https://adworld.xctf.org.cn/home/index</span></p>\n<h2 id=\"view_source\"><a class=\"anchor\" href=\"#view_source\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuL2NoYWxsZW5nZXMvbGlzdA==\">view_source</span></h2>\n<ul>\n<li>点击获取在线场景</li>\n<li>F12</li>\n</ul>\n<h2 id=\"get_post\"><a class=\"anchor\" href=\"#get_post\">#</a> get_post</h2>\n<ul>\n<li>hackbar</li>\n<li>get——?a=x</li>\n</ul>\n<h2 id=\"robots\"><a class=\"anchor\" href=\"#robots\">#</a> robots</h2>\n<p>obots 协议也称爬虫协议、爬虫规则等，是指<span class=\"exturl\" data-url=\"aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTclQkQlOTElRTclQUIlOTkvMTU1NzIyP2Zyb21Nb2R1bGU9bGVtbWFfaW5saW5r\">网站</span>可建立一个 robots.txt 文件来告诉<span class=\"exturl\" data-url=\"aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTYlOTAlOUMlRTclQjQlQTIlRTUlQkMlOTUlRTYlOTMlOEUvMTA0ODEyP2Zyb21Nb2R1bGU9bGVtbWFfaW5saW5r\">搜索引擎</span>哪些页面可以抓取，哪些页面不能抓取，而搜索引擎则通过读取 robots.txt 文件来识别这个页面是否允许被抓取。但是，这个 robots 协议不是防火墙，也没有<span class=\"exturl\" data-url=\"aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTUlQkMlQkElRTUlODglQjYlRTYlODklQTclRTglQTElOEMlRTUlOEElOUIvNTUxODA2MzY/ZnJvbU1vZHVsZT1sZW1tYV9pbmxpbms=\">强制执行力</span>，搜索引擎完全可以忽视 robots.txt<span class=\"exturl\" data-url=\"aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTYlOTYlODclRTQlQkIlQjYlRTUlOEUlQkIvMTg5NzM5Nzg/ZnJvbU1vZHVsZT1sZW1tYV9pbmxpbms=\"> 文件去</span>抓取网页的<span class=\"exturl\" data-url=\"aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTUlQkYlQUIlRTclODUlQTcvMzI3MDM4P2Zyb21Nb2R1bGU9bGVtbWFfaW5saW5r\">快照</span><strong>。</strong> [5] 如果想单独定义搜索引擎的漫游器访问<span class=\"exturl\" data-url=\"aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTUlQUQlOTAlRTclOUIlQUUlRTUlQkQlOTUvNDcyODAyNj9mcm9tTW9kdWxlPWxlbW1hX2lubGluaw==\">子目录</span>时的行为，那么可以将自定的设置合并到<span class=\"exturl\" data-url=\"aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTYlQTAlQjklRTclOUIlQUUlRTUlQkQlOTUvNjA2MTMzMD9mcm9tTW9kdWxlPWxlbW1hX2lubGluaw==\">根目录</span>下的 robots.txt，或者使用 robots<span class=\"exturl\" data-url=\"aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTUlODUlODMlRTYlOTUlQjAlRTYlOEQlQUUvMTk0NjA5MD9mcm9tTW9kdWxlPWxlbW1hX2lubGluaw==\"> 元数据</span>（Metadata，又称元数据）。</p>\n<ul>\n<li>直接 /robots.txt</li>\n</ul>\n<h2 id=\"backup\"><a class=\"anchor\" href=\"#backup\">#</a> backup</h2>\n<h3 id=\"备份文件后缀名-2\"><a class=\"anchor\" href=\"#备份文件后缀名-2\">#</a> 备份文件后缀名：</h3>\n<ul>\n<li><code>.git</code></li>\n<li><code>.svn</code></li>\n<li><code>.swp</code></li>\n<li><code>.~</code></li>\n<li><code>.bak</code> ☆</li>\n<li><code>.bash_history</code></li>\n<li><code>.bkf</code></li>\n</ul>\n<h2 id=\"cookie\"><a class=\"anchor\" href=\"#cookie\">#</a> cookie</h2>\n<ul>\n<li>应用 / Application</li>\n<li>Cookies</li>\n<li>看 look-here</li>\n<li>response？</li>\n<li>网络 / Network</li>\n<li>重新加载</li>\n<li>点击 php, 看到 flag</li>\n</ul>\n<h2 id=\"disabled_button\"><a class=\"anchor\" href=\"#disabled_button\">#</a> disabled_button</h2>\n<ul>\n<li>F12，指针指过去，发现是 post</li>\n<li>右键，以 html 格式修改，删除 disable.</li>\n</ul>\n<h1 id=\"class-over\"><a class=\"anchor\" href=\"#class-over\">#</a> Class Over!</h1>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        },
        {
            "id": "https://enjundu.github.io/shudian/%E6%95%B0%E7%94%B5%E5%AE%9E%E9%AA%8C%E4%B8%89/",
            "url": "https://enjundu.github.io/shudian/%E6%95%B0%E7%94%B5%E5%AE%9E%E9%AA%8C%E4%B8%89/",
            "title": "数码管扫描点亮电路",
            "date_published": "2024-07-05T18:17:48.000Z",
            "content_html": "<div class=\"hbe hbe-container\" id=\"hexo-blog-encrypt\" data-wpm=\"Oh, this is an invalid password. Check and try again, please.\" data-whm=\"OOPS, these decrypted content may changed, but you can still have a look.\">\n  <script id=\"hbeData\" type=\"hbeData\" data-hmacdigest=\"25122584b1fc24b318a2b72598994387551056b5a959f2adb8b6ea7e0aa4eff6\">56e217ffdf260fcd20c20879edd7e57f5f5414d966c0642e8cbaa1edde36166bdde44dfb1dfe6ea7bbba451851bef7db4623160cf342c78f14e5dca9c94791ff10b4beefa4d2fe2d749320b2b47691579bbb5fb5cc55db76c34726b2d0efa3e2039cd1482a6df0f77df1ac610f59af8f654800c4cc1a0ac41c182b63ca67cb808480b58c45ad9b9f4305c25ed93867e7ebf67d000b698afd2d2fe29844cd492f1a222e1e4836bcbfcb86d71242b99570830ecf7ce4a92a360f8a484a1cc609ef1a6da9d9175049d8637dc345a389b0db5f5188822c8aca2ab0704928c044775af820c653d79ec7d161fdfea6a68cab83f95a89d396163ece1f20e5ed0651c4b4ede7b0bab531950a66a527d55f99c61e75042c1ae215e4cb9d3604d363b31a7b019370c313354d93b9d20cf8f71358c9a44ca30b396f2f25537d72a7da8e7d457c0999325a34afa748124ebc56988ed6b9bdebca5690fa6775c6e36c260879c345e6d18a99b69d9449c17f4fa4f063f51601e269818450e6251a061536f718bc19d7ff7094191cbae24c390cd9ea3a165d1bce569e01b50d9e16236af28b737fdedf808009d4807f34b47de0c09ad9379c3d6b072b836335effbc7ef0a56c6bba8333f335dc847b8a7836bc2e2e81166b55053f4fde6f0661a5338a0c4106ae1a0b975a6c0e8b2d6424aa2a8bd62bd81d1644f30001babc85035105a7ef2be8addcccc652405259088d10c69ef8370dc19261d5fb62f8efbef9decd1c0fa7993bb306636320ab8eaccc133c14469b5e0cb4256c206fd0bb4f81d16a4631568f05dc37eb322b3f0d88d72626c42d189f98974b4de4ac87ee0f6256e96fd183da0ef0ba5a94555fbaf14464580cafb7ca7036967c446c1c863c82f068ae16b030be34e1b931296c96812b7ce3db56014093e83ddc8462cadd0572d92f212ad57e9f4edcad8790d6d50d67d94d66deafedaa9ea52542507feac6cc25632329aa3e3297fa239c83cb27360b342f58b7319829561b404b3a218502e9efdb774882e9ae3cfd291c7a2ad661a89b2d4fdc4a574fbf909dc71962625bd7794ff5fdc965937777895ad7eb21d1769e0b28e2937d7975f6343ff4afa9aeaec61c4cad04a44b7d8bd01524821d5437ba873a9d13f72ad75a81b217fddb47384e52fe27394f7ce20b1fdd3ea4de69f2eae58b7146a8e19c757bd9523f8622d59bf2a500215e3f9fc8bbcda60275474d0e0d5e51de0c5e9408de58a3b5ffbbfe77718738a83e883ac81fbccf69ec33249a34ac54ea234ffdc937654a1886d5807619ea3336c61a9888e763cffe49ba70dc40840ba3c8adf4649fe51ea70e4a737bc45c7af4eb99430be45e785f6a61b739912b2c5cde87e198ddaa8e36dd996682c1d757f38ce4c353d93cde72fea24103ba3968a3837ab2f54d7408a809d4d771c0bcdb72e116252221b7ea509c57ba8ef7d7097a7eef6708abc1da4153d9759069a1c784e4cb011ca761d65783f6c2be8e29190478136f961c03dc2a07747ac108d31aa0e2f704a95087573c672f175454f0139094f760fd5ec6cda5342f13e570ff0807c9ffbbe3fe3234bdb990d0c0370f051b4c6b1803450befcb618efe8f513d860a64e00342815e9207fec3012320d5087f9e21ac0db1e7b847e16066e5be8e0efb5400d1672c9c011fd64b8b98f95d8a0e62f7d9008ef93a28a9dad79fdc05f7bddf6af202bae8c90020c571561f82a258008f43f6be19274a85b6e2a41d115366ccefde41238e6ef75b31148b1429b85c7797219d80e6ba3eef572708b5475feb98791ce3afdf5734aa514c53bebf6358b2c8d8b4bb78defe5c3545f9a18bea9525d13df95adc3aceebf65c2a6be53f3d89b92ad9e7793425a8246f4bef8f9028b07cd4c54c17b2fc4646510a34a14d0421906e01ea9cc4d94c6a5aef54c4e484f00e119b7ff72f6e61aaf8ae39a5dd1df90c172c9761d68aac5c2124bafcdd18ca0234da1b3422beba242329a2b709239d68b1293f3a7ff234a2136eeadbb0b0f8842ad4ed40f6e5617939406847bb542a76591814305b76e55ed39b58ff7e543835b6d75d7654e47d544a00b22e63bf7068d74884582cadf47a2526dac9cae4d3ad3e0c39a4bed75e07951a4b5a21a442264e0a7a41d01b9d5c7a51c9e458402b493fdce8f7a100f4317831dbd4fc2932abd0a9ef8048edd64c422e82566de842ec665ea177fd35c569b2ec62ecc3c7c0ee707a51484fa971762f8c43160a590185622418a98dae9581e5f3a13ae252521491db1e57fdb1b1894e0b43d12a63d794315441fe2378ae40b3cd37df7d6ccddab9c79bb48f76d68192e164dbd6ce3c2e28f7f3a556166a8a5f09f42452660e3f7efd9b599a485e032902a53233cff5c9a8495768fcd6c25de3aef54570b0df1389d197ad4ade9521f82a8a6cfc1d5c22144f53917d27055c57aa34c0bc8aacb0d6bf260798a38a97ef7e8b18ca71125a88afb91f614a2945708da735513fd139f459bf39da05eeb55b166e414e71b104eef16f54d00c85745eeddc44b419af315ae420fefcfbf64be3843db4995ccc528cf4b3b97ddb2f2bceff67208113a95124646479351e150c803e40b274cb87dabd3afcf9be5b60537c9376e1f6a22b9eb2c146227feae9b1663f51dfa3142b9356e8a797467a479014a7e703b0665a215db920a8c3d8f53ea3d0c840b756d835b0e619002c57c90085c5c9d4910d6a0243f1df84f723e80c7dfc5180929a6be5fe4ea109aa94edf9d28f05df7ab3c01e30df894cbab0b5f8d186421861912eefd940af832b6a15781c22044d5a3dc620714874048c9b531621fb179795028e2f940c14d5b6507c7701b3247b95853e07cc8e6505787692f7677aa7220db37046dabbad6886c97baa8c5a0610b0fec8bb5df35d18b3a8032a007c17e504af5312af00e18a39c08359d0ae63543e871b70ae1c0d2a32088484a39fdfd3cce88460e564db932a019d7b2b8ce97869263ae512615db50c260c3a0aee1c14acb0ae70dc8276e68f8e5d02a6f60ddb3e1f6a0167b2e37994433f3d3dc88afb99eb626e410ed0217368d5a94c0d6d06b6b002afd61f4bd0d9de3542e7c609e35eba94731dce32d3b6b407be4f47395300f160b81512f21ee19d4868483564a91f7c6cc6f283cb4b15fa31a911d8fe4d0197e38e2f7d7ba9504ffdd488e446b4b0b2e18a909cf0d72ce1e5cfdf6f476c13748df922827cb06c25a61300e9fe9ee38d0d14cd6bf9df3fcc5adc4e34d7008537571b42cad725df2ea76f4e630723df74e8a9a4a141330c18e391170aab5b50b1887b789497b402b784cd07f6d8c4d72cda9d77aa2b1337895ac07e3802823a271c0836d75bdfab56c02252a3b6a2ea6821464d403e6a20c471807f4a67d9389c5535f484f5c81cb74c5ee382cf451e4251a6d3cf034304ff85aeed3a00741f9d9a09dbf39a78710f0774e9938900c8ed899b1f8c349659ea907247bdb9b4012fee0f63cef79aaa29365d8f5fd2a86419dfa44cbd5a3da132e0c02439bb008a503a755f8c078839812037dd9d0a7dbb1642ffc8cac008a08cb2aabd718e6cb3f7ffc9f33948630472d521c47d6f68cf3c39a861b3879d78f8a532bbc1cf4826e498ecfe6c8722c57c03936dddb083045dc413121a4d6e107c49abad97a3b064240fc15738a14338018345f99169f26d6639b8e83710dd40a0452d19962980d10b5a13b832de5f5c6a14027483db8c4fb193fda531a43ef29d863a78ef179339fee608811be0b111e1f5e466134555b8ae70ff0f11dca9bbfc8ae86a271ef8ffe81c235fd3f8c12d8b4d8d4337f116c46c0f57992b6a778dbfbce36cec2b825bc4a064aa0af85fe660f9330f27d5a71ba9da77b379e2599d322344a6af1b36575b85c461a17b87277b49d6b1b438439dfc24f2cbbbb99235a8062b7418b4931c3ad85f5ec3c298462c4dc4e88259a1514d43d901d6f21de837be65a5eb863aec1137376b8aea2c1ce7ae15784e013b18d1cbaecddf838834b845c456d00b2542e5df9099acfb277753df635b53290eaabbb49d1c12b3857f2d0e1c6b26db4c422a3fd3e4adf9b149c2e7f2e625f328eaac934839190ea038f497a4979618fc97732d6afbaabd28aef7746202c2e959237eeb156748fa9547ec5090cca619a8085c80d5d83d0c15c7b5f685668371455f886378f8c7730be011d0ecdfedba0fa4e8ac12993b6432bf2e3224329df73030bc90fe8773aa6f45937327dd86bcb244e0a1f68fbab915bf2abc0e0eaa343b56de6ce240208bd1137379ea5bb5bd4848ccc0911ad44497627cd4089839323452f7df85f02ec420c5f6b1d85feb490886e44b032b9b27dfa86c3d748b0ecf305e3eefabc9de15f551bf0f1d233f299ec4f9efd262bd5b81a1c9e827c00c2bf549043e7965ca0b62802d55cdb11677bf8ab7707eddaae91fbce2deecb19e041147796e33650818bafcdac4eae12f5d6c1420b231ffe4cc62c6cf19349b4a45daf5ee37196c55bb2474c0f1b9a38c05c5f7a3c08c32bf79f80a8b57bdca3b17e39adb1249de0dee16084555141aa9864231ae33cad06041662cae7efee576bad94f9b483487500edc5bc94fd1fc40a28d601f3b95d00b3559ba3c249b6936412eb44cb51fb4c1b1af05ee5e4f917bc30c0bde3cb38cc57975cb5b5f0e9c4146c7bb9463f273b0a22d82bcb8318621df76216567b8438e029c5483df7b7fa32411f9f3247bc8a8e928be2af6143fe54d1c0ac7f972c8ea5277c15eb9422fe6d7702942c55110aceb72249c5ee8e326e933935eb8262feb99648daba6f5fbadefbb6432e2a8159b477e36d88d91713dbe7e2f3964e6ee4f83cb6cd4f137da85a801499d5fd762b90fb06bd5ef341f177c05eb4c9d70e3e3ca0f42df20950afa324a4f901ab282f2fc80a7cb9c1e672319a1849fcbb8391c64eb76dbdfb7efb0863e4659e6a7a340ed9ffe22bbbe29b831df18cea407480c78d29f867b1e24df93bd00207dbe256442879f23cb19e98ea465ee261be29989f43202927844be0b56ffae5f3b0de2d199296cec774e03db596494e7e75b644292b94c5afa435458c8737cea9088ddc727acfdfffffac623373a004e7f53d178d46a0022581b70612d4cc046889a3ac1088f026bcb98e2e436d16b400327b20c3b388b473d8aae9c88279c8b854b1a09fb6a38d5c2928c95305b6b5b5af70d1c1657dcd4cca72d05ae80b369529a53be9b5d2f5ec1889ccc92a3955d66068a55ea952ad0a604fda5a3d4ed48d009440d24e4a69e6bd48e02c482a0cce616f5214be0b8926ae1a5d4736944902c6af28c762bce61cfa3d37ad7fa8c759902bbf1ce5c31bdc05b62a3b797d6127994709d518ddd9ed7152acdc45880d6f28a401c61750c38bd7df6bff90f357488bd205eb71a3c0499f21d0612dff7322e0d809dfa89aeb9868819fbcf9ad8fc4133bfef15729752ce021142f150b0d435c35fffd2bdd10c497cf3d5040bf286b258f7e0f42d84a22590724ad44428b7edff88166ad37ecb446a21a0ca563c5dccbfb0f8282e34d2c9a10a94e7ec011e3d977cbbfc3a679b130d606f77b717f24dab84364bc394b41184942f35610bdd7550589c7c394637946d2aef0fc764bb1f626afeab766b6c7764cb5c360b9c458730a760ae873c2557de86a28c1e996d5e2805045a8fd5a583c0cc4c79824ec9f57427d082e8428a4e836f434b1f765892baebd78a37c3f995114742d6d86347207892feafffb64eff6fb2e315867783cba4f62fe4f3f6fcf17e04cee12c30c5c2022ccb82f208f5df18804c3461cf2969bf07374d562558bbd7cccbf1f9c4d7cdcd681ef36aa766e8a1d13bfd03e56ce8176e181db4acda802ca2fea0fd7529404bbac29cbd5c36b53425c7686caf23e745abaf8e05b26e264113275853d3850154e2cf89ce1bf406d8b3550dcae066e47eb6d719e7efedc6575dcac140d6ba5f266fc0b610cd446a2b01858f55b1d703165cb6a075ab491703ecc85da8d4dd8130300e7f4f9a8b53a2a70d5f3a88fc66a33e5a3d060fbb1d2d91428ecaee9f6e424e87e813e203a61477e2e6b8b4ef798b1fa0902070ba2ebcc52f47db7258842ce8e759e0a2048da8533fb9ddaec286344726ae3b8b068662b1b1dd22e0a28bbcf7a747d4891d39b9ae84250bdddbb76f4c2a70ba7a33b07a4ac82948bc5ec850f244ddd8e7e75e2027da2f6054dee0ee550123ffca213b508a197056696b4336427bffa0bad0b57fd4753282279f24712ad6140ecfae0dc5a66ae485ccdeaafe51012c90b5afe335563cf0a5c0fae4fac04924debb68a1f0213e402dd05bf368dbe6c626e5ad76d2d232511217d19d6bf57408330399c8a664d87128f14a5a4a0e3a4f0784c560ac0010abf2aaf3e04eb93bbf0cc8d7ddda3facf6a19a92286113fd48047c98312d2ab9045abb814a2a203ea4aeb8f15ceb5e9257fd5f4a61cf65f4b9183e9e67a39d3628ca403bf08941e2b517a87e3173949bd567bd9ab7c068fff1f946b86a7aaf0bb26f7740e6f62006baa65730f8a94a79e2855d8aaf06f2fbf9ab2038fcc5bbca28f6a59d979482a21a687c9ce6fc9132f2abecd9222615188ad71e2fd605c1536fe99cd7c3e0a4642f7e352778f5fd4bb47c7ae0a9b222eb654aa0b7afc08acdb89ce838e50129d2c1b11149f05ad3893a1b630a8b21dfd3cdf70b317262933f9189ec69e0f5f4973fac8bebd6d69ecdf0be9eaeddb87354794b98c6f3d75a3a22715a481a3b3cd1db894251592625830df2559fdee65956ac543e9d4e1f343461e38247e97cb8a699c2a054d15548decb38775d9cff857d83ce71ca9529375ebd5b1f61e10183df6b41a82b1db6d7c7dfb383ddf4becb43bac4240ac3ed4526c48792e5d72b48e90e65bd5a5e3731a632f3afe820e884d03c5bc2ce5bdedd3bb84860ff8ae0067d076923a04f75744250fb0834d497d0e29e67c3966fe70e88082b3ac43bcd565a750424a915d6d6854ccf97720709e65c53c77c945f66d56ae0a1e0a84d652a39741c63890760f847f56fadf5349f5ae3854dcb1b743de1e484d033530125b40cf3ec48e21d91fa35a24b9a8cebdf22a4f292bfc94e6ed60f74ebaf7fdfa62e3b430b60dc2477ee75288a0f0a9740b7f33af99a45794137a6d2598e109f5643ec79d9501fd8b658598ff4dcd7271b1b50ca579a342bed4474b3e5f67d8a8455b6ee003c4cc47527c2eb4718eaf65267a8b44a58804d0273ba14fd6818f9c85aee7ce7961124b24d17f361b4931a03db2ee72f659e3882c82d8fbf23a43e5bb168433720335b6f657bd07ef0000f5d9a25ee2d256f7e2c9bc1f60afbac6be652100bb96346109289c9aeb8d2f049b3b0164503e3be475a1de6573293440752dab803846dffe013ac30ff7cfb6fba29f5fd8c043ed72fc17ce03ea8f680f5a7fffc2930577718ba6243aa03c97dbb288248143526f2216a05e2f6c855ea9656282b13811142a23df15b6abf4478d4290d983464a37dc9c91bbea3988909b961222944836f48de93e43c106f42462694feb44657b81d111dd2509f2b485008c6de3362b3e5c48b1b76d74cb6aa40cdc96e36e54eeb09c731ac38f8c6a46802656024713b3c7c45241a184269ecac90c8629fcbbf54aeeb3f84f45832ad7a0708a4feac5fb1a19f84c62b0d4e099d937b5d7885cefd51ca1bb194e0937e0e9fa1a01d5aa1c89e3b0a055acfe25c82312ad836369496f761df6a800302b519522940cd153ed56c64450b6eed0e4cce890ddddd823c2a4737db52131c3b6f59f4842301a5552bb1675cbc67cdd0297ac0f41f636c22f3c872aebab7a9864a8016df24b87ec15c7c193c66f73e0e2cbb84ca018aac076de9b37c8e6d443e435e1b6c48efa4bb0d254ad89658405d147215b6905c199d865fc1b8cb41e0bb51c995ad98971bc9c96813cd8862150ff47d6b73f4ac2146eb88e21ab80c8b6dcb867aaa7466773eb288a18a375afbfe8cba467577b49ce75d72c46d7e8df00b0a912dab854b713b02d19b49a566e70966463656bef18f5743bfc353eeab67703d3346ffee9895c279182beeb19929a087bb22216b2abeb38ca15d2a64bde329e5e5e594707295b9b68b6745ece11a0752e60b2a800e51c4b438c5f0261124e824a413f67a708bbbb1f1beb3ef6bb6585b7797e17fe420850fa88eb44c80318428ba965a64f98207d5af604da5aceb6d0efd91b9d1f9cd3575a9c74d2fee8aa66a8413cfb0184ad9397afc1af73f1325316c039182d1f81b4f57899a2e56f82357f353fed90ab82e9cbb42f74dc93ba013307a9853647d5cc36c33277eb928cebd94ba1167c79218387c59d1483278ca9b9b08988c6e94ac2b3bd4375c10de88dc831b30e1d7b400e9152a03087b1c74c5127228f82cc072d027443300be187b1d6cc2526dd25543d843a15d2177f84ee3a75a971c0365f18410c7fb57d7b12c696f1d37abff89d26b04bd9a9d6df8aca2dc5e5f8226bb8b1e1dc4d3b46802a1371d633e6a180f2798758442f9fb24146b41d4f49433a121ba514592e9c3cd8bc253f672acf9c86360204557197838f821c40c828fe1dd71260346625b441c928d4f7c20cb6527d372611f8a09c60d238439af7cf38b1f9576aadcab3db72768ad85299d0b530275ce62d1c01c33fb34e20b3dc6372a44d3041a48056b8d11941c6280e39caf5d12aa0287f80dc26627bbd2667002fda2f325242c301438e79c34bf86d3429f7593385f03f61f084f520c88eaec25938f84e807fd5ad31a57ada8c6fe0e5c23a34a58dc9a038d4bee65a1d10f023cf8c60f67784ad5e05ffb8327d57003e49cbc0df2c4cce631286e66956a58b5b08d4e34cdda9f42b2a9c93f23493cff936eaa08d88c94b88f2e5a6e08284ab6d7560f836c2d3de8f445c9daf399683b74e56adbffee1f366f53d4944c77a21fb3ba4321b3256eeec4d81dc5e5424fb3f5e729368c89e6604859ea9de47ce595c375b20dd17503c3971d6492321729494b403c67d3ccc6fb6e21a7539600c061c4f5de3b5916f50dd983090fad9b6934b60e07b2548e5a96dde2705f8270a9cfa2a036818b18b79f4cf1206336034d78307e8783ce2c759d72a27c6c73d39b14372b5ec4cf4ff40976bb158e384960c6b40d34b8ec86087ed46b6c04cf95dc676c71c20059f217ea5166dacc33969ef69fb87d987cc397af2b2996f35abf30de1b8dc2286476839bf7c19e18ab56799fbe7f94d3d87f7a3b40b4127155359aa53d869c598e07576b80eb37e80710e385a719fa9ae284b3633b07acbac790da80412b0f1c5532898420c4eb314519e0648dda578b92e17cf51e953b89f869b880663dd1ab918b004707184fc2a401980c4c8243dfe4088f3957213e29845928cff7558ace69c82c69efaccd859388386a4dbd1b5faed38442076517169ff6bf128b3c848c6d7a8a41fb864b4c42621a601c78abc369398e481e7b18421d91d28d3975f845d293182f68fa57802381634bc0fec38784ee82bc619a755f1273ff5f1eedd32003560860c45e3d3bd4783b67739a95222c2c686cabcc1e2e07cea37b11986e62252767f5e8d74b8160a30dd6f618dca03d298c24673578ef7a03b055b2477e53db9522009851175dd210586ab12f5f7a5d6409f79c31a78d434d6553e60f708430838766cf8be60d57bc98df889e897d37918d7a46384ce913b2365c69ae2022d54e30bb92870e94bd5b40540386a3f2386702ec8e421fab3c9b65d29969ded7c22b4e88a63e1a53f3012aed2fb013fc183347aff472f366ce50a3dfdb7d700df3c42d543e96231e74faa39f588be43b7da37882ba70ee1e4d3afd38ef3735534026ee9fa1e0f2d2e67f5663e7b063832cb16825724b785cc53a84604e61d5f0e2f4c82bf5a57c9e535e2a01a136c6366469f89df40c59b25e2114dc3d92b08895292d3178d2bab3a25621b109241963894cb5ebf86aa8d4fa9febad5d7ebbdad0ac9445063cd85bc2181812fc9659755ae1e1d90655ab57eb97b0ee7974138bd20a43683f9adf1ff9828743a4785f819c90d7b3130c1eb2917189a34fc7b9c55730c5da45f37afc4b439d839aabb6c5c6392f1ef091346d76d577d45c5017bace479e1285bb96b0233babf70ce79bd4f73ca6d5f428ff742b64538365301f2072a00529fa60d4834bd03311202705ff4c4b6ae989a9ae320488a5d8f9677b99b79920b1833655b85cd654386e59b46303c48274a09c8aa98a7ee317e907669df22837fbf8d32fd77b362e6931d56086610a2fa49fe68e899e784f2902be65e0a4224b0cb6eccb45260672efa1c9b352345260aabefbb11bc7148787552ea42c21886c4e82a2c10a4fdc17a7bc4097c4edc2e95b290589b7d92b9c815527581fa30579a5a8dd12cf07b4aa300a981459357e44c293060a3e29e96c6129bdba26217e4c9003c34c404f4b9f922c5d4350814f9e46bcb2008f7a26030526626ead0b6ef0db69f927e4031c78f7e220c2f8df23f55de5c206aecc375c21b41fc7dfd3614d647f91a321c1b389116ac57f545f808dbc37d6ce2c2c75956ed09b24d505c1f3d2646979d5b06b5d392817721515f0359d076beb90877bb8cfe3ef637deacc5d1830d89af6a14b198062eb366bbc299e654a28672d6f9f9fcf8321217df88b0746312f9d8069277da8a9f06870eeb9a4c0b498e4b36c35c8bed7f928562d1a9c0c2a12b9197e23b47a57788cd240848b5abb3c41e8aaec82ad038090ed04607456bedb17b1063e81a8c580830907a610061c617ffb83defc38628b604ea4833a47e13f17e7725c05384ead7a0b47b4e696cf0010cad9352c444a386a155493ffa53ecf58fd1aa7fd151550bc7c79a1f2de868ee1cda9c0a1341bd763409a9de1d4bbd00e70e7388519ef659b39ccfa1334c329a7fc124358557def3ede77d1258058f936e63dd5926dc3edaffbeca370e0d75bf7fc52e69a3cb8bf78895b07930c2b9a5b7a9b51fd1240eb68a8a71dac53e5e7d17bc5a28959e2d13300be9179101c5bdc87baded6d7e3ef932d7104dd6af536dfb87138e906d64b0eea5b99541dbe421e434da01ed9c2b07ef465474995a98d3c1744b272ebc586685f166688fa1ab5ad2c4921191e81cd502b1a2c36725f85cb479bfc6f379249ef56208c1e1b213603d055371eeea814feb3f75048addf98eb8d1ec51961e9179a359c75b4b0ace5f73944f68d3d6653dc854c85aa6e4e48a156630004972bb60541a781fb81efd32d7d990d87360781b843f1a786ccef657c9575c8e4df2c6344db7e6ee7806e6029fb9ac7ba8e59a535f34b7ca591b28359192b5549bdb45318864c73707324fbbe673c6234bf3f236ff961e319f15c86ad0067aa0f9dc658ad2c98378147db703af5e3490b17b1c8ca42c73c0bd3aa8767ca1712e71b506b3ac60178decbc695589e2f38b989323398e81208e8662818a2f109c0322dfda1c708142adbcaf7a481f72aee1a3c73ccb4db5a2f5ef063f98aefb20235727b4398502ce42d36e749a53fe625f7a3701a1eabdf2aee4d7fb16918737d48f43a2e79c21ff12641b30f77b8e7675e9e19d6e7cc8e3205773b4078ee64bf5c831bab85d61d6c69d8c52927e940546245a5ffce18116c9f771a83eed84b24f11ff29d8845225d7f427022559f71198563553a7467fadf228932e91a593134c3f3b18f254d9517273b90149c132236f1d750c8b0ecb14ff659b3ea85d40bafb9f9d43756a7a79acd5a9b2d0ab3cd25bbb9b5d576ba992498b63ddd1829e4cd5477ea61e17e77d6a433f5a0173fa0e74659a81c765cc56dee75a5602a7a9e2c66201f301da6fe7653db4bcf4a52b525b1cc76b2d02304feecd099f64fbc583570be07c2b145f4d12db325204a633d7abee6304d42f1b6a689cd299ec5955c0fb0d2136f6815f18da3391d1826c188fd68b6cc4dd587f40b8d94247c0ccfe53866f77c1ae90d13556d3e11481529f526b67c98c1aefbde5dd4bf33c10b7e54230872c7f92f1e70421fd9832cb61c70af4188fe369c249e10f49d2f444c38635b0496d0eef4bed81b80538f5323f117eb29e0ef295a6c4b13b6521c6b0b0443107ebd624d8f21156c4c02241aa7a0f8b33ba085849d64c2d7db474230525649ba04da7d707b1b05986d853ebe2136a2858b75cdc7bb016c586bd3372fd173d98e9d32f49668041f6a9283b8e50119d77f2202539bc17e7ede259171b289a96642ff929ad6842b65916e085d55e33cffdde1b870fea3173446b113798291917943b0f8edeb9cc7d4ce699209e8b103c01147178f5655fa53d6d8747f02b48f93e41099f9324a3914fff96c1bbc8fa67634010019f498366e82e5d7b7189cad5f54027f5165c464ef37bc87de6b2001b005a5bfa3176a8aff9bbb4a256ecaa271163709f653c73bcbf70fc0154a626321d6ebfd186e3f2a4a494de9c4b788fc6a1096909041e54c7126c1908391b8be267934f6cffd01bf69de611902e5a8bc813e1cd821971ad8a913c1ac8b96766626a7ef7b709fcae08e769e6dca34594a997299e90d8496ef8bee20adac25b8728812206c912abd425b200c8e02947a977e4187668be20efabdc856256225f0eccec3f2367c9b9a03dc0f9acd10b34c8f38ace1f4436e3ea1f7def69c18d29e3a83f2dd769ea1b6ebf626f658e80c02395201629705ccace1c954973ffd996062d8f05c41e857fb86e508f04c3d795c0552522ba7e9bbbef86694aa055ee89b595645ffd7d5df045febdd341b9d2d35109d5494686ca792f75c76dfd826ab12d28cbf58ffb4cbf15609fa87823f567de7696d2b58432702275a382fc9fb57e183a6bc40b2dd1b505864933f114a150667d71312a2cfcf75b5f0c128abb4205e971f516d4cbff7f6ff5bdb8bcee8fe0371624c3fb6137b66153c9458e72e0dcca985669379603ea40f69fd498dc02ee64010837bb898ded26d018728578d750bfdc02f863d7c0fd8adff377b09dd92f4ae81a5a4eae15de569f0beab38fb1e6097ac82ac068f8427f247e179e3bbcbed4c988f1189202687fbde2ab84747471d8023e86e42eff8983f41fb7644db524abae31cb93804f16d1712191e0599914e79e1b2c3c71a6ece2c09c496364ce1965bc72f38647dbee515c28ae01d4a0dcff0157a32f96f7cbf53f423de765234103d9610f1db7323e2ea574ceed7033bcb932cdd751137e74f5856dfba81644c33d0a9018a90e471fd2eeb01d3245fab076d2bb2d8c9507ae13b7abd06b11201d7b7eb021d3bbe7b760878831e673a24bee5d1d8a67335674b9e1f9a700b607cb09e29ecf1bed5da5d183246e4a6c061254ae57bde95311032b33ed2869a61e90a2ca3a50ef64bfe8433ac67736f36c671033e0e93aad5829d6dab0a0bc5de831c588553904e906bc25665e4df6c5a9fc3d2117cd676a4929a7d1bcbeb5e1c81cc786f452f420ce0dc5eafea3185978b7004c8724676a9ad4f8c719745dba13ec74bdfd6abdf545cd2b6fd4a5296fc76bae2591c6bab989ca43a882c8720bc641a84710446b31b204e971b9f7ad3a0971e46e5d545370db638608735118ac5db7409538e3aeafd14297539f468f9e17d732ee88cbe2e495db19eee0c9cb9db538533effc81480bea5c272b4a1a1ea8b517187ef61c974fceb0755c4b31f8b0645861e4f7be45fb0eb07bacbaec91ab2d45bfe0a271f25d0f091cd94ccbdc066b403109efca93f0b5ae1f1988e089498d9840f0b7e255062cbe80d5dc915887d234c0e0cc1710068e7f345ad6bd689c0e587bb4bc67e55b34d6ec7f08d940e35d749828aac16fdb857849df7e9a5198c12d895593b40e6d727fd12f93620b9ec4e20d56e4a348146bbd815111b8620d5b9cb20c467435b06e37f2f39a319ea0545b7995b85bacbec7d8cd6a51c76cd9f23ca56cdcfbf0c2b41f0386cceed184043cae05113164f6f1460ea2b81349d914d4303d748b81ac644cdb3b669a4ce051acef6f4454ebfca42851b0fc145a68048a1bfa53274bdf974603960708d109fc9b2935d184d5513af658d85c012540c52b9c97595aa8b52218ffd3b9a2924593c956b8ed58955010de4fdc3c111261b77cee4bba02c8901e44e3b7033e6f4964efb72ca740b43b794832e2bd9abe15900c1f4a88042e9ea792afefd5c5095b26b085808b7616a9ab0f2b4d89ecea8e81e7aaddd88ff5d489f55f5c4aa302c57ef085d7ef6c6bcdb392a8374c8c0c68770f004624e1d74b887b57e9c90000d2f769e8209655193dbfb816b510fcfb9b66dfd301416261a5755a6075737acf46aa248e02704fdf6184345ad41a00f53910d9c63f5942ec640c648d78bbb29bfe2fc33e0e3211b787e419bf382ba43404dd1fa73ccc970a47b3dc7353986d5085de71bbcccd0800133b6850e64abadacfae106ad2154c2a5614dc237d2ffed9e994b2b80b7548250d1c9b404f77bf41c2e533e3249266ef65a9aaf91de371aa951044229da2a847f7bb2a800027f51ac5911bbf67f77b0931fcaba98ba8df569e82e7fd77bb6d556f9d40c9b11a014b699f46ce0e39643eee77d13c2bf860e2156f88960770f30087f215a89d813d4d91f21e151c34f53690dcf169e457c4240fc5fd1dde4240cab4bec054a77577d1529c08e367e9abed79b25612b71bda22cb47e93c6dba9cf31d220cdbd295dec526f5b38948b4de84cc2b759c57eefa1fcd43960cc8f571e757b704ee3e33c1312b1d97095cf265cbd4dc9b8f65d19c557471b0c6f5109c34cad18dc2498289a3bc3d53acbe17598cd8249900218886500f96a6f947f707c17ac80c7725f594900b17707f2a909985cf3ee987a3cbeace946fb7bc292aba6d723cf2e9a67ebe3308f6d14fdff810dc0f47f6881702b431235f5a3dea7d56b0278c0e270a1f9fa72d9358ac310979309b5bb221edfdd29ba4d26ce2d5bbc989bf86d824fd4669ada439592d6d8d4dcf308d306cc99a184162070f0f9b84e025f14c48d7df2516244e8738297fab916c9e413b836a2595070abf08be1b1ad726ccc3c53b7d0292ff532d8692c823aa52ecb43c25891f1a28dd7ac0fc70021e727ab0a8938b4d32ff84cdc0b8ad9f1bca29a24af7a5d4928f882378848df475df6c12b91dbe2b3b92815afaaee7c234184eda96459f5aa4c195aa914c43dd7eee76e06026d5597d418bce13264ce4f9387603f884e7d8dd43826271b1fc3645eeebff4a31d8cf08410d58dc8917eaac7e5dffa04df6cc6e11b252fd29fbd1179b750d98129e9842f8b75715dbf520a562ce95ce5d831b8acd6194f55d8d273d936d39fbd23e847405ba3ccff6c0a91853bff11abe69db3c91a076eb680d297a8659f8d2446473da543dd3aa84cd58503e7ec5332a0a90cd92f7be9135e8e3b0915172bc8ec47dcddff9fe75203816ce1a25567b5829c03493e228a63eac2bc0144cfdb0c80d362aec833d2395c02bf695813a61fbe384bcc681901140a29c01591a6f0c27be4be83d2267e1328e6868d1cd642e206333042f5fcffbb2145212675dfdbf75532c4439123dc406c2494d9011f4c2cc3829e1247eddd324911b1438019a7012172ae5057a3e295b47cb2843222a559aded775ce0b9af7792dc5b6a8b03abbac47ce3fa07bcb07c0245100bb40b6b5da5224d069dd242f47f97edbf95bd612d1100e008681d32d8efc7a3e60133f12ba6730a517b61ea16fd53bef350ab49fdfe652968e5d7925e1af845fc2c1dcab0abbc5d946c1c0ebeee68d22e73606c8042eacf2e463cedbe261672b187378399171976a0dde3ac960359b7ad82fcae494730c54767146f65402f02aed61e898f83d8a7d7511dd9b71d9fe7b279940254d6c763e15100478cb58020cb3a9a411aff90752696763b4ad0ea46289ea60971a5927c98fa70295a3aa1f113654690233be0fd5dc973f6c1ade8646ba51d7a18ff317c64822d29bd0957362f895564bccd2e73662c6ee979911b8f7de08aa6f345bd49f60033489a82c92b415f92afc79e9ae2e67f1fa1de308634f473442e73a58b138095d5c13d1121d2b4da61b9cb7121d04fe298258b0d62dd88b24a18b927a4e523f29fff153124a399d07495ebd03bfa468d5ef517d046eb972402a9f587f6de6b52fd722a62200e310067bb8080f5286cfea35e832a68f31702398430020f3cbb5869075ffcf4e3dc48f75e49319b5967303d009f1b08523a1e91cd0cf7406fd3aaac9c7bea8fddf8843a04dac868f2ad41c4f6bf69445658d07f7773d02229efa0a1e3a9bd62a19e435dc1656b25897e7c4a3158ddc9386e662320eaacf38ba69039f7e180a988058605490095fc9277e225c2dc3d2a117ade05f92fd3944d4aac8654a55265b6f847c29909c12a9f0e593f20ed02af52de99e677de62c23174ccf78337b1719adaf90135fb9f55951c19e286da5149088c16c8d0d3c497b9e1b920084833b50e6f2055a60fbc50f6280065f504f5bd3a018881063a22e11373ad5373fe6047c53a3b0972ae60209ae224ec234635e1506bca5ccc854ddd6c6fef67744d77daa16451643c5acee44b09d8d03e7e4bc5af398626b4309d80bce5734eeaacce5ceb1b0c90740b01be7afe6f1431a24ccca8b28ccd77f26ee75ad2cbbdef79b132e22cb45725efccf8d49b2446a08d8b7851412cac7eeafc3c1b96188f8a2b355ae7c29432a66e181ef0d5eb2b00021d4a7eed9345409d5b23ac62a927ae37e0da7c85740df2980f0f2ce2b4913715e9ae70f4caf883f08403f8ac79c2521c604dc643c18aa68952d183d14cd172fef8a8616ab4f7fdec9c4165211eca1cfaaf5af16fa5359ff10e1532aff76bbf9dc0851d792b988e7c3e6e9788b5f32f2aba54bf9ee4fc9f4b5a23ea5bbca5e16c275c7de90254cd83d7df4a36a26b3f462cb13dc46389db5502d502c67209c268a0237134188de8d85d6dbd689dea706d637feabe5d6c1caae4abc6c824af5b0b7276867ea3b6d89f3f82c88fdf9523d6ab820c3ea6e9ff9393b960aa69f4441ef8aad3b380a015cd6367b37621ec77a813cac829b2234683c9b38ca95b1a7e1c39e09710a7daa6b21728f3a1b48a60a59637616e007dea794d321a2614596cb7b42ab3247f3612f9a136a3fa06f97315642bbc196dd26fb4458b333319d19a7f17a4004a2f378bc1b16fe6ca33040c8d950333f7aaa4177ae3ccf4af2175b81520de065983e1c50bad6ae2ab4cfe2479e226b8b18a21fed898b68368b86aa9c808e8c0fe7151b6c6c5fefcac8a230e1d87f7c80bb6cbf58d220c3221e6222fc69de605bc27b5579cde6fd5824001fc861374b96dff42db980c6af792e5cebfe9e1417c79a67ca976a82d1d4af054242f676448c3092554ab52afdd552df5c4a9442dcd5851fc4303febb8aa0964ea1e4dd985ec39b23224105b7689de58a37b9aa2ce2f71ba3f22bc28388bfac391caf262f084998a27227d1be45037505fe3b9ae641a3caffcc512f70c2d4b11b385b4a0279ba1d4b9892e5dfd883ca464df0734bede187f1e9b6d03ebc2ce8997ed09cf19996ed949fa847bd7b42d84d250c36f47af41d924e614ea1b6f91cceda313719a196b489ccf9c62e3ed1d8864cf3f726efa2a6b131b8d629b8664e36972e3499e5ece280a4523b4241fe23800c5c4db952c8d1522287eeec03d5af4dc432093f03c85a26b08b52601cb7f93abc7bafc6a78624e46eba0bdda1f0de7351d75b9c8e200f087a797fab05702386585e1adc9d9bea26bb4065feef50c7d3b7c57a285ac95c16974bc263865fa7d4144d1aaad734a2def698cbd4e87c7273226c1c28a9209d59b1dd7014ed0d322bc31aec366a790987bde586502635152f060cfe56ba8e4ffc682d4ad45a9ba48bea9136b71b573537192773d31334f29a989bb0174cd65039c9815d2356cdacebfb9b22e63509c4b722eb435efb90bf8156d9d80b03e613f25095c369cb90e8fc9a59683285ceb467a859ddd7647737602b4f70073eabc7b61533dc4ac7269bf5460f3d052124115f5a4561230e71d6bb360cea831a77b2c758727070605207bad1e983fc42acee9e5fc5bae7cd6acd12c9808e6c21e8c9459051b84edab7f732ae29494859ee2e7c715a6c2d6fcbe1c3fe2232af9aad7fc8c3d49a2820fc10421bead9c26ff71ba6629908eef56441581a0faaf60d3409119b8a013a48964b34876956a7db2cf582597b820997b9a95676350c47c8f9c1c0bd519439379cbef22b1faa04aa11c2655ad863814a077f5c52692a184667efbcfc78c16e5e05cdf9b344244b7712b466a09481c60f687762c87717619e73a4b24e398a14dc075d4eae683411b4e3c5aa0f92f0bea18b3a0bd663ed5c0d015b77dd686490df0503d3dc8eb67304e54e7792a8a4737fa0903b736e034307777c56107aa5277f7f6b8271b3d8837771b7993c7f7f4683c2d685fec5ffe87a743ade359ba5c517a19bb4ad60d7416deff93c6012d8364a1bb16ca5c29a8c624344c53e1a865d3bd525d6076ef143443b4ba03412e5b1edf7b2b3a4ebba3f4316a1356ea9d94f677c7c1471835a451f7b47ee690809a8faf2385e0c477a438d670f51c8aa1e016fa31c8f7d9029b1966727f1d89836a6e176c43df810550ffd00d93b731644816841aff600200ce4ad5ad0720405e1f43e89ca5ebae8ccbb231dd7ae2dd0b0757956ab4fbbadc9ac156dee54c7ea678c8a98971a6aaec945feb408008a2f915acfb68b0049dcb9a0e02f5ff8afc0d6d328ce27e343699c07c06d610a4ebc65d3375f75fc8c9b59c317c1c8dbccbb0f0b5f79be38dc0c29739975057c0329fafb9fa4c996e1dcb41eefeb7e49b2bc0c7515b2ce0da7a7e80fdcae9c4a6e9334890a738875501aeeed51758b712e8a80ca62a3e77576349a5242035933796c1f8ed0e00a99e82fc3486e8ce696cc6080bc9eeb5b43cceb927bfca9083c8ad4e37174c9482acbd103ff1d66ed9acc6e1b4a3b4ac77bc75b5302d28f3e41cffa0eec967b74057cb6acd3e78030db5ced2e47ef2b87dde90c5b2d23cafd4503a318516023f6ebdd21ffaccb4fedf91a7417a4b03593f9dd305c6fd15bb4ac0171ec7b153291fa1694a53edb283530780d7fe7b24901d377a86efd6399442fc5e0a0fec68667609b547ac818751352cc4dfcfaa2e213d4d53cd0c34d774e8e79e4da04def4587e48e3f39005516d7d5708ccf8aec1b1441b2fcc851daeb086410d40d77985bea0b926d01fd382d5781b73893c1f81da032f51f6ab4110d252e8bd3f604875bb9ccd9ee4539eabddece14e08005d6b9ea1c9340292913df2d97e2ff3345e6911f7b03ffc62989324514c7015f8abbc00e2d4fd38a2a516f447b8e5306c7c9eb0803e11449eaec8e20f8ae7b3bc2ed479a124f56522daacda2c908644ad0a7e8792cd14c621a397c3aa5bbe3cbd6ffcd639a66c70125370fe09d09eafa9d2f446d721ea20263bee52e990202b2f176dced9d7ada60e2afb72695855d09764cf1c37593a6e0cd04f975919a5665a44be19928449b775a3a0a4f372e23bd9e5f2b5fc71a3ac11d1b2bef751884b0c0e76ddd70373302c3de168eb3388da68d57e5500cea15f9312a443c92752c23c609136cf61939763c8a672beae77f8ac07fadfe55dd6fe5ec40cbcc8a0e3c50021a51f805e75ad4abaa46b06f75be3ddd01bf58fd8dcdd84750c9f4d67c5459be0db8bc0bcf8c8a7b227d3ccb894f3eaf134f877f448c2c64aece7c55860d949abb8bb7c3b0f9a7295f3616549faa2ff3986209eb63dc889981ad40ae97cd14181fff618033ecde2a7276c920efefe85e2eaa541e33019a516b649d9143a2c2b5df637eb21dc2e896f855d04a13f1e2aeb85ecb11ab81f05b74a9c3822c5fd9e6701aa49dd7a18fc36bb0a6d428e1dfb3cf0845c769bfb531c3132f2ec36df6d5c4275f85511ae616744cb1baa1e2ce76ed85f862eeea3673c47561f2d4c92786aa439a416743d38f7fbecedb80d58955f34bfed4245cf8e1cd18e60edff3d51748038f2aacc1223f94796527b9d71906528cc9b8943783e48b2680983c311488d32d51d3a38d089c5c01c64ef61434879ba0b11e73f7ade52acfc03e2ba26cfded1c0b5cea65e01595e9d2c7b0fc25311d4cd84959008fcfa9eb54bf3233f7a09e6dbd8f79414d151d56d79b2154a0bde0749338f16252bbadd095d2c8049fc072fa8ce03ff825d446f10d302f788514519f6dec1cb270c06149508dea56d040283bf4fe791697c89c6f9e1b93a105a3a2a36f7ec4646c689ac1bdb9f3a5d8b5efcab8e31645e428004953563c44a38f2158801535389e7f55de9b1de039adb2d12b39ce3058e20cb08b64d339d5a52509ca92c27cbacefcc456603033a5df48ee6bb50ae8eb0615406de2d3fd238cd7b2cc080d1e8433e33ecd9c9326c35705f9f388ccb006b432b0b0f70d1f7ec51b4baf98f8642923daa0439beecc1555be9b8a8ff0c6015bc89db088dcc81d046db0298a3e36e8bf1c8be5fb27952204c1a4e82377313d8b73ac6bda39317ec7972e990949e832f83ab0e91dab8d6c8a5529833df55e384ad80a6879ed4b089bde3b8fce4b6cdf0cf01d437198f1dab57624ce8643c117a19a7dbce4b846910bb2a4a90f0a45635f08d72ec49b3d6b02816da30be163e655766d986fd69680f80d4c897c77846ea67582d7df530b7e425edc65632e679e58155b0cf1c5e81d191a9e43941d05ba59d62bfbd1247b26893c854ccfcf3b674c523e2a9c9c4dc224de2345da43a079d20742bf5535707b64dbe3b7b3611a0dc1640d61df66ef15ccfcef46089bd1619bfce45c2f659add4c04271add5e6df98b1d91913b37d258f12014fd4648e0000aa28c664ffdfc69df5ba94ae58960ddf2ad75cccd19046074bf4c8530f2dae125a566e01d445e7a5641474f444bb6a5a72473f80a52e143528c981ba016da9243bbe59572ffcbbb91f45d8a2d68f8939ad18a6c066c1f5f359f46b09dcbc0d8549f9d0ffc7403b0a8fe934ecfb6a99ee5cdff8c87277c77b6ba9cef66e1e3e44419bf4629abc0aba60237c0b1613ff909f1bc9e772447bc6d5f17dc03afcc5ee107d1a6bd97df08029977e1af9c6313ab9649335ef0ae70f76747028f34a3136cac01cc934c7922fc79f42b3cd8e874118fb55598efc28be29a425f4e364c0806185d919e2b22fb1663462c1b760a12fe1c0edad348dad3bf34a7a5795677c8787ae42890c418fbf2d2876a2ec66244f373cafffea306e466d3ad4aee4f216a654b5105221a17b3b251ae449113562b055a2b24cd64b5442e83bfb0ad875ca18fb38dc528b3522088d9434eef806af03dedc96abd68565f9bc29b40e2065abab3dabaec38a2779f15aead5ccab030dba844865d9ff6a36582dd2f24430d6830ce84a88e36e06a72e32986caaaaaf50626091191b7657b8dfa2f596c610273461ed29d9d8d5bef6c5fcfa6eb15eb2dcf12ff0915c7b5a6fb523ecb6e00c905d737814d414c907e66d1ac66d3518e2a9c1fc4ac45c088a026f87ff8ef2ef77bec681f8ed90dff6430752453a6a15419857bb2e50d37e3b9a40fb68fa1d520391962e55fc573af2b790e92e7373df7e152fda3cf7995406c94c532ac07d4c7a06eddb026aa8e3b9ba690810e33c4cf369ececf751886388725d0340597dbbc77eb0da10bb7b724c260b8f2d7d12ecbcd17d481a480bb690e83706b1b8b269c0ebd175ae64b69e25fa2e7cae73648edc31cbc30fe623aee0285a0ed75613eb3ae67b6030e27ee24effce9d086dcfc755ac0cf57a74360179fe48d76ef39d61b78c46815c5328985bb85b7239c1149fd350022ad026d11e7b95639f6c8961839437b5cd28c1068958618b3381ca23ec5f350d7fe0d13fb1315b59fe17639fb1f4949f61328839bb3f20252a56d639546d0c9ce0ccdaced30f6e930e8bc954c9968662e6b73df7c6c9985cf165ee619a90157a5cab7ac0eb0ac60b48d297c38a177731741ca5d1f66ffc40dbaf48272f9927451b39b682165d6e3db382b1afa298d04233793c70ffb9d595492a8620774ae3a8ae25aff121bfeb50b0a42d79967ad75fa8f1adac0fb3ba1de6fb08d531266eadf1b74191fe4047c653946eaefd2146d1d1e399ee12f5cfc7843bae5da9faa8b38dbd4002b168fbd4ba03133f331231d399d5809217bc6430d802ab38bb65246bda0700c170f99d5d08e06d1bbcf283e29f0c2eb33498002252979b669facf98450906251b30f42b3a4e0caed28012e9673f0200dfdc4ae81689c5aa5a88c42276cd3109215d513d7a58e9cf1f80de6548f3446dc82604c7e43f2e1b472094fa988084ac0c1c230fc9c1eeaeb5c96c7bd6b284c7324523dfa4433714c5dd61ec29b6420030fe28f21795a8d6c3c394fa15e5e33664e4d5e8fad65d726ce62e7b8d8dda0905a607922f73764590945f7e21ae20c3c78129c024433c2915a073a67bba53d5cf2699dd344b5b7e88a3026337a94b50818deeb334880745379eeec4209ce8ba7c771fb0764ca1e27f5944735ff0873dfc846825f36d365459d631cfd88d563c379b7b390b46a3a6a9bf124106ca887db299fe3d017ce00a38b53328bcf4dd29d62b2df1df072a3e985f5fd55853ca8a7fa72d910e31085873d89516553e87c26dfeb38f1d11fc4557cfe8711512a3902af9ba7f7dfa47ba5228398ed52b6306dc970a8711ca4f130bd773b43c8178472093d3bd678fc355b259e41d1f92a382bfbded913630569403faa262861161742bcd0ec6ec9f4a9ebc1ec12cccef674a6cd3be104815467ab8683e3d04231c36487a301238a71c71265f4522fd6dc546e003b268109b40fada8dd54c209fe151dfbde98c6259c6e95eb9fef188f64f6cd37658f0a17961627ac4ec7d40bd733ca9b293d4c68c2cf7f3becb9baacf3cf7bce1ee116a9af728921028f3b1db9040be4a9e4e3511f7516e475e5855480e1115a2d72d2f3413f3777d13acfd62a2b3b8f412e8f7e1d510194668a35930bb29c66bb8f1e816cb000d16362d1edfdaeeda05ca3112ee78fce1982472a263a82ec268e8b071066f247853dae18e48e5a8ee892d169543ce7c4f7f085d9d0a1a9d7a9d10505ab4cc7e03fda4348532d45924ede9ea5fa55d11cfa356c69e76fa7c9e49615f597ab73bd9d0ab20538abed5cb220a51ef0813e40421ca29c656dcfad498327e08345eaff3ba04c06a098052015cb157f71ff80a008e8ebe179970fc20462f43e6aa6b32b6688a0f75bcd4c5cb4d6927ffb3f30c72e6736bb64a957182dfbcd0c9b38a4184cbb986a4cb0e9be4927eb6022957ae4b4bed89fcf96218f2694904555336c7ebaa1d9556a714b54e1e1dd31b7daf176739530bba1c606bc70299dbff572be3f0127a15cbd162593e1985f6391718ee31d0f8d244f0b598eb68b2f3a3aab0b1467694d8ac2d3e3062d8b2b344b239159923804f9878bd9400c9e03452bfb7c3c4b787a41f828209ecfc1af1dd1adf76c0db1bc2f2e0843d4254cce5cd73f7d34967ef0180448c074ce1211fe2307771b8fb91b5678ddbeaff7e323eda5a1405d3bfce61a37cea2915b473821f661f6792da26931e64f3e97453c7f8d83d388475ee2e7346a0ea30ac2896d345402aa154fbe434740a052ba9df1ee0f965b65b22e59133869163089cab9254bdf58611409467ee3b77c6915503362c007b06cd64ae6c2690d3e5131ddf637ea1042d04f88c38e72dbdf08e88c73759c30545ed7f6a18a623b32724445611d7912e827053be1fbe50e89df5624c894467b45d8bbef3e4b81e8e7a57040eaf92f950ed1a082515def23969c40e571e7b0cf7b822c2f836261577932d15ce290103f692bcc623a0a95b27908e98ad06ede7ee87036cd3762195c69489d4d7b7bedad66c308b37e3dcababc39d3c4139b2a06b9649677afa6bf0e3308b85f9013c5837b467eb97403da709c12078ace157c2d0d34291e9e50a5d4dc470425fe647286ab60a0a41f387f0909c91c562fa1bd5ff56c7c07158a1bd700a79fa8579911d18fb491c70aedb62e3a55a793f57269ececab096fc94c39ef015ceb53b18210033582d5c341b0de1827806f816fda16e309306f9194d9920f4c299a49c68f412f5ad43f378c5e4d4394d6238473a46609133cf69a43c2115bf358172028285127f7adfd07b6fa3af7d4028cfbc0d0ffe78baeecd6f69762430a3b3f115b0e6e56d35730515aa8d6110ffaf8fe2d2b3e7d245beed9ec546c27697f365755d0e066fa6d324d96192663671cb3848af0c1440f44b5dee400857d44c598283980a1dc1d0e3e81ecd7db48be89ff42d90cbdf9f9e3fc659159780fffb17a61c0100ce18a8b2b636233632d287ce980869725e597a67dce48678afd89c0ded1beb48fddc3d2b70bfc7a70232f61848212d992712b307bb080dcc49a94eed2f0e3aa4fa54f70e7b50cc1d9a7fd499747e5edc8b7f43da6fc6dcbede439376d33eec395c227d99deb60cb066d22c3926f7185199c99b204f886b055355b9ea5bc6ef58af850d7cff71ed0fcee7a8ef810d50b648d8eb1b247454d1dd532a81ce5d7dc947d4017b60347c8a2ff5774c7efbce2b91d14e9bf4260e19229e5e29530b8a03e6a75cd923b7960370707f55c23328d2727970d59c4ca0c9dcffc7fa60bbf24f54e57d279e8824ef2a77f864358b233d05dd0385543a5babee5259af8cf02442466a725fe00dc06cd23e8f9aae4601e2c4096d256ee89817c3d0c01914d95efbca08db5608d2e55e6ec8ecab542b854215bdcbe70fe7f03d2e57057aa82bc39671b1c857b3023976d51eecfc34221c576dcdb4ac44fe7b916b5b21ee37ca436407cd51561c930b7e3d2731b61de1c1a4a424fc4085c4be762b674fbe25177415ef77387cec0f103148c6db22847cb5ddcf2d1f95cb2ae480045dec4404c00a08f8dd27013469a2883d4c06ad282eec747207d80be65900ddf6e8ba090947d091738a48c721b0dbf27b88b9e1b0cbf592512d22e837bb7f32b523049376a8efa4215719b66bec5b202c700c0abe48b43d488b9984c413b781706f59716ccdbbf66ccacf61a3fc384dfffdcb2ef1dd0df72c2c1a7c1b3ec4b88337c3bd256efc88339d0a4a97d09c45db4bb068d12fc3a6d7bf07109e9f30ca8d64f342e0426a499b6acfe3628209f7819a155e2de52170e6b68b1c18a7800c03061680f66c6ccc5f8d89241de17702bd249701d0e2bf0487f2edba196c9cdff361e3656a7fbb0b407df859c916c079392541b352c5f24a28bb385354294f50e26b597196518885ea693f3ca97943fe69cdbaab92799ff4dc0f11a5b9f054767e9f2960f698f3f92efaab988ac790f3798b45126ea91d396cd0ef3e6061a926fc6f25ab73afd726f8b131efa4b441ff6a2dff1f33475c872501a545f1aae0a1daf768f995f4fe38cbc5611f75ac2a708f83c8d23b248860d050505ccfdf4fa892295db6e40afc966998dae2dc730d8ebd5f7c191e47017d9969d87884bef6c72e1e1d68dc9ed0615ab5685db4ed4544f539535f9cdcb199c133fbc020ec72b53a46912972ccea2a9a444e0e1810d75bd47b0c25d3f47961c2fe821e835a8bf11dc75f09c5c5f29baac0ecb9de6d368e17d3e5b6c0d6c57d238d43e61e92afadf4eb3817045b62031e604a43579f616260013cb44e36e952b2d456e11cc4d44fb6b7948219a34f20f05f8b432e3ab89ec860f91367174dc61e1b015b0653d3c08b725d2cb52032f730bfee0c2b2d08aaa71ce76cbc5aaebc355e98fa19d53fddd37240ecd6ddf2d2ff94e9115ee25c10ab6bb534527b682085aa7a075462822e33a63f595bab0b737585de45525e376999fdb34972ca97bef4d09fddec5d7f6f4426901fe806c7a11ed6a32e301d201c93fcbee09aaae91af9bec0d22c533b698fa70f469b2383fd7af5d08856910f419b859109ad8cf61003f45bc289eda24785ec6aec42a356c5f65f4adec9a970fda11e14a6efa555c9fcd97311c22ba5daf874101a2e69f391e9ee2a7d2406206206129bc960eb279dfe3e603db88de193097590653601f9611271e732cb263d91438db6ffec826d1c5c0a418180905764cc5a26ba157f0caefa5a0d78138f626e0b59a90909278c2a6403a1c0cffddd98c2484f87d8d92d194ef61f0a57aedaafb8367ff7e02fda3e1f6f0b8a38c6813f4299bc09399df26896797af24f80431f1778b09c437892850e73611ba1cbb130bd64bd37b44f9c50f89ce0bfe68c798aaf6399ee3edb1235d8b411e2af87fd74f164b1e2bb76b21e7735500152da9eacea010f0d09330fbf5a512ef9dce0069c22cb0e30589643168709efea33f04329c6c5c8f2e0b95ec4a5f0a3d24a18e5f1181d71ec6da722558e95912083a365c9269618b549607b73d7b1175427b28c0716c4ea33c6bab6b30e83ebb2538ede75ee65106c10a41934e2d801d25bee58ad295de8ff48783a0651d1cc053137e49f4bfa004db7a8b59711e5b944d03aee7601f2db520ab068b1491205b9157d96c0a3929f5bcb8d873e19f06876f53e5d8dd9dec851b2755b6470d87ce0dd709081d741369c3efa8a0f4826e831aa89c887cae02d2b749be73277fea726da60fe55812f37e4a7b044204dbd3616e2a71f64470ca4e51b367750708e60f19af3fa7251a0d174034d03621f60eaba73d17dbb175f9a5666db011567a93a73e3d6e128ae957e0fbf8d225a189bbb8c17123daf6208d995dd95d941dcff8db37f6496cd90d8b58edba16966c17f2c11b8e957bd5892fa9bb64beb14c3c8b1e40f672843c7e32cd17060ce00362c9d2d2c0aabff634ae347fdc460927a7a4f3219b2fff69bab3d16e4417979629c86495a0b155b54d9af80bfdc4337be0d5ffb9ff9edc09c22b20eee58fc521816bea6b0d486133746c79f7f83e75aef2542c57228440d4a948d6c7f67909df805ec9e147e2aae63d380b2aec39cbcc13e1a1f1f79b56f1f64e55c27648410220e5eddc4a34bf5308a0beb996b3bb2cbb642cd365d4b43d9f87475e47da75e31c2da3c675ac68016e31092c4a6b99c7e2125788a081c6c3274676f86884c72cb5e5672c2dbec25bc22e962b1098c81d57952ae0f4e72658b517287becf20c870812e07beffeae69e115419d139359515d3ede125771586ff60722dbc2e388b61d43aaaac01e6bead82d4a84e0228dffe01540d2ecac00218cd9783d4858e1c62974a180f82192bf1d503b16bd88902384a61b9f6dac91b164f8503838bf61b572dc5883ccb9cec096ecc4b3cc6e0b63a41ca793fc34e6bcb3b303b506c02b73c670843f23af7032d801cdbab37eae0b2e59bd04844f14278626c4f2419052c2fac14b12eff724e7bf46af9eac522a5376ff7ffb131d80215ca73573d3a40dd956904e5ac27df3e9ce32744fb721133047f300875bcdd2dec6608c5419dbd4ae0ad0e63f866b9f913a9092ffcda6b6aaa20d2e2539f3b3974c87f69c49d2de9e9da930c0f04b0d53d1ec537c572a459ff219e851d18d62d4acfae088615e047c6307013426aaa360fed9b1d6a10b0984c7f7ed89d0d2a8ee610f7edfedcfbc3ae0bb28351fe8bfd24a058005c15b2d9610416bd56858483e08d41ecb687aec906e0f3e6bf42519392d004d8b581a56a01f890b303104fc627820ae2daa42457640dea7056d899c456eaf0e2a7653743cc33d63ef20abe7817c4a54c21628f2da8ec041489d50c8562b50c349f9137c9ac858ea840b57208746b16e581f71fea90ff41462497e9ee6826e1391e3bfb48f6f581693ba65cb32270bf0b84926a038f5883dea4cbe01fc4a90ec445cd584cd17a050cf262a19985aa27af0aee3ce73c23b8019276283b4a4db611a1c11e3acc9d9aaa49cbfcb5456af9f7cf612161c8efacc028cd126da2c2b93b800ceba32f845c058835d5637401cfbebaf0cf88e5594cc1c2a0ae67b1c84b2100ce680451b7cd1661378e01d35e189193858e4604ed97e025ed8050622d1732fb2c08331a1d15f885fc9680ba226e3fa7abb457a7811ca17ba9d968b315dd033ab5329bd1136e200b539c6b39b8ba348efb74b6a9c4165d2d5ef296700561e678755108c030cfc4328d4c2f4fd983edd65c29cecdc8991630039d12789f9a3777e7c0dcb3336e684a9a11deb1435d5cc68c4b2a42aaf0af9607a9b1ac20220c4380098def1934d7b747f79747ee28a3d5d79e1118007d62c46ea7244526ced5bb068dfb9dcc56fabbcb17b4f044bca853a4760097d98854d505a4bdce5c145717e095e39698e57d31e13dcc077fd4797ad3271de8c7de765ae9d699c9647cf903c2d5e11fcd8ac59fa632a79e53d592e63d7907811b79035c9974976d9a3f5c5445f13ebb4f95ad1c483ea67bc0bf893bfa96d12c5a609f500ec639786bf4ef61ad238c13ffe85e917d9ee4f501de4c79b366244aec4d37cb50a30a4f87b5cb0f071e343becd8621e911b9fd470a1246d9c69f8dd923de557f052c53f80dda9bb8042db7928fe3a28f2915d14e7c2e19c49b75735cd9e1c1a77eac72d2bf5a0266d8c67d1ee997894fcae1f669c804314c3f0c8b941d6af75e166e1ba7426f7e595ec0f9e8c86517d8a0fe4f295cca89e32a842717a3a465bf2581f1e6fd8d965fa8fd5b7f87afbc051f40fb132a9cbcc086d41b27d21bfc2a9b0cbfa388eaa0714a0e98f96a70883534c8c5912b205df253df56aeeb1ce9d6f7760ee893ac5dfa75c601c4c8b00e008e349f63fd4c5467f87fbf76398fd2eef80f6561a62d55881cdb728357fac5f23560f18899bf2d670ab77aac3465962b09e0faa7241dccabf3b4736236bee31ad46554a2f396b1556da0ea008d78d92a7a05a0d4a96385b363899e3be2a7a25d9b7343925820a543a5ba0a1c33b1d211408d2cabebfc3e3d3cd7fbe0267ba6d02bb3e837268c318af466d6ef4a1db2c781f85b3cfa7861aa446f6c52bf70c9a8f3ec56a787f5cfa325539b915d9f07a9a4ff16d6873cd9d2e302d62df7a3f9abf36e46c028abee52398ddbae3681eb33677b1fb1deef9efdb364a385311282e7833377f940a1d1fedbda91dcaaf3be4c6c9ea2ee6c0cf4152440fee7a9ca919c6eb1c0ae0745385a8601b57340ebcaa98fe8880759a51c224f2f2f39d6468b16a1c3f6f005fbc049caf6be1a77dde8c7149a9b14ae1d1f54c913e92e4a6c8df0e8721f9ceb8d8de937487cb5d516e396333387b4dd5c16e81704b3068a2893c6f6760a4b9ade476fb20ec9395d5ad6f0d57c64776e78768caa9b60c00904a3e5efe0880b0b8a20926a4a0c691557b386d6ed2c406b6cdc3c90178e74f3f24249fa412d99c50e87917d9d6c65f78082d3281c0873d21d3584de1a276b361424bcf4666db720f837462aac2def309558a4f47d1de3eabfa63b6ecb1140a2122b81032ece84947687e30f2645b5ee73bef5029ae518384eead05b54ba07675edb19fa63c5a53539e2dfd5f6ae0770b828c79f1b4d17851022dff7d5e731f5dc85d6b06fecce7525284a6d7a2c6776359e7f716cff2123e7d8e0d41049470f199469a46b37774f3e6b838473155c665603a45498dd236f13ade412ed540dcdeacb10bf6d5efb9bc78b653ccd2a8457edce0ee9654a59185fa5b5c6fce253b6e655bbae41655dd6b394cdfa502f78128bf266f01eb55daa51a352c01acb0757716f5317541e8cdfd6293400ca0dd62131bbb979227844133145120abddb3e85b9770a653734c760ee8dba35149141870b59f31c336e2d4d21bac2084c20c47183ca0b34bacdbfa9dc04b0a881059e1d82f371926cea530467725311c2bd071fc6a1868ba2328215a179fe10f0a934a41c231b0b0b07ffde01887830ed90f06a271f9f3f94a76ee535b113d2bf2c1665df5db9dbfe9e0843feac8db68e45985d5253de0acefe1ae29511c53c5ad7388f69bee86f06162680343baaaf4d7bb84258eaa237ad07fc01444ab1418021cb8ceffa87ce4af180a2c71cca46dc80ddfe03de63d2ee4ad0c79400044cadb5addfbb346ee5270ca6318ce1b70e5c7d96398481ffd912251ff5d6c721a1145bc0e637256ee71e2a63aa30350ce99f3c4cf90675b52d05db82811d2ed7c9123937d9fb7dfd00737d88b1c84406aa4408bbb49b88ce7df8983c4ffbd3d9c750f62eedba1f7fc881fdda278cf1cec2e9969af4931306515a76abe98422d3901d29d4f302a187385292d17e0525deabbdc22e8bb89e2d34c409da2dc873094ea5ee753d4b93e2f0a85d92d19ea8fde95aa15081298f840c443c478954f69c4675b30747545ac529c6c3175ce249932a14a7de606dc80567c66f6611a08ae00e521101f5efe5bad1fd505a710bc16cb4bfb125790d6df365b2d16e5d0a6688cdd20e9c2450f7a55b5641090fe9edaa9f1f89729ecb0fdb4bcd0b0ec18c70852bf2511fd59d42ff54ca878454f0690a702b83239eec51ad4fc56f78de39d323c82421573d123e04c0b6a2098c1ae00fa8d499d54af2fd4be447d8ce01f66d8bb23e3e55f87a04df91b296cd165cbb5eba6b060c455fa36f5ec1278ff83dddc4d2b5757e626fcc8b29adbbe3a485c2f1fe074225d979c8bca444578164d5eaf6a2d162e2df4f4f8954766dc214daa71372b50d4d273e82afa941e042afb96f871ddcb60e4b1d68c8cb71d99d1e0f26f3f94be38aeeaab92eeb88c5fded5a509a9e629297ace6debd4fa653856486925ac4229b47220fa450bf9043d67b4272dcb1b0f7b4320ec11b45fb67b8ee2fc803bb5db1b1a7da6e32e9064e07e1cda11f63bd920a5391996be127f027add4a45872584bca7160f629e804f43ff03a894f818e1d2f1d591d43f7d2e87150205787184c67306e6f997cf09fbd1aa87aa2f1a8a70e33d4c32c415e9a2cb54edf50cab02ed7a94da34b5bceb17c4c167b9f678be63990df7f02d9172bbe007973d70c4ad826758473fb3543295554778596940d7cd92848b0a9924b675e95e513cc5b2d45116b60c99a42539a57f371d0ae0f6d041fceb33ef51d52c516e92ba0f10f4c0035ba310d4558182baf74531f25d6f32a8468188f962f981132265567590f0ca514eea090df51fe8ce8206966b5f3d9f9d988ab1013720245670373d10d002212e156ec2c53360dddea9106995d9ae5b19091b4a38b76da2a2a9ccdcd1c21e025a8cc3132d148b4af6191fbbc0b0ba0139936dd9fbffa6290484cde8a8d7b8fcdf88b9eb522a97cb18a3c015a594ffaf9fd8b4aa182899af25fdf1285be970939fff766cd0fd30c7d4f23d3e17722222a4385a438209f6152f4681a2d344bd6df0b4d4cc5d6fe2355a70fdc63e71f5cd4156a8e72d8f04e5da4951a44cb37259827c9bfe49e12c15030683b8a6e03b9318aa2e25bd4338ed11261487d261ba0859768842f5737d0fc0d6ad08976fb180c8de60b9cdf10a322dd98901c6cb9834111c0b87f96e9af6affaf67d7f2f1d49539918eb2a72ab226d0acec3bacac1f87957510574e2bacd0ab9277c2c742070f372fbd67cadd26fba243b9b385f1d0842a2edb7ce7225a5e8356398212dcb6f74605703432c9ab11efe13e1928f52f69ece662bda475c3c89adf9bd27b00bdb55633842dfb213740d68a5ec459926ac2d1127ada4471089aeb5c1df151c6728d3e4af9433bc356b5b864425fae953f46c9aa86ddeea385744bb56d834a3afa9e526012be18786e202dd75cdc1c21807160e258b1fe88d0117c2b06df41abc94e342aa31c66c945ac1dbd31c8402618028c6d8e1ad4ef6882f6b99505d7e64953a0a680634deb02c6665c3eb7941d161ccb82ebed9bedf371f797f10cc2663c738211d0af770fd021caf2ed371e026d46e5d7742d6b2f2b69122833e6a88a8d82a5c0a4e6fed3779ce8104e72070541bf7028d898bcd93092f09746f6ade6ae9d71c179275115f3df75cf670866f7188aa0eb5487fd5ce390fa19705739436b6faf06ae5f2de7430b61efa1064fe4ba81577270a3127c05ba123017f61471f3964df0ea14a4d6835f5aa2aada2853298dc73d3455b14629f285a3b0890ca1590e9aa8d78d2abda390d927d8c4041e20d73f4701493436808d846019b9933556f056ab17dfa3f1437bf1f2d5a811c9e9d0c1d679a0da066386f097f74ace1927295e5ad84bbb9e03db053e80b7cca35662e13750d656a3dedeb68259f6d7c141e388ac9351a6956a34b02afeadf170fe14ffa1aa8a31a107ab638d3e6ac8308f1bedc23f7b0da5ff4dbf23f911daeb7949d60be29644413f5333eced5732a54d9c3cf56e344825700e1e09b162edb05e6e1db32638e5a579c1ca529d2f0ec44320d26144c85e36d2f0751ef04f9289f37c384889f0d6f309c7b3be70128b231088432bf3aca4a835788ea250a591eca76f0aa2c379060a8bddab0fa75f8620129f23927815ddbb49f0c7a9be28ba2f739c99f5ad159edf610f36bbc69ae4620a2d6accb386b67652afc93c1ee2528f2853f74b81b364d4399c0035ed4782074dde75c92d7fb0de0122820fde47a01c4b9fc14255289c890c315e77ae80d5cc13507aa11394d084a02bc96b4e39422e40193ca17f912c69a1c587dce8740949ac9541c913d0b18ecc710ffb532bc357533562f0dab3b1a7e3be918d9ff81b79e2456f40b0a2c6fadfe84f966b6e68e4ebb5b3c56abbfd181c8620ec03cb5a9d2e95096cebb6847cdc58b784a59a70a5cdc6126ad1a7b7440561eedf9dd250cdf4742eb055ac00fe15a8d7747f36d3635e234965c2aaab9b278d797dd1b8b2b5154f84b1d65cef9ca315a58f4235cd08e37ecdbc6bc5ec808ccd82b1e24a4b239786ae91aed54833a960617fe38d4fc718f3db0552303377e8ac2214764047ca5f61b843e7567d11cf9d0ee21f088fe8ddf6548dfeaf91ccdc18976bc7e6f403cea0db26f5e2465fa8acf260646485828f9acd60d55a9060d07f41033bf50d3c169e2626965882c2bdd5d01401698e70757eaafa66f7b004a66974aacc7472c37c89c57aff0bffceb4c205cedd616d792b1f875e4df841ed2c40ba8f2bc01eb6480d5bbe1e80eb795343c8b5beabce578768c76a7d01fbc4b75676e65a340db70f28dc1a227ebaf8d779e865e7d391432386c9f17df11fc76a67ea9632afa5cea0c01b1de362832ac07d11ed1db1afec1a517cfd262026e7ebb6eeaef78633a4ca16c754ee0f52e21ea9901dc6fd77d2c246960ea41c052aa62fb52baffaa006240807ef9703574406ee36b1dc5b01e6bef7f7c7b4f14d68ea984d0a2aa6087adb13ee8346137a1c8507e3114a696d4506fc118096417a499a161005abe379c270f3ffe680fe21e6cf020e2f77ed0f57b3e3bfa8970f7166e05e660c6d4799081826a718120ee38b2efdc5175249ef0b8dfad505ca8eb8501692d7de8b961f9f0468fa902e2a08d19fc35eedd7b52d7450a7741a790a7d8b598760d88912931ff54c4e5fa31081c0ba9a1efbd44fd2fb6800493fb981f67c61a02bd69e995f0474324afd9fe7b6b0d3316d8d1411cd55e0c8c46f9de497c259c67e5115c48de0633af19726ca1215b917bf77dc58f3c331c09356fd10d9e44c9450a52e3bc8ce0dfb3df4966b7aac31b8174426120dc837a7a474647ffc68069224f1533e4f629f997e873bb067586595c72645aa97472c00e5f22817024e2d431e7d4bf612590a4579a573060c5bb5c54369362db017492e08d8f1d64ea3f3a0124bc3d7728691cb2494f58b0f29a06bbff96ec9c49862b2c0a0fd570e812832acd20ad18b6efd81648a2125e776abaf97473e118ddf67904cbc99891c24faa310d24f7c3780f4f959b769a76c46f85870c94d0774637d85e4ccc94314b5823792e5c904c777e9bc96ff4130c91a9b59821a3a5f1a030f79e0395413e427e2068320d02903d79b9be191ac38756833bd7cc7231cb9144e351ba809693d4dba5eb75c018bcd93a314fca3daa647c4b083987cbee13a64a7f630e486b82f57ed86f41364818103cfdca6733e058ab54dc633bd52fa349dfa72c46350407f8958d2749c697476a3fcff3ac75998b2724b3b7e84e0d43bca92a5234b15f1fc8341d73480dabe2dff33987da01ca204da85795f70a764a7fa297818adb53dc933e8639cca228f460ca567cc46cf77073dd76f994cce8b4f8c05b9294123d54c6f1ada3b491ded78b2ae81fd105bc4e6bcfe2b72e06623befe69ce244cf08ac253ef144ef1bfd42eb4a72efc0391680c7482e2afc43fe847fb7e282ef4ae1ec992490557f9c23abc4b360be3d13ecaca1eb6af8eb6b6dd21e5db55477031e71087ababeeb74756baa3d790746a030fd28c9b03bec6f41083f33f9932828522dc4c7709562a739412aa0dd29f0ed36d31eb43c43b5deb4d9d892b95f4af54b61e6c058d5fcc90055363afe92807748f80a17bc3fe878146ff3fd2684590a627fb9a1aee33c156b57879bd2f970203f0a9b01245904a7081349bd9656df312a6308e45f7d80c2e5442fe9a04435a8125b868aa58063f6ff9f397bb3317f5738173ffe710707acc1c6708557ddfef9919a4c5b60f9c2679c553bee5b7d1ec938f9de8799ca8942d1e1bd11ab93ca59d58ae5efa0f532e885c7bf7754e22ead9ad62867b497e38d2bf6218c57992292486b8b819cfa6553e31769626fcd68a063203487ec54efb38ad7f8ac342d51737b4ab2318d5970617b89645ef7cad4388ce400d48b4ca0c8a2638aad986c955f0252d9224620dd0b10def881dfd23d6893a6f443b8d19e7635410d24eb93b9958a8e51ebd2f70c56f8acee897092a880d0c93e2b9bae44f3abd6195b1e9eeab6eea07f9d16ea7a8a62647dd9b7374ffd17afe1f83f5653380ee6045730501468d8c41c69fa84caafecebadab8da8344d10e68c86ac5eb40bb20d8806790ec88981e41696f97dc4c0919702a85af6a6dffbf7a8515f291b08f116da6ebb36c52647712c20116535aec3d63951902d199472cb2c44d5ca5bddbfa7bf105ef4a57ea3b1d36a0ac327be485d5d042363e2ad60f4529853f0899ce918d99e42ffacfc5e16cc6d49908dc80b027dfb672837d32a83b610bd799d0af02eff3c2acfdb2b3d62da4626eb4f23fb740d917e7e7c077a9ef0c6d8504fda5721bd5954a5af8c60701338bf2d67101845b8756fbe56801d993445b6e47a6cb1f28bfb34827c5b834f3ee3371822a4bb19077fd46ce2a5622c4600e4ed6de46b1ce94798f84259ed437e9837d29d04427ce8da5a314393197f15c79fc4f68ad0946a7df9225b3755d066d5806bc8c23bfb900cefc89e6f42dfdca10da538ab67e2290dcf980c4ee099500de43e20dd07a3fbd31629c3bd9f8384497ac35a6d20ac7893e05ecd04abf906c51a256a4a786c5fcd8281e36911c846d7574959daad8133d1dc4035c4a99816ea0243317d081b18c6e38e0ed126431d1c70ae518b4f10e2be6d8262f959d6ccd1d783d5750e7ed8e159e00caba8461ee5ddaa213f3a8a85ad2b6332615aac0e298c1b7554590dc6df5412e954a7732f2c526afe13d5991a323d678156a937877e22abcfaed82f879a7c7cd5c328ef31fdc4d363b9b7611fc25a0393168bc185886c74070fc582bfde838db19b3fd00baab64c04963f15abc5a9c791f43052740dcb7b535566a6273027da60885c1d600b13f0b9403bdac68394e8e26f9c9ca9d50f191c439f31c82f339a4b60b32c9421f501e959f4123898a6210f9c66606433734516984f6ba7499a41f5539e6046a292e0c713ca75bfc0a349335448d0f20bebf19d95b6c4d88ba2ae1ea36d18d9f0f3abd89fc644bd88a343339ea8f99c3ecc5898a4f682ff549b994a2e16b8ae7ec26fb342779da6e564d006cf06e9c483a29463a1e9afb3bc3743df4a760f587e08b406b0ff183357cb961a66938947c32243b225ea8229ed3dba9ef8015cbdba1bd1b6a2a1ba98acb05bc38f5ec3fb0cf0da99fd529d90dad53293116fd9ecb8211090a94a7e62fb9e55b075ef7cf831052b4b379deb7794b0a1f68fc15b7196c02aae43e65f39b43e53258874606e62ec93c46d628c4d42da5aa7fc44d0811fcae8a7c2e74505ef25ad03c97e6238be2657ec9ec7a046d4532bac67d9d8e042880517a7ba9dea12f8f6ad12a39beec6fd7a899b7940525353bbed7ad2a7d6a0b82d3089ae119f4279e07feafc22465b5ddd4ca07babecd7b6d1f4588b5ee546e1865063746b85a140860df4d99f8c08b486f0cf9590155c9d4e6578bca36885e69ea2a6012b74356bf5f7a87786dc36b38284bacf4de0d1126f8e1b37288ec622b6e98c4da965e8018618ee093f13e7647a03ecc14e3c15bcf07703ad6dabe0676e65d87d9e9bbdf935ebb5716f6ebddff473907187cc758dc1a0baa0373630e7aa0d1f9231cdd7913bf1e68581f0941316e5bde0fb86f1c5e118f461c4b87959a6401011727ff8bf9ebe98b3c3c395cbea86f947432302a9472edf977c8e4eda744ee732411c6ac6d7d60a224af1e214ee8e463762d4fcc50e0a88ff68e3aebd94f4480204e5ecf9947f076a6c50f747670faf4364530f3c77a2a9ff498e744693dc0852b4efbcc47fb01c01e6eeb205c5f120a2c2ba0698196e9772c00c6239864cd989e7d94893e994d906ee9f2a210fdabb9728c32818af18bc896017214199bb522dbb853b72d2917d35bc9957ae2bbf67a9a9ef704855d812af2bcbd5f476e028ea76d899b433b412cd1a2ba2c6d3796951871343d33b25d01a79be1762248695df1a8679318c35b10fedad4afc0dead8f482f6295392e7a2e8d826eedcd0b4c63a230923c133a5cef762bdc31d5271f793c88346404fe97dca120ad367cf5a77c9eadf329e25e21fa1bcf92b35ce382380ca5227c8f27a540942cb95baa498dd2f3b65816393dd41a6865dca952cbf2e633702d5d5722bd0bf6e552b6253289ece6c60184131058c095e703d88c58d7c30000d4b85fc50702c5bf4cb231424934ad510164377302b1cf73261e0d570890a2e6d3a5195825cbb6128afc67cc88ab82b01ab4c43dbb891d31d11ecc426c37ad6c6d50fbafad209c05149e13fd387eb131cd53bf5cf1d13cc302d31effc04dbef476529804d19efc56417a13ccfbbc8a219236f310e26d9573f574eb4dec0e8e243a11c5ff1b50689e173312570988ea52cfd08266f24a5ef23809b7b3de39064a9e8ea9ad3d32f85cb28d630c66d2c00e052dfe0cea4131eb511810e68c9d2fb867a06e29e8584dc0018a5553df7ee1b48837cf27394d75209990f7b00a36519c51f8342749b5d05ed45dcd77bd08477c08ffaf0595088955ac89e1fec9e0cce4a43a7520079294945b4d8c6580f17bf1030cee1d114a000ac87a5ca9a648a837883ce68aa526effb0bc17447f7c239264077ddaca24bacb9d7c87d87bc88f9fd74cbef244aef0d52e7454fad85a6256c03461e755c09ea2c5dd68418528017b2dce66ea01abaa5215a337779fc204d4f79a87fcae8dde3597a78d17dac003188ac029403ae99632204d9524ad12d7a0a87da10e01a28194d90a14784fc825cd2d0804106dbbef787c1761dedd7806b956d6712052a5c72b632b3aef796ac0317f69eb8396d859cfe2ba932b9e5d7c04272c5150c7769e29924cc2fac77ad97af6dd5ee906a3734c8abb81dc117876a50f3fbce67acebec84fb87cb47768b0fd4e745bb50ae31a8f2e9935df641157a459bca04c171f2ff2bcc18298573c1226911fc3c3ebd76bbc3d78bfe8aee2110b0e20352b571c3da892bdecb7bcc2bc1e038a0a0ae9943dbc1c05e086074340850943d84bc63ad6e5268f9356aafb247e2a66a8b3ad018777c5a7b0a3c2bd756301ce97103d82d3c94db0d1a2148acc27fc1e4db0ec2d745903c7777a2f48da6d95fbaffa0811855642e68c19bc5fac2d3993c7292639adcdc0b814c254209ad0432b057eea15d766438e44d5fbdae2d9f45b515bc84d0234e50886ce793c97ff3dec018282a98495ff0de4dc3a0ffc9772972aa81051711c78f617c1c46543cf7f472abd7a99d18f86b5103014384fb00176331f861d7c900114c72314eb3858bc9d8d95a198f38fffec09b6ab424a451022b6ee7f5bfef50f36b6c65a56810d2c91b12766f81725ca4375becc3783fa7a38152445fcc3ea53bf28595c6003a4c904b9671eff05cb70519284c76938ddfa48a4e9edfe7a049d73935d38b25b443f57e43bc9d8b15444c07963206a1312278fcb3656c689b67e33b6fe0e5e764018e825adf9a30e195a5148f22953de0058ba06ce7270d0ed10d4f527ee12d56021414e22d94880cbeef7ebe82ccfbe13042c09face45a310c0d89cf04fb12544131fa3216c20b838eda9f994be9578f2d702e650a465375b8b874419b680b22944b7bef5f3d3c14ce315fd9efa2b5e6470dd1620fcf86799c709590dc118b0626d167ba9d4c7a8c7ec0a91ad4b4af12acf0b0056212294076be70a66ca44005d71a8ed0053dff7ce68b9d82e4747edec5411d7193385d21e8ae30e0e5afbe3aeb9dba4c930325eb19f8249f8ec9a269912ff59617ed329e4cbae9caf192671e3b4b70aa61569595fc7977bf7aa044e41befb628fc26b51299d21ebf9ef0ade7ac3f338343f581cf906f590bdee64445f00a64e5ff756478cf374667a957e747960416358853925b68ce2318401df67de25e517d03f7058f6c0ebf3eea7fdb0cd4891b50df56339d3a0db3ecb4c887d2e79acfd1a6967eace0c2589c883f002d950d131ab8d101b54e2d15208bffb165bafd4207e4bc21d440b698fd10d49cceff11649445c8a3745db849e9fe3434dbb7b416c8bd1f34fa02e794a18725683db2a63cad50f7c61fe9ce522d734aa5955934b61f11f0ad54e0aa069118e88aa55e476dddad438ad7de6f5b867a8fcf313028af88a26c0d77b183255ea40473cda3c5cc1f32ecb73eedf84ec3c173f32c5f8bb631119acd3f7d2e3aa85a8a7f850d90c8331154c48659111f92df4e7f75de4881295e035ece74660fc3be18d24d500c16a3e5ee6a789e2f550a646b3040cea6dcf63725708aa329b9b941fa9a9a29b96cda4193df9fd5b15615517d5755c307968e1c2e757e26bc2bb8e8406f3590ba6046ca9d5239ec79b56d553ed6352db2cf1ca4cc3e1a42b0ffbeb50e95f221b7eed3b117effd5e7d28da729730a318bedc9c0aee5546db1e2e3d7cbca6d32341449af3a5e25efecddf978dfa4429903641300b07a210d5fc8b1ff751c78f7aea65574376751f864ecb40c320ce53aad2c4ba64046b1c52ea1910a53e16d19a5419be97c454fe93b79c87317efda0e856c93e70de53389758b01bbc6a9c3c2308d6c405fc9904ac6293da1206f8814e0422f647c735a90402489fa6589b89ba8f4132c5d8cd9a08341cba32d44cec40ab13404c8fb8de44ee0bfa453d6ffbec54344a372b8cd008a0f54669cee16a39b0b2842c89234ade926f6d2493cb5bcdbe74531ee8cea7f3490e11272f35f6b270dc635d723c01981be08b65683178ecb876c898211079280ed8ee032c6a0a4a8f0cc27b6066df16519b9953a6fd166f48d2e06acf4e601cf4017419ac4f585796e02e896db12c248705e65c71e36243f3a29d9642869e16b33bf023e4ab35b48ed4b05a6a73e08b3fefb0c8074362e42ed058d98e404c9b54c39c58213b98156214f3a93acaff39a51bb65b84b79daba936c89581ad67cd1f57055c954aedf79f7c26650c45563b945517d6d71b1a356d2b8de3c880042cebefe5475ca173c763b5b1f7af4ae44896293d77fa895c69ea7a2e591a98b7f4c59f498378261a53174d0cfb17bda7a5fbb9ef821ba40fda814c703273dd9997a7672ef4264867e45d4bf571f8dc2b2b2e326b0ef7be4479e9ceab93403d148b60f9b2006cb5156a06062405787560b3f1a9b106b211478f35d650d52842bcf9b141ef97ac00973937e9f42749524bd4ca984d8ec996fa5b614f8f0f34e933c86b5bf968df605ae6ed695db430b4073a7849f014b98ffd7a8db29cf6fb623ebe092baaa4040facbd03425b72a9903f206c60c0b0dbcab96ea33d9cdc9c29058e62338abe255d344ae2236fb315a63826323f12f99718dd4858f89982c59eea44f44ff962d9dc4beccb600634a4b14da111e9e16b82ea6b0537c74ad4b840be01d90dd01df9f7d30d172df44537bdf237609fb739a8afbc41a92feb6056d99704392d948ab66fca60cea2f181a0dd2185a43e61d7d8edf0b2b252679d36d8d319a453d4e389cd3fb97b2eb642dada2e0c72e0dc416224356c016fd24d72512910dc275858626661b5798455ebbd25c92cff7d70fe73ab22ed83636c11711a52211ac1b0c4a2421c86675f059ee311d999d3c21c61cd3fe20e7b3b801fb2680f2f839168c782e72a69a9f356b5207f8f7bb79c676d1fb868c779ab02d31ad9bd92b3aab16fc62779f4d25de397fd1df6aec58425cd08805c67f5bed8b2cb186b267d1a18ad1ac59ed6d9a0e0111f91b189a3405a039b3462039d0128b9211bd31ce3166c9f36a1a1fb5be2c71dc671b8c13edf3ce756b5fef7d9bb3d000d65a1c4b72113558e09ea582cd81d9030d49ed30af8638af2ea7c3d70e1e1ad486917e68aa902a2ceafc96ba11279077e454f106004fd4b3b1c0fa1ed113202496b68a43889e2cdbe492e73f4ba3c5421ac1154f19b1a9037c232cf59ba8e897e9651a364d74301d999dfdffc40aff937accc029e76b37996a6cc3315cabef751d5770606ad36cce391f88099f046b9f9c5a012dc8af15fc3f2489449ec1c4533eccf16cc708be00fbcb641416edff4c0bacf85be3a6569db8d216ca755faa474d22ca42d35dc8a0f968b540a58be17c7a6b7194f8b444532de4781e41a8820a756de6ac8a8a1d72080ac64da77b29c4540c6c03ad03ab13a466cee9d6d6de333dbc6930bf2968b5885ebf34bee926785d7a7c41ab28f3cc6a067fcae6ee1ce96615689583e3bb3c63e34d25cd3ac0e26f9b0ad87663cc546f083f3b4737e97f8bb6f19079f69dee491c7592c60405fa53dc4eb0bf873df1ff23bedda9bc10dd2a4eb62dce50376a1918659684ad8c2e5e04c729ebe7155ad5acd0973f9ee27c403340b9dfb9fba037272b45d4e709d4aff3563698d430e4b1b7c56de453bd3b2ea47b5e41a272a4a74547cb834604fd2eb24e9583d3935097f36ebdaaf8f408badc8ad04d426a4e552d275a1e49cc6ebe18137ef1a80a1a9e314acbc9516e46f0fac4931e8447f6e0db3c265d6704bf7859af03a8de5659db327d5c949f128c2ae13ace9765a333fbcc8c91926e923e42e581ec47f7cd987a2d9da4b4e73c2e0be349dea0601bca06a53a97ce1b4e084db1b249a89930f4dd251ef54e94922a372e8b4b2ac09af181dfce5288ba1ec368fb6796ead56bd2761bda0be675ff9506e066f167380f5b257002c3d87f4a7245b4fbb18ab6ac0cd1822ed925e78ba3cd4c59256f26b6eb9c359bbc4be9ce0f77d02362481fc256e4446f1fc6c451e249dbb7b1608b6064e998846d6fa7852da3d76ce93a72f1446ed7a3af1a52e78e7385fc891d712c6a05d2a87a3f87e8d3fae4817876b35530c99dc635ad888ee11797b750fba3a634230e4c17dd6f701dcbec198e7d9b7ce0783215f93c62287c16a1bbb3b8704f6d60a800062d6e857f8254e6cc8a3e07b32b2c8bf8970c1b41df0e0fcad8b6a7013997505eb765131a873d7bec2b2b39321eca26af6bff121bccf0a5912267be62e3f1fbfbdd11256b4a044cfcc5bd0a82efd8c57be1407cb0e1cb2f9477cd7f1b583b2cfbbf0e94c461c13483185495b7d5c46c2102bb2cbdcd6dc53f4236acb10fd48265ce130a0aaa4e25723d438de9019e8a28d5347bfb1efb56a5eab13532ae84ef33069a60210ad413a3eec8ddeeabbe20bba7e284920d0acd445ccfdb080cc3108223909bcb0e8c01752084f7f42bc67340fff418d65d89e65a7f0cc6c6ec533a2e5369e32789ec549e5954e386a4b4483c4c9a74199c9bb91cd01b5d1450dd18907ab067537ab662a5dbb07c1fedad60897cedef3c45a54bae930aad69223e4ea7602a4708ac1d0178270396864e1bc14cf099a9b244ce3cce7d0378652b114248063d3e933c300cb2c0aa2fe4d1e724a0eed9f8a9354e5af659f99ffd6f293ac2cde3b92e86ca100506813c97bdad758f627435e9f171226410bd2b60e7d36acf2837d9448cd18c5cce271d64ae45755da7b33fcd13701ba95699a7c28607c2eff50fcb540c9701b0dcd31af6e68b24efdee05e5e5d659fd04a50eb128d95dab140078fe546fc5aa2ea13ca371590c58e9195d546ba13d9dcaf44bcb5f0f24f0c10c7dc85b1d0fc1e0494a573e3dbf81e865024e2fadf584bad5a83290300e281919fc534f636985bb8331601cad57c5b90f712b814d632142d520135019426b9c2ab11b05f2ba4d72cbfa5a11e5e93a2ec7be7668d52c5a4e2c0120141f0d30298c88aef963e74360db289b93c8cd8d337eaea77b830a53c865a9c006a0d64f160c3bacb4d95ef7858d1b110f09c325a9645464abc041c263e897a93d0bfb202fe025b7632dea79a401ddf6de744690118f1e46953d3a0b6ca31c73d241fb698392792a4cf1a9faff6f82432c325fa38bd252b071d2116d09ec9318d19d79dd3d9f0ddaea023bf1b8d401cfc37d3b4ef8d9436b5b3585d20637dbd422883d7e99bdafcedb471b3ffa29897755d035f50e2bf3147fc02210d97c7db4753796353b5b1ef1c8bdf5e4f10504c3df3922511ebbbfcd5c9e56d4ce9c970eddabcefad6f77622cf87213e18debd029e9c988718022e6c9b99ebf2f3ac4d05d090f231731ea5a82402807a4722731a018a380685ffd40988ef346570e96d8e135a18c71b9f298da572c13e739b9d1224249f33678442353aba2cdd52e2b0ccbc4a1686d7b84bf40b44e09b54fa7af7d6608e164c70df784b116a2a9b042aed446fd18f90d214e5450b2042e0ac7dc4a4762118646f6d5c44f8b777e1f2ff6069e10736c4b5e07f08375082ff75f3f345adfaf480d8e61bed85fe779b59cff2c96a28fa27325d15891fe46a61d79abd81df888284b8396d67d8a22a89deec925bcc50baed19262365dacab70c999167bf59d8e3114fc8b57f956ce1e6d7e675aa6da426df462d3cbca7ec2c0dcd6422ddaa2920c457ec8c21fabbaa30dd1c983ce420f48f55e984c63f3be4248afe230da82eda7e425eb3641922ba146ce6730cea5ee7e7ecf8f79be0397f5a49bfbd095c5741e6037e31338c73f0281597dc2078c5d90a26aaefd3f9ad5594e65b6984f5fdcd8eef3737a715d6a17e600be8a5514167ddf059cc2d0c8a06d57f1434a9248dd23637931c1b3ba6714159fc3b0801a619ca6877d617f9b0ed03e8b82788c95f1199c6564fb1992f8175a24165abf7f245e7da0311cee001adb48aea6a1df667c07e2b0076aaaef6c091f59452f9a14c1a89025e8af46235e41aa2d7a8dffab9ae403e58c5572900f1e23731aef4c02960d4ece91bce37c2f1231ac990663a50271c95f614ab628accc74ce98edb52e41a5e91360824093a0e2af5bf57bbee02b70bb2103e7ff57a5d0ff99e5bd639dc4f2f33398fd19e2b6ca1935f58e4104c0adb016b1ebc4cdd65d63a61357e9d0fa9256b4e44fa4dc67ac32c1dd49c8246e61e23c9295eacfba20754425fe5999940d67757cc1700a8e0b395efe32577867844ab52774eea3d84c7eebafca9c292abda98bcb26cb266a8947eb6d032678b0582943a87f29869100a28d422e6e7bb25466fc31ebc1a62e50630f0742293ff65e2c4603ff13e962aadb680be5d284401661e34e1dc8287aa4dacb6a4d3cc72428116780ccfd8c38e92bc2e45bf33111f79b9e385ed357121a7f4018ee78d5c512d81d9e6a2c3ef53ed93b4b323b433446ccac476aab182d4834dc4096981fb7c78d7983e25784d82291aa281ff2e720d210670aadec3c30de0762cc0eefcb35f5c0d26af4cbe689b770f3b7e792c0c6902f8a741d339cef3ac59fe7b561ec595a314039a72968ebc48c2d08d32b753a9876417f1fbfb69a8cc294dbbd9e3b598bb27107c6774a2f662c955e31f60a90f429e16c939913725ff7a820f778ea40c3bc7a011b44883403b1bbddc485fc951018a57af883aee2eaa2f0b43ed644276b3f541641acf58603ab094121f258a0741eebffc876fbce8ef65fe1c02b8677c933a4acb7e33aa5e437100919c85fd50eec42001bd03d647b346504a7573c8ff3b8f41a8eb1f7bbda991de03e789fa27db2abcb8f131ea8a1e278f5d57ca490f45a8e656dcec702ebec2efec313af29a113f830268303bb1ca2a3c2b1d9bdec4c6de8281fcffbcb2fe34fb82f8d6777d4f50efba4c996684e911618300b25a34c1783b684a738e9cb7f1eb2e1e64c13f7043e2fae14c36ecf817cdec70911a02847e88c42206faa561789e3cc335a891127a6c2a794e50b812d0e4ee935a61a8eca2b655742787ef952092efbeaa5ced51ed6f8b9003854f8a7460e21955214825d56e94510adc1309b26a03176d90e0a540dec5b1ae2afd088cbd94991e81680beae13bfd04ce903b3002edd8a04ea79853f473a4b0f79c906dfb6f4307c978586233ed2dfe311bc84b64e14525b2ebc8b6a9cf19642e428b47bdc342004aca079bc2fee150db981ba6167263a9d873eae2f214303b181aeb137085a6537982da2165fa798dea734812bf6a7d64aebd10ff49a6ba064c374a20a04941d0417c9f90a16983fd22f39aad13e0c44bd627fe417e6047740d1d7805b193bb1f482e631ce8d2fa552fe9ace7e8144c429adeb1ade0b7a81d5dca6a30e0cf64dcd0a8117fa0c9672a91870ef611cbb7fe3ff78b7f43c507091a4c67a1c0e51f09f10a59e1db938195215248715fd038bd1a5350fcd4a1b907d698797e0f13f7f88e3b113a9ee050e305b2a18001a0c94087be1e57eba6a46e1288263f01bdf8c98b08f1fd8990c1fcd671f5d40a73dc182a45bba9caed03c88eefbb0921332b9737621517e3466dbdb7b54af5f47b0005d8bf82c4a28f4013550f3bb739a117168180280e9ff9a949eb603cf39832d3e8c35af55a06906d83fad29d189f99435bbb069afdf3cf61aca347d1a4b31ac5e0fc43dbbc703c4471275c48ac4825996021efb2c401ed2175805964e749fb9d87ed38a68b34960f79cd76f1a2ea76ab894e79ecc67aecbde041b41da9694d47762cfe50b456233ea35faf57ddcbabac3b5d6cf83633f7e8146a53f402f900548af86133588f7fd32cca80ac24f66c084c50ce9ff3dad09dd6760dd888ac29e967b9cd3052e0916f6c8d4772640474b4ebd1ea044f50d01e7441f6588779ac1facb8f07a5aef905382e0b3d318343ef51bef7ccd5df62c643d5ebcd333226b29ed543cce405293e6af00c739333ddc64abf07020024a05f7552e60dda0d24df333645fcdd3f2d967491b4393189b19b20b4652fc96a756a54f20003b45ee46433004091630ff556d73a8aa9b5bb81403f530efb6ad89ec7dc66b1f954a7e438d88236d3425a5cc6500bd2a5400180ed04327bbcbbfec4957e88fa95dcc1c130fa2a8bb6a125a998946921113a5cb29d55f22e7015b8f3790ccd451d52e05bd56eadc3b81202a51109715c4385483c3c888e30db6d9bfddc24ce2f3f972a4028184ba432bcc8af5ae399bbf25fc28ef1096db0d6d1e65048150215fa66e43ba93f8a1ecdd46a7fc2eef1b3772c0e4f2cedf173fd0d126d9319d87f9102a37cfb08d3c13dea4d055b2bb4e76d338eaf648f2b0f4cdd3170c1212d41d56c87d0c4a0bb83582b2186012a6bcb32124d034d38fcf91d21f5b3cbf0def85246b4b61c53f823ef5b304dde28a02727bbcdccace51fecab6a90b9c28d7284561a58fb311dcb04bedb2cd4accf3919b21970b1f87bde018b85005ed3d85f6a33261c6f33baac52e4207576b4284467c407edd7cf4692af611bd804ad64d67959f0199c6a20cd333b14b9ca89c8a3383efd9e7956fc22ae0e9bfa1f89d9f3d1578e3c0a9ca7db6d26cac1fee04376a4b75fb1e21430dc8b55d6784cc4a29ded294fae936cfe7b3245f4e7a0b8030d252dddf2570a93a6bf3eac1c39ff76f19facd6aa55dcf8f79badbf7bbe3c62db26e660ed61df1b4c334c9cc2b8cade8043e75be70431ccd5034c99c43ac0bae8f3f1356aa626d99b5b28008535a617287de2ff8c00443f9e52ff9676a1ecac4fb771e40d6a3876ba07e0ccbd1bfac780d9e39b22eb2c201206961280176f4ce24e9f0494d48e563c32754c30b816c714ed50329b6cb2349a77c2690d4848616d757397046d6f27d187684223bf7c36565a0a23e498bce445fff29d10b946f2d880f33e78a97b015f4e49760dc469dae0750f970c9e8049b61d93afbb9d6548f8bd413b0c0a113eda17ad2ed01d6793a89c01790e84b0a732843ea334ec17aafe74789e52efa7c6c9036f2ea3fb238722ec9b3aedd901c131db9812ede86ec03fcae37e16bd8129beec5c5fad70a5b1300ec3f19fff2611d011498e9095fcf821d10ef9897812016d37a82538afa9c9530629095e98a1982b95f9056649b65801520d2dcffde55cb69cc0fefe7d2d1f75bc4fa9a7374a8a72892ee2d1607d1571a3692fe03460d66c46986c7de97d89c4c81a7c90d3833e1f4215bf0c00964e7cc3b08bfc3600162e6885dec8d2fd20bc1b99fa9b4162cef8ffd0e1d957dfb544877f2905019442c80ac9cee579c378aab99f0ee192c72080e84cba2742b29f6863cb02dcdb91bd8100a689a27ea2e4f10770b03f43fd07e6936fd369a290511174b9cfe9e91b654599be649a79b48e6240843c451a34ba44585fc5e8bb9466d49d5b05c20f35b2326add7cdda2dd84cdae651c4c31123ee38c31e78a5f0085c9be1599cbe97932bdc01e83d644f6df41f25ed0594e837db20932ea08706b6ae80f340a19b30e58afc97d6a65da82da976078d120146cc05aee569489bfd8bb58eaf652d5455aef7f5c1d96e8d9e1e94159a327d381a8dea4aa3bb04292ef96d9e83b1aa27ade6d45d709eb252edf649184d8382c933dde410c175304e14f0a49643d5733958dc3f29f4bea0997a4a71d0de459569b16a576ecbc4f8f36b533280bdc2db6676cabd01d749d2edf8f81c1293ece70eb9e1888d2cf698028ea48aefbfbcb5cac2f1c2e2f890a4eefa6f21afa652cd1e92366d8c0fbf3620bed1a683f301dd43d10ddb5f6cfcec02c05377f5ec54ab3e4e2b0bb39f5787d965357703b11fd2b0fa4b4e6b983617ce6ea6033104b61f42e094868f5f9f098c5b9789cd4b9666ea5fc65b2c59ab42204926dea1472aa83c2a6d8778cda521b405d9552c5ffcd064e5e468240d357ec7a660b90fac97e0a083f09a28d7df3ea03bab1f60b3e3986e3d4d15bc464efa2cd5535f42911e9479305f322a2e4927cf6f8def7045da0104a31460f5f490cfb8795b9ffb732e5aba684480f315804df6f22d08ce00e5039d6fff75d748ec8ae33507f4c24920ff4de2822090ceca6794ecb7664ad42b594ed1c91397e87f346c8461afd81a52b24ff39fe76413a404ad626d0476fc0d7b6087518ec6a7188c77220114ee615a6cfef416776e5900defc221b93841a7f4a3e1e39f1d4b29be1553cbc9ddb9afa1da41cfc96d15369f34654adc5c4ed00d879d22ea02665bf2fae85d05cb40f3f780797d31554636ca1946eda8f0d047e65fa299934985443f017ec522705d80e1efbb6f98584dba391f4e475fd9dca1f1c9d9f8e3a238b5cabddcad9be17710e09e6ec8f012df5ac2d036104373be99f2268a000f05596604bc42f3c8575adfb40ae73311127028c63284da42473832a7817028a2bc7d516b8a6b78c680acdcc3242fa9f90a77b4be2321ca6613211f8e064328fe30976a9006b4c910b8ee1818a5b992f07af8d61b2442ddf2febc4abcd42e1c6debf1f1049b2aaa68c66fdab3ec6705ddca73a23162dcc2ff9350157747761be598f982bc2123120be8846d8735d2fe45a1adb4131a8ff897f603ec17c528bc76fdacb12a1795c3b9d4d0ac291ce1e1262ebf3b6e8411ea21c45689eaa820b8c69aaa521451a2739e932968ae7451a22dad083c640d5bfaf0d87866e39490bb3a7f1a2e6eb3a9a05de835997d58e46aad64dd5eec44cc8b81abd02653f29017e48b76be5f828c5663f4d6de1d7b3dbf2ccc5baa5f6a742d3ea8dd6cc509b1e45fec3e1204a6271141cadb94968000b8cf734c71ef5a77c6c559f2af770778a8e0a4bb348326e749fc4d2c48b885fc38422e3d5cc15e95f96a9ee92bb3cd535e22d066c81562064e5165dac2f86dd17db526cf5a93fae1afe6a890be4d1760d83cfcd1fe84da353ce42afbfe3385624cfc8752fff4c34a029b63ce063ae80811ea30b14355ebf965fff6ad470d5886bb9955465a6ef16f3a6c66a0aaa8dca7fea7dbae88c146ea6e754f76878812f38a0214af0a18f0f5b684f3e37d10e1232429bd9ae23ae6bbf0b0d1e233c31c809ce1657854591768f5871d5a855047eb95e7618196b2c8244fcc7e34286302c8ee641ae5e7861e7469f1b20ec2906381b49f12b042f83070c44d52431a100a78d55b32e94221910282aba6dd5036c125c5d381f5fd60a4b6d8ae6b0e2a418961205774da0ffaf778f43b0d0be8540e0e15339c395f03a2e520f42129677b1e0c08dd39efc0e6805072b0f95bfe78070dd2178d19dec12a69d676f551095cef06ba2180795ce37197f7810aac89d5319a4766d012c0c895bdc1246f3902685e15b816ef2bccba159952e04e43e8fe9783f6c1a25a346abaa002b2d400819b0c97b7250a17e09d39c5810c89a837d1fb884448d63839a5d78e775454dbc2cf78c8404f6f64d15324728b261ba85e5ed6ea06c01ac0e0d4fb01ca41acdc4c4bb18a76ebf2786b800b63382a5267590f2623a8b5351762a75a391c90f83764989153bf1d248d9da0f8dd78201e4eb6501679fb8118e7c2442185778cb87c714c1db8bc0ef37c33abd2fa466b14923968f0e7d50b4442af220fe837712e4ee133635f9497132dd9a0a799fc1fb5a921f2451755b4c291a880f6909c6f475134ca9f18f13efcfbc65d1d7df5aff223d68ca5a1912a945810da957325c55028953623ac35b772c6eefab83b21e898aa0559e48a495498a8bc8e1e13714a2e588957a68d6d679c584449cfdaa442864ec5ab5983652084a7d9783aa4ceb59020cee75bfca861516674598c993931b2bbc090d2f6cbe4d6dd0b0eed46b3e13ae608da4e416170e62ba5a9cf74fb817d70133b52f88045b89e6a16a032247131a073e379e41b18021591c255044c99a0fa5a81acc1a5a767e1f71e6583e17dc09223906925d7eff1c9ad0aec54629ba8cd8e8854d9c00d9fce4a2b15797ae1c6818ab3205c8998a393b284b749ad08273f4717a0f50772357ee10e3520662142b06aa42bc650a98edf69d9ef2d7185d303c8658eb752ef990183fce33728a730a9e766190c87ded7e029125b78cd6e9fe4dc6554013afb340fc00d24a4c0f60aa9cc987f80b40130caf5130dd8e14326bcd9c9cfc5479affb678d3e49fce3a2887d25727b1fb48fa209ac2ff405db7b904c2da26d8d248ae49588ba45329acf95d14de491a8ecc180bbd1be7d0799d68ceebd904cac52cf928e1718940c1ef9dc2058778bf0f45cfc1cb6d0dcea102f24ff303e8946d00943e8bb215f6c2a067c9409259a0ff0482ba90a4dc6e38a46ad4e2e5ddedabf10f2a68ba4735837efac95f7d4848b1c9ee1fc68634ac76f807d8590cf6761e76f08f1708fc63c1a77231a19b0e350752cf68b6d6cae2e8cbff3955616e5e83fe623b600ba86fba863b6a1dccf7e098d14d2661e643cb89bd14b6658165e8b8c514fc3c607290ed3340561bd24ee2a003bcd66cc3f1955edead6e651b39588fcffc494c4869ab95483616bbd300b52c13d28c103235048dc581dce721e9898cee8372f390489176261ff8e4eff7fed2cce3b5c446585d292a8d75a141d88198dbb91cf89dbc471c314d6afbf69aeab04fd848ffc928c47a4fb31b0561cfd42c25f7b6eb63988e0d1cddf0611482643d38a22522d502a11a7dc5e65bbd2b71348242ca346c69e36315be20e33926e5e028aec90893f1df2c92d9ee8b6763d86840520b4ba6f4459d107923c97b69ef6692dee076c3503e27826030210bce63128f1a1b6fe21fee9fa088f0a558f1708bc8ecd9b8f6bb8f5bc636489c1901de1fa188cba4cfaff5adccfef36f34041b073b03f14e1ec6bcbe9e3e9bc446237646cee5a42cad981765a662a362c149bb726fed7c257ea1b3c038acf4216ccddd75abcd1f65ba0c513bd7995f3494bd6e27e25e0b2ab06927c12520cc659ab2aab42108ad46b1bc33fe85e987f857d699275281d40332fc82bd648bacbe92b688e3a08d03430afc5f8d5bb42e4e509ab163aadc4238e5b056ef96b9e2b4596c4e85df5efbef92c59f7bc335a02a25c6e6a3bd339a58436d84c674ee962a0021b6282ba2a3954dce6ad144854855eda2c5c2bbd60becba773cc4667e2e928cfb21ab926e81fcf66ff9c04c82a76560991c774f1d8aa8bae9334b7f27ae0f2586c3c4c9efd06d3d815a3fa51f81faf432015a41e30805f63746457fb92e8e06b7649763ca98739db61459d985abdb6c36a3b4e874eab79e2fd6dcd74b353c06a99841370df2ef90973ac38e77a407b4fcf3e2d0afd7885e16d20917cd82015284115d6185d8007000b8e81b601405f941e9af84e6195a850c9acae67f538bb3104925d6a31744ff5ddf47b3f73595dc1e1037e00afe0d4083b934c8f3d5ec4d9cee2cddf38cbe2a7301637092271040b35db0e94df50fea8e3dd796370975781e87deda343d80c6666a6c98d6e58f243cf72ca8a87200e060002c5637b2de5d9f4ca8ae914c8c4338909d293eda9855b485f98082cb0ac0e1670b425d4fcf5049052b886f7a65b91b15b6c933aee6d20ce58a9f11439f0873aacb379bef47920f4f4882c3ee2419eec6a4c6653a4c37d72eee5d929d0199bf7cbd1c16f6383e77f0026c1d5c3c4fbb947450736e0dcf65d15a42b28ea7a7e88a4348efa5fe44fec2eb61eb20e5fa5b05c6e43ce563beea404f60308a54f6ea5eb38cbddff4815b249ce82e6295d8bc2b6305a5cc8d727259ca57a62357d405c53ab5bdbb64b26b2e9125c7bbaa83566b1bed7d17f56e8f8d6ea860b75250bb16fd82e9bf0df58b284349b02131493ad0a047f00a6379f7e2e35d7187107b3bb052d96f21fb0cbb316394d1aa2552ea731b5fd3aebfded9e63bf8fd49bc6f67c78d4817d3be8ad0ab1a780ba7860d6b027feb94712bef88fc00be67489f9757826ae9dd7165bf48c8ac0b9c15fff58a579a9341294b55a32af771026cb425bd438391acb9e51ec4801da2b3fbfd993a2b23fceb754ff5602313c7b655745477acc78a1c0613d161a682f5419e7eb89394b7b33f25f767c25820479a3c6b9e81be511206a2cd560bfde242749296412497f286fb55e8dc1ea5ed49fe59975a99947b08718342fe5bd9a1f983abf1fea8e26f5c4664e16c33f079e52fc1e3645138454fc004d2e5daf0893e562db58f2a200d23d8c9e699e0c2cddaa26b69944976721239955ac8a98518cdb124533dc1e988715071098746370ae9635d9ff183e21d9afc4e35886557f97124f3ae964d587fbba4951d7a6d116648852f4a5f3c13c6c4d00d5fc75f9dc018a6432f42f3fa5b4613d8f9b9696e89449f4000f793aeb55d28af16390ef8498c300ead745d96383f11473c471ddbdeca751878c20b734c158b983546e9302a42af7b38fcfa11ef2c75a2348de6ab8576f6a16b70a699651ef5cd9547abb0a6b70e99464f4716466bf874e729234999a87e9891a888bf87ed8beb7850e1df2269cf885c0a99ff1cdfb281c96153a520ac0b636c789498a4d4b2f672701c3e4a4e461f0fc0854d7ab19435557d15a51ba7ca46fb353bcb635abca7e79032df265ec890e3b8bc5fea52fcd52cafae706584a482b6606c04861db7cd889618430b5d6741524b6d912367bcee2cf8da89a92ab7c3700986e7494998a0a07b6787258c6040a987c431247aa0001cd066afa5ba54ead3213210f487280283b056680d50d44b07e05c9930010967cb20843e63e63bac0f6879d4159b603f2decd7997b698badff3dd9c761d6e8f487f4e6e88d3cd3673640294f918213f504a0059cf4e04b66840b273080a8005eee149ab1f9ffd09839afe1ee198a7a9742ef720c72b9dbbdc49c7d8ff4da1091791888528327c98bf069adcd5aa57384331d7a91e60260adf8845e19653dd07f8b0c63b15b4535aaa328954138d6ce420c94ea2c4d34a2821fc4b00f1dd1ab3c7fe6f6a3924529421d062145d16404e80c46139470f092d4a6133c58d3b2f9633f3788795c5978148eceb2def7f4206c0db552c3651bfb4f4bafc2d4f7e5251c305b6ead6e69727f761b84fc40c40ddcc79063e4bcb4034270d1796c5d8f69ad533dfefa7b87b41ba99046d4157eef3ea49c6be86e88db7805c18f1a1f6f86a593f132034625016d0ddd4c204e376a2fea10c6a3dbb8f79764510c3fda51230edd09f95c02fa41ddd9c404c5bd3c20ed0261429407f86563d830e554b1d7eadca0dbf2b0643698a72c62f303dc8e4cef96b063e0846bebc1955e2a576f0e521dc0c47c9cebd5ea6ebbeb1fd82a023ecfd0309b0336ff7e57b8efa2ec798d27b576e41fb9908a46baa4c7a2d100239064910869ed1be1ee54a689ef9666878a8baad6e717c05792345b704a28290fa24911ba5dd9a508901fbd5c03978fb1396722ee2f3d5602467</script>\n  <div class=\"hbe hbe-content\">\n    <div class=\"hbe hbe-input hbe-input-default\">\n      <input class=\"hbe hbe-input-field hbe-input-field-default\" type=\"password\" id=\"hbePass\">\n      <label class=\"hbe hbe-input-label hbe-input-label-default\" for=\"hbePass\">\n        <span class=\"hbe hbe-input-label-content hbe-input-label-content-default\">Hey, password is required here.</span>\n      </label>\n    </div>\n  </div>\n</div>\n<script data-pjax src=\"/lib/hbe.js\"></script><link href=\"/css/hbe.style.css\" rel=\"stylesheet\" type=\"text/css\">",
            "tags": [
                "Hexo",
                "Front Matter",
                "code"
            ]
        },
        {
            "id": "https://enjundu.github.io/bit/%E4%BA%9A%E5%A4%AA%E6%95%B0%E6%A8%A1%E2%80%94%E2%80%94%E6%96%B0%E8%83%BD%E6%BA%90%E6%B1%BD%E8%BD%A6/",
            "url": "https://enjundu.github.io/bit/%E4%BA%9A%E5%A4%AA%E6%95%B0%E6%A8%A1%E2%80%94%E2%80%94%E6%96%B0%E8%83%BD%E6%BA%90%E6%B1%BD%E8%BD%A6/",
            "title": "亚太数模——新能源汽车",
            "date_published": "2024-07-04T14:49:23.000Z",
            "content_html": "<h2 id=\"abstract\"><a class=\"anchor\" href=\"#abstract\">#</a> ABSTRACT</h2>\n<p>This study presents a comprehensive analysis of new energy electric vehicles (NEEVs) in China, employing a range of statistical methods and advanced algorithms. Using tools such as MATLAB, SPSS, and Excel, the research systematically addresses several critical questions regarding the development, impact, and future trajectory of NEEVs.</p>\n<ol>\n<li><strong>Development of NEEVs in China</strong>: The study investigates the rapid growth of NEEVs in China, highlighting the influence of technological advancements and supportive government policies. An upward trend in vehicle ownership and market size is revealed, attributed to factors such as government subsidies, carbon emissions, and advancements in battery technology.</li>\n<li><strong>Predictive Modeling</strong>: Predictive models, including multiple regression, ARIMA time series, and random forest algorithms, are employed to forecast the development of NEEVs over the next decade. The models indicate robust growth in sales and market penetration, driven by reduced costs and technological improvements.</li>\n<li><strong>Market Dynamics</strong>: The research delves into the specific factors affecting the NEEV market in China, identifying key contributors such as patent applications, subsidies, and battery capacities. Regression analysis shows a positive relationship between these factors and the growth of NEEV ownership and market size.</li>\n<li><strong>Impact on Traditional Energy Vehicles</strong>: The study assesses the impact of NEEVs on the global traditional energy vehicle industry, indicating a market transition favoring electric vehicles. This shift is driven by technological advancements, economic considerations, and environmental benefits associated with electric vehicles.</li>\n<li><strong>Government and International Policies</strong>: The analysis extends to the effects of international policies on the development of NEEVs in China. Policies from countries like Germany, Japan, and the United States are examined, revealing their influence on China's NEEV market dynamics.</li>\n<li><strong>Ecological Benefits</strong>: The study evaluates the ecological benefits of NEEVs, particularly in urban areas. It highlights significant reductions in carbon emissions when conventional vehicles are replaced with electric ones, underscoring the environmental advantages of NEEV adoption.</li>\n</ol>\n<p>In conclusion, the paper provides a detailed evaluation of the NEEV market in China, offering valuable insights into its development, market dynamics, and future prospects. The findings underscore the importance of NEEVs in fostering environmental sustainability and economic growth.</p>\n<p><strong>Keywords</strong>: New Energy Electric Vehicles, Statistical Analysis, ARIMA, GA-BP Neural Network, Random Forest, Market Trends, Environmental Sustainability.</p>\n<p><em><strong>*Content*</strong></em></p>\n<p><em><strong>*ABSTRACT*</strong></em>\t<em><strong>*1*</strong></em></p>\n<p><em><strong>*Content*</strong></em>\t2</p>\n<p><em><strong>*1.*</strong></em>\t<em><strong>*Introduction*</strong></em>\t3</p>\n<p>1.2 Problem background\t3</p>\n<p>1.3 Restatement of the Problem\t3</p>\n<p>1.4 Our work\t4</p>\n<p><em><strong>*2.*</strong></em>\t<em><strong>*Assumptions and Justifications.*</strong></em>\t6</p>\n<p><em><strong>*3.*</strong></em>\t****Notation****s\t6</p>\n<p><em><strong>*4.*</strong></em>\t<em><strong>*Data Desceiption*</strong></em>\t7</p>\n<p>4.1Data Collection\t7</p>\n<p>4.2 Data Cleaning\t7</p>\n<p><em><strong>*5.Models and solutions*</strong></em>\t8</p>\n<p>5.1 Analyzing the main factors affecting the development of new energy electric vehicles in China\t8</p>\n<p>5.2 Predicting the future development of new energy electric vehicles in China in the next 10 years.\t12</p>\n<p>5.3 Collect data and establish a mathematical model to analyze the impact of new energy electric vehicles on the global traditional energy vehicle industry.\t19</p>\n<p>5.4 Some countries have formulated a series of policies targeted to resist the development of new energy electric vehicles in China. Establish a mathematical model to analyze the effects of these policies on the development of new energy electric vehicles in China.\t23</p>\n<p>5.6 Based on the conclusion of question 5, write an open letter to the citizens to publicize the benefits of new energy electric vehicles and the contributions of the electric vehicle industry in various countries around the world.\t25</p>\n<p><em><strong>*Appendi*</strong></em><em><strong>*x*</strong></em>\t27</p>\n<p>\\1. <strong>Introduction</strong></p>\n<p><strong>1.1</strong> <em><strong>*Problem background*</strong></em></p>\n<p>New energy vehicles refer to vehicles with advanced technical principles, new</p>\n<p>technologies and new structures, which use unconventional vehicle fuel as their power source (unconventional automotive fuels refer to fuels other than gasoline and diesel) and integrate advanced technologies in vehicle power control and drive. New energy vehicles include four major types: hybrid electric vehicles, pure electric vehicles, fuel cell electric vehicles, and other new energy vehicles. As a type of new energy vehicle, new energy electric vehicles have achieved rapid development in recent years due to their properties of low pollution, low energy consumption, and ability to regulate peak electricity consumption. New energy electric vehicles, including electric buses and family electric cars with less than 7 seats, have been popular with consumers and governments around the world.</p>\n<p>Since 2011, the Chinese government has actively promoted the development of new energy electric vehicles and formulated a series of preferential policies. The new energy electric vehicle industry has achieved tremendous development, gradually becoming another Chinese symbol after the “China High Speed Railway”.</p>\n<p><strong>1.2</strong> <em><strong>*Restatement of the Problem*</strong></em></p>\n<p><em><strong>*problem*</strong></em> <em><strong>*1*</strong></em></p>\n<p>Analyze the main factors that affect the development of new energy electric vehicles in China, establish a mathematical model, and describe the impact of these factors on the development of new energy electric vehicles in China.</p>\n<p><em><strong>*problem*</strong></em> <em><strong>*2*</strong></em></p>\n<p>Collect industry development data on China’s new energy electric vehicles, establish a mathematical model to describe and predict the development of China’s new energy electric vehicles in the next 10 years.</p>\n<p><em><strong>*problem*</strong></em> <em><strong>*3*</strong></em></p>\n<p>Collect data and establish a mathematical model to analyze the impact of new energy electric vehicles on the global traditional energy vehicle industry.</p>\n<p><em><strong>*problem*</strong></em> <em><strong>*4*</strong></em></p>\n<p>Some countries have formulated a series of policies targeted to resist the development of new energy electric vehicles in China. Establish a mathematical model to analyze the effects of these policies on the development of new energy electric vehicles in China.2</p>\n<p><em><strong>*problem*</strong></em> <em><strong>*5*</strong></em></p>\n<p>Analyze the impact of the electrification of new energy electric vehicles (including electric buses) in cities on the ecological environment. Assuming that there is an urban population of 1 million, provide the calculation results of the model.</p>\n<p><em><strong>*problem*</strong></em> <em><strong>*6*</strong></em></p>\n<p>Based on the conclusion of question 5, write an open letter to the citizens to publicize the benefits of new energy electric vehicles and the contributions of the electric vehicle industry in various countries around the world.</p>\n<p><strong>1.3</strong> <em><strong>*Our work*</strong></em></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/UbNpk4d2zYBxO1s.png\" alt=\"image.png\" /></p>\n<p><strong>1.1.1</strong> <em><strong>*problem 1*</strong></em></p>\n<p>In analyzing China's new energy electric vehicles, we identified key factors like vehicle ownership and market size as dependent variables and included patent applications, subsidies, carbon emissions, battery capacities, vehicle price, and market penetration as independent variables. Our regression analysis showed an upward trend in vehicle ownership, suggesting a positive development in the sector. We addressed variable collinearity and established a robust model, highlighting the significant relationship between vehicle ownership, yearly changes, patent applications, and subsidy amounts.</p>\n<p><strong>1.1.2</strong> <em><strong>*Problem 2*</strong></em></p>\n<p>Our study predicts a bright future for China's new energy vehicles, with sales trends showing considerable growth since 2013. Using a multiple linear regression model based on 19 independent variables, we forecasted the sector's growth for the next decade. The model exhibited an excellent fit, accurately mirroring the actual sales trends and projecting a continued rise in new energy vehicle sales.</p>\n<p><strong>1.1.3</strong> <em><strong>*Problem 3*</strong></em></p>\n<p>Our research involved extensive data preparation and exploratory analysis to understand the impact of electric vehicles on the traditional energy vehicle industry. By employing time series, scatter plots, and correlation matrices, we established a VAR model to analyze the dynamic relationship between electric and traditional vehicle sales. The results indicated a significant influence of electric vehicle growth on the traditional vehicle market, informing policy implications and future industry trends.</p>\n<p><strong>1.1.4</strong> <em><strong>*Problem 4*</strong></em></p>\n<p>This section assessed how international policies like Germany and Japan's opposition, the US Inflation Reduction Act, and the EU's investigation into Chinese electric vehicles affected China's market. Our analysis, based on export data and policy impacts in 2022 and 2023, revealed that these policies have somewhat hindered the growth of China's new energy vehicle exports.</p>\n<p><strong>1.1.5</strong> <em><strong>*Problem 5*</strong></em></p>\n<p>Our study evaluated the ecological benefits of electrifying vehicles in urban areas. By comparing carbon emissions from traditional and electric vehicles, we concluded that a complete switch to electric vehicles could drastically reduce carbon emissions in a city of one million people, emphasizing the environmental advantages of electric vehicle adoption.</p>\n<p><strong>1.1.6</strong> <em><strong>*Problem 6*</strong></em></p>\n<p>In an open letter to citizens, we highlighted the significant role of new energy electric vehicles in achieving a sustainable future. The letter underlined the environmental and technological benefits of electric vehicles, noting advancements in battery technology and smart systems. We encouraged public recognition of these benefits and the positive future outlook for the electric vehicle industry.</p>\n<p>\\1. <strong>Assumptions and Justifications</strong>**.**</p>\n<p><strong>A****ssumption 1:</strong> It is assumed that the data in each form is real and valid, and the sampling error is small. Only when the model is built on real data can reliable prediction results be obtained.</p>\n<p><strong>A****ssumption 2:</strong> It is assumed that the influence of other factors such as Consumer Acceptance is not considered. The model selects some factors that have a greater impact on vehicle ownership, vehicle market size and etc. as independent variables. Only by ignoring the influence of other factors can be reasonable prediction equation be obtained.</p>\n<p><strong>A****ssumption 3</strong>: It is assumed that the data obtained from the search has a certain degree of credibility and rationality. And the data is relatively complete.</p>\n<p>\\2. <strong>Notations</strong></p>\n<p><strong>Table</strong> <strong>1</strong> <strong>Symbol</strong> <strong>Description</strong></p>\n<table>\n<thead>\n<tr>\n<th><em><strong>*Symbol*</strong></em></th>\n<th><em><strong>*Explanation*</strong></em></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><em><strong>*β*</strong></em></td>\n<td>the coefficient of x</td>\n</tr>\n<tr>\n<td><em><strong>*X*</strong></em><em><strong>*Y*</strong></em></td>\n<td>self variantimplicit variant</td>\n</tr>\n</tbody>\n</table>\n<p>\\3. <strong>Data Desceiption</strong></p>\n<p><em><strong>*4.1Data Collection*</strong></em></p>\n<p>Due to the fact that the mathematical modeling problem in this study is related to the development of new energy vehicles, in order to collect datasets related to the development of new energy vehicles, we searched many databases. The data in these databases are all related to new energy vehicles, and due to the different types of data provided by different databases, we integrated the data on an annual basis into a table. Below are the sources of the data and the meanings of variables.</p>\n<p><em><strong>*Table 2 Dataset source*</strong></em></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/CnsZD9HIi3qmerM.png\" alt=\"image.png\" /></p>\n<p><em><strong>*4.2 Data Cleaning*</strong></em></p>\n<p><em><strong>*4.2.1 Data missing value processing*</strong></em></p>\n<p>Due to the different departments and cycles of data recording, the amount of data in different data sets is not the same. In order to make the data sets of each variable available, the missing values in the data sets should be dealt with accordingly. In this paper, the regression interpolation method based on the serial trend is used to deal with the missing values of the data.</p>\n<p><em><strong>*4.2.2 Data Standardization processing*</strong></em></p>\n<p>Since each variable has different units and orders of magnitude, we standardize each data in order to facilitate the construction of our multiple regression model. In this paper, z-scores are used to process the data. It can be expressed by the following equation:</p>\n<p>*z=(x-μ)/*<em>σ</em>\t\t\t\t\t\t\t\t\t（1）</p>\n<p><em><strong>*4.2.3 Factor correlation analysis chart*</strong></em></p>\n<p>According to the following correlation coefficient heatmap, it can be seen that when New energy vehicle ownership (10000 vehicles) and New Energy Vehicle Market Size (RMB bill) are used as dependent variables, their values are related to Year, Number of patient applications for new energy vehicles (items), Amount of subsidiaries for new energy vehicles (RMB bill), Total carbon emissions (miles of tons) Lithium iron phosphate power battery installed capacity/GWh, installed capacity of term battery/GWh, and weighted average price of new energy vehicles ($10000) are all related. And the correlation coefficients are relatively large (greater than 0.8 and mostly 0.95-1)</p>\n<p>Therefore, the quantities we collected all have strong correlation, and they can all be used as independent variables to predict the sales or development of new energy vehicles.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/M3q9CDOzgfIFwJN.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture2 Correlation coefficient heat map*</strong></em></p>\n<p><strong>5.Models and solutions</strong></p>\n<p><em><strong>*5.1 Analyzing the main factors affecting the development of new energy electric vehicles in China*</strong></em></p>\n<p><em><strong>*（1）Data collection*</strong></em></p>\n<p>We organize the collected data and set Year as an irrelevant variable, but changes in Year will affect the subsequent changes, so we keep Year. then we set New energy vehicle ownership (10,000 vehicles) and New Energy Vehicle Market Size (RMB billion) as dependent variables because our group believes that changes in these two variables can reflect changes in the development of new energy electric vehicles in China. Then we set Number of patent applications for new energy vehicles (items), Amount of subsidies for new energy vehicles (RMB billion), Total carbon emissions ( millions of tons), Lithium iron phosphate power battery installed capacity/GWh, Installed capacity of ternary battery/GWh, Weighted average price of new energy vehicles ($10,000), New energy vehicle market penetration (%) are set as independent variables, considering that they are the main factors affecting the change of the dependent variable.</p>\n<p>Therefore, we design the statistical graph as shown below.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/f4hN28J9a1mEk6X.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture3 Statistical data on factors affecting the development of new energy vehicles*</strong></em></p>\n<p><strong>（2）</strong><em><strong>*New energy vehicle ownership (10,000 vehicles) multiple regression curve*</strong></em></p>\n<p>According to the change of New energy vehicle ownership (10,000 vehicles) and its first-order difference curve over the years, it can be seen that New energy vehicle ownership (10,000 vehicles) shows an upward trend, so the factors in the multivariate regression curve of New energy vehicle ownership (10,000 vehicles) should generally show an upward trend after weighting. Therefore, the factors in the multiple regression curve of New energy vehicle ownership (10,000 vehicles) should be in an upward trend after weighting in general. And we can also know that the curve of New energy vehicle ownership (10,000 vehicles) is accelerating in general.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/waLd5vgBN1xM4pt.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture4 Vehicle ownership and its first-order difference curve vary with year*</strong></em></p>\n<p>The analysis of the results of the F-test shows that the P-value of significance is 0.001 * * *, which is significant at the level and rejects the null hypothesis of a regression coefficient of 0. Therefore, the model basically meets the requirements.</p>\n<p>For the collinearity performance of variables, the VIF values of Year, Number of patent applications for new energy vehicles (items), Amount of subsidiaries for new energy vehicles (RMB bill), Total carbon emissions (miles of tons), Lithium iron phase power battery installed capacity/GWh, Installed capacity of term battery/GWh, Weighted average price of new energy vehicles ($10000) are greater than 10, There is a collinear relationship, so it is easy to remove the collinear independent variables or perform ridge regression or stepwise regression.</p>\n<p>The formula of the model is as follows: y=-0.046-0.507 * Year -0.155 * Number of patient applications for new energy vehicles (items)+1.81 * Amount of subsidiaries for new energy vehicles (RMB bill)+0.028 * Total carbon emissions (miles of tons) -0.556 * Lithium iron phase power battery installed capacity/GWh+1.402 * Installed capacity of term battery/GWh+44.817 * Weighted average price of new energy vehicles ($10000).</p>\n<p>This also confirms that the fit is very good.</p>\n<p><strong>Table3 Table of results of linear regression analysis</strong></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/eT6WKdN4sLfBkYz.png\" alt=\"image.png\" /></p>\n<p New=\"\" energy=\"\" vehicle=\"\" ownership=\"\" (10000=\"\" vehicles)=\"\">The following figure shows the independent variables X: {Year, Number of patient applications for new energy vehicles (items), Amount of subsidiaries for new energy vehicles (RMB bill), Total carbon emissions (miles of tons), Lithium iron phase power battery installed capacity/GWh, Installed capacity of term battery/GWh, Weighted average price of new energy vehicles ($10000)}; The relationship between the dependent variable Y:</p>\n<p>We order:</p>\n<p>y=New energy vehicle ownership (10,000 vehicles)</p>\n<p><em>x</em>1=Year</p>\n<p><em>x</em>2=Number of patent applications for new energy vehicles (items)</p>\n<p><em>x</em>3=Amount of subsidies for new energy vehicles (RMB billion)</p>\n<p><em>x</em>4=Total carbon emissions (millions of tons)</p>\n<p><em>x</em>5=Lithium iron phosphate power battery installed capacity/GWh</p>\n<p><em>x</em>6=Installed capacity of ternary battery/GWh</p>\n<p><em>x</em>7=Weighted average price of new energy vehicles ($10,000)</p>\n<p>According to the statistics listed above,we could get this function：</p>\n<p>y=-0.046-0.507<em>x</em>1-0.155<em>x</em>2+1.81<em>x</em>3+0.028<em>x</em>4-0.556<em>x</em>5+1.402<em>x</em>6+44.817<em>x</em>7（2）</p>\n<p><strong>Table4 multivariate regression coefficient value</strong></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/Sa6Z4jpmUWsYM21.png\" alt=\"image.png\" /></p>\n<p>The following graph shows the raw data plot, model fitted values, and model predicted values for this model.</p>\n<p>According to the graph, the fit is very good.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/oG1wCaSuvhMyKEj.png\" alt=\"image.png\" /></p>\n<p><strong>Picture5 Comparison of model fit and true value</strong></p>\n<p>Based on the resultant fit we know that the predicted value of New energy vehicle ownership (10,000 vehicles) is very close to the true value and the fit is successful.</p>\n<p><strong>（3）</strong><em><strong>*New Energy Vehicle Market Size (RMB billion) multiple regression curve*</strong></em></p>\n<p><em><strong>*In the same way as above, we can obtain a set of equations：*</strong></em></p>\n<p>New Energy Vehicle Market Size (RMB billion)=-0.569-6.291（Year）-1.893*（Number of patent applications for new energy vehicles (items)）+28.455*（Amount of subsidies for new energy vehicles (RMB billion)）+0.344（Total carbon emissions (millions of tons)）-5.866*（Lithium iron phosphate power battery installed capacity/GWh）+16.201*（Installed capacity of ternary battery/GWh）+559.405*（Weighted average price of new energy vehicles ($10,000)）</p>\n<p><strong>（4）</strong><em><strong>*Analyzing and summarizing the first question*</strong></em></p>\n<p>In general, government subsidies, total carbon emissions, installed capacity of ternary batteries, and the weighted average price of new energy vehicles have a positive impact on the market size, while the number of patent applications and the installed capacity of lithium iron phosphate power batteries have a negative impact.</p>\n<p>However, from my perspective, an increase in the number of patent applications may signify the growing applicability of patents to new energy vehicles. Additionally, as the development of lithium iron phosphate power batteries matures, it is likely to have a positive impact on the market size. We recognize that during the initial stages of technological development, significant investments are required, and any short-term negative impacts may be inconsequential. Following our group research, a consensus has emerged that these factors will likely contribute positively to the new energy vehicle market in the future.</p>\n<p>Therefore, it is conceivable that a higher number of patent applications could reflect increased technological relevance to new energy vehicles, and the mature development of lithium iron phosphate power batteries may eventually contribute positively to the market size. As our group collectively believes, these factors are expected to benefit the new energy vehicle market substantially in the future.</p>\n<p><em><strong>*5.2 Predicting the future development of new energy electric vehicles in China in the next 10 years.*</strong></em></p>\n<p>(1)<em><strong>*Preliminary trend of increase/decrease based on sales graphs*</strong></em></p>\n<p>The sales of new energy vehicles year by year according to the year - sales plotted as the following curve, from which we can see that the sales of new energy vehicles and the year between the year does have a rising trend, and we can see that the sales of new energy vehicles in the initial emergence of the trend of low-frequency slow growth in about 2013, and in 2020 after the trend of high rate of growth, the analysis of the world's new energy science and technology and the Chinese government's new energy vehicle policy support and other factors, to be discussed in the follow-up.<img data-src=\"https://s2.loli.net/2024/07/04/nysUCTQd6HGLNzp.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture6 Year vs. graph Production and sales of new energy vehicles (10,000 units)*</strong></em></p>\n<p>After the sales of new energy vehicles are processed by the first-order difference, the obtained first-order difference-year graph shows an exponential growth trend, which generally shows a relatively smooth first and a rapid growth trend until the beginning of 2020. Overall it is still in the form of growth.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/aBuoMKwGljnqWkF.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture*</strong></em><em><strong>*7 first-order difference in value Production and sales of new energy vehicles*</strong></em></p>\n<p><strong>(2)</strong> <em><strong>*Modeling based on multiple regression linear curves*</strong></em></p>\n<p>(3) Combining examples and research, we can find that the change of annual sales of new energy vehicles is related to Year、New energy vehicle ownership (10,000 vehicles)、New Energy Vehicle Market Size (RMB billion)、New energy vehicle market penetration (%)、New Energy Vehicle YoY Growth Rate (%)、Number of new energy vehicle enterprises (number)、Number of patent applications for new energy vehicles (items)、Scale of new energy vehicle industry chain (home)、Number of charging piles for new energy vehicles (10,000)、Coverage of new energy vehicle charging infrastructure (%)、Amount of subsidies for new energy vehicles (RMB billion)、Market penetration of conventional fuel vehicles (%)、Total carbon emissions in the Yangtze River Delta region (million tons)、Production and sales of conventional vehicles (10,000 units)、Conventional Vehicles YoY Growth Rate (%)、Lithium iron phosphate power battery installed capacity/GWh、Installed capacity of ternary battery/GWh、Total carbon emissions (millions of tons)、Weighted average price of new energy vehicles ($10,000)and other variable factors are closely related.</p>\n<p>Therefore, we will model the relationship between Production and sales of new energy vehicles (10,000 units) and the other 19 independent variables based on the collected dataset.And the model's conclusions are used to predict the development of new energy electric vehicles in China over the next decade.</p>\n<p>​\t⚫ Build multiple linear models</p>\n<p>We order:</p>\n<p><em>x</em>1=Year</p>\n<p><em>x</em>2=New energy vehicle ownership (10,000 vehicles)</p>\n<p><em>x</em>3=New Energy Vehicle Market Size (RMB billion)</p>\n<p><em>x</em>4=New energy vehicle market penetration (%)</p>\n<p><em>x</em>5=New Energy Vehicle YoY Growth Rate (%)</p>\n<p><em>x</em>6=Number of new energy vehicle enterprises (number)</p>\n<p><em>x</em>7=Number of patent applications for new energy vehicles (items)</p>\n<p><em>x</em>8=Scale of new energy vehicle industry chain (home)</p>\n<p><em>x</em>9=Number of charging piles for new energy vehicles (10,000)</p>\n<p><em>x</em>10=Coverage of new energy vehicle charging infrastructure (%)</p>\n<p><em>x</em>11=Amount of subsidies for new energy vehicles (RMB billion)</p>\n<p><em>x</em>12=Market penetration of conventional fuel vehicles (%)</p>\n<p><em>x</em>13=Total carbon emissions in the Yangtze River Delta region (million tons)</p>\n<p><em>x</em>14=Production and sales of conventional vehicles (10,000 units)</p>\n<p><em>x</em>15=Conventional Vehicles YoY Growth Rate (%)</p>\n<p><em>x</em>16=Lithium iron phosphate power battery installed capacity/GWh</p>\n<p><em>x</em>17=Installed capacity of ternary battery/GWh</p>\n<p><em>x</em>18=Total carbon emissions (millions of tons)</p>\n<p><em>x</em>19=Weighted average price of new energy vehicles ($10,000)</p>\n<p>y=β0+β1<em>x</em>1+β2<em>x</em>2+β3<em>x</em>3+β4<em>x</em>4+β5<em>x</em>5+β6<em>x</em>6+β7<em>x</em>7+β8<em>x</em>8+β9<em>x</em>9+β10<em>x</em>10+β11<em>x</em>11+β12<em>x</em>12+β13<em>x</em>13+β14<em>x</em>14+β15<em>x</em>15+β16<em>x</em>16+β17<em>x</em>17+β18<em>x</em>18+β19<em>x</em>19 \t\t\t\t\t\t\t\t\t\t\t\t<strong>(<strong><strong>3</strong></strong>)</strong></p>\n<p>Using the python code for the multiple regression algorithm (Appendix 1), we can get the value of this multiple regression equation as:</p>\n<p>y=-175.361921+0.786334<em>x</em>1+4.674333<em>x</em>2+0.133171<em>x</em>3+1.340155<em>x</em>4+0.203066<em>x</em>5+5.114536<em>x</em>6-1.460884<em>x</em>7+0.602279<em>x</em>8+2.367206<em>x</em>9-7.039104<em>x</em>10+7.524213<em>x</em>11-1.340155<em>x</em>12-0.623688<em>x</em>13+0.488335<em>x</em>14-6.786688<em>x</em>15-2.279974<em>x</em>16+5.143792<em>x</em>17-0.075757<em>x</em>18+0.393167<em>x</em>19\t\t\t\t\t\t\t\t\t\t\t\t\t\t  <strong>(<strong><strong>4</strong></strong>)</strong></p>\n<p>​</p>\n<p><strong>Table****5</strong> <strong>Model</strong> <strong>Summary</strong></p>\n<table>\n<thead>\n<tr>\n<th>Model</th>\n<th>R</th>\n<th>R square</th>\n<th>Adjust R square</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td></td>\n<td>0.930</td>\n<td>0.865</td>\n<td>0.980</td>\n</tr>\n</tbody>\n</table>\n<p>According to the multiple regression model it is shown that the model R is 0.930, the square of R is 0.865 and the adjusted R square value is 0.980, which indicates a very good fit.</p>\n<p>Hypothesis is raised in F-test: all coefficients are 0. From the ANOVA table (see appendix), it can be seen that the p value of the F test is &lt;0.001, and the null hypothesis is rejected at the significance level of 0.05, and the test is passed.</p>\n<p>We substituted formulas to calculate projected annual sales based on the values of the other nineteen formulas (the algorithm is attached in the Appendix), and then calculated a graph of year-annual sales - projected sales as follows.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/OjX4MycbRzuod8W.png\" alt=\"image.png\" /></p>\n<p><em><strong>*picture8 imagery of year-annual sales - projected sales*</strong></em></p>\n<p>From the above figure, we can find that the number of expected annual sales and the actual number of annual sales is really too close, leading to the fact that we may wonder whether there is a second line drawn, so we do not put a different way of thinking, to make the number of expected annual sales - the actual number of annual sales of the x-y curve, we can clearly see that the slope of the image k = 1, and the intercept is only -0.0046, which is very small, so you can approximate that the predicted results are exactly the same as the actual results. The fit is valid.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/W7yidw4JYGRtPUK.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture9 Forecasted - Actuall Number of units sold*</strong></em></p>\n<p>From the graph I gave and the formula new energy vehicle production and sales (10,000 units) = -175.361921 + 0.786334 × year + 4.674333 × new energy vehicle ownership (10,000 units) + 0.133171 × new energy vehicle market size (100 million yuan) + 1.340155 × new energy vehicle market penetration rate (%) + 0.203066 × new energy vehicle vehicle chain growth rate (%) +5.114536×number of new energy vehicle enterprises (home) +-1.460884×number of new energy vehicle patent applications (item) +0.602279×size of new energy vehicle industry chain (home) +2.367206×number of new energy vehicle charging piles (10,000 pcs) +-7.039104×coverage of new energy vehicle charging infrastructure ( %) + 7.524213 × amount of subsidies for new energy vehicles (RMB 100 million) + -1.340155 × market penetration rate of traditional fuel vehicles (%) + -0.623688 × total carbon emissions in the Yangtze River Delta region (millions of tons) + 0.488335 × production and sales volume of traditional vehicles (10,000 vehicles) + -6.786688 × chain growth rate of traditional vehicles (%) + - 2.279974×Lithium iron phosphate power battery installed volume/GWh+5.143792×Ternary battery installed volume/GWh+- can be known.</p>\n<p>\\1. New energy vehicle production and sales (10,000 units) and year, new energy vehicle ownership (10,000 units), new energy vehicle market size (RMB 100 million), new energy vehicle market penetration rate (%), new energy vehicle chain growth rate (%), number of new energy vehicle enterprises (home), new energy vehicle industry chain size (home) new energy vehicle industry chain size (home), number of new energy vehicle charging piles (10,000) The independent variables of new energy vehicle subsidy amount (RMB 100 million), installed capacity of ternary batteries/GWh, and weighted average price of new energy vehicles (RMB 10,000) are positively correlated.</p>\n<p>\\2. Negative correlation with total carbon emissions (million tons), chain growth rate of conventional vehicles (%), etc.</p>\n<p>From the following change curves of the respective variables, it can be seen that the total sales volume of new energy vehicles (10,000 units) will grow exponentially in the next ten years.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/BwtxHlyNRXcsh3g.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture10 The variation curve of each variable over the year（1）*</strong></em></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/2wXANi7ZkCgn4FW.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture11 Comparison of Market Penetration Rates of Conventional and New Energy Vehicles*</strong></em></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/5PZpFxaSj2vr8Xo.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture12 The variation curve of each variable over the year（2）*</strong></em></p>\n<p>In summary, I have the following views on the development of new energy vehicles in China in the next decade:</p>\n<p>\\1. In the next decade, the number of new energy vehicles (10000 units) will steadily increase, currently showing a cubic growth, and will continue to grow until reaching a certain order of magnitude and starting to grow steadily and slowly.</p>\n<p>\\2. The scale of the new energy vehicle market (in billions of RMB) will be greatly increased, gradually surpassing the sharp decline in the traditional vehicle market size with increasing derivatives</p>\n<p>\\3. The penetration rate (%) of the new energy vehicle market will gradually increase, ultimately reaching over 70%.</p>\n<p>\\4. The month on month growth rate (%) of new energy vehicles will first increase and then decrease. As the month on month growth is compared to the previous year's growth, the growth rate will not be particularly high in the future, but overall it still shows a growth trend.</p>\n<p>\\5. The number of new energy vehicle enterprises will increase. As new energy vehicles are an emerging market, manufacturers such as Tesla will make a lot of money, which will attract more manufacturers to enter new energy. At present, the most representative manufacturers are Huawei's Wenjie and Xiaomi Motors.</p>\n<p>The number of patent applications for new energy vehicles will gradually increase, and then gradually decrease. Due to the current peak period of new energy vehicle development, it is normal for patents to spring up one after another. As the new energy industry gradually matures in the future, the number of patents will decrease.</p>\n<p>\\7. The scale of the new energy vehicle industry chain will gradually increase, consistent with the conclusion in 5</p>\n<p>The number of new energy vehicle charging stations (10000) will be significantly increased to adapt to the increasing holdings of new energy vehicles and attract new customers.</p>\n<p>\\9. The coverage rate (%) of new energy vehicle charging infrastructure will be significantly increased, for the same reason.</p>\n<p>The most important thing is that the sales of new energy vehicles will also steadily increase. In short, the development of new energy electric vehicles in China in the next 10 years will be very promising, and the future is bound to be limitless!</p>\n<p><em><strong>*5.3*</strong></em> <em><strong>*Collect data and establish a mathematical model to analyze the impact of new energy electric vehicles on the global traditional energy vehicle industry.*</strong></em></p>\n<h3 id=\"data-preparation-and-preprocessing\"><a class=\"anchor\" href=\"#data-preparation-and-preprocessing\">#</a> Data Preparation and Preprocessing:</h3>\n<p>Data Organization: Transform raw data into an analyzable format, ensuring correct data types for each variable (e.g., years as date format, sales volumes as numerical values).</p>\n<p>Missing Values: Inspect the dataset for any missing entries. If present, choose to impute (using methods like mean of neighboring values, median, or regression prediction based on other variables) or to exclude missing records.</p>\n<p>Outlier Analysis: Identify and scrutinize outliers to determine whether they result from input errors or natural fluctuations. Correct or exclude errors; retain natural fluctuations as they may represent real-world scenarios.</p>\n<p>Normalization/Standardization: Apply normalization or standardization techniques (such as Z-score standardization) to adjust the scale of data, eliminating the influence of different variable magnitudes.</p>\n<h3 id=\"exploratory-data-analysis-eda\"><a class=\"anchor\" href=\"#exploratory-data-analysis-eda\">#</a> Exploratory Data Analysis (EDA):</h3>\n<p>Time Series Analysis: Plot time series for each variable to observe trends and patterns over time, identifying any evident trends or seasonality.</p>\n<p>Scatter Plot Analysis: Create scatter plots to explore relationships between variables, such as the relationship between electric vehicle sales and crude oil prices.</p>\n<p>Correlation Matrix Visualization: Construct a correlation matrix and visualize it to discern linear relationships between variables, aiding in variable selection for the VAR model.</p>\n<h3 id=\"correlation-analysis\"><a class=\"anchor\" href=\"#correlation-analysis\">#</a> Correlation Analysis:</h3>\n<p>Pearson Correlation Coefficient: Compute the Pearson correlation coefficient between electric vehicle sales, traditional vehicle sales, and crude oil prices to quantitatively describe their linear relationships.</p>\n<p>Significance Testing: Perform tests to ascertain the statistical significance of the correlation coefficients, thus determining the reliability of the relationships between variables.</p>\n<h3 id=\"causality-testing\"><a class=\"anchor\" href=\"#causality-testing\">#</a> Causality Testing:</h3>\n<p>Granger Causality Test: Conduct Granger causality tests to determine if one variable's historical values can significantly predict future values of another, thereby establishing a Granger cause.</p>\n<p>Lag Selection: Choose the number of lags to use in Granger causality testing, typically selected based on information criteria such as AIC or BIC.</p>\n<h3 id=\"var-model-construction\"><a class=\"anchor\" href=\"#var-model-construction\">#</a> VAR Model Construction:</h3>\n<p>Variable Selection: Based on EDA and correlation analysis outcomes, select appropriate variables for the VAR model.</p>\n<p>Model Estimation: Estimate the VAR model's parameters using the ordinary least squares method.</p>\n<p>Lag Structure Determination: Determine the optimal lag order for the VAR model using information criteria.</p>\n<h3 id=\"model-estimation-and-testing\"><a class=\"anchor\" href=\"#model-estimation-and-testing\">#</a> Model Estimation and Testing:</h3>\n<p>Model Diagnostics: Conduct diagnostic tests, including tests for autocorrelation of residuals, heteroscedasticity, and model stability.</p>\n<p>Predictive Accuracy: Assess the model's predictive accuracy, often by reserving a portion of data as a test set.</p>\n<h3 id=\"model-interpretation-and-policy-analysis\"><a class=\"anchor\" href=\"#model-interpretation-and-policy-analysis\">#</a> Model Interpretation and Policy Analysis:</h3>\n<p>Impact Interpretation: Interpret the results of the VAR model, discussing how the growth in electric vehicle sales dynamically influences the sales of traditional energy vehicles.</p>\n<p>Policy Impact Discussion: Explore how electric vehicle-related policies might affect the relationships between these variables and how policymakers can utilize these findings.</p>\n<p>External Factors Consideration: Discuss potential external factors that may impact the markets for electric vehicles and traditional energy vehicles, and how these factors might be incorporated into future research.</p>\n<h3 id=\"translated-conclusions\"><a class=\"anchor\" href=\"#translated-conclusions\">#</a> Translated Conclusions:</h3>\n<p>The data indicates that the market share of electric vehicles grew from 0.4% in 2013 to 18.6% in 2022, a substantial increase that correlates with a decline in traditional energy vehicle sales. Specifically, as electric vehicle sales have risen, traditional vehicle sales have demonstrated a downward trend. This suggests a shift in consumer preferences and the impact of reduced costs and technological advancements in electric vehicles, attracting more buyers.</p>\n<p>The increase in the electric vehicle market share significantly correlates with a decrease in the average fuel consumption of traditional vehicles. This suggests that automobile manufacturers may be enhancing the fuel efficiency of traditional vehicles to compete with electric vehicles, or consumers may be increasingly opting for models with lower fuel consumption.</p>\n<p>While the growth in electric vehicle market share has not directly impacted crude oil prices (the correlation is not significant), it does not preclude the potential for long-term effects on the energy market. As electric vehicle costs continue to decrease and policies further support, the demand for traditional fuel vehicles might decline, potentially affecting future crude oil demand and prices.</p>\n<p>In conclusion, the emergence of electric vehicles is gradually impacting the global traditional energy vehicle industry. Specifically, with the continuing expansion of the electric vehicle market share, global sales of traditional vehicles have begun to be affected, as indicated by decreasing sales. Meanwhile, the traditional vehicle industry's technological adaptation is reflected in improved fuel efficiency and reduced consumption. However, so far, the rise in the electric vehicle market has not had a significant impact on crude oil prices, which may be due to the crude oil market being influenced by a variety of factors, including global economic activity levels, international political situations, and the development of alternative energy markets.</p>\n<p><em><strong>*5.4 Some countries have formulated a series of policies targeted to resist the*</strong></em> <em><strong>*development of new energy electric vehicles in China. Establish a mathematical model to*</strong></em> <em><strong>*analyze the effects of these policies on the development of new energy electric vehicles in China.*</strong></em></p>\n<p><em><strong>*（1）Policy*</strong></em> <em><strong>*Collection*</strong></em></p>\n<p>​\tIn June 2022, Germany and Japan were strongly opposed to new energy sources.</p>\n<p>On 16 August 2022 the Inflation Reduction Act (IRA) was signed into law, under which only electric vehicles assembled in North America are eligible for tax credits.</p>\n<p>On 4 October 2023, the EU launched a countervailing investigation into China's new battery electric vehicles.</p>\n<p><em><strong>*（2）*</strong></em><em><strong>*Data collection*</strong></em></p>\n<p>In order to analyse these policies on the development of new energy electric vehicles in China, we collected the export volume of new energy vehicles from 2011 to 2023, As shown in the figure below</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/6mILXTDCbUc7htY.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture13 New Energy Vehicle Export Volume scatterplot*</strong></em></p>\n<p>The anomaly is removed due to the impact of the New Crown Epidemic, which resulted in a decrease rather than an increase in exports of new energy electric vehicles in 2020</p>\n<p>As the above policies are concentrated in 2022 as well as 2023, we fitted a non-linear fit to the data as shown in the following figure, to specifically compare exports in 2022 and 2023.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/nudLeiwcsNBbSXJ.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture14 New Energy Vehicle Export Volume and Time curve*</strong></em></p>\n<p>Get the polynomial function:</p>\n<p>y=-0.0049x6-59.72x5+301061x4 \t\t\t\t\t\t\t\t\t <em><strong>*（5）*</strong></em></p>\n<p>Comparing the estimates of new energy vehicle exports corresponding to the fitted curves with the actual data using the fitted curves, it can be seen that these policies have indeed inhibited the development of new energy electric vehicles in China.</p>\n<p><em><strong>*5*</strong></em><em><strong>*.5 Analyze the impact of the electrification of new energy electric vehicles (including*</strong></em> <em><strong>*electric buses) in cities on the ecological environment. Assuming that there is an urban*</strong></em> <em><strong>*population of 1 million, provide the calculation results of the model.*</strong></em></p>\n<p><em><strong>*(*</strong></em><em><strong>*1) Data Collection*</strong></em></p>\n<p>The carbon emission factor for petrol is 2.951kg-CO2/kg, each liter of petrol weights approximately 750g, total combustion produces 2.194kg CO2, the average fuel consumption of a conventional car is 6.46L/ 100 kilometres, The resulting 100 km for conventional cars CO2 emissions: 14.17kg/km, average fuel consumption of conventional buses is 25L/100km, conventional buses 100km CO2 emissions: 54.85kg/km;</p>\n<p>grid carbon intensity is 0.65kg/kWh, and the average electric vehicle power consumption is 15kWh/100km, resulting in 100km CO2 emissions from electric vehicles: 9.75kg/100km, electric buses on average Electricity consumption is 56.6kWh/100km, CO2 emission of 100km from electric bus: 36.79kg/km.</p>\n<p><em><strong>*(*</strong></em><em><strong>*2)*</strong></em> <em><strong>*model assumption*</strong></em></p>\n<p>​\tThe population of the city is 1 million, assuming that there are on average 3 people in a household, and each household has a car, i.e., there are 333,000 cars in the city; there are 70,000 buses in the city. The average journey of a car in a day is 300km, which gives the difference in CO2 emissions between new energy electric cars and traditional cars as 48.4 tons/vehicle<em>per year, and the difference in CO2 emissions between new energy electric buses and traditional buses as 197.76 tons/vehicle</em>per year, and the difference in the total annual CO2emissions between new energy electric vehicles and traditional vehicles as 2,996 tons, and China's average per capita carbon emissions as 6.8 tons. When all vehicles in the city are replaced with new energy vehicles, the city's per capita carbon emissions can be reduced by 2.996 tons, a whopping 44%!</p>\n<p><em><strong>*5.*</strong></em><em><strong>*6*</strong></em> <em><strong>*Based on the conclusion of question 5, write an open letter to the citizens to publicize the benefits of new energy electric vehicles and the contributions of the electric vehicle industry in various countries around the world.*</strong></em></p>\n<p>Dear Citizens,</p>\n<p>In our journey towards a sustainable future, the emergence and expansion of new energy electric vehicles (EVs) stand as a testament to our collective commitment to environmental stewardship and technological innovation. These vehicles, characterized by their minimal environmental footprint, are pivotal in reducing urban pollution and enhancing air quality. Unlike their traditional counterparts, EVs convert energy with remarkable efficiency, offering a sustainable alternative that aligns with the global imperative to conserve resources.</p>\n<p>In addition to their environmental benefits, electric vehicles are driving technological advancements across multiple sectors, including battery technology, smart connectivity, and autonomous driving systems. This evolution is not just a leap in vehicular technology but a catalyst for broader socio-economic changes. Economically, EVs present a cost-effective solution for consumers, promising lower long-term operating and maintenance expenses.</p>\n<p>Globally, countries have been contributing significantly to this transformative movement. China, for instance, has solidified its position as a leader in the EV market, boasting record-breaking sales and a rapidly increasing market penetration. The Chinese government's robust policies under its dual carbon goals have been instrumental in catalyzing this growth, demonstrating a commitment to high-quality industry development. Concurrently, the United States has embarked on an ambitious plan to integrate EVs into its national fabric. With strategic investments in infrastructure and manufacturing, driven by comprehensive legislative support like the Bipartisan Infrastructure Law and the Inflation Reduction Act, the U.S. is poised to significantly influence the global EV landscape.</p>\n<p>Similarly, the European Union's initiatives have been pivotal in driving EV adoption. By implementing stringent CO2 emission standards, the EU has not only promoted environmentally friendly vehicles but also spurred innovation in green technologies. The collaborative efforts of European nations in policy formulation and infrastructure development further underline a shared vision for a green and sustainable future.</p>\n<p>As we embrace this era of electric vehicles, it is evident that our choices transcend beyond individual preferences to a collective responsibility towards a greener, more efficient, and sustainable world. The commitment and actions of countries like China, the United States, and the European Union reflect a global paradigm shift, one where the adoption of electric vehicles is a key component in our pursuit of environmental sustainability and economic resilience.</p>\n<p>In closing, the journey towards a sustainable future is not a solitary endeavor but a collaborative effort that requires the participation and support of each one of us. As we continue to witness and contribute to this transformation, let us remember that each step towards embracing electric vehicles is a step towards a cleaner and more sustainable world.</p>\n<p>Sincerely</p>\n<p>2023-11-25</p>\n<p><em><strong>*Appendix*</strong></em></p>\n<p>Data</p>\n<table>\n<thead>\n<tr>\n<th>Data</th>\n<th>Data sources</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Market share of new energy vehicles, etc.</td>\n<td>NDANEV：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5uZGFuZXYuY29tLw==\">http://www.ndanev.com/</span></td>\n</tr>\n<tr>\n<td>Market penetration of new energy vehicles and conventional vehicles</td>\n<td>National Bureau of Statistics, Ministry of Industry and Information Technology, New Energy Vehicle Association</td>\n</tr>\n<tr>\n<td>China's total annual carbon emissions</td>\n<td><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudGhlcGFwZXIuY24vbmV3c0RldGFpbF9mb3J3YXJkXzE5ODk1MjQ3\">https://www.thepaper.cn/newsDetail_forward_19895247</span></td>\n</tr>\n<tr>\n<td>Number of new energy vehicle patents</td>\n<td>China Patent Publication Announcement Network</td>\n</tr>\n<tr>\n<td>Development of New Energy Vehicle Battery</td>\n<td>China ICT</td>\n</tr>\n<tr>\n<td>Infrastructure coverage and number of charging piles for new energy vehicles</td>\n<td>Data Center for Resource and Environmental Sciences, Chinese Academy of Sciences</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>新能源汽车销量（万 / 辆）</td>\n<td></td>\n<td></td>\n<td>年份</td>\n<td>市场占有率（%）</td>\n<td></td>\n<td></td>\n<td>年份</td>\n<td>电池平均能量密度（Wh/kg）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>-----------------------</td>\n<td>----</td>\n<td>----</td>\n<td>----</td>\n<td>---------------</td>\n<td>----</td>\n<td>----</td>\n<td>----</td>\n<td>-------------------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>50.7</td>\n<td></td>\n<td></td>\n<td>2016</td>\n<td>1.8</td>\n<td></td>\n<td></td>\n<td>2016</td>\n<td>75</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>77.7</td>\n<td></td>\n<td></td>\n<td>2017</td>\n<td>2.7</td>\n<td></td>\n<td></td>\n<td>2017</td>\n<td>95</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>126.8</td>\n<td></td>\n<td></td>\n<td>2018</td>\n<td>4.5</td>\n<td></td>\n<td></td>\n<td>2018</td>\n<td>105</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>120.6</td>\n<td></td>\n<td></td>\n<td>2019</td>\n<td>4.68</td>\n<td></td>\n<td></td>\n<td>2019</td>\n<td>140</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>140.9</td>\n<td></td>\n<td></td>\n<td>2020</td>\n<td>5.4</td>\n<td></td>\n<td></td>\n<td>2020</td>\n<td>153</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>352.9</td>\n<td></td>\n<td></td>\n<td>2021</td>\n<td>23.5</td>\n<td></td>\n<td></td>\n<td>2021</td>\n<td>215</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>689.9</td>\n<td></td>\n<td></td>\n<td>2022</td>\n<td>25.6</td>\n<td></td>\n<td></td>\n<td>2022</td>\n<td>280</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>945.9</td>\n<td></td>\n<td></td>\n<td>2023</td>\n<td>30.4</td>\n<td></td>\n<td></td>\n<td>2023</td>\n<td>300</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>电机效率（%）</td>\n<td></td>\n<td></td>\n<td>年份</td>\n<td>充电桩数量（万个）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>-------------</td>\n<td>----</td>\n<td>----</td>\n<td>----</td>\n<td>------------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>80-88</td>\n<td>84</td>\n<td></td>\n<td>2016</td>\n<td>16.6</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>85-90</td>\n<td>87.5</td>\n<td></td>\n<td>2017</td>\n<td>45</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>88-92</td>\n<td>90</td>\n<td></td>\n<td>2018</td>\n<td>77.7</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>90-95</td>\n<td>93</td>\n<td></td>\n<td>2019</td>\n<td>121.9</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>91-96</td>\n<td>93.5</td>\n<td></td>\n<td>2020</td>\n<td>168.1</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>92-97</td>\n<td>94.5</td>\n<td></td>\n<td>2021</td>\n<td>261.7</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>93-98</td>\n<td>95.5</td>\n<td></td>\n<td>2022</td>\n<td>521</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>94-98</td>\n<td>96</td>\n<td></td>\n<td>2023</td>\n<td>795.4</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>补贴估计值（万）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>----------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>5</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>7</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>6</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>4</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>3.5</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>3</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>2</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>1.5</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>产业协同率（%）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>---------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>35</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>40</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>45</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>50</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>55</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>60</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>65</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>70</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>中国新能源汽车产量（万辆）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>--------------------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>51.7</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>79.4</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>127.9</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>124.9</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>145.9</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>367.8</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>700.8</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>1000</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>新能源汽车产量增长率（%）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>-------------------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>53</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>53.3</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>79.5</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>0.11</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>7.5</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>145.6</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>96.9</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>40</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>中国燃油车产量（万辆）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>----------------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>2819</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>2942.5</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>2781</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>2456</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>2531.1</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>2458.8</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>1508.1</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>1955.7</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>新能源汽车保有量（万辆）</td>\n<td>新能源汽车市场规模（亿元人民币）</td>\n<td>新能源汽车企业数量（家）</td>\n<td>新能源汽车专利申请数量（项）</td>\n<td>新能源汽车产业链规模（家）</td>\n<td>新能源汽车充电桩数量（万个）</td>\n<td>新能源汽车充电基础设施覆盖率（%）</td>\n<td>新能源汽车补贴金额（亿元人民币）</td>\n<td>传统燃油车市场渗透率（%）</td>\n<td>新能源汽车市场渗透率（%）</td>\n<td>长三角地区碳排放总量 (百万吨)</td>\n<td>新能源汽车产销量（万辆）</td>\n<td>新能源汽车环比增长率 (%)</td>\n<td>传统汽车产销量（万辆）</td>\n<td>传统汽车环比增长率 (%)</td>\n<td>磷酸铁锂动力电池装机量 / GWh</td>\n<td>三元电池装机量 / GWh</td>\n<td>碳排放总量 (百万吨)</td>\n<td>新能源汽车加权平均价格 (万元)</td>\n</tr>\n<tr>\n<td>----</td>\n<td>------------------------</td>\n<td>--------------------------------</td>\n<td>------------------------</td>\n<td>----------------------------</td>\n<td>--------------------------</td>\n<td>----------------------------</td>\n<td>---------------------------------</td>\n<td>--------------------------------</td>\n<td>-------------------------</td>\n<td>-------------------------</td>\n<td>----------------------------</td>\n<td>------------------------</td>\n<td>-----------------------</td>\n<td>----------------------</td>\n<td>---------------------</td>\n<td>--------------------------</td>\n<td>------------------</td>\n<td>------------------</td>\n<td>----------------------------</td>\n</tr>\n<tr>\n<td>2013</td>\n<td>0.2</td>\n<td>7.3</td>\n<td>30</td>\n<td>630</td>\n<td>230</td>\n<td>0.3</td>\n<td>0.5</td>\n<td>6.2</td>\n<td>99.9</td>\n<td>0.1</td>\n<td>1608.79</td>\n<td>1.79</td>\n<td>39.8</td>\n<td>2198.3</td>\n<td>15</td>\n<td>2</td>\n<td>15</td>\n<td>9839.7</td>\n<td>18</td>\n</tr>\n<tr>\n<td>2014</td>\n<td>1.2</td>\n<td>25.4</td>\n<td>50</td>\n<td>870</td>\n<td>280</td>\n<td>0.6</td>\n<td>1.7</td>\n<td>7.5</td>\n<td>99.6</td>\n<td>0.4</td>\n<td>1569.41</td>\n<td>7.48</td>\n<td>317.9</td>\n<td>2341.2</td>\n<td>6.5</td>\n<td>5</td>\n<td>20</td>\n<td>10029.8</td>\n<td>18.5</td>\n</tr>\n<tr>\n<td>2015</td>\n<td>3.3</td>\n<td>71.5</td>\n<td>70</td>\n<td>1020</td>\n<td>320</td>\n<td>1.2</td>\n<td>3.5</td>\n<td>9.8</td>\n<td>98.7</td>\n<td>1.3</td>\n<td>1578.45</td>\n<td>33.01</td>\n<td>341.4</td>\n<td>2406.5</td>\n<td>2.8</td>\n<td>6.1</td>\n<td>26.9</td>\n<td>9980.2</td>\n<td>19</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>7.3</td>\n<td>162.5</td>\n<td>90</td>\n<td>1170</td>\n<td>370</td>\n<td>3.5</td>\n<td>8.7</td>\n<td>13.2</td>\n<td>98.2</td>\n<td>1.8</td>\n<td>1496.37</td>\n<td>50.71</td>\n<td>53.6</td>\n<td>2801.5</td>\n<td>16.4</td>\n<td>21.8</td>\n<td>28.9</td>\n<td>9861</td>\n<td>19.5</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>16.7</td>\n<td>331.5</td>\n<td>120</td>\n<td>1360</td>\n<td>420</td>\n<td>8.2</td>\n<td>17.2</td>\n<td>19.6</td>\n<td>97.4</td>\n<td>2.6</td>\n<td>1602.22</td>\n<td>77.68</td>\n<td>53.3</td>\n<td>2871.5</td>\n<td>2.5</td>\n<td>39.9</td>\n<td>37.8</td>\n<td>10058.8</td>\n<td>20</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>31.7</td>\n<td>609.5</td>\n<td>150</td>\n<td>1470</td>\n<td>460</td>\n<td>15.6</td>\n<td>30.5</td>\n<td>28.4</td>\n<td>96.4</td>\n<td>3.6</td>\n<td>1602.72</td>\n<td>125.6</td>\n<td>61.7</td>\n<td>2791.7</td>\n<td>-2.8</td>\n<td>79.9</td>\n<td>45.7</td>\n<td>10291.8</td>\n<td>20.5</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>57.2</td>\n<td>956.7</td>\n<td>180</td>\n<td>1610</td>\n<td>500</td>\n<td>28.4</td>\n<td>52.3</td>\n<td>38.7</td>\n<td>95.3</td>\n<td>4.7</td>\n<td>1623.18</td>\n<td>120.6</td>\n<td>-4.0</td>\n<td>2535.4</td>\n<td>-9.2</td>\n<td>79.8</td>\n<td>49.8</td>\n<td>10492.5</td>\n<td>21</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>94.3</td>\n<td>1521.6</td>\n<td>220</td>\n<td>1750</td>\n<td>550</td>\n<td>44.7</td>\n<td>77.9</td>\n<td>46.3</td>\n<td>94.3</td>\n<td>5.7</td>\n<td>1649.15</td>\n<td>136.8</td>\n<td>13.4</td>\n<td>2023.1</td>\n<td>-20.2</td>\n<td>96.3</td>\n<td>61.6</td>\n<td>10713.5</td>\n<td>21.5</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>127.9</td>\n<td>2002.5</td>\n<td>250</td>\n<td>1900</td>\n<td>590</td>\n<td>59.1</td>\n<td>80.2</td>\n<td>53.9</td>\n<td>93.6</td>\n<td>6.4</td>\n<td>1675.53</td>\n<td>352.1</td>\n<td>157.6</td>\n<td>2334.1</td>\n<td>15.4</td>\n<td>183.8</td>\n<td>110.4</td>\n<td>10934.6</td>\n<td>22</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>164.5</td>\n<td>2483.4</td>\n<td>280</td>\n<td>2000</td>\n<td>630</td>\n<td>74.2</td>\n<td>87.6</td>\n<td>61.5</td>\n<td>92.7</td>\n<td>7.3</td>\n<td>1702.35</td>\n<td>688.7</td>\n<td>95.6</td>\n<td>1997.7</td>\n<td>-14.4</td>\n<td>184.5</td>\n<td>117.3</td>\n<td>11155.6</td>\n<td>22.5</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>新能源汽车保有量（万辆）</td>\n<td>新能源汽车市场规模（亿元人民币）</td>\n<td>新能源汽车专利申请数量（项）</td>\n<td>新能源汽车补贴金额（亿元人民币）</td>\n<td>碳排放总量 (百万吨)</td>\n<td>磷酸铁锂动力电池装机量 / GWh</td>\n<td>三元电池装机量 / GWh</td>\n<td>新能源汽车加权平均价格 (万元)</td>\n<td>新能源汽车市场渗透率（%）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>------------------------</td>\n<td>--------------------------------</td>\n<td>----------------------------</td>\n<td>--------------------------------</td>\n<td>------------------</td>\n<td>--------------------------</td>\n<td>------------------</td>\n<td>----------------------------</td>\n<td>-------------------------</td>\n</tr>\n<tr>\n<td>2013</td>\n<td>0.2</td>\n<td>7.3</td>\n<td>630</td>\n<td>6.2</td>\n<td>9839.7</td>\n<td>2</td>\n<td>15</td>\n<td>18</td>\n<td>0.1</td>\n</tr>\n<tr>\n<td>2014</td>\n<td>1.2</td>\n<td>25.4</td>\n<td>870</td>\n<td>7.5</td>\n<td>10029.8</td>\n<td>5</td>\n<td>20</td>\n<td>18.5</td>\n<td>0.4</td>\n</tr>\n<tr>\n<td>2015</td>\n<td>3.3</td>\n<td>71.5</td>\n<td>1020</td>\n<td>9.8</td>\n<td>9980.2</td>\n<td>6.1</td>\n<td>26.9</td>\n<td>19</td>\n<td>1.3</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>7.3</td>\n<td>162.5</td>\n<td>1170</td>\n<td>13.2</td>\n<td>9861</td>\n<td>21.8</td>\n<td>28.9</td>\n<td>19.5</td>\n<td>1.8</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>16.7</td>\n<td>331.5</td>\n<td>1360</td>\n<td>19.6</td>\n<td>10058.8</td>\n<td>39.9</td>\n<td>37.8</td>\n<td>20</td>\n<td>2.6</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>31.7</td>\n<td>609.5</td>\n<td>1470</td>\n<td>28.4</td>\n<td>10291.8</td>\n<td>79.9</td>\n<td>45.7</td>\n<td>20.5</td>\n<td>3.6</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>57.2</td>\n<td>956.7</td>\n<td>1610</td>\n<td>38.7</td>\n<td>10492.5</td>\n<td>79.8</td>\n<td>49.8</td>\n<td>21</td>\n<td>4.7</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>94.3</td>\n<td>1521.6</td>\n<td>1750</td>\n<td>46.3</td>\n<td>10713.5</td>\n<td>96.3</td>\n<td>61.6</td>\n<td>21.5</td>\n<td>5.7</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>127.9</td>\n<td>2002.5</td>\n<td>1900</td>\n<td>53.9</td>\n<td>10934.6</td>\n<td>183.8</td>\n<td>110.4</td>\n<td>22</td>\n<td>6.4</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>164.5</td>\n<td>2483.4</td>\n<td>2000</td>\n<td>61.5</td>\n<td>11155.6</td>\n<td>184.5</td>\n<td>117.3</td>\n<td>22.5</td>\n<td>7.3</td>\n</tr>\n</tbody>\n</table>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LinearRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> r2_score, mean_squared_error</span><br><span class=\"line\"><span class=\"comment\"># 读取 Excel 文件</span></span><br><span class=\"line\">excel_path = <span class=\"string\">r&#x27;D:\\desktop\\2023亚太赛 c 数据\\第二问\\data\\第二问数据整合.xlsx&#x27;</span></span><br><span class=\"line\">df = pd.read_excel(excel_path)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 选择自变量和因变量</span></span><br><span class=\"line\">X = df[[<span class=\"string\">&#x27;年份&#x27;</span>, <span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>,<span class=\"string\">&#x27;新能源汽车市场规模（亿元人民币）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车市场渗透率（%）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车环比增长率(%)&#x27;</span>, <span class=\"string\">&#x27;新能源汽车企业数量（家）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车专利申请数量（项）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车产业链规模（家）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车充电桩数量（万个）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车充电基础设施覆盖率（%）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车补贴金额（亿元人民币）&#x27;</span>, <span class=\"string\">&#x27;传统燃油车市场渗透率（%）&#x27;</span>, <span class=\"string\">&#x27;长三角地区碳排放总量(百万吨)&#x27;</span>, <span class=\"string\">&#x27;传统汽车产销量（万辆）&#x27;</span>, <span class=\"string\">&#x27;传统汽车环比增长率(%)&#x27;</span>, <span class=\"string\">&#x27;磷酸铁锂动力电池装机量/GWh&#x27;</span>, <span class=\"string\">&#x27;三元电池装机量/GWh&#x27;</span>, <span class=\"string\">&#x27;碳排放总量(百万吨)&#x27;</span>, <span class=\"string\">&#x27;新能源汽车加权平均价格(万元)&#x27;</span>]]</span><br><span class=\"line\">Y = df[<span class=\"string\">&#x27;新能源汽车产销量（万辆）&#x27;</span>]</span><br><span class=\"line\"><span class=\"comment\"># 创建线性回归模型</span></span><br><span class=\"line\">model = LinearRegression()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 拟合模型</span></span><br><span class=\"line\">model.fit(X, Y)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取回归系数</span></span><br><span class=\"line\">coefficients = pd.DataFrame(&#123;<span class=\"string\">&#x27;Variable&#x27;</span>: [<span class=\"string\">&#x27;intercept&#x27;</span>] + <span class=\"built_in\">list</span>(X.columns), <span class=\"string\">&#x27;Coefficient&#x27;</span>: [model.intercept_] + <span class=\"built_in\">list</span>(model.coef_)&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输出回归系数</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(coefficients)</span><br><span class=\"line\"><span class=\"comment\"># 预测值</span></span><br><span class=\"line\">predictions = model.predict(X)</span><br><span class=\"line\"><span class=\"comment\"># 计算R²和标准估计误差</span></span><br><span class=\"line\">r2 = r2_score(Y, predictions)</span><br><span class=\"line\">mse = mean_squared_error(Y, predictions)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输出R²和标准估计误差</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;R²:&#x27;</span>, r2)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;标准估计误差:&#x27;</span>, mse)</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> statsmodels.tsa.holtwinters <span class=\"keyword\">import</span> ExponentialSmoothing</span><br><span class=\"line\"><span class=\"keyword\">from</span> statsmodels.tsa.seasonal <span class=\"keyword\">import</span> seasonal_decompose</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]  <span class=\"comment\"># 设置中文字体为黑体</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 1. 数据导入和准备</span></span><br><span class=\"line\">df = pd.read_excel(<span class=\"string\">&quot;第二问数据整合.xlsx&quot;</span>, index_col=<span class=\"string\">&quot;年份&quot;</span>)</span><br><span class=\"line\">df.index = pd.to_datetime(df.index, <span class=\"built_in\">format</span>=<span class=\"string\">&#x27;%Y&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2. 可视化数据</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(df[<span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>], marker=<span class=\"string\">&#x27;o&#x27;</span>, label=<span class=\"string\">&#x27;新能源汽车保有量&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;新能源汽车保有量 Over Time&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Year&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.savefig(<span class=\"string\">&quot;可视化数据.png&quot;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3. 趋势分析</span></span><br><span class=\"line\">result = seasonal_decompose(df[<span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>], model=<span class=\"string\">&#x27;multiplicative&#x27;</span>, period=<span class=\"number\">1</span>)  <span class=\"comment\"># 选择合适的周期</span></span><br><span class=\"line\">result.plot()</span><br><span class=\"line\">plt.savefig(<span class=\"string\">&quot;趋势分析.png&quot;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4. 时间序列预测模型 - Holt-Winters Exponential Smoothing</span></span><br><span class=\"line\"><span class=\"comment\"># 将数据拆分为训练集和测试集</span></span><br><span class=\"line\">train_size = <span class=\"built_in\">int</span>(<span class=\"built_in\">len</span>(df) * <span class=\"number\">0.8</span>)</span><br><span class=\"line\">train, test = df[<span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>][:train_size], df[<span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>][train_size:]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建并拟合模型</span></span><br><span class=\"line\"><span class=\"comment\"># 使用Holt-Winters指数平滑模型</span></span><br><span class=\"line\">model = ExponentialSmoothing(train, seasonal=<span class=\"string\">&#x27;add&#x27;</span>, seasonal_periods=<span class=\"number\">2</span>)</span><br><span class=\"line\">result = model.fit()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 预测</span></span><br><span class=\"line\">forecast = result.forecast(steps=<span class=\"built_in\">len</span>(test))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 保存预测结果为 Excel 文件</span></span><br><span class=\"line\">result_df = pd.DataFrame(&#123;<span class=\"string\">&#x27;实际值&#x27;</span>: test, <span class=\"string\">&#x27;预测值&#x27;</span>: forecast&#125;)</span><br><span class=\"line\">result_df.to_excel(<span class=\"string\">&#x27;预测结果.xlsx&#x27;</span>, index=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 可视化预测结果</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">12</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(train.index, train, label=<span class=\"string\">&#x27;Train&#x27;</span>)</span><br><span class=\"line\">plt.plot(test.index, test, label=<span class=\"string\">&#x27;Test&#x27;</span>)</span><br><span class=\"line\">plt.plot(test.index, forecast, label=<span class=\"string\">&#x27;Predicted&#x27;</span>, linestyle=<span class=\"string\">&#x27;dashed&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;新能源汽车保有量预测&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Year&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.savefig(<span class=\"string\">&quot;新能源汽车保有量预测.png&quot;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> statsmodels.api <span class=\"keyword\">as</span> sm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 读取 Excel 文件</span></span><br><span class=\"line\">excel_path = <span class=\"string\">r&#x27;D:\\desktop\\2023亚太赛 c 数据\\第二问\\data\\第二问数据整合.xlsx&#x27;</span></span><br><span class=\"line\">df = pd.read_excel(excel_path)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 选择自变量和因变量</span></span><br><span class=\"line\">X = df[[<span class=\"string\">&#x27;年份&#x27;</span>, <span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>,<span class=\"string\">&#x27;新能源汽车市场规模（亿元人民币）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车市场渗透率（%）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车环比增长率(%)&#x27;</span>, <span class=\"string\">&#x27;新能源汽车企业数量（家）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车专利申请数量（项）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车产业链规模（家）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车充电桩数量（万个）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车充电基础设施覆盖率（%）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车补贴金额（亿元人民币）&#x27;</span>, <span class=\"string\">&#x27;传统燃油车市场渗透率（%）&#x27;</span>, <span class=\"string\">&#x27;长三角地区碳排放总量(百万吨)&#x27;</span>, <span class=\"string\">&#x27;传统汽车产销量（万辆）&#x27;</span>, <span class=\"string\">&#x27;传统汽车环比增长率(%)&#x27;</span>, <span class=\"string\">&#x27;磷酸铁锂动力电池装机量/GWh&#x27;</span>, <span class=\"string\">&#x27;三元电池装机量/GWh&#x27;</span>, <span class=\"string\">&#x27;碳排放总量(百万吨)&#x27;</span>, <span class=\"string\">&#x27;新能源汽车加权平均价格(万元)&#x27;</span>]]</span><br><span class=\"line\">Y = df[<span class=\"string\">&#x27;新能源汽车产销量（万辆）&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 添加截距项</span></span><br><span class=\"line\">X = sm.add_constant(X)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 拟合线性回归模型</span></span><br><span class=\"line\">model = sm.OLS(Y, X).fit()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 进行F检验</span></span><br><span class=\"line\">f_test = model.f_test(<span class=\"string\">&quot; &quot;</span>.join(X.columns[<span class=\"number\">1</span>:]))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(f_test)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> statsmodels.tsa.holtwinters <span class=\"keyword\">import</span> ExponentialSmoothing</span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]  <span class=\"comment\"># 设置中文字体为黑体</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 1. 数据导入和准备</span></span><br><span class=\"line\">df = pd.read_excel(<span class=\"string\">&quot;data/第二问数据整合.xlsx&quot;</span>, index_col=<span class=\"string\">&quot;年份&quot;</span>)</span><br><span class=\"line\">df.index = pd.to_datetime(df.index, <span class=\"built_in\">format</span>=<span class=\"string\">&#x27;%Y&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2. 需要预测的列名</span></span><br><span class=\"line\">columns_to_predict = [</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车市场渗透率（%）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车环比增长率(%)&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车企业数量（家）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车专利申请数量（项）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车产业链规模（家）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车充电桩数量（万个）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车充电基础设施覆盖率（%）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车补贴金额（亿元人民币）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;传统燃油车市场渗透率（%）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;长三角地区碳排放总量(百万吨)&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;传统汽车产销量（万辆）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;传统汽车环比增长率(%)&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;磷酸铁锂动力电池装机量/GWh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;三元电池装机量/GWh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;碳排放总量(百万吨)&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车加权平均价格(万元)&#x27;</span></span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3. 循环预测并保存结果和图</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> column <span class=\"keyword\">in</span> columns_to_predict:</span><br><span class=\"line\">    <span class=\"comment\"># 创建并拟合模型</span></span><br><span class=\"line\">    model = ExponentialSmoothing(df[column], seasonal=<span class=\"string\">&#x27;add&#x27;</span>, seasonal_periods=<span class=\"number\">2</span>)</span><br><span class=\"line\">    result = model.fit()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 预测</span></span><br><span class=\"line\">    forecast = result.forecast(steps=<span class=\"number\">11</span>)  <span class=\"comment\"># 预测2023年到2033年的数据</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 输出预测结果</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;column&#125;</span> 预测结果:&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(forecast)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 可视化预测结果</span></span><br><span class=\"line\">    plt.figure(figsize=(<span class=\"number\">12</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">    plt.plot(df.index, df[column], label=<span class=\"string\">&#x27;历史数据&#x27;</span>)</span><br><span class=\"line\">    plt.plot(pd.date_range(start=<span class=\"string\">&#x27;2023-01-01&#x27;</span>, periods=<span class=\"number\">11</span>, freq=<span class=\"string\">&#x27;Y&#x27;</span>), forecast, label=<span class=\"string\">&#x27;预测&#x27;</span>, linestyle=<span class=\"string\">&#x27;dashed&#x27;</span>)</span><br><span class=\"line\">    plt.title(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;column&#125;</span>预测&#x27;</span>)</span><br><span class=\"line\">    plt.xlabel(<span class=\"string\">&#x27;年份&#x27;</span>)</span><br><span class=\"line\">    plt.ylabel(column)</span><br><span class=\"line\">    plt.legend()</span><br><span class=\"line\">    plt.savefig(<span class=\"string\">f&quot;<span class=\"subst\">&#123;column&#125;</span>_预测.png&quot;</span>)</span><br><span class=\"line\">    plt.close()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> statsmodels.api <span class=\"keyword\">as</span> sm</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"comment\"># 读取 Excel 文件</span></span><br><span class=\"line\">excel_path = <span class=\"string\">r&#x27;D:\\desktop\\2023亚太赛 c 数据\\第二问\\data\\第二问数据整合.xlsx&#x27;</span></span><br><span class=\"line\">df = pd.read_excel(excel_path)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 使用回归方程的系数</span></span><br><span class=\"line\">coefficients = [-<span class=\"number\">175.361921</span>, <span class=\"number\">0.786334</span>, <span class=\"number\">4.674333</span>, <span class=\"number\">0.133171</span>, <span class=\"number\">1.340155</span>, <span class=\"number\">0.203066</span>, <span class=\"number\">5.114536</span>, -<span class=\"number\">1.460884</span>, <span class=\"number\">0.602279</span>,</span><br><span class=\"line\">                <span class=\"number\">2.367206</span>, -<span class=\"number\">7.039104</span>, <span class=\"number\">7.524213</span>, -<span class=\"number\">1.340155</span>, -<span class=\"number\">0.623688</span>, <span class=\"number\">0.488335</span>, -<span class=\"number\">6.786688</span>, -<span class=\"number\">2.279974</span>, <span class=\"number\">5.143792</span>,</span><br><span class=\"line\">                -<span class=\"number\">0.075757</span>, <span class=\"number\">0.393167</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 选择自变量</span></span><br><span class=\"line\">features = df[[<span class=\"string\">&#x27;年份&#x27;</span>, <span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车市场规模（亿元人民币）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车市场渗透率（%）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车环比增长率(%)&#x27;</span>,</span><br><span class=\"line\">                <span class=\"string\">&#x27;新能源汽车企业数量（家）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车专利申请数量（项）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车产业链规模（家）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车充电桩数量（万个）&#x27;</span>,</span><br><span class=\"line\">                <span class=\"string\">&#x27;新能源汽车充电基础设施覆盖率（%）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车补贴金额（亿元人民币）&#x27;</span>, <span class=\"string\">&#x27;传统燃油车市场渗透率（%）&#x27;</span>,</span><br><span class=\"line\">                <span class=\"string\">&#x27;长三角地区碳排放总量(百万吨)&#x27;</span>, <span class=\"string\">&#x27;传统汽车产销量（万辆）&#x27;</span>, <span class=\"string\">&#x27;传统汽车环比增长率(%)&#x27;</span>, <span class=\"string\">&#x27;磷酸铁锂动力电池装机量/GWh&#x27;</span>,</span><br><span class=\"line\">                <span class=\"string\">&#x27;三元电池装机量/GWh&#x27;</span>, <span class=\"string\">&#x27;碳排放总量(百万吨)&#x27;</span>, <span class=\"string\">&#x27;新能源汽车加权平均价格(万元)&#x27;</span>]]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 添加截距项</span></span><br><span class=\"line\">features = sm.add_constant(features)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算预测值</span></span><br><span class=\"line\">predicted_sales = np.dot(features.values, coefficients)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将预测值添加到数据框</span></span><br><span class=\"line\">df[<span class=\"string\">&#x27;预测新能源汽车产销量（万辆）&#x27;</span>] = predicted_sales</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输出结果</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(df[[<span class=\"string\">&#x27;年份&#x27;</span>, <span class=\"string\">&#x27;新能源汽车产销量（万辆）&#x27;</span>, <span class=\"string\">&#x27;预测新能源汽车产销量（万辆）&#x27;</span>]])</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        },
        {
            "id": "https://enjundu.github.io/bit/%E4%BA%9A%E5%A4%AA%E6%95%B0%E6%A8%A1%E2%80%94%E2%80%94%E6%B4%AA%E6%B0%B4%E9%A2%84%E6%B5%8B/",
            "url": "https://enjundu.github.io/bit/%E4%BA%9A%E5%A4%AA%E6%95%B0%E6%A8%A1%E2%80%94%E2%80%94%E6%B4%AA%E6%B0%B4%E9%A2%84%E6%B5%8B/",
            "title": "亚太数模——洪水",
            "date_published": "2024-07-04T14:49:23.000Z",
            "content_html": "<p><strong>改前版本 直接从 word 转的  凑合着看吧</strong></p>\n<h1 id=\"代码解析\"><a class=\"anchor\" href=\"#代码解析\">#</a> 代码解析</h1>\n<h2 id=\"before-problem-数据传入与预处理全局函数设置\"><a class=\"anchor\" href=\"#before-problem-数据传入与预处理全局函数设置\">#</a> Before Problem -- 数据传入与预处理，全局函数设置</h2>\n<h3 id=\"导入必要的库\"><a class=\"anchor\" href=\"#导入必要的库\">#</a> 导入必要的库</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> statsmodels.api <span class=\"keyword\">as</span> sm</span><br><span class=\"line\"><span class=\"keyword\">import</span> statsmodels.formula.api <span class=\"keyword\">as</span> smf</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LinearRegression</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.preprocessing <span class=\"keyword\">import</span> StandardScaler</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> r2_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> DecisionTreeRegressor</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LogisticRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> preprocessing</span><br><span class=\"line\"><span class=\"keyword\">import</span> joblib</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> RandomForestRegressor</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LogisticRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.decomposition <span class=\"keyword\">import</span> PCA</span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">u&#x27;simHei&#x27;</span>]   <span class=\"comment\"># 显示中文</span></span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span>      <span class=\"comment\"># 解决负号问题</span></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"数据读入\"><a class=\"anchor\" href=\"#数据读入\">#</a> 数据读入</h3>\n<h4 id=\"从traincsv读入train数据\"><a class=\"anchor\" href=\"#从traincsv读入train数据\">#</a> 从 train.csv 读入 train 数据</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"数据预处理\"><a class=\"anchor\" href=\"#数据预处理\">#</a> 数据预处理</h3>\n<p>id 列对于数据分析没有用处，直接清洗掉这一列</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<p>经检验，原始数据中不存在缺失值与明显的离群点，因此在这里全部保留</p>\n<p>将 ' 洪水概率 ' 设置为目标变量，将原始数据划分为 X，y</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">y=train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">y=np.array(y)</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"数据相关性简要分析\"><a class=\"anchor\" href=\"#数据相关性简要分析\">#</a> 数据相关性简要分析</h3>\n<p>利用不同指标与洪水概率的相关系数来衡量这些指标与洪水概率的关系</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]=y</span><br><span class=\"line\">heat_corr = train_data.corr()[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">heat_corr_sorted=heat_corr.sort_values(ascending=<span class=\"literal\">False</span>)</span><br><span class=\"line\">heat_corr=heat_corr[:-<span class=\"number\">1</span>]</span><br></pre></td></tr></table></figure></p>\n<p>可视化相关系数图</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">heat_corr.plot(kind=<span class=\"string\">&#x27;bar&#x27;</span>, color=<span class=\"string\">&#x27;skyblue&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;不同因素对洪水概率的影响&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;影响因素&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;corr&#x27;</span>)</span><br><span class=\"line\">plt.grid(axis=<span class=\"string\">&#x27;y&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"建立三个水平的指标集\"><a class=\"anchor\" href=\"#建立三个水平的指标集\">#</a> 建立三个水平的指标集</h3>\n<pre><code>20： 全指标\n\n10：半指标\n\n5：核心指标\n\n划分依据: 相关系数大小\n</code></pre>\n<p>根据语义与实际情况考虑，先剔除如下的两个属性形成 18 个指标的属性集</p>\n<pre><code>湿地损失、无效防灾\n</code></pre>\n<p>进一步建立精简指标集，剔除如下的指标集：</p>\n<pre><code>湿地损失、无效防灾、农业实践、排水系统、规划不足、季风强度、政策因素、流域、基础设施恶化\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X.columns</span><br></pre></td></tr></table></figure></p>\n<pre><code>Index(['季风强度', '地形排水', '河流管理', '森林砍伐', '城市化', '气候变化', '大坝质量', '淤积', '农业实践',\n       '侵蚀', '无效防灾', '排水系统', '海岸脆弱性', '滑坡', '流域', '基础设施恶化', '人口得分', '湿地损失',\n       '规划不足', '政策因素'],\n      dtype='object')\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X_COPY=X</span><br><span class=\"line\">eighteen_columns=X.drop(columns=[<span class=\"string\">&#x27;湿地损失&#x27;</span>,<span class=\"string\">&#x27;无效防灾&#x27;</span>])</span><br><span class=\"line\">eleven_columns=X.drop(columns=[<span class=\"string\">&#x27;湿地损失&#x27;</span>,<span class=\"string\">&#x27;无效防灾&#x27;</span>,<span class=\"string\">&#x27;农业实践&#x27;</span>,<span class=\"string\">&#x27;排水系统&#x27;</span>,<span class=\"string\">&#x27;规划不足&#x27;</span>,<span class=\"string\">&#x27;季风强度&#x27;</span>,<span class=\"string\">&#x27;政策因素&#x27;</span>,<span class=\"string\">&#x27;流域&#x27;</span>,<span class=\"string\">&#x27;基础设施恶化&#x27;</span>])</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"利用过滤法获取指标集\"><a class=\"anchor\" href=\"#利用过滤法获取指标集\">#</a> 利用过滤法获取指标集</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.feature_selection <span class=\"keyword\">import</span> SelectKBest,f_classif</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ten_columns=[<span class=\"string\">&#x27;淤积&#x27;</span>, <span class=\"string\">&#x27;滑坡&#x27;</span>, <span class=\"string\">&#x27;城市化&#x27;</span>, <span class=\"string\">&#x27;海岸脆弱性&#x27;</span>, <span class=\"string\">&#x27;气候变化&#x27;</span>, <span class=\"string\">&#x27;侵蚀&#x27;</span>, <span class=\"string\">&#x27;人口得分&#x27;</span>, <span class=\"string\">&#x27;大坝质量&#x27;</span>, <span class=\"string\">&#x27;河流管理&#x27;</span>, <span class=\"string\">&#x27;地形排水&#x27;</span>]</span><br><span class=\"line\">X_selected = X[ten_columns]</span><br><span class=\"line\">selector = SelectKBest(score_func=f_classif, k=<span class=\"number\">4</span>)</span><br><span class=\"line\">X_new = selector.fit_transform(X_selected, y)</span><br><span class=\"line\">selected_features_indices = selector.get_support(indices=<span class=\"literal\">True</span>)</span><br><span class=\"line\">selected_features = X_selected.columns[selected_features_indices]</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">selected_features=<span class=\"built_in\">list</span>(selected_features)</span><br><span class=\"line\">selected_features.append(<span class=\"string\">&#x27;森林砍伐&#x27;</span>)</span><br><span class=\"line\">five_columns=selected_features</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"全局函数设置\"><a class=\"anchor\" href=\"#全局函数设置\">#</a> 全局函数设置</h3>\n<p>建立余弦相似度的计算函数</p>\n<pre><code>cosine(a,b)\n\ninput : 向量A，B\n\noutput : 两个向量的余弦相似度 0-1\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">cosine</span>(<span class=\"params\">a,b</span>):</span><br><span class=\"line\">    dot_product = np.dot(a, b)</span><br><span class=\"line\">    norm_a = np.linalg.norm(a)</span><br><span class=\"line\">    norm_b = np.linalg.norm(b)</span><br><span class=\"line\">    cosine_similarity = dot_product / (norm_a * norm_b) </span><br><span class=\"line\">    <span class=\"keyword\">return</span> cosine_similarity</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"划分训练集与测试集\"><a class=\"anchor\" href=\"#划分训练集与测试集\">#</a> 划分训练集与测试集</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"problem-one-全指标集数学模型建立与求解\"><a class=\"anchor\" href=\"#problem-one-全指标集数学模型建立与求解\">#</a> Problem ONE -- 全指标集数学模型建立与求解</h2>\n<pre><code>利用多种数学模型拟合本问题，并得出不同指标的权重\n多元线性回归\n梯度提升树\n决策树\n随机森林模型\n</code></pre>\n<h3 id=\"模型一-线性回归\"><a class=\"anchor\" href=\"#模型一-线性回归\">#</a> 模型一 线性回归</h3>\n<pre><code>原理：利用标准方程法求解线性方程组\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\">model_line=LinearRegression()</span><br><span class=\"line\">model_line.fit(X_train,y_train)</span><br><span class=\"line\">y_pred = model_line.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = model_line.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;模型的系数为: <span class=\"subst\">&#123;model_line.coef_&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;模型的截距为: <span class=\"subst\">&#123;model_line.intercept_&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\">joblib.dump(model_line,<span class=\"string\">&#x27;../Model/linear.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<pre><code>Model score: 0.8444528508563269\n均方误差为: 0.0004043169737229802\n模型的系数为: [0.00560656 0.00564613 0.00565985 0.00567684 0.00565284 0.0056578\n 0.00565561 0.00564293 0.0056437  0.0056492  0.00564238 0.0056413\n 0.005674   0.00564575 0.0056467  0.00562068 0.00568107 0.00563092\n 0.00561738 0.00564302]\n模型的截距为: -0.053357024379501294\n余弦相似度为0.9992129608069907\n\n\n\n\n\n['../Model/linear.pkl']\n</code></pre>\n<h3 id=\"模型二-梯度提升树\"><a class=\"anchor\" href=\"#模型二-梯度提升树\">#</a> 模型二 梯度提升树</h3>\n<pre><code>原理：递归的决策树，能发现更深层的变量关系\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> GradientBoostingRegressor</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> plot_tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\">n_estimators = <span class=\"number\">2000</span></span><br><span class=\"line\">gb_model = GradientBoostingRegressor(n_estimators=n_estimators, random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">cv_scores = cross_val_score(gb_model, X_train, y_train, cv=<span class=\"number\">5</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;每折交叉验证的评分:&quot;</span>, cv_scores)</span><br><span class=\"line\">gb_model.fit(X_train, y_train)</span><br><span class=\"line\">gb_score  = gb_model.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model Score : <span class=\"subst\">&#123;gb_score&#125;</span>&#x27;</span>)</span><br><span class=\"line\">feature_importances = gb_model.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\">train_loss = np.zeros((gb_model.n_estimators,), dtype=np.float64)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, y_pred <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(gb_model.staged_predict(X_train)):</span><br><span class=\"line\">    train_loss[i] = mean_squared_error(y_train, y_pred)</span><br><span class=\"line\"></span><br><span class=\"line\">test_loss = np.zeros((gb_model.n_estimators,), dtype=np.float64)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, y_pred <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(gb_model.staged_predict(X_test)):</span><br><span class=\"line\">    test_loss[i] = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">y_pred = gb_model.predict(X_test)</span><br><span class=\"line\">theta = cosine(y_pred,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;theta&#125;</span>&#x27;</span>)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差为<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(np.arange(<span class=\"number\">1</span>, gb_model.n_estimators + <span class=\"number\">1</span>), train_loss, label=<span class=\"string\">&#x27;Training Loss&#x27;</span>)</span><br><span class=\"line\">plt.plot(np.arange(<span class=\"number\">1</span>, gb_model.n_estimators + <span class=\"number\">1</span>), test_loss, label=<span class=\"string\">&#x27;Test Loss&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Number of Iterations&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Mean Squared Error&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Training and Test Loss&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances)), feature_importances, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\">joblib.dump(gb_model,<span class=\"string\">&#x27;../Model/gb_tree.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<pre><code>---------------------------------------------------------------------------\n\nKeyboardInterrupt                         Traceback (most recent call last)\n\nCell In[35], line 9\n      7 n_estimators = 2000\n      8 gb_model = GradientBoostingRegressor(n_estimators=n_estimators, random_state=42)\n----&gt; 9 cv_scores = cross_val_score(gb_model, X_train, y_train, cv=5)\n     10 print(&quot;每折交叉验证的评分:&quot;, cv_scores)\n     11 gb_model.fit(X_train, y_train)\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\sklearn\\model_selection\\_validation.py:515, in cross_val_score(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch, error_score)\n    512 # To ensure multimetric format is not supported\n    513 scorer = check_scoring(estimator, scoring=scoring)\n--&gt; 515 cv_results = cross_validate(\n    516     estimator=estimator,\n    517     X=X,\n    518     y=y,\n    519     groups=groups,\n    520     scoring=&#123;&quot;score&quot;: scorer&#125;,\n    521     cv=cv,\n    522     n_jobs=n_jobs,\n    523     verbose=verbose,\n    524     fit_params=fit_params,\n    525     pre_dispatch=pre_dispatch,\n    526     error_score=error_score,\n    527 )\n    528 return cv_results[&quot;test_score&quot;]\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\sklearn\\model_selection\\_validation.py:266, in cross_validate(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch, return_train_score, return_estimator, error_score)\n    263 # We clone the estimator to make sure that all the folds are\n    264 # independent, and that it is pickle-able.\n    265 parallel = Parallel(n_jobs=n_jobs, verbose=verbose, pre_dispatch=pre_dispatch)\n--&gt; 266 results = parallel(\n    267     delayed(_fit_and_score)(\n    268         clone(estimator),\n    269         X,\n    270         y,\n    271         scorers,\n    272         train,\n    273         test,\n    274         verbose,\n    275         None,\n    276         fit_params,\n    277         return_train_score=return_train_score,\n    278         return_times=True,\n    279         return_estimator=return_estimator,\n    280         error_score=error_score,\n    281     )\n    282     for train, test in cv.split(X, y, groups)\n    283 )\n    285 _warn_or_raise_about_fit_failures(results, error_score)\n    287 # For callabe scoring, the return type is only know after calling. If the\n    288 # return type is a dictionary, the error scores can now be inserted with\n    289 # the correct key.\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\sklearn\\utils\\parallel.py:63, in Parallel.__call__(self, iterable)\n     58 config = get_config()\n     59 iterable_with_config = (\n     60     (_with_config(delayed_func, config), args, kwargs)\n     61     for delayed_func, args, kwargs in iterable\n     62 )\n---&gt; 63 return super().__call__(iterable_with_config)\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\joblib\\parallel.py:1051, in Parallel.__call__(self, iterable)\n   1048 if self.dispatch_one_batch(iterator):\n   1049     self._iterating = self._original_iterator is not None\n-&gt; 1051 while self.dispatch_one_batch(iterator):\n   1052     pass\n   1054 if pre_dispatch == &quot;all&quot; or n_jobs == 1:\n   1055     # The iterable was consumed all at once by the above for loop.\n   1056     # No need to wait for async callbacks to trigger to\n   1057     # consumption.\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\joblib\\parallel.py:864, in Parallel.dispatch_one_batch(self, iterator)\n    862     return False\n    863 else:\n--&gt; 864     self._dispatch(tasks)\n    865     return True\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\joblib\\parallel.py:782, in Parallel._dispatch(self, batch)\n    780 with self._lock:\n    781     job_idx = len(self._jobs)\n--&gt; 782     job = self._backend.apply_async(batch, callback=cb)\n    783     # A job can complete so quickly than its callback is\n    784     # called before we get here, causing self._jobs to\n    785     # grow. To ensure correct results ordering, .insert is\n    786     # used (rather than .append) in the following line\n    787     self._jobs.insert(job_idx, job)\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\joblib\\_parallel_backends.py:208, in SequentialBackend.apply_async(self, func, callback)\n    206 def apply_async(self, func, callback=None):\n    207     &quot;&quot;&quot;Schedule a func to be run&quot;&quot;&quot;\n--&gt; 208     result = ImmediateResult(func)\n    209     if callback:\n    210         callback(result)\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\joblib\\_parallel_backends.py:572, in ImmediateResult.__init__(self, batch)\n    569 def __init__(self, batch):\n    570     # Don't delay the application, to avoid keeping the input\n    571     # arguments in memory\n--&gt; 572     self.results = batch()\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\joblib\\parallel.py:263, in BatchedCalls.__call__(self)\n    259 def __call__(self):\n    260     # Set the default nested backend to self._backend but do not set the\n    261     # change the default number of processes to -1\n    262     with parallel_backend(self._backend, n_jobs=self._n_jobs):\n--&gt; 263         return [func(*args, **kwargs)\n    264                 for func, args, kwargs in self.items]\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\joblib\\parallel.py:263, in &lt;listcomp&gt;(.0)\n    259 def __call__(self):\n    260     # Set the default nested backend to self._backend but do not set the\n    261     # change the default number of processes to -1\n    262     with parallel_backend(self._backend, n_jobs=self._n_jobs):\n--&gt; 263         return [func(*args, **kwargs)\n    264                 for func, args, kwargs in self.items]\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\sklearn\\utils\\parallel.py:123, in _FuncWrapper.__call__(self, *args, **kwargs)\n    121     config = &#123;&#125;\n    122 with config_context(**config):\n--&gt; 123     return self.function(*args, **kwargs)\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\sklearn\\model_selection\\_validation.py:686, in _fit_and_score(estimator, X, y, scorer, train, test, verbose, parameters, fit_params, return_train_score, return_parameters, return_n_test_samples, return_times, return_estimator, split_progress, candidate_progress, error_score)\n    684         estimator.fit(X_train, **fit_params)\n    685     else:\n--&gt; 686         estimator.fit(X_train, y_train, **fit_params)\n    688 except Exception:\n    689     # Note fit time as time until error\n    690     fit_time = time.time() - start_time\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\sklearn\\ensemble\\_gb.py:538, in BaseGradientBoosting.fit(self, X, y, sample_weight, monitor)\n    535     self._resize_state()\n    537 # fit the boosting stages\n--&gt; 538 n_stages = self._fit_stages(\n    539     X,\n    540     y,\n    541     raw_predictions,\n    542     sample_weight,\n    543     self._rng,\n    544     X_val,\n    545     y_val,\n    546     sample_weight_val,\n    547     begin_at_stage,\n    548     monitor,\n    549 )\n    551 # change shape of arrays after fit (early-stopping or additional ests)\n    552 if n_stages != self.estimators_.shape[0]:\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\sklearn\\ensemble\\_gb.py:615, in BaseGradientBoosting._fit_stages(self, X, y, raw_predictions, sample_weight, random_state, X_val, y_val, sample_weight_val, begin_at_stage, monitor)\n    608     old_oob_score = loss_(\n    609         y[~sample_mask],\n    610         raw_predictions[~sample_mask],\n    611         sample_weight[~sample_mask],\n    612     )\n    614 # fit next stage of trees\n--&gt; 615 raw_predictions = self._fit_stage(\n    616     i,\n    617     X,\n    618     y,\n    619     raw_predictions,\n    620     sample_weight,\n    621     sample_mask,\n    622     random_state,\n    623     X_csc,\n    624     X_csr,\n    625 )\n    627 # track deviance (= loss)\n    628 if do_oob:\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\sklearn\\ensemble\\_gb.py:257, in BaseGradientBoosting._fit_stage(self, i, X, y, raw_predictions, sample_weight, sample_mask, random_state, X_csc, X_csr)\n    254     sample_weight = sample_weight * sample_mask.astype(np.float64)\n    256 X = X_csr if X_csr is not None else X\n--&gt; 257 tree.fit(X, residual, sample_weight=sample_weight, check_input=False)\n    259 # update tree leaves\n    260 loss.update_terminal_regions(\n    261     tree.tree_,\n    262     X,\n   (...)\n    269     k=k,\n    270 )\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\sklearn\\tree\\_classes.py:1247, in DecisionTreeRegressor.fit(self, X, y, sample_weight, check_input)\n   1218 def fit(self, X, y, sample_weight=None, check_input=True):\n   1219     &quot;&quot;&quot;Build a decision tree regressor from the training set (X, y).\n   1220 \n   1221     Parameters\n   (...)\n   1244         Fitted estimator.\n   1245     &quot;&quot;&quot;\n-&gt; 1247     super().fit(\n   1248         X,\n   1249         y,\n   1250         sample_weight=sample_weight,\n   1251         check_input=check_input,\n   1252     )\n   1253     return self\n\n\nFile f:\\a\\envs\\env\\lib\\site-packages\\sklearn\\tree\\_classes.py:379, in BaseDecisionTree.fit(self, X, y, sample_weight, check_input)\n    368 else:\n    369     builder = BestFirstTreeBuilder(\n    370         splitter,\n    371         min_samples_split,\n   (...)\n    376         self.min_impurity_decrease,\n    377     )\n--&gt; 379 builder.build(self.tree_, X, y, sample_weight)\n    381 if self.n_outputs_ == 1 and is_classifier(self):\n    382     self.n_classes_ = self.n_classes_[0]\n\n\nKeyboardInterrupt: \n</code></pre>\n<h3 id=\"模型三-决策树\"><a class=\"anchor\" href=\"#模型三-决策树\">#</a> 模型三 决策树</h3>\n<pre><code>原理：利用信息增益实现节点的划分\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> plot_tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\">tree_model = DecisionTreeRegressor(random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">cv_scores = cross_val_score(tree_model, X_train, y_train, cv=<span class=\"number\">5</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;每折交叉验证的评分:&quot;</span>, cv_scores)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;交叉验证评分的平均值:&quot;</span>, np.mean(cv_scores))</span><br><span class=\"line\">tree_model.fit(X_train, y_train)</span><br><span class=\"line\">tree_score = tree_model.score(X_test, y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;Model Score :&quot;</span>, tree_score)</span><br><span class=\"line\">feature_importances = tree_model.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\">feature_importances_flat = np.ravel(feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 可视化特征重要性</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances_flat)), feature_importances_flat, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances_flat))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上进行预测</span></span><br><span class=\"line\">y_pred = tree_model.predict(X_test)</span><br><span class=\"line\">theta = cosine(y_pred,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;theta&#125;</span>&#x27;</span>)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差为<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br><span class=\"line\">joblib.dump(tree_model,<span class=\"string\">&#x27;../Model/ju_tree.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<pre><code>每折交叉验证的评分: [0.04694866 0.04297524 0.0450139  0.04790429 0.04502323]\n交叉验证评分的平均值: 0.045573064737767635\nModel Score : 0.05301513744804842\n特征重要性: [0.05072873 0.04679774 0.04822921 0.0498514  0.05054892 0.05003494\n 0.04871661 0.0509244  0.05185402 0.04976417 0.04994974 0.0515037\n 0.05054295 0.05088047 0.04947362 0.04914221 0.04920693 0.0502652\n 0.05116479 0.05042025]\n</code></pre>\n<p><img data-src=\"output_40_1.png\" alt=\"png\" /></p>\n<pre><code>余弦相似度为0.9952026345820846\n均方误差为0.0024615176549126197\n\n\n\n\n\n['../Model/ju_tree.pkl']\n</code></pre>\n<h3 id=\"模型四-随机森林\"><a class=\"anchor\" href=\"#模型四-随机森林\">#</a> 模型四 随机森林</h3>\n<pre><code>原理： 抽样决策树并使用投票策略\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rf = RandomForestRegressor(n_estimators=<span class=\"number\">4</span>, random_state=<span class=\"number\">42</span>) </span><br><span class=\"line\">rf.fit(X_train, y_train)</span><br><span class=\"line\">y_pred = rf.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = rf.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\">feature_importances = rf.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\">feature_importances_flat = np.ravel(feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 可视化特征重要性</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances_flat)), feature_importances_flat, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X_train.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances_flat))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"><span class=\"keyword\">import</span> joblib</span><br><span class=\"line\">joblib.dump(rf,<span class=\"string\">&#x27;../Model/rf_forest.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<pre><code>Model score: 0.499235508143682\n均方误差为: 0.0013016476676680254\n余弦相似度为0.9974668593808351\n特征重要性: [0.04968638 0.04813227 0.04933601 0.05021542 0.05116166 0.0494662\n 0.05073097 0.05094782 0.05060163 0.05058865 0.04939483 0.05095208\n 0.05029554 0.05063372 0.04975227 0.04803734 0.04872015 0.05049445\n 0.05024486 0.05060773]\n</code></pre>\n<p><img data-src=\"output_42_1.png\" alt=\"png\" /></p>\n<pre><code>['../Model/rf_forest.pkl']\n</code></pre>\n<h2 id=\"problem-two-风险聚类\"><a class=\"anchor\" href=\"#problem-two-风险聚类\">#</a> Problem TWO 风险聚类</h2>\n<h3 id=\"读入数据\"><a class=\"anchor\" href=\"#读入数据\">#</a> 读入数据</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"聚类算法kmeans\"><a class=\"anchor\" href=\"#聚类算法kmeans\">#</a> 聚类算法：Kmeans</h3>\n<pre><code>原理: 利用n维空间距离对初始聚类中心进行学习，得到最终聚类中心\n</code></pre>\n<h4 id=\"聚类预测函数\"><a class=\"anchor\" href=\"#聚类预测函数\">#</a> 聚类预测函数</h4>\n<pre><code>predict_cluster(kmeans,points)\ninput: kmeans模型 points需要预测的点集\noutput: 点集的预测结果\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">predict_cluster</span>(<span class=\"params\">kmeans, points</span>):</span><br><span class=\"line\">    points = np.array(points)</span><br><span class=\"line\">    points = points.reshape(-<span class=\"number\">1</span>,<span class=\"number\">1</span>)</span><br><span class=\"line\">    cluster_label = kmeans.predict(points)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> cluster_label</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"建立kmeans模型\"><a class=\"anchor\" href=\"#建立kmeans模型\">#</a> 建立 Kmeans 模型</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.cluster <span class=\"keyword\">import</span> KMeans</span><br><span class=\"line\">y=train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">y=np.array(y)</span><br><span class=\"line\"><span class=\"comment\">#y=-np.log(1/y-1)</span></span><br><span class=\"line\">data=np.array(y)</span><br><span class=\"line\">data_2d = data.reshape(-<span class=\"number\">1</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">kmeans = KMeans(n_clusters=<span class=\"number\">3</span>)</span><br><span class=\"line\">kmeans.fit(data_2d)</span><br><span class=\"line\">cluster_centers = kmeans.cluster_centers_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(cluster_centers)</span><br></pre></td></tr></table></figure></p>\n<pre><code>f:\\a\\envs\\env\\lib\\site-packages\\sklearn\\cluster\\_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n  warnings.warn(\n\n\n[[0.56441718]\n [0.44231226]\n [0.50212141]]\n</code></pre>\n<h4 id=\"建立聚类中心到风险的映射字典\"><a class=\"anchor\" href=\"#建立聚类中心到风险的映射字典\">#</a> 建立聚类中心到风险的映射字典</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">temp = np.array(cluster_centers)</span><br><span class=\"line\">indices= np.argsort(temp,axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">dic=&#123;&#125;</span><br><span class=\"line\">dic[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;indices[<span class=\"number\">0</span>]&#125;</span>&#x27;</span>]=<span class=\"string\">&#x27;低风险&#x27;</span></span><br><span class=\"line\">dic[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;indices[<span class=\"number\">1</span>]&#125;</span>&#x27;</span>]=<span class=\"string\">&#x27;中风险&#x27;</span></span><br><span class=\"line\">dic[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;indices[<span class=\"number\">2</span>]&#125;</span>&#x27;</span>]=<span class=\"string\">&#x27;高风险&#x27;</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"示例\"><a class=\"anchor\" href=\"#示例\">#</a> 示例</h4>\n<p>data= [0.55,0.99,0.51,0.42]</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data= [<span class=\"number\">0.55</span>,<span class=\"number\">0.99</span>,<span class=\"number\">0.51</span>,<span class=\"number\">0.42</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(predict_cluster(kmeans,data))</span><br></pre></td></tr></table></figure></p>\n<pre><code>[1 1 2 0]\n</code></pre>\n<h3 id=\"基于风险预警的预测模型\"><a class=\"anchor\" href=\"#基于风险预警的预测模型\">#</a> 基于风险预警的预测模型</h3>\n<h4 id=\"模型建立-mymodel\"><a class=\"anchor\" href=\"#模型建立-mymodel\">#</a> 模型建立 MyModel</h4>\n<pre><code>内核    ：某一个概率预测模型与kmeans聚类模型\npredict : 预测输入的X对应的y的风险类别\nscore   : 利用预测成功的比例衡量得分\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyModel</span>:</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self,model,kmeans</span>) -&gt; <span class=\"literal\">None</span>:</span><br><span class=\"line\">        self.model = model</span><br><span class=\"line\">        self.kmeans = kmeans</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">predict</span>(<span class=\"params\">self,X_test</span>) -&gt; np.ndarray:</span><br><span class=\"line\">        y_pred=self.model.predict(X_test)</span><br><span class=\"line\">        y_pred=np.array(y_pred)</span><br><span class=\"line\">        y_pred=predict_cluster(kmeans,y_pred)</span><br><span class=\"line\">        y_pred=np.array(y_pred)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> y_pred</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">score</span>(<span class=\"params\">self,X_test,y_test</span>):</span><br><span class=\"line\">        y_pred=self.predict(X_test)</span><br><span class=\"line\">        y_test = np.array(y_test)</span><br><span class=\"line\">        y_true=predict_cluster(kmeans,y_test)</span><br><span class=\"line\">        correct_predictions = np.<span class=\"built_in\">sum</span>(y_pred == y_true)</span><br><span class=\"line\">        overlap = correct_predictions / y_pred.size</span><br><span class=\"line\">        <span class=\"keyword\">return</span> overlap</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"数据读入-2\"><a class=\"anchor\" href=\"#数据读入-2\">#</a> 数据读入</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">map_dic</span>(<span class=\"params\">dic,a</span>):</span><br><span class=\"line\">    a=np.array(a)</span><br><span class=\"line\">    lis=[]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> a:</span><br><span class=\"line\">        lis.append(dic[<span class=\"string\">f&#x27;[<span class=\"subst\">&#123;i&#125;</span>]&#x27;</span>])</span><br><span class=\"line\">    <span class=\"keyword\">return</span> np.array(lis)</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">train_data_copy=train_data</span><br><span class=\"line\">train_data_copy[<span class=\"string\">&#x27;洪水概率&#x27;</span>] = predict_cluster(kmeans,np.array(train_data_copy[<span class=\"string\">&#x27;洪水概率&#x27;</span>]))</span><br><span class=\"line\">train_data_copy[<span class=\"string\">&#x27;洪水概率&#x27;</span>] = map_dic(dic,train_data_copy[<span class=\"string\">&#x27;洪水概率&#x27;</span>])</span><br><span class=\"line\">train_data_copy.to_csv(<span class=\"string\">&#x27;../Data/train_dealed.csv&#x27;</span>,index=<span class=\"literal\">False</span>,encoding=<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">train_data=train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">y=train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">y=np.array(y)</span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"利用先前模型构建自定义的分类模型\"><a class=\"anchor\" href=\"#利用先前模型构建自定义的分类模型\">#</a> 利用先前模型构建自定义的分类模型</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\">models = [<span class=\"string\">&#x27;linear.pkl&#x27;</span>,<span class=\"string\">&#x27;gb_tree.pkl&#x27;</span>,<span class=\"string\">&#x27;ju_tree.pkl&#x27;</span>,<span class=\"string\">&#x27;rf_forest.pkl&#x27;</span>]</span><br><span class=\"line\">path = <span class=\"string\">&#x27;../Model&#x27;</span></span><br><span class=\"line\">m_path=<span class=\"string\">&#x27;../Model/3_means&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> model <span class=\"keyword\">in</span> models:</span><br><span class=\"line\">    model_name=model.replace(<span class=\"string\">&#x27;.pkl&#x27;</span>,<span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;当前模型为<span class=\"subst\">&#123;model&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    model_path=os.path.join(path,model)</span><br><span class=\"line\">    model = joblib.load(model_path)</span><br><span class=\"line\">    model = MyModel(model,kmeans)</span><br><span class=\"line\">    <span class=\"comment\"># 这里可以加入模型的预测过程</span></span><br><span class=\"line\">    y_pred = model.predict(X_test)</span><br><span class=\"line\">    y_true=predict_cluster(kmeans,y_test)</span><br><span class=\"line\">    mse = mean_squared_error(y_true, y_pred)</span><br><span class=\"line\">    score = model.score(X_test,y_test)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\">    accuracy = cosine(y_true,y_pred)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> model_name == <span class=\"string\">&#x27;linear&#x27;</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;不同指标的权重为&#x27;</span>)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(model.model.coef_)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;不同指标的权重为&#x27;</span>)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(model.model.feature_importances_)</span><br><span class=\"line\">    joblib.dump(model,m_path+<span class=\"string\">&#x27;/&#x27;</span>+model_name+<span class=\"string\">&#x27;.pkl&#x27;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<pre><code>当前模型为linear.pkl\nModel score: 0.7765729680757218\n均方误差为: 0.6680161171113177\n余弦相似度为0.8397624947557178\n不同指标的权重为\n[0.00560656 0.00564613 0.00565985 0.00567684 0.00565284 0.0056578\n 0.00565561 0.00564293 0.0056437  0.0056492  0.00564238 0.0056413\n 0.005674   0.00564575 0.0056467  0.00562068 0.00568107 0.00563092\n 0.00561738 0.00564302]\n当前模型为gb_tree.pkl\nModel score: 0.7688148201130105\n均方误差为: 0.6767756240612259\n余弦相似度为0.8430676769184631\n不同指标的权重为\n[0.05053843 0.0513698  0.05097438 0.04985333 0.04968169 0.0498542\n 0.05148326 0.05025949 0.04944183 0.04878379 0.04970291 0.04908077\n 0.0490136  0.05042491 0.04939282 0.05113171 0.05085744 0.04953673\n 0.04897519 0.04964374]\n当前模型为ju_tree.pkl\nModel score: 0.5086617552392533\n均方误差为: 1.1945068306988056\n余弦相似度为0.7075274653380997\n不同指标的权重为\n[0.05072873 0.04679774 0.04822921 0.0498514  0.05054892 0.05003494\n 0.04871661 0.0509244  0.05185402 0.04976417 0.04994974 0.0515037\n 0.05054295 0.05088047 0.04947362 0.04914221 0.04920693 0.0502652\n 0.05116479 0.05042025]\n当前模型为rf_forest.pkl\nModel score: 0.5983406051069309\n均方误差为: 1.0319147414348044\n余弦相似度为0.7889832533919223\n不同指标的权重为\n[0.04968638 0.04813227 0.04933601 0.05021542 0.05116166 0.0494662\n 0.05073097 0.05094782 0.05060163 0.05058865 0.04939483 0.05095208\n 0.05029554 0.05063372 0.04975227 0.04803734 0.04872015 0.05049445\n 0.05024486 0.05060773]\n</code></pre>\n<h4 id=\"逻辑回归\"><a class=\"anchor\" href=\"#逻辑回归\">#</a> 逻辑回归</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">train_data=train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">y=train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">y=np.array(y)</span><br><span class=\"line\">y=predict_cluster(kmeans,y)</span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">model = LogisticRegression(solver=<span class=\"string\">&#x27;liblinear&#x27;</span>)</span><br><span class=\"line\">model.fit(X_train,y_train)</span><br><span class=\"line\">y_pred = model.predict(X_test)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">y_true=y_test</span><br><span class=\"line\">mse = mean_squared_error(y_true, y_pred)</span><br><span class=\"line\">score =np.<span class=\"built_in\">sum</span>(y_true==y_pred)/<span class=\"built_in\">len</span>(y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_true,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\">joblib.dump(model,<span class=\"string\">&#x27;../Model/3_means/logistic.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<pre><code>Model score: 0.7634599337195718\n均方误差为: 0.5021147748134372\n余弦相似度为0.8741869419358508\n\n\n\n\n\n['../Model/3_means/logistic.pkl']\n</code></pre>\n<h3 id=\"模型灵敏度分析\"><a class=\"anchor\" href=\"#模型灵敏度分析\">#</a> 模型灵敏度分析</h3>\n<pre><code>利用结果的熵值来衡量模型的灵敏度\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"设置熵的计算函数-calculate_entropy\"><a class=\"anchor\" href=\"#设置熵的计算函数-calculate_entropy\">#</a> 设置熵的计算函数 calculate_entropy</h4>\n<pre><code>input: list\nouput :总熵\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">calculate_entropy</span>(<span class=\"params\">lst</span>):</span><br><span class=\"line\">    value_counts = np.unique(lst, return_counts=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    values, counts = value_counts</span><br><span class=\"line\">    total_count = <span class=\"built_in\">len</span>(lst)</span><br><span class=\"line\">    probabilities = counts / total_count</span><br><span class=\"line\">    entropy = -np.<span class=\"built_in\">sum</span>(probabilities * np.log2(probabilities))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> entropy</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"设置基于属性变化率的计算函数-average_change_rate\"><a class=\"anchor\" href=\"#设置基于属性变化率的计算函数-average_change_rate\">#</a> 设置基于属性变化率的计算函数 average_change_rate</h4>\n<pre><code>input:list\noutput: 平均相邻变化率\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">average_change_rate</span>(<span class=\"params\">lst</span>):</span><br><span class=\"line\">    <span class=\"comment\"># 检查列表是否至少有两项</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(lst) &lt; <span class=\"number\">2</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">None</span></span><br><span class=\"line\">    change_rates = [(lst[i+<span class=\"number\">1</span>] - lst[i]) / lst[i] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(lst) - <span class=\"number\">1</span>)]</span><br><span class=\"line\">    avg_change_rate = <span class=\"built_in\">sum</span>(change_rates) / <span class=\"built_in\">len</span>(change_rates)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> avg_change_rate</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"启动基于属性对概率变化率的灵敏度计算\"><a class=\"anchor\" href=\"#启动基于属性对概率变化率的灵敏度计算\">#</a> 启动基于属性对概率变化率的灵敏度计算</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\">models = [<span class=\"string\">&#x27;linear.pkl&#x27;</span>,<span class=\"string\">&#x27;gb_tree.pkl&#x27;</span>,<span class=\"string\">&#x27;ju_tree.pkl&#x27;</span>,<span class=\"string\">&#x27;rf_forest.pkl&#x27;</span>]</span><br><span class=\"line\">path=<span class=\"string\">&#x27;../Model&#x27;</span></span><br><span class=\"line\">m_path=<span class=\"string\">&#x27;../Model/3_means&#x27;</span></span><br><span class=\"line\">entropy_list=[]</span><br><span class=\"line\"><span class=\"keyword\">for</span> model <span class=\"keyword\">in</span> models:</span><br><span class=\"line\">    model_copy=model</span><br><span class=\"line\">    train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">    train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">    train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">    X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">    model_name=model.replace(<span class=\"string\">&#x27;.pkl&#x27;</span>,<span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;当前模型为<span class=\"subst\">&#123;model&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    <span class=\"comment\"># 读入模型</span></span><br><span class=\"line\">    model_path=os.path.join(path,model)</span><br><span class=\"line\">    model = joblib.load(model_path)</span><br><span class=\"line\">    av_list=[]</span><br><span class=\"line\">    <span class=\"comment\"># 计算不同模型的变化率</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> each_column <span class=\"keyword\">in</span> X.columns: </span><br><span class=\"line\">        temp_X=pd.DataFrame(columns=X.columns)</span><br><span class=\"line\">        target=np.array(X[each_column])</span><br><span class=\"line\">        <span class=\"built_in\">min</span>=np.<span class=\"built_in\">min</span>(target)</span><br><span class=\"line\">        <span class=\"built_in\">max</span>=np.<span class=\"built_in\">max</span>(target)</span><br><span class=\"line\">        column_list=[]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">min</span>,<span class=\"built_in\">max</span>+<span class=\"number\">1</span>):</span><br><span class=\"line\">            temp_X_copy=X</span><br><span class=\"line\">            temp_X_copy[each_column]=i</span><br><span class=\"line\">            y_pred=model.predict(temp_X_copy)</span><br><span class=\"line\">            column_list.append(y_pred.mean())</span><br><span class=\"line\">        av_list.append(average_change_rate(column_list))</span><br><span class=\"line\">    df = pd.DataFrame(&#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;属性&#x27;</span>: X.columns,</span><br><span class=\"line\">    <span class=\"string\">&#x27;变化率&#x27;</span>: av_list</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    df.plot(kind=<span class=\"string\">&#x27;bar&#x27;</span>, x=<span class=\"string\">&#x27;属性&#x27;</span>, y=<span class=\"string\">&#x27;变化率&#x27;</span>)</span><br><span class=\"line\">    plt.title(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;model_name&#125;</span>属性平均变化率&#x27;</span>)</span><br><span class=\"line\">    plt.xlabel(<span class=\"string\">&#x27;属性&#x27;</span>)</span><br><span class=\"line\">    plt.ylabel(<span class=\"string\">&#x27;变化率&#x27;</span>)</span><br><span class=\"line\">    plt.show()</span><br></pre></td></tr></table></figure></p>\n<pre><code>当前模型为linear.pkl\n</code></pre>\n<p><img data-src=\"output_75_1.png\" alt=\"png\" /></p>\n<pre><code>当前模型为gb_tree.pkl\n</code></pre>\n<p><img data-src=\"output_75_3.png\" alt=\"png\" /></p>\n<pre><code>当前模型为ju_tree.pkl\n</code></pre>\n<p><img data-src=\"output_75_5.png\" alt=\"png\" /></p>\n<pre><code>当前模型为rf_forest.pkl\n</code></pre>\n<p><img data-src=\"output_75_7.png\" alt=\"png\" /></p>\n<h4 id=\"启动基于预测结果的熵值的灵敏度计算\"><a class=\"anchor\" href=\"#启动基于预测结果的熵值的灵敏度计算\">#</a> 启动基于预测结果的熵值的灵敏度计算</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\">models = [<span class=\"string\">&#x27;linear.pkl&#x27;</span>,<span class=\"string\">&#x27;gb_tree.pklfvv&#x27;</span>,<span class=\"string\">&#x27;ju_tree.pkl&#x27;</span>,<span class=\"string\">&#x27;rf_forest.pkl&#x27;</span>,<span class=\"string\">&#x27;logistic.pkl&#x27;</span>]</span><br><span class=\"line\">path=<span class=\"string\">&#x27;../Model&#x27;</span></span><br><span class=\"line\">m_path=<span class=\"string\">&#x27;../Model/3_means&#x27;</span></span><br><span class=\"line\">entropy_list=[]</span><br><span class=\"line\"><span class=\"keyword\">for</span> model <span class=\"keyword\">in</span> models:</span><br><span class=\"line\">    model_copy=model</span><br><span class=\"line\">    train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">    train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">    train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">    X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">    model_name=model.replace(<span class=\"string\">&#x27;.pkl&#x27;</span>,<span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;当前模型为<span class=\"subst\">&#123;model&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    model_path=os.path.join(m_path,model_copy)</span><br><span class=\"line\">    model = joblib.load(model_path)</span><br><span class=\"line\">    train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">    train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">    train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">    X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">    train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">    temp_X=X</span><br><span class=\"line\">    y_pred=model.predict(X)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(y_pred)</span><br><span class=\"line\">    temp_X[<span class=\"string\">&#x27;洪水概率&#x27;</span>]=y_pred</span><br><span class=\"line\">    temp_X[<span class=\"string\">&#x27;id&#x27;</span>]=train_data[<span class=\"string\">&#x27;id&#x27;</span>]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">3</span>):    </span><br><span class=\"line\">        temp=temp_X[temp_X[<span class=\"string\">&#x27;洪水概率&#x27;</span>]==i]</span><br><span class=\"line\">        temp[<span class=\"string\">&#x27;洪水概率&#x27;</span>]=dic[<span class=\"string\">f&#x27;[<span class=\"subst\">&#123;i&#125;</span>]&#x27;</span>]</span><br><span class=\"line\">        name=dic[<span class=\"string\">f&#x27;[<span class=\"subst\">&#123;i&#125;</span>]&#x27;</span>]</span><br><span class=\"line\">        csv_path=<span class=\"string\">&#x27;../Data/3_means/&#x27;</span></span><br><span class=\"line\">        temp.to_csv(csv_path+<span class=\"string\">f&#x27;<span class=\"subst\">&#123;model_name&#125;</span>&#x27;</span>+<span class=\"string\">&#x27;/&#x27;</span>+<span class=\"string\">f&#x27;<span class=\"subst\">&#123;name&#125;</span>.csv&#x27;</span>,index=<span class=\"literal\">False</span>,encoding=<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">    entropy_list.append(calculate_entropy(y_pred))</span><br><span class=\"line\">df = pd.DataFrame(&#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;模型&#x27;</span>: [<span class=\"string\">&#x27;线性回归&#x27;</span>,<span class=\"string\">&#x27;梯度提升树&#x27;</span>,<span class=\"string\">&#x27;决策树&#x27;</span>,<span class=\"string\">&#x27;随机森林&#x27;</span>,<span class=\"string\">&#x27;逻辑回归&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;熵值&#x27;</span>: entropy_list</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">df.plot(kind=<span class=\"string\">&#x27;bar&#x27;</span>, x=<span class=\"string\">&#x27;模型&#x27;</span>, y=<span class=\"string\">&#x27;熵值&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">f&#x27;不同模型的灵敏度&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;模型&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;熵值&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<pre><code>当前模型为linear.pkl\n[2 2 2 ... 2 2 1]\n\n\nC:\\Users\\12780\\AppData\\Local\\Temp\\ipykernel_25292\\1261529529.py:28: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  temp['洪水概率']=dic[f'[&#123;i&#125;]']\n\n\n当前模型为gb_tree.pkl\n[2 2 2 ... 2 2 1]\n\n\nC:\\Users\\12780\\AppData\\Local\\Temp\\ipykernel_25292\\1261529529.py:28: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  temp['洪水概率']=dic[f'[&#123;i&#125;]']\n\n\n当前模型为ju_tree.pkl\n[2 0 2 ... 2 0 1]\n\n\nC:\\Users\\12780\\AppData\\Local\\Temp\\ipykernel_25292\\1261529529.py:28: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  temp['洪水概率']=dic[f'[&#123;i&#125;]']\n\n\n当前模型为rf_forest.pkl\n[2 2 2 ... 2 2 2]\n\n\nC:\\Users\\12780\\AppData\\Local\\Temp\\ipykernel_25292\\1261529529.py:28: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  temp['洪水概率']=dic[f'[&#123;i&#125;]']\n\n\n当前模型为logistic.pkl\n[2 2 2 ... 2 2 1]\n\n\nC:\\Users\\12780\\AppData\\Local\\Temp\\ipykernel_25292\\1261529529.py:28: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  temp['洪水概率']=dic[f'[&#123;i&#125;]']\n</code></pre>\n<p><img data-src=\"output_77_10.png\" alt=\"png\" /></p>\n<h2 id=\"problem-three-从不同指标集建立洪水的预测模型\"><a class=\"anchor\" href=\"#problem-three-从不同指标集建立洪水的预测模型\">#</a> Problem THREE 从不同指标集建立洪水的预测模型</h2>\n<h3 id=\"利用半指标集重新训练模型\"><a class=\"anchor\" href=\"#利用半指标集重新训练模型\">#</a> 利用半指标集重新训练模型</h3>\n<h4 id=\"数据读入与划分\"><a class=\"anchor\" href=\"#数据读入与划分\">#</a> 数据读入与划分</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">X=X[ten_columns]</span><br><span class=\"line\">y=train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">y=np.array(y)</span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"多元线性回归\"><a class=\"anchor\" href=\"#多元线性回归\">#</a> 多元线性回归</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\">model_line=LinearRegression()</span><br><span class=\"line\">model_line.fit(X_train,y_train)</span><br><span class=\"line\">y_pred = model_line.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = model_line.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;模型的系数为: <span class=\"subst\">&#123;model_line.coef_&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;模型的截距为: <span class=\"subst\">&#123;model_line.intercept_&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<pre><code>Model score: 0.37461847859805275\n均方误差为: 0.0016255673314973993\n模型的系数为: [0.00507833 0.00501385 0.00495665 0.00492889 0.00504095 0.00491355\n 0.00504961 0.00504281 0.0050641  0.00502683]\n模型的截距为: 0.2568960934135129\n余弦相似度为0.9968319141241095\n</code></pre>\n<h4 id=\"梯度提升树\"><a class=\"anchor\" href=\"#梯度提升树\">#</a> 梯度提升树</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> GradientBoostingRegressor</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> plot_tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\">n_estimators = <span class=\"number\">1200</span></span><br><span class=\"line\">gb_model = GradientBoostingRegressor(n_estimators=n_estimators, random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">gb_model.fit(X_train, y_train)</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上评估模型性能</span></span><br><span class=\"line\">gb_score  = gb_model.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model Score : <span class=\"subst\">&#123;gb_score&#125;</span>&#x27;</span>)</span><br><span class=\"line\">feature_importances = gb_model.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 计算每轮迭代的损失值</span></span><br><span class=\"line\">train_loss = np.zeros((gb_model.n_estimators,), dtype=np.float64)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, y_pred <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(gb_model.staged_predict(X_train)):</span><br><span class=\"line\">    train_loss[i] = mean_squared_error(y_train, y_pred)</span><br><span class=\"line\"></span><br><span class=\"line\">test_loss = np.zeros((gb_model.n_estimators,), dtype=np.float64)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, y_pred <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(gb_model.staged_predict(X_test)):</span><br><span class=\"line\">    test_loss[i] = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上进行预测</span></span><br><span class=\"line\">y_pred = gb_model.predict(X_test)</span><br><span class=\"line\">theta = cosine(y_pred,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;theta&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 计算均方误差</span></span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差为<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 绘制损失曲线</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(np.arange(<span class=\"number\">1</span>, gb_model.n_estimators + <span class=\"number\">1</span>), train_loss, label=<span class=\"string\">&#x27;Training Loss&#x27;</span>)</span><br><span class=\"line\">plt.plot(np.arange(<span class=\"number\">1</span>, gb_model.n_estimators + <span class=\"number\">1</span>), test_loss, label=<span class=\"string\">&#x27;Test Loss&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Number of Iterations&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Mean Squared Error&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Training and Test Loss&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"><span class=\"comment\"># 可视化特征重要性</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances)), feature_importances, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X_train.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure></p>\n<pre><code>Model Score : 0.378759314749781\n特征重要性: [0.10139095 0.10060794 0.09787091 0.09610327 0.09900577 0.09537671\n 0.10140741 0.10290733 0.10224735 0.10308238]\n余弦相似度为0.996852927605829\n均方误差为0.0016148039690650664\n</code></pre>\n<p><img data-src=\"output_85_1.png\" alt=\"png\" /></p>\n<p><img data-src=\"output_85_2.png\" alt=\"png\" /></p>\n<h4 id=\"决策树\"><a class=\"anchor\" href=\"#决策树\">#</a> 决策树</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> plot_tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\">tree_model = DecisionTreeRegressor(random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">tree_model.fit(X_train, y_train)</span><br><span class=\"line\">tree_score = tree_model.score(X_test, y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;Model Score :&quot;</span>, tree_score)</span><br><span class=\"line\">feature_importances = tree_model.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\">feature_importances_flat = np.ravel(feature_importances)</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances_flat)), feature_importances_flat, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X_train.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances_flat))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\">y_pred = tree_model.predict(X_test)</span><br><span class=\"line\">theta = cosine(y_pred,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;theta&#125;</span>&#x27;</span>)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差为<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<pre><code>Model Score : -0.37999290530770646\n特征重要性: [0.09880106 0.09983387 0.10125522 0.10165829 0.10035667 0.10129578\n 0.09900273 0.09949576 0.0994488  0.09885181]\n</code></pre>\n<p><img data-src=\"output_87_1.png\" alt=\"png\" /></p>\n<pre><code>余弦相似度为0.9930189485511745\n均方误差为0.003587044560474931\n</code></pre>\n<h4 id=\"随机森林\"><a class=\"anchor\" href=\"#随机森林\">#</a> 随机森林</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rf = RandomForestRegressor(n_estimators=<span class=\"number\">4</span>, random_state=<span class=\"number\">42</span>)  <span class=\"comment\"># 使用100棵树</span></span><br><span class=\"line\">rf.fit(X_train, y_train)</span><br><span class=\"line\">y_pred = rf.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = rf.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\">feature_importances = rf.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\">feature_importances_flat = np.ravel(feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 可视化特征重要性</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances_flat)), feature_importances_flat, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X_train.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances_flat))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure></p>\n<pre><code>Model score: 0.15691875212778306\n均方误差为: 0.002191438805653956\n余弦相似度为0.9957272905379122\n特征重要性: [0.09854545 0.10019614 0.10220218 0.1030608  0.1000937  0.10149794\n 0.09828828 0.0987665  0.09905775 0.09829126]\n</code></pre>\n<p><img data-src=\"output_89_1.png\" alt=\"png\" /></p>\n<h3 id=\"利用核心指标集重新训练模型\"><a class=\"anchor\" href=\"#利用核心指标集重新训练模型\">#</a> 利用核心指标集重新训练模型</h3>\n<h4 id=\"数据读入-3\"><a class=\"anchor\" href=\"#数据读入-3\">#</a> 数据读入</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 在这里进行数据指标的选择</span></span><br><span class=\"line\">X=X[five_columns]</span><br><span class=\"line\">y=train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">y=np.array(y)</span><br><span class=\"line\"><span class=\"comment\">#y=-np.log(1/y-1)</span></span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"多元线性回归-2\"><a class=\"anchor\" href=\"#多元线性回归-2\">#</a> 多元线性回归</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\">model_line=LinearRegression()</span><br><span class=\"line\">model_line.fit(X_train,y_train)</span><br><span class=\"line\">y_pred = model_line.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = model_line.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;模型的系数为: <span class=\"subst\">&#123;model_line.coef_&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;模型的截距为: <span class=\"subst\">&#123;model_line.intercept_&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<pre><code>Model score: 0.181427445558773\n均方误差为: 0.0021277328437480304\n模型的系数为: [0.00482241 0.00476873 0.00479914 0.00474271 0.00475476]\n模型的截距为: 0.38645331900338376\n余弦相似度为0.9958512145383939\n</code></pre>\n<h4 id=\"梯度提升树-2\"><a class=\"anchor\" href=\"#梯度提升树-2\">#</a> 梯度提升树</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> GradientBoostingRegressor</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> plot_tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\"><span class=\"comment\"># 设置迭代次数为100</span></span><br><span class=\"line\">n_estimators = <span class=\"number\">1000</span></span><br><span class=\"line\"><span class=\"comment\"># 创建并训练梯度提升树回归模型</span></span><br><span class=\"line\">gb_model = GradientBoostingRegressor(n_estimators=n_estimators, random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">gb_model.fit(X_train, y_train)</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上评估模型性能</span></span><br><span class=\"line\">gb_score  = gb_model.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model Score : <span class=\"subst\">&#123;gb_score&#125;</span>&#x27;</span>)</span><br><span class=\"line\">feature_importances = gb_model.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 计算每轮迭代的损失值</span></span><br><span class=\"line\">train_loss = np.zeros((gb_model.n_estimators,), dtype=np.float64)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, y_pred <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(gb_model.staged_predict(X_train)):</span><br><span class=\"line\">    train_loss[i] = mean_squared_error(y_train, y_pred)</span><br><span class=\"line\"></span><br><span class=\"line\">test_loss = np.zeros((gb_model.n_estimators,), dtype=np.float64)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, y_pred <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(gb_model.staged_predict(X_test)):</span><br><span class=\"line\">    test_loss[i] = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上进行预测</span></span><br><span class=\"line\">y_pred = gb_model.predict(X_test)</span><br><span class=\"line\">theta = cosine(y_pred,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;theta&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 计算均方误差</span></span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差为<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 绘制损失曲线</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(np.arange(<span class=\"number\">1</span>, gb_model.n_estimators + <span class=\"number\">1</span>), train_loss, label=<span class=\"string\">&#x27;Training Loss&#x27;</span>)</span><br><span class=\"line\">plt.plot(np.arange(<span class=\"number\">1</span>, gb_model.n_estimators + <span class=\"number\">1</span>), test_loss, label=<span class=\"string\">&#x27;Test Loss&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Number of Iterations&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Mean Squared Error&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Training and Test Loss&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure></p>\n<pre><code>Model Score : 0.18546794557325652\n特征重要性: [0.20028747 0.20177494 0.20162684 0.20300577 0.19330498]\n余弦相似度为0.9958717349992869\n均方误差为0.002117230287145886\n</code></pre>\n<p><img data-src=\"output_96_1.png\" alt=\"png\" /></p>\n<h4 id=\"决策树-2\"><a class=\"anchor\" href=\"#决策树-2\">#</a> 决策树</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> plot_tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\"><span class=\"comment\"># 创建并训练决策树回归模型</span></span><br><span class=\"line\">tree_model = DecisionTreeRegressor(random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">tree_model.fit(X_train, y_train)</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上评估模型性能</span></span><br><span class=\"line\">tree_score = tree_model.score(X_test, y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;Model Score :&quot;</span>, tree_score)</span><br><span class=\"line\"><span class=\"comment\"># 输出特征重要性</span></span><br><span class=\"line\">feature_importances = tree_model.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 将特征重要性展平</span></span><br><span class=\"line\">feature_importances_flat = np.ravel(feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 可视化特征重要性</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances_flat)), feature_importances_flat, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances_flat))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上进行预测</span></span><br><span class=\"line\">y_pred = tree_model.predict(X_test)</span><br><span class=\"line\">theta = cosine(y_pred,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;theta&#125;</span>&#x27;</span>)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差为<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<pre><code>Model Score : 0.06121741625318666\n特征重要性: [0.19938786 0.20108056 0.19957446 0.20072828 0.19922885]\n</code></pre>\n<p><img data-src=\"output_98_1.png\" alt=\"png\" /></p>\n<pre><code>余弦相似度为0.9952413117618393\n均方误差为0.0024401972992366535\n</code></pre>\n<h4 id=\"随机森林-2\"><a class=\"anchor\" href=\"#随机森林-2\">#</a> 随机森林</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rf = RandomForestRegressor(n_estimators=<span class=\"number\">4</span>, random_state=<span class=\"number\">42</span>) </span><br><span class=\"line\">rf.fit(X_train, y_train)</span><br><span class=\"line\">y_pred = rf.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = rf.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\">feature_importances = rf.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\">feature_importances_flat = np.ravel(feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 可视化特征重要性</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances_flat)), feature_importances_flat, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X_train.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances_flat))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure></p>\n<pre><code>Model score: 0.08951717139739401\n均方误差为: 0.0023666371509472196\n余弦相似度为0.9953848954929839\n特征重要性: [0.19743656 0.2002398  0.20023184 0.20070336 0.20138843]\n</code></pre>\n<p><img data-src=\"output_100_1.png\" alt=\"png\" /></p>\n<h2 id=\"problem-four-预测洪水发生的概率\"><a class=\"anchor\" href=\"#problem-four-预测洪水发生的概率\">#</a> Problem FOUR 预测洪水发生的概率</h2>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> RandomForestClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> BaggingClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> BaggingRegressor</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> DecisionTreeClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> GradientBoostingRegressor</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.datasets <span class=\"keyword\">import</span> load_iris</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.compose <span class=\"keyword\">import</span> ColumnTransformer</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.pipeline <span class=\"keyword\">import</span> Pipeline</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LinearRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> DecisionTreeRegressor</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.preprocessing <span class=\"keyword\">import</span> StandardScaler</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">import</span> joblib</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">bagging_model</span>:</span><br><span class=\"line\">    a_gb=<span class=\"number\">0.15</span></span><br><span class=\"line\">    a_ju=<span class=\"number\">0.15</span></span><br><span class=\"line\">    a_line=<span class=\"number\">0.4</span></span><br><span class=\"line\">    a_rf=<span class=\"number\">0.2</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self</span>) -&gt; <span class=\"literal\">None</span>:</span><br><span class=\"line\">        self.gb_tree=GradientBoostingRegressor(n_estimators=<span class=\"number\">1000</span>, random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">        self.ju_tree=DecisionTreeRegressor(random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">        self.normal_line=LinearRegression()</span><br><span class=\"line\">        self.rf_forest=RandomForestRegressor(n_estimators=<span class=\"number\">20</span>)</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">step</span>(<span class=\"params\">self,X_train,y_train,X_test,y_test</span>):</span><br><span class=\"line\">        y_test=np.array(y_test)</span><br><span class=\"line\">        y_test=y_test.flatten()</span><br><span class=\"line\">        pre_gb=self.gb_tree.predict(X_test)</span><br><span class=\"line\">        pre_gb=pre_gb.flatten()</span><br><span class=\"line\">        pre_ju=self.ju_tree.predict(X_test)</span><br><span class=\"line\">        pre_ju=pre_ju.flatten()</span><br><span class=\"line\">        pre_line=self.normal_line.predict(X_test)</span><br><span class=\"line\">        pre_line=pre_line.flatten()</span><br><span class=\"line\">        pre_rf=self.rf_forest.predict(X_test)</span><br><span class=\"line\">        pre_rf=pre_rf.flatten()</span><br><span class=\"line\">        df=pd.DataFrame(&#123;</span><br><span class=\"line\">            <span class=\"string\">&#x27;gb&#x27;</span>:pre_gb,</span><br><span class=\"line\">            <span class=\"string\">&#x27;ju&#x27;</span>:pre_ju,</span><br><span class=\"line\">            <span class=\"string\">&#x27;line&#x27;</span>:pre_line,</span><br><span class=\"line\">            <span class=\"string\">&#x27;rf&#x27;</span>:pre_rf,</span><br><span class=\"line\">            <span class=\"string\">&#x27;target&#x27;</span>:y_test</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        X_t=df.drop(columns=<span class=\"string\">&#x27;target&#x27;</span>)</span><br><span class=\"line\">        y_t=df[<span class=\"string\">&#x27;target&#x27;</span>]</span><br><span class=\"line\">        X_tr, X_te, y_tr, y_te = train_test_split(X_t, y_t, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">        MODEL=LinearRegression(fit_intercept=<span class=\"literal\">False</span>)</span><br><span class=\"line\">        MODEL.fit(X_tr,y_tr)</span><br><span class=\"line\">        temp=MODEL.coef_</span><br><span class=\"line\">        temp=temp/<span class=\"built_in\">sum</span>(temp)</span><br><span class=\"line\">        self.a_gb=temp[<span class=\"number\">0</span>]</span><br><span class=\"line\">        self.a_ju=temp[<span class=\"number\">1</span>]</span><br><span class=\"line\">        self.a_line=temp[<span class=\"number\">2</span>]</span><br><span class=\"line\">        self.a_rf=temp[<span class=\"number\">3</span>]</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">fit</span>(<span class=\"params\">self,X_train,y_train</span>):</span><br><span class=\"line\">        X_t=X_train</span><br><span class=\"line\">        y_t=y_train</span><br><span class=\"line\">        <span class=\"comment\"># 有放回地抽样4次</span></span><br><span class=\"line\">        df = pd.merge(X_train,y_train,left_index=<span class=\"literal\">True</span>,right_index=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        data_list=[df.sample(frac=<span class=\"number\">1</span>, replace=<span class=\"literal\">True</span>) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>)]</span><br><span class=\"line\">        data=data_list[<span class=\"number\">0</span>]</span><br><span class=\"line\">        X_train=data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">        y_train=data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">        self.gb_tree.fit(X_train,y_train)</span><br><span class=\"line\">        data=data_list[<span class=\"number\">1</span>]</span><br><span class=\"line\">        X_train=data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">        y_train=data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">        self.ju_tree.fit(X_train,y_train)</span><br><span class=\"line\">        data=data_list[<span class=\"number\">2</span>]</span><br><span class=\"line\">        X_train=data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">        y_train=data[[<span class=\"string\">&#x27;洪水概率&#x27;</span>]]</span><br><span class=\"line\">        self.normal_line.fit(X_train,y_train)</span><br><span class=\"line\">        data=data_list[<span class=\"number\">3</span>]</span><br><span class=\"line\">        X_train=data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">        y_train=data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">        self.rf_forest.fit(X_train,y_train)</span><br><span class=\"line\">        self.step(X_t,y_t,X_test,y_test)</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">predict</span>(<span class=\"params\">self,X_test</span>):</span><br><span class=\"line\">        pre_gb=self.gb_tree.predict(X_test)</span><br><span class=\"line\">        pre_gb=pre_gb.flatten()</span><br><span class=\"line\">        pre_ju=self.ju_tree.predict(X_test)</span><br><span class=\"line\">        pre_ju=pre_ju.flatten()</span><br><span class=\"line\">        pre_line=self.normal_line.predict(X_test)</span><br><span class=\"line\">        pre_line=pre_line.flatten()</span><br><span class=\"line\">        pre_rf=self.rf_forest.predict(X_test)</span><br><span class=\"line\">        pre_rf=pre_rf.flatten()</span><br><span class=\"line\">        y_pred=pre_gb*self.a_gb+pre_ju*self.a_ju+pre_line*self.a_line+pre_rf*self.a_rf</span><br><span class=\"line\">        <span class=\"keyword\">return</span> y_pred</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">score</span>(<span class=\"params\">self,X_test,y_test</span>):</span><br><span class=\"line\">        score_gb=self.gb_tree.score(X_test,y_test)</span><br><span class=\"line\">        score_ju=self.ju_tree.score(X_test,y_test)</span><br><span class=\"line\">        score_line=self.normal_line.score(X_test,y_test)</span><br><span class=\"line\">        score_rf=self.rf_forest.score(X_test,y_test)</span><br><span class=\"line\">        score = score_gb*self.a_gb+score_ju*self.a_ju+score_line*self.a_line+score_rf*self.a_rf</span><br><span class=\"line\">        <span class=\"keyword\">return</span> score</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"训练集成模型\"><a class=\"anchor\" href=\"#训练集成模型\">#</a> 训练集成模型</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">y=train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">model=bagging_model()</span><br><span class=\"line\">model.fit(X_train,y_train)</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"集成模型输出\"><a class=\"anchor\" href=\"#集成模型输出\">#</a> 集成模型输出</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">y_pred=model.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = model.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<pre><code>Model score: 0.182629512994938\n均方误差为: 0.0021174324247682824\n余弦相似度为0.9958713234970328\n</code></pre>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 读取测试数据并进行预测</span></span><br><span class=\"line\">test_data_path = <span class=\"string\">&#x27;../Data/test.csv&#x27;</span></span><br><span class=\"line\">test_data = pd.read_csv(test_data_path)</span><br><span class=\"line\">test_ids = test_data[<span class=\"string\">&#x27;id&#x27;</span>]</span><br><span class=\"line\">X=test_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">X_test=X.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">predictions = model.predict(X_test)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将预测结果写入submit.csv</span></span><br><span class=\"line\">submit_data = pd.DataFrame(&#123;<span class=\"string\">&#x27;id&#x27;</span>: test_ids, <span class=\"string\">&#x27;洪水概率&#x27;</span>: predictions&#125;)</span><br><span class=\"line\">submit_data.to_csv(<span class=\"string\">&#x27;../Data/submit.csv&#x27;</span>, index=<span class=\"literal\">False</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;预测结果已保存到 submit.csv&quot;</span>)</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"通过绘制图形直方图和qq图-统计检验shapiro-wilk-检验-kolmogorov-smirnov-检验-anderson-darling-检验-dagostinos-k2-检验-描述性统计偏度skewness和峰度kurtosis\"><a class=\"anchor\" href=\"#通过绘制图形直方图和qq图-统计检验shapiro-wilk-检验-kolmogorov-smirnov-检验-anderson-darling-检验-dagostinos-k2-检验-描述性统计偏度skewness和峰度kurtosis\">#</a> 通过绘制图形（直方图和 QQ 图）、统计检验（Shapiro-Wilk 检验、Kolmogorov-Smirnov 检验、Anderson-Darling 检验、D'Agostino's K^2 检验）、描述性统计（偏度（Skewness）和峰度（Kurtosis））</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> scipy.stats <span class=\"keyword\">as</span> stats</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 加载数据</span></span><br><span class=\"line\">data = pd.read_csv(<span class=\"string\">&#x27;/mnt/data/submit.csv&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 提取洪水概率</span></span><br><span class=\"line\">flood_probabilities = data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制直方图和Q-Q图</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">12</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">plt.subplot(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">sns.histplot(flood_probabilities, kde=<span class=\"literal\">True</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;洪水概率的直方图&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">plt.subplot(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">stats.probplot(flood_probabilities, dist=<span class=\"string\">&quot;norm&quot;</span>, plot=plt)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;洪水概率的Q-Q图&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Shapiro-Wilk检验</span></span><br><span class=\"line\">shapiro_test = stats.shapiro(flood_probabilities)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;Shapiro-Wilk 检验: W=<span class=\"subst\">&#123;shapiro_test[<span class=\"number\">0</span>]&#125;</span>, p值=<span class=\"subst\">&#123;shapiro_test[<span class=\"number\">1</span>]&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> shapiro_test[<span class=\"number\">1</span>] &gt; <span class=\"number\">0.05</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Shapiro-Wilk 检验结果: 数据服从正态分布&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Shapiro-Wilk 检验结果: 数据不服从正态分布&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Kolmogorov-Smirnov检验</span></span><br><span class=\"line\">ks_test = stats.kstest(flood_probabilities, <span class=\"string\">&#x27;norm&#x27;</span>, args=(np.mean(flood_probabilities), np.std(flood_probabilities)))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;Kolmogorov-Smirnov 检验: D=<span class=\"subst\">&#123;ks_test[<span class=\"number\">0</span>]&#125;</span>, p值=<span class=\"subst\">&#123;ks_test[<span class=\"number\">1</span>]&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> ks_test[<span class=\"number\">1</span>] &gt; <span class=\"number\">0.05</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Kolmogorov-Smirnov 检验结果: 数据服从正态分布&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Kolmogorov-Smirnov 检验结果: 数据不服从正态分布&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Anderson-Darling检验</span></span><br><span class=\"line\">ad_test = stats.anderson(flood_probabilities, dist=<span class=\"string\">&#x27;norm&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;Anderson-Darling 检验: A2=<span class=\"subst\">&#123;ad_test.statistic&#125;</span>, 临界值=<span class=\"subst\">&#123;ad_test.critical_values&#125;</span>, 显著性水平=<span class=\"subst\">&#123;ad_test.significance_level&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> ad_test.statistic &lt; ad_test.critical_values[<span class=\"number\">2</span>]:  <span class=\"comment\"># Typically, the 5% significance level is used</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Anderson-Darling 检验结果: 数据服从正态分布&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Anderson-Darling 检验结果: 数据不服从正态分布&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 偏度和峰度</span></span><br><span class=\"line\">skewness = stats.skew(flood_probabilities)</span><br><span class=\"line\">kurtosis = stats.kurtosis(flood_probabilities)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;偏度: <span class=\"subst\">&#123;skewness&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;峰度: <span class=\"subst\">&#123;kurtosis&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"built_in\">abs</span>(skewness) &lt; <span class=\"number\">0.5</span> <span class=\"keyword\">and</span> <span class=\"built_in\">abs</span>(kurtosis) &lt; <span class=\"number\">3</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;偏度和峰度结果: 数据服从正态分布&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;偏度和峰度结果: 数据不服从正态分布&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 显示Anderson-Darling检验结果</span></span><br><span class=\"line\">ad_test_results = pd.DataFrame(&#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;临界值&#x27;</span>: ad_test.critical_values,</span><br><span class=\"line\">    <span class=\"string\">&#x27;显著性水平(%)&#x27;</span>: ad_test.significance_level</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(ad_test_results)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制洪水概率的折线图</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(data[<span class=\"string\">&#x27;id&#x27;</span>], flood_probabilities, marker=<span class=\"string\">&#x27;o&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;洪水概率的折线图&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;ID&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">plt.grid(<span class=\"literal\">True</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h1 id=\"洪水灾害的数据分析与预测基于多模型集成学习的方法研究\"><a class=\"anchor\" href=\"#洪水灾害的数据分析与预测基于多模型集成学习的方法研究\">#</a> 洪水灾害的数据分析与预测：基于多模型集成学习的方法研究</h1>\n<h2 id=\"摘要\"><a class=\"anchor\" href=\"#摘要\">#</a> 摘要</h2>\n<p>本研究围绕洪水灾害的分析与预测展开，利用多模型集成学习方法对洪水发生概率及其影响因素进行了系统性和科学性的探讨。研究通过对附件提供的 train.csv 数据进行预处理，确保数据的准确性和完整性，并基于多种相关性分析和预测模型，提出了有效的洪水预测和防洪减灾策略。</p>\n<p>针对问题一，本文采用<strong>皮尔逊</strong>相关系数和<strong>斯皮尔曼</strong>等级相关系数对 20 个指标与洪水发生概率之间的相关性进行了详细量化分析。结果显示，<strong>基础设施恶化、季风强度、大坝质量、地形排水、河流管理</strong>等指标与洪水发生概率具有显著相关性。基于这些分析，研究提出了一系列合理的防洪措施建议，如加强基础设施建设、优化河流管理、提升大坝质量等，以有效降低洪水发生的风险。</p>\n<p>针对问题二，本文利用<strong> K-means</strong> 聚类方法将洪水发生概率划分为高、中、低三个风险等级，并深入分析了不同风险等级下的<strong>指标特征差异</strong>。通过对高、中、低风险类别中各项影响因素的详细探讨，建立了四个具有高度准确性的预警评价模型，明确了不通类别洪水风险的主要特征，为洪水风险管理提供了科学依据。</p>\n<p>针对问题三，研究基于前述相关性分析结果，分别构建了<strong>多元线性回归模型、梯度提升树模型、决策树模型、随机森林模型和逻辑回归模型</strong>，系统评估了各模型的预测性能。为了提高预测的准确性和稳定性，本文通过 Bagging 技术整合多种模型的预测结果，提出了一个集成学习模型。该模型在对 test.csv 数据进行验证时，显示出优异的预测性能，进一步提升了洪水发生概率预测的准确性。</p>\n<p>针对问题四，本文利用集成学习模型对 test.csv 中的数据进行了洪水发生概率的预测，并将预测结果填入 submit.csv 中。通过绘制直方图和折线图，对预测结果的分布进行了统计分析，并通过<strong> Quantile-Quantile 图、Shapiro-Wilk 检验、Kolmogorov-Smirnov 测试和 Anderson-Darling 检验</strong>，验证了预测结果的分布特性。结果表明，模型预测的洪水发生概率分布较为合理，但不完全符合正态分布，具有一定的重尾现象，进一步验证了模型的有效性和可靠性。</p>\n<p>总体而言，本研究不仅为洪水灾害的预测提供了有效的数学模型和工具，也为制定科学合理的防洪减灾策略提供了重要参考和借鉴。通过对数据的深入分析和模型的多样化应用，本文为相关领域的研究和实践提供了新的思路和方法。本文的研究成果不仅具有重要的理论价值，也在实际应用中具有广泛的推广潜力。</p>\n<p><em><strong>* 关键词 *</strong></em>：洪水灾害，数据分析，多模型集成学习，皮尔逊相关系数，斯皮尔曼等级相关系数，K-means 聚类，风险分类，Bagging 技术，预警评价模型，正态分布分析，防洪减灾措施</p>\n<h2 id=\"目录\"><a class=\"anchor\" href=\"#目录\">#</a> 目录</h2>\n<p><a href=\"#_Toc28221\"><em><strong>* 洪水灾害的数据分析与预测：基于多模型集成学习的方法研究 *</strong></em>\t</a></p>\n<p><a href=\"#_Toc26087\"><em><strong>* 一、问题背景与问题重述 *</strong></em>\t</a></p>\n<p><a href=\"#_Toc20599\">1.1 问题背景\t</a></p>\n<p><a href=\"#_Toc12872\">1.2 已知条件\t</a></p>\n<p><a href=\"#_Toc9667\">1.3 问题重述\t</a></p>\n<p><a href=\"#_Toc18489\"><em><strong>* 二、 模型假设 *</strong></em>\t</a></p>\n<p><a href=\"#_Toc21271\"><em><strong>* 三、 符号说明 *</strong></em>\t</a></p>\n<p><a href=\"#_Toc24812\"><em><strong>* 四、 研究思路 *</strong></em>\t</a></p>\n<p><a href=\"#_Toc23690\"><em><strong>* 五、*</strong></em> <em><strong>* 问题一的建模与求解 *</strong></em>\t</a></p>\n<p><a href=\"#_Toc10510\">5.1 数据预处理\t</a></p>\n<p><a href=\"#_Toc14684\">5.2 问题一的模型建立与求解\t</a></p>\n<p><a href=\"#_Toc19215\">5.2.1 用皮尔逊相关系数和斯皮尔曼等级相关系数研究各指标与洪水发生概率的相关性。\t</a></p>\n<p><a href=\"#_Toc8589\">5.2.2 通过多元线性回归、递归提升树、随机森林对指标的优劣进行分析。\t</a></p>\n<p><a href=\"#_Toc16643\">5.2.3 结果分析\t</a></p>\n<p><a href=\"#_Toc26819\">5.3 建议与措施\t</a></p>\n<p><a href=\"#_Toc21065\"><em><strong>* 六、问题二的建模与求解 *</strong></em>\t</a></p>\n<p><a href=\"#_Toc22996\">6.1 问题 2 的分析\t</a></p>\n<p><a href=\"#_Toc913\">6.1.1 数据预处理\t</a></p>\n<p><a href=\"#_Toc24367\">6.1.2 聚类方法选择\t</a></p>\n<p><a href=\"#_Toc13314\">6.2  k-means 建模实现与分析\t</a></p>\n<p><a href=\"#_Toc26613\">6.2.1 模型建立\t</a></p>\n<p><a href=\"#_Toc14469\">6.2.2 高中低风险特征分析\t</a></p>\n<p><a href=\"#_Toc13962\">6.2.3 建立发生洪水不同风险预警模型\t</a></p>\n<p><a href=\"#_Toc3720\">6.3 模型灵敏度分析\t</a></p>\n<p><a href=\"#_Toc27867\">6.3.1 基于特征变化率的灵敏度计算\t</a></p>\n<p><a href=\"#_Toc18865\">6.3.2 基于预测结果熵值的灵敏度计算\t</a></p>\n<p><a href=\"#_Toc2991\">七、 问题三的建模与求解\t</a></p>\n<p><a href=\"#_Toc15454\">7.1 指标选取\t</a></p>\n<p><a href=\"#_Toc1478\">7.1.2 基于过滤法选取关键指标\t</a></p>\n<p><a href=\"#_Toc6370\">7.2 各模型结果分析\t</a></p>\n<p><a href=\"#_Toc19592\">7.3 最终模型建立\t</a></p>\n<p><a href=\"#_Toc31192\"><em><strong>* 八、问题四的建模与求解 *</strong></em>\t</a></p>\n<p><a href=\"#_Toc11155\">8.1 结果预测\t</a></p>\n<p><a href=\"#_Toc29202\">8.2 结果可视化\t</a></p>\n<p><a href=\"#_Toc12659\">8.3 判断洪水发生概率是否符合正态分布  </a></p>\n<p><a href=\"#_Toc2276\">8.3.2 Shapiro-Wilk 检验\t</a></p>\n<p><a href=\"#_Toc5950\">8.3.3 Kolmogorov-Smirnov 测试\t</a></p>\n<p><a href=\"#_Toc28126\">8.3.4 Anderson-Darling 检验\t</a></p>\n<p><a href=\"#_Toc26091\"><em><strong>* 九、*</strong></em><em><strong>* 模型分析 *</strong></em>\t</a></p>\n<p><a href=\"#_Toc18219\">9.1  模型的优点\t</a></p>\n<p><a href=\"#_Toc20389\">9.2 模型的缺点\t</a></p>\n<p><a href=\"#_Toc22586\">9.3 模型的推广\t</a></p>\n<p><a href=\"#_Toc9316\"><em><strong>* 十、*</strong></em><em><strong>* 总结 *</strong></em>\t</a></p>\n<p><a href=\"#_Toc27225\"><em><strong>* 十一、*</strong></em><em><strong>* 参考文献 *</strong></em>\t</a></p>\n<p><a href=\"#_Toc17550\"><em><strong>* 十二、*</strong></em><em><strong>* 附录 *</strong></em>\t</a></p>\n<h1 id=\"\"><a class=\"anchor\" href=\"#\">#</a> </h1>\n<h1 id=\"-2\"><a class=\"anchor\" href=\"#-2\">#</a> </h1>\n<p>**<br />\n**</p>\n<h1 id=\"一-问题背景与问题重述\"><a class=\"anchor\" href=\"#一-问题背景与问题重述\">#</a> <em><strong>* 一、问题背景与问题重述 *</strong></em></h1>\n<h2 id=\"11-问题背景\"><a class=\"anchor\" href=\"#11-问题背景\">#</a> <em><strong>*1.1 问题背景 *</strong></em></h2>\n<p>洪水作为一种由暴雨、急剧融冰化雪、风暴潮等自然因素引发的自然灾害，对全球范围内的社会经济系统构成了重大威胁。从先秦时期《尚书・尧典》到现代全球频发的洪水事件，无不彰显着洪水灾害的广泛性与严重性。进入 21 世纪以后，随气候环境的严重变化和人类活动加剧，洪水灾害的频率和强度显著提高，对人类社会造成了前所未有的挑战，本论文基于此，以附件里的数据为参考，对于洪水发生概率及其影响因素进行了深入的分析。</p>\n<h2 id=\"12-已知条件\"><a class=\"anchor\" href=\"#12-已知条件\">#</a> <em><strong>*1.2 已知条件 *</strong></em></h2>\n<p>​\t为了研究与洪水发生概率有关的各个指标，本题提供了 train.csv、test.csv、submit.csv 三个附件为研究依据。</p>\n<p>1.1048574 个包含洪水事件 id、季风强度、地形排水、河流管理、森林砍伐、城市化、气候变化、大坝质量、淤积、农业实践、侵蚀、无效防灾、排水系统、海岸脆弱性、滑坡、流域、基础设施恶化、人口得分、湿地损失、规划不足、政策因素和发生洪水的概率的事件训练表格。（train.csv）</p>\n<p>2.745305 个包含洪水事件 id 和上述 20 个指标得分，缺少洪水概率的测试表格。(test.csv)</p>\n<p>3. 包含 test.csv 的洪水事件 id，缺少洪水概率的事件提交表格。(submit.csv)</p>\n<p>为了更好的对洪水预防提供建议，本小组选取以下文章作为参考文献：</p>\n<pre><code> 1.选取对于河流管理因素治理的参考[1]\n\n 2.选取对于水利工程等基础设施因素治理的参考[2][3]\n\n 3.选取对于气候变化因素治理的参考[4][5]\n\n 4.选取对于降水预测治理的参考[6]\n</code></pre>\n<h2 id=\"13-问题重述\"><a class=\"anchor\" href=\"#13-问题重述\">#</a> <em><strong>*1.3 问题重述 *</strong></em></h2>\n<p>​\t问题 1 通过分析 train.csv 中的数据，分析并可视化上述 20 个指标与洪水发生的关联的强弱性。并根据可能的原因针对洪水预防提出建议和措施。</p>\n<p>​\t问题 2 将附件 train.csv 中洪水发生的概率聚类成不同的类别，分析具有高中低风险的洪水事件的指标特征。</p>\n<p>​\t问题 3 基于问题 1 中的指标分析结果建立洪水事件发生的概率预测模型。从 20 个指标中选取合适指标，预测洪水发生的概率，并验证模型准确性。并且尝试分析如果只用五个指标应该如何改进模型。</p>\n<p>​\t问题 4 基于问题 3 建立的洪水发生概率预测模型，预测 test.csv 中事件发生洪水概率并填入 submit.csv 中，并绘制发生洪水概率的直方图和折线图，分析结果是否呈现正态分布。</p>\n<h1 id=\"二-模型假设\"><a class=\"anchor\" href=\"#二-模型假设\">#</a> <strong>二、</strong> <em><strong>* 模型假设 *</strong></em></h1>\n<p>\\1. 假设题目所给的数据真实可靠；</p>\n<p>\\2. 假设洪水事件由且仅由这 20 个指标影响；</p>\n<p>\\3. 假设洪水发生概率与其他事件呈线性关系。</p>\n<h1 id=\"三-符号说明\"><a class=\"anchor\" href=\"#三-符号说明\">#</a> <strong>三、</strong> <em><strong>* 符号说明 *</strong></em></h1>\n<table>\n<thead>\n<tr>\n<th>符号</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps78.jpg)</td>\n<td>洪水发生概率</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps79.jpg)</td>\n<td>均方误差</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps80.jpg)</td>\n<td>余弦相似度</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps81.jpg)</td>\n<td>第！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps82.jpg) 个样本的真实值</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps83.jpg)</td>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps84.jpg) 的平均值</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps85.jpg)</td>\n<td>模型对第！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps86.jpg) 个样本的预测值</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps87.jpg)</td>\n<td>第！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps88.jpg) 个指标，以 csv 出现的先后排序</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps89.jpg)</td>\n<td>第！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps90.jpg) 个指标的系数</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps91.jpg)</td>\n<td>皮尔逊相关系数</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps92.jpg)</td>\n<td>斯皮尔曼等级相关系数</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps93.jpg)</td>\n<td>第 �� 个数据点的两个变量的等级差值</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps94.jpg)</td>\n<td>聚类中心</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps95.jpg)</td>\n<td>分配给聚类中心！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps96.jpg) 的数据点的集合</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps97.jpg)</td>\n<td>数据点！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps98.jpg) 与聚类中心！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps99.jpg) 的距离</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps100.jpg)</td>\n<td>统计量</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps101.jpg)</td>\n<td>权重系数</td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps102.jpg)</td>\n<td>第！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps103.jpg) 个排序后的样本数据点</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"四-研究思路\"><a class=\"anchor\" href=\"#四-研究思路\">#</a> <strong>四、</strong> <em><strong>* 研究思路 *</strong></em></h1>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps104.jpg)</p>\n<h1 id=\"五-问题一的建模与求解\"><a class=\"anchor\" href=\"#五-问题一的建模与求解\">#</a> <strong>五、</strong> <em><strong>* 问题一的建模与求解 *</strong></em></h1>\n<p>在分析该题目的时候，本文首先使用相关系数判定各数据的相关性，然后使用多元回归算法建立这 20 个指标关于洪水概率的数学模型，最后使用梯度提升树、随机森林回归模型预测洪水发生的概率，并进行了 K 折交叉验证、模型评估、特征重要性分析以及损失曲线的绘制。</p>\n<h2 id=\"51-数据预处理\"><a class=\"anchor\" href=\"#51-数据预处理\">#</a> <em><strong>*5.1 数据预处理 *</strong></em></h2>\n<p>（1）针对给出的超过 100 万条的洪水事件数据，本文对 train.csv 进行基本的数据清洗，处理缺失值、异常值。</p>\n<p>（2）由于 id 列对于数据分析无直接用处，本文对该列进行清洗处理。</p>\n<h2 id=\"52-问题一的模型建立与求解\"><a class=\"anchor\" href=\"#52-问题一的模型建立与求解\">#</a> <em><strong>*5.2 问题一的模型建立与求解 *</strong></em></h2>\n<h3 id=\"521用皮尔逊相关系数和斯皮尔曼等级相关系数研究各指标与洪水发生概率的相关性\"><a class=\"anchor\" href=\"#521用皮尔逊相关系数和斯皮尔曼等级相关系数研究各指标与洪水发生概率的相关性\">#</a> <em><strong>*5.2.*</strong></em><em><strong>*1 用皮尔逊相关系数和斯皮尔曼等级相关系数研究各指标与洪水发生概率的相关性。*</strong></em></h3>\n<p>​\t首先，我们根据式一计算各个指标对于洪水概率的皮尔逊相关系数：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps105.jpg)      （1）</p>\n<p>​\t斯皮尔曼等级相关系数和！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps106.jpg) 的计算公式如式二三所示：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps107.jpg)          （2）</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps108.jpg)         （3）</p>\n<p>本文使用.core () 函数，通过皮尔逊相关系数公式和斯皮尔曼等级相关系数来对各个指标和洪水概率的相关系数进行计算，最终得到相关系数表格一：</p>\n<p>表 1 相关系数前 10 的指标</p>\n<table>\n<thead>\n<tr>\n<th>指标</th>\n<th>皮尔逊相关系数</th>\n<th>斯皮尔曼等级相关系数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>基础设施恶化</td>\n<td>0.190152</td>\n<td>0.1813993896616919</td>\n</tr>\n<tr>\n<td>季风强度</td>\n<td>0.189259</td>\n<td>0.18027659009022504</td>\n</tr>\n<tr>\n<td>大坝质量</td>\n<td>0.187676</td>\n<td>0.17945801481789098</td>\n</tr>\n<tr>\n<td>地形排水</td>\n<td>0.187643</td>\n<td>0.18048274098179304</td>\n</tr>\n<tr>\n<td>河流管理</td>\n<td>0.187202</td>\n<td>0.1789312726571455</td>\n</tr>\n<tr>\n<td>淤积</td>\n<td>0.186914</td>\n<td>0.17873822145951626</td>\n</tr>\n<tr>\n<td>人口得分</td>\n<td>0.186285</td>\n<td>0.1779930987957486</td>\n</tr>\n<tr>\n<td>气候变化</td>\n<td>0.185311</td>\n<td>0.17711933159486049</td>\n</tr>\n<tr>\n<td>滑坡</td>\n<td>0.184926</td>\n<td>0.17663628560684871</td>\n</tr>\n<tr>\n<td>森林砍伐</td>\n<td>0.184420</td>\n<td>0.1770136418593642</td>\n</tr>\n</tbody>\n</table>\n<p>最终可视化图片为：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps109.jpg)![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps110.jpg)</p>\n<p>图 1 不同因素对洪水概率的影响  图 2 不同因素与洪水概率的斯皮尔曼相关系数</p>\n<p>为了便于分析相关性差异，我们将皮尔逊相关系数减去 0.175、斯皮尔曼等级相关系数减去 0.17 后再次可视化，得到结果为：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps111.jpg)![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps112.jpg)</p>\n<p>图 3 调整后的相关系数柱状图</p>\n<h3 id=\"522通过多元线性回归-递归提升树-随机森林对指标的优劣进行分析\"><a class=\"anchor\" href=\"#522通过多元线性回归-递归提升树-随机森林对指标的优劣进行分析\">#</a> <em><strong>*5.2.*</strong></em><em><strong>*2 通过多元线性回归、递归提升树、随机森林对指标的优劣进行分析。*</strong></em></h3>\n<p>先在模型一中，通过多元线性回归拟合模型里各指标的系数，通过计算预测值！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps113.jpg) 和真实值！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps114.jpg) 之间的均方误差！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps115.jpg)、在测试集的分数！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps116.jpg) 以及余弦相似度用以评估模型性能，表达式如下：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps117.jpg)          (4)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps118.jpg)           (5)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps119.jpg)         (6)</p>\n<h4 id=\"5221-线性回归模型\"><a class=\"anchor\" href=\"#5221-线性回归模型\">#</a> <em><strong>*5.2.*</strong></em><em><strong>*2.1 线性回归模型 *</strong></em></h4>\n<p>多元线性回归模型是一种常用的统计分析方法，该模型表达式为：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps120.jpg)    (7)</p>\n<p>​\t首先初始化回归系数，然后使用梯度下降或正规方程法来迭代更新回归系数，最小化损失函数（均方误差），训练完成后，输出不同特征的回归系数，这些系数反映了每个特征对预测目标的影响程度。</p>\n<p>使用训练数据（X_train 和 y_train）训练线性回归模型，并使用模型对测试集 X_test 进行预测，返回预测值 y_pred，并且得到性能指标如下：</p>\n<p>表 2 线性回归模型性能指标</p>\n<table>\n<thead>\n<tr>\n<th>性能指标</th>\n<th>数值</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>测试集分数</td>\n<td>0.8444528508563269</td>\n</tr>\n<tr>\n<td>均方误差</td>\n<td>0.0004043169737229802</td>\n</tr>\n<tr>\n<td>余弦相似度</td>\n<td>0.9992129608069907</td>\n</tr>\n<tr>\n<td>截距</td>\n<td>-0.053357024379501294</td>\n</tr>\n</tbody>\n</table>\n<p>最终得到公式：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps121.jpg)(8)</p>\n<h4 id=\"5222-梯度提升树模型\"><a class=\"anchor\" href=\"#5222-梯度提升树模型\">#</a> <em><strong>*5.2.*</strong></em><em><strong>*2.2 梯度提升树模型 *</strong></em></h4>\n<p>本文使用梯度提升树（Gradient Boosting Trees, GBT）模型来预测洪水发生概率，并通过一系列步骤来评估模型的性能、特征重要性以及训练过程中的损失变化。该模型通过组合多个弱学习器（决策树）形成一个强学习器，算法通过递归逐步提升优化模型的预测能力，在每一轮迭代中，计算当前模型的残差并基于该残差训练新的决策树，而新训练的决策树会被加入到模型中，与之前的模型加权融合以提高预测能力。</p>\n<p>本文设置迭代次数为 500，即构建 500 棵决策树拟合数据。并使用 5 折交叉验证帮助评估模型在不同数据子集上的性能，估计模型泛化能力，其输出的每折交叉评分为 R2 的值。本文使用完整的训练集（X_train 和 y_train）训练梯度提升树模型，并在测试集上评估模型性能。同时输出特征重要性并使用 matplotlib 库绘制特征重要性的条形图，以直观地展示哪些特征对模型预测的贡献最大。</p>\n<p>本文使用 staged_predict 方法获取模型训练集和测试集上每轮迭代后的预测结果，计算并存储每轮迭代后的均方误差（MSE），以观察训练集和测试集上损失值的变化情况，进而使用 matplotlib 库绘制训练集和测试集上的损失值（MSE）随迭代次数变化的曲线，帮助观察模型是否过拟合（即训练集上的损失持续下降，而测试集上的损失在某个点后开始上升）。</p>\n<p>以下为该模型的性能指标：</p>\n<p>表 3 梯度提升树模型性能指标</p>\n<table>\n<thead>\n<tr>\n<th>性能指标</th>\n<th>数值</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>测试集分数</td>\n<td>0.8367668430250391</td>\n</tr>\n<tr>\n<td>交叉验证平均值</td>\n<td>0.8375024016574082</td>\n</tr>\n<tr>\n<td>均方误差</td>\n<td>0.00042429537540674935</td>\n</tr>\n<tr>\n<td>余弦相似度</td>\n<td>0.9991741505605559</td>\n</tr>\n</tbody>\n</table>\n<p>最终可视化结果如下图：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps122.jpg)</p>\n<p>图 4 梯度提升树各指标的重要性</p>\n<h4 id=\"5223-随机森林模型\"><a class=\"anchor\" href=\"#5223-随机森林模型\">#</a> <em><strong>*5.2.*</strong></em><em><strong>*2.3 随机森林模型 *</strong></em></h4>\n<p>随机森林模型是多个决策树的集成，通过对每棵树的预测结果进行投票或加权平均来得到最终的预测结果。随机森林通过随机选择样本和特征来构建每棵树，从而增加模型的鲁棒性和泛化能力。整个过程线通过自助法（Bootstrap）从训练数据中有放回地抽样，生成多个不同的子集，然后对每个子集，随机选择部分特征，训练一棵决策树，最后将所有树的预测结果进行投票（分类问题）或加权平均（回归问题），得到最终的预测结果，从而输出不同指标的权重（特征重要性），表示每个特征在所有树中的分割点选择过程中所贡献的纯净度提升的总和。</p>\n<p>本文设置随机森林的决策树数量为 200，通过抽取部分训练数据训练模型并使用投票策略以加快模型训练速度并提高模型精度。该模型的性能指标如表 4 所示：</p>\n<p>表 4 随机森林模型性能指标</p>\n<table>\n<thead>\n<tr>\n<th>性能指标</th>\n<th>数值</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>测试集分数</td>\n<td>0.6559609909975268</td>\n</tr>\n<tr>\n<td>预测准确率</td>\n<td>0.000894267826368524</td>\n</tr>\n<tr>\n<td>均方误差</td>\n<td>0.000894267826368524</td>\n</tr>\n<tr>\n<td>余弦相似度</td>\n<td>0.9982658517029762</td>\n</tr>\n</tbody>\n</table>\n<p>随机森林得到的特征重要性如下图：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps123.jpg)</p>\n<p>图 5 随机森林各指标的重要性</p>\n<h3 id=\"523-结果分析\"><a class=\"anchor\" href=\"#523-结果分析\">#</a> <em><strong>*5.2.3*</strong></em> <em><strong>* 结果分析 *</strong></em></h3>\n<p>根据皮尔逊相关系数和斯皮尔曼等级相关系数结果分析，可以发现 **** 基础设施恶化、季风强度、地形排水 *<em><strong> 三个指标与洪水发生概率的相关性最强，而</strong></em> * 海岸脆弱性、排水系统、侵蚀 **** 三个指标与洪水发生概率的相关性最弱。</p>\n<p>针对指标优劣性的分析，本文采用了线性回归模型、递归提升树回归模型和随机森林模型。本文对三种模型得出的指标系数进行降序排列，并记前十项指标得分为 1，后十项指标得分为 - 1，将三种模型的指标得分进行累加，通过比较各指标得分情况判断指标的重要性。最终得到各指标得分条形图。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps124.jpg)</p>\n<p>图 6 各指标得分条形图</p>\n<p>由图可以发现，经过三个模型的综合分析，<strong>森林砍伐</strong>与洪水发生概率的相关性最强，而<strong>淤积、滑坡、城市化、海岸脆弱性、气候变化、侵蚀、人口得分、大坝质量、河流管理、地形排水</strong>十个指标与洪水发生概率的相关性较强，<strong>农业实践、排水系统、规划不足、季风强度、政策因素、流域、基础设施恶化</strong>七个指标与洪水发生概率的相关性较弱 **，湿地损失、无效防灾 ** 两个指标与洪水发生概率的相关性最弱。</p>\n<p>尽管三个模型得出的指标相关性排序结果各有差异，但观察数据可以发现各指标重要性数值差异并不大，因此在考虑洪水发生概率及应对洪水灾害时，<em><strong>* 以上 20 个指标都需要考虑 *</strong></em>。</p>\n<p>综上，本文认为 **** 森林砍伐、淤积、气候变化、人口得分、大坝质量、河流管理、地形排水 *<em><strong> 与洪水发生概率的相关性</strong></em> * 最大 *<em><strong>，而</strong></em> * 无效防灾、湿地损失 *<em><strong> 与洪水发生概率的相关性</strong></em> * 不大 ****。</p>\n<p>对于各指标与洪水发生的相关性的原因，本文作出以下分析：森林通过树木和植被可以有效保持土壤，减少地表径流，并且树木的根系可以固土。而当森林遭到砍伐且暴雨发生时，土壤失去固定易被冲刷，导致泥沙进入河流，削弱河道蓄水能力，导致水量激增进而增加洪水发生的概率。同时砍伐森林会降低蒸腾作用，导致削弱大量水分返回大气的效果，进而导致地表径流增加，增加洪水发生概率。淤积会减少河流、湖泊和水库的蓄水容量，同时改变河道的水流速度和流向，增加洪水发生的复杂性和频率，因此降水量较大时，水体更易溢出河道，导致洪水发生。针对气候变化，现世界范围气候变化多端，导致极端天气事件（如暴雨、飓风）频率增加，降水在短时间内过于集中，导致洪水灾害发生。同时，人口增长和城市化导致土地利用变化，如水泥地面增加减少地表渗透，加剧地表径流，且人口密度高的地区，排水系统和其他基础设施在暴雨时容易超负荷，进而增加洪水发生的概率。大坝在控制水流和调节河流水位方面至关重要，若大坝质量不佳，可能在洪水期间受损坍塌，导致严重泄洪。因此良好的河流管理（如疏浚河道、修建防洪堤坝）可以有效地预防和控制洪水，若河流管理不恰当，即难以预测灾害发生。良好的地形排水设计能够快速排除积水，进而减少洪水风险，且低洼地区和排水不通畅的区域更容易发生洪水。因此地形排水与洪水发生概率的相关性也较大。[2]</p>\n<p>针对低相关性的指标，虽然无效的防灾措施可能会增加洪水的破坏程度，但它们并不会直接增加洪水发生的概率，无效防灾主要影响的是洪水造成的损失，而不是洪水发生的本身。而湿地确实具有调节水流、减缓洪水的功能，但其影响相对于森林和河流管理可能较小，湿地损失更多影响的是水生态系统的健康和水质，而不是洪水发生的直接原因。</p>\n<h2 id=\"53建议与措施\"><a class=\"anchor\" href=\"#53建议与措施\">#</a> <em><strong>*5.3*</strong></em><em><strong>* 建议与措施 *</strong></em></h2>\n<p>结合相关文献，本文针对以下方面给出提前预防洪水的建议和措施：</p>\n<p>（1）加强森林保护和恢复：实施大规模的植树造林项目，恢复被破坏的森林，扩大森林范围，提高土壤的吸水和固土能力。同时制定并严格执行森林保护法律法规，防止非法乱砍和乱伐现象。</p>\n<p>（2）改善河流管理和治理：定期清理河道中的淤积物，保持河道的蓄水和排水能力 [1]。同时需要修建防洪堤坝、水闸等设施，并定期检查和维护，确保其在涨洪期间可以正常运行 [2]。</p>\n<p>（3）提高大坝质量和管理水平：先需要对现有的大坝进行定期检测和维护，确保其结构安全。同时采用先进的技术和材料，科学设计和建造新大坝，提高大坝的防洪能力 [2]。</p>\n<p>（4）应对气候变化：利用气象监测和数据分析技术，建立暴雨早期预警系统，及时发布洪水预警信息，提前做好预防。需要加强对气候变化对区域降水模式和洪水风险影响的研究，为防洪决策提供科学依据 [3]。</p>\n<p>（5）改善城市和农村排水系统：升级和改造城市和农村的排水系统，确保在暴雨期间能迅速排除积水 [4]。除此之外，还需要定期清理排水管道和沟渠，防止淤积和堵塞。</p>\n<p>（6）加强公众教育和应急准备：除了进行生态治理，还需要通过社区活动和媒体宣传，提高公众的防灾意识和应急响应能力。同时制定详细的洪水应急预案，并定期进行演练，确保居民在洪水来临时能够迅速、安全撤离。</p>\n<h1 id=\"六-问题二的建模与求解\"><a class=\"anchor\" href=\"#六-问题二的建模与求解\">#</a> <em><strong>* 六、问题二的建模与求解 *</strong></em></h1>\n<h2 id=\"61-问题2的分析\"><a class=\"anchor\" href=\"#61-问题2的分析\">#</a> <em><strong>*6.1*</strong></em> <em><strong>* 问题 2 的分析 *</strong></em></h2>\n<p>问题 2 要求将附件 train.csv 中的洪水发生概率进行聚类，并分析具有高、中、低风险的洪水事件的指标特征。然后选取合适的指标，计算不同指标的权重，建立不同风险的预警评价模型，最后进行模型的灵敏度分析。</p>\n<h3 id=\"611-数据预处理\"><a class=\"anchor\" href=\"#611-数据预处理\">#</a> <em><strong>*6.1.1*</strong></em> <em><strong>* 数据预处理 *</strong></em></h3>\n<p>在进行聚类分析之前，首先需要对数据进行预处理：首先检查数据中是否存在缺失值，并选择合适的方法进行填补。例如，可以使用均值填充法或者插值法填补缺失值。</p>\n<h3 id=\"612-聚类方法选择\"><a class=\"anchor\" href=\"#612-聚类方法选择\">#</a> <em><strong>*6.1.2*</strong></em> <em><strong>* 聚类方法选择 *</strong></em></h3>\n<p>选用 K 均值聚类（K-means clustering）方法对洪水发生概率进行聚类。K 均值聚类是一种非监督学习方法，通过迭代不断调整聚类中心的位置，使得每个数据点到其最近聚类中心的距离之和最小。本文使用该算法将洪水发生概率分为高、中、低三个风险等级。该算法通过迭代的方式寻找 k 个簇的划分方案，使得聚类结果对应的代价函数最小，代价函数通常定义为各个样本点到其所属簇中心点的误差平方和。该算法利用 N 维空间距离对初始聚类中心进行学习，得到最终聚类中心，步骤如下：</p>\n<p>\\1. 首先选择要将数据集分成 3 个簇，然后随机选择 3 个数据点作为初始簇中心（即为高、中、低三个风险等级）。</p>\n<p>\\2. 将每个数据点分配到距离其最近的簇中心。</p>\n<p>\\3. 根据分配的数据点更新簇中心点，即通过计算属于每个簇的数据点的平均值实现。</p>\n<p>\\4. 重复步骤 2 和 3 直至簇中心点不再发生变化。</p>\n<p>\\5. 输出 3 个簇和每个簇的中心点。</p>\n<h2 id=\"62-k-means建模实现与分析\"><a class=\"anchor\" href=\"#62-k-means建模实现与分析\">#</a> <em><strong>*6.2*</strong></em>  <em><strong>*k-means 建模实现与分析 *</strong></em></h2>\n<h3 id=\"621-模型建立\"><a class=\"anchor\" href=\"#621-模型建立\">#</a> <em><strong>*6.2.1*</strong></em> <em><strong>* 模型建立 *</strong></em></h3>\n<p>首先，我们以公式（9）计算数据点到聚类中心的距离，然后对于每个数据点，用公式（10）找到最近的聚类中心。最后重新计算每个聚类中心的位置，使其等于簇内所有数据点的均值。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps125.jpg)         (9)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps126.jpg)        (10)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps127.jpg)           (11)</p>\n<p>​\t 重复上述步骤，直到聚类中心不再发生改变，我们可以得到各风险层级聚类中心表格。</p>\n<p>表 5 各风险层级聚类中心</p>\n<table>\n<thead>\n<tr>\n<th>风险等级</th>\n<th>聚类中心</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>高风险</td>\n<td>0.56840101</td>\n</tr>\n<tr>\n<td>中风险</td>\n<td>0.50701183</td>\n</tr>\n<tr>\n<td>低风险</td>\n<td>0.44612593</td>\n</tr>\n</tbody>\n</table>\n<p>洪水发生概率更靠近哪个聚类中心则被划分为哪个聚类。例如，当洪水发生概率为 0.55 时为高风险，洪水发生概率为 0.51 时为中风险，洪水发生概率为 0.42 时为低风险。</p>\n<p>​\t我们将区分开后的 train.csv 分别保存为高风险.csv、中风险.csv 和低风险.csv 以便于后续特征分析。</p>\n<h3 id=\"622-高中低风险特征分析\"><a class=\"anchor\" href=\"#622-高中低风险特征分析\">#</a> <em><strong>*6.2.2*</strong></em> <em><strong>* 高中低风险特征分析 *</strong></em></h3>\n<p>​\t对于不同风险等级的数据，我们首先分别计算其 20 个指标的平均值和方差。然后通过式（12）进行标准化数据，即将不同量纲的数据转换到一个相同的尺度上，使其均值为 0，标准差为 1。这样可以消除不同特征之间的量纲差异，使得它们在同一尺度上进行比较。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps128.jpg)             (12)</p>\n<p>​\t据此公式，将 20<em>3</em>2 个指标的数据标准化和特征可视化于图像。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps129.jpg)</p>\n<p>图 7 不同风险类别的标准化特征平均值条形图</p>\n<p>​\t通过对图 7 的分析，我们可以知道高中险聚类中，大坝质量、河流管理两个指标的影响最大，而流域、人口得分、规划不足三个指标的影响最小。在中风险聚类中，河流管理、侵蚀、无效防灾、海洋脆弱性、湿地损失、规划不足六个指标的影响最大，而季风强度、基础设施恶化两个指标的影响最小。在低风险聚类中，河流管理、大坝质量两个指标的影响极为突出，而流域、人口得分、规划不足三个指标的影响最小。由此可以得出，洪水发生高风险地区主要受设施建设影响，而中风险地区主要受地质因素影响，低风险地区也主要受设施建设影响。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps130.jpg)</p>\n<p>图 8 不同风险类别的标准化特征方差条形图</p>\n<p>​\t通过对图 8 的分析，我们可以知道在三个聚类中，地形排水、城市化、海岸脆弱性、政策因素的不确定性和波动性都很高，而季风强度、森林砍伐、气候变化、基础设施恶化四个指标的不确定性和波动性较低，也可以看出其对于各聚类洪水发生事件都有影响，进而体现其相关性强。除以上指标外，在高风险聚类中城市化、大坝质量、流域等指标的不确定性和波动性较强，即其在高风险聚类中的相关性并不强。</p>\n<p>​\t然后，我们利用差值图，通过计算高风险和低风险类别的特征差异，来直观展示哪些特征在不同风险类别中存在显著差异，为了突出差异，我们将最后的结果均减去 0.8，以此来筛选具有显著差异的因素。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps131.jpg)           (13)</p>\n<p>​\t![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps132.jpg)</p>\n<p>图 9 高风险与低风险类别特征平均值差异条形图</p>\n<p>​\t最后我们使用热力图，通过热力图结合层次聚类，直观展示不同风险类别中各特征的表现，识别特征之间的相似性和差异性，帮助分析洪水风险的主要影响因素。对标准化后的数据进行层次聚类分析，将相似的特征聚合在一起。根据聚类结果对数据进行重新排序，以确保相似的特征相邻。使用热力图将重新排序后的数据可视化，用颜色表示数据值的大小。最终得到该不同风险与指标间的热力图。在该热力图中，颜色越淡则代表该指标与该聚类中的洪水发生相关性越弱，而颜色越浓则表示其相关性越强。因此，可以直观分析得到在 **** 高风险聚类 *<em><strong> 中，</strong></em>* 河流管理、大坝质量、湿地损失、基础设施恶化 *<em><strong> 四个指标的相关性最强，而</strong></em> * 低风险聚类 *<em><strong> 中</strong></em> * 地形排水、淤积、人口得分、流域、滑坡 *<em><strong> 等指标相关性最强，在</strong></em> * 中风险聚类 *<em><strong> 则</strong></em> * 季风强度、气候变化、基础设施恶化 **** 三个指标的相关性最强。通过以上分析也可以更好帮助我们在不同风险聚类更好制定预防措施并分析风险来源。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps133.jpg)</p>\n<p>图 10 各指标层次聚类热力图</p>\n<h3 id=\"623-建立发生洪水不同风险预警模型\"><a class=\"anchor\" href=\"#623-建立发生洪水不同风险预警模型\">#</a> <em><strong>*6.2.*</strong></em><em><strong>*3*</strong></em> <em><strong>* 建立发生洪水不同风险预警模型 *</strong></em></h3>\n<p>​\t为了建立一个有效的洪水风险预警评价模型，我们分别尝试了选取 20、问题 1 中前 15 个、前 10 个相关性最大的指标进行建模。结果显示当选取 20 个指标的情况下模型拟合程度 **** 最高 ****。故我们选取全部指标进行模型的建立。</p>\n<p>​\t为了构建洪水风险预警评价模型，我们选择了几种常见的机器学习模型，包括逻辑斯特回归、线性回归、梯度提升树、决策树和随机森林。这些模型在处理回归和分类问题时具有较好的表现，并且能够提供特征重要性分析。我们通过问题 1 中训练的模型，得出不同指标的权重，并且在本问题中增加了 **** 决策树 *<em><strong> 做法和逻辑斯特回归，使得预警模型更加的全面。并且我们定义了一个</strong></em> * MyModel**** 类，用于调用预警模型，并且以公式（14）来获取模型预测正确率（Model Score）。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps134.jpg) (14)</p>\n<p>​</p>\n<p>​\t我们通过分析建立建立的五个模型 (线性回归:linear、梯度提升树：gb_tree、决策树：ju_tree、随机森林：rf_forest，逻辑斯特回归：logistic)，以 MyModel 调用模型得出结果，最终得到模型的性能可视化结果为：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps135.jpg)</p>\n<p>图 11 各模型性能对比条形图</p>\n<p>对比这三个图，我们可以发现，线性回归模型得到的模型性能最优。</p>\n<h2 id=\"63-模型灵敏度分析\"><a class=\"anchor\" href=\"#63-模型灵敏度分析\">#</a> <em><strong>*6.3*</strong></em> <em><strong>* 模型灵敏度分析 *</strong></em></h2>\n<p>灵敏度分析的目标是评估不同模型对输入特征变化的响应程度。这一过程有助于识别哪些特征对模型的预测结果影响最大。为了深入探究线性回归、梯度提升树、决策树和随机森林四个模型的灵敏度。我们采用两种方法进行灵敏度分析：基于特征变化率的灵敏度计算和基于预测结果熵值的灵敏度计算。</p>\n<p>而逻辑斯特模型不能使用特征变化率的灵敏度计算，因为逻辑斯特模型的输出是通过对线性组合后的特征进行 Sigmoid 函数变换而得：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps136.jpg)            (15)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps137.jpg)     (16)</p>\n<p>特征变化率假设特征与目标变量之间是线性关系，但逻辑斯蒂回归是非线性的。这使得特征值的简单变化并不能直接线性地反映在输出概率的变化上，并且 Sigmoid 函数具有非线性性质，在极端值处（接近 0 或 1）变化很小，而在中间值（接近 0.5）变化较大。这意味着特征值的相同变化在不同范围内对输出概率的影响不同，导致特征变化率无法简单地反映这种非线性变化。这种非线性会导致特征变化率难以稳定地捕捉特征变化对输出的影响。</p>\n<h3 id=\"631-基于特征变化率的灵敏度计算\"><a class=\"anchor\" href=\"#631-基于特征变化率的灵敏度计算\">#</a> <em><strong>*6.3.1*</strong></em> <em><strong>* 基于特征变化率的灵敏度计算 *</strong></em></h3>\n<p>​\t基于特征变化率的灵敏度计算通过评估输入特征变化对模型预测结果的影响，来衡量每个特征对模型预测的敏感度。对每个特征逐个进行变化，从最小值逐步增加到最大值，每次变化后记录模型的预测结果的平均值。然后利用式（17）计算变化率。最后计算所有变化率的平均值，作为该特征的灵敏度度量。变化率越高代表模型的灵敏度越高，效果越好。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps138.jpg)              (17)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps139.jpg)          (18)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps140.jpg)</p>\n<p>​\t 通过公式（18）计算得到四个模型的基于特征变化率的灵敏度。</p>\n<p>​\t![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps141.jpg)     ![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps142.jpg)</p>\n<p>图 12 线性回归模型属性平均变化率     图 13 递归提升树模型属性平均变化率</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps143.jpg)     ![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps144.jpg)</p>\n<p>图 14 决策树模型属性平均变化率      图 15 随机森林模型属性平均变化率</p>\n<p>由上图可以看出，不同模型的特征变化率各有差异。图 12 表明在线性回归模型中，季风强度、地形排水、河流管理等特征的变化率较高，说明这些特征对模型的灵敏度较大。图 13 表明在梯度提升树模型中，季风强度和地形排水的变化率较高，其他特征的影响相对较小。图 14 表明决策树模型中，特征变化率分布较为均匀，无明显突出的特征。图 15 表明随机森林模型中整体变化率较低，说明模型对单个特征的依赖程度较低。</p>\n<h3 id=\"632-基于预测结果熵值的灵敏度计算\"><a class=\"anchor\" href=\"#632-基于预测结果熵值的灵敏度计算\">#</a> <em><strong>*6.3.2*</strong></em> <em><strong>* 基于预测结果熵值的灵敏度计算 *</strong></em></h3>\n<p>​\t基于预测结果熵值的灵敏度计算通过评估模型预测结果的分布不确定性，来衡量模型的灵敏度。熵值越高，表示模型的预测结果越不确定，灵敏度越高。我们运用公式（19）得到熵值：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps145.jpg)         (19)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps146.jpg)</p>\n<p>在图中，我们展示了五种不同模型的灵敏度（通过熵值衡量）。熵值越高，表示模型的预测结果越不确定，预测的稳定性越差；熵值越低，表示模型的预测结果越确定，模型的稳定性越高。以下是针对五个模型的具体分析：</p>\n<p>1. 线性回归模型：该模型熵值最高，接近 1.6，表示该模型的预测结果具有极高的不确定性。尽管线性回归模型简单且易于理解，但在处理复杂性较高的非线性关系时，表现不如其他模型。且高熵值意味着线性回归模型在特征变化时，预测结果的波动较大，对输入数据的变化非常敏感。</p>\n<p>2. 梯度提升树模型：该模型熵值较高但低于线性回归模型，这表明该模型在预测结果的确定性方面表现比线性回归模型稍好。梯度提升树模型通过集成多棵决策树的预测结果，可以捕捉到更复杂的特征关系，因此在稳定性上有所提升。</p>\n<p>3. 决策树模型：该模型熵值接近梯度提升树模型，但略高。这表明单棵决策树模型在处理特征变化时的稳定性相对较差，预测结果波动较大。且该模型容易过拟合，特别是在训练数据较少的情况下，熵值较高恰好反映了这点。</p>\n<p>4. 随机森林模型：该模型熵值接近 1.4，略低于梯度提升树和决策树模型。随机森林模型通过集成多棵决策树，增强了预测结果的稳定性。较低的熵值表明随机森林模型在特征变化时的预测结果相对稳定，具有较好的鲁棒性。</p>\n<p>5. 逻辑回归模型：该模型熵值与随机森林模型相近，逻辑回归模型在处理分类问题时具有较好的表现，但在特征变化率计算上存在局限性。熵值反映了逻辑回归模型在预测结果上的确定性，表现出一定的稳定性。</p>\n<p>综上，线性回归模型的预测结果不确定性最高，灵敏度也较高。梯度提升树和决策树模型的熵值稍低于线性回归模型，但仍较高，说明这些模型在处理特征变化时有较大波动。随机森林模型和逻辑回归模型的熵值较低，即这些模型的预测结果稳定性表现较好，灵敏度较低。整体而言，随机森林模型在灵敏度分析中表现最佳，具有较高的预测稳定性和确定性。因此，随机森林模型可能是处理洪水概率预测的最佳选择。</p>\n<h3 id=\"七-问题三的建模与求解\"><a class=\"anchor\" href=\"#七-问题三的建模与求解\">#</a> <strong>七、</strong><em><strong>* 问题三的建模与求解 *</strong></em></h3>\n<p><em><strong>*7.1 指标选取 *</strong></em><br />\n<em><strong>*7.1.1*</strong></em><em><strong>* 初步选取指标 *</strong></em></p>\n<p>本文基于问题 1 的结论，将 20 个指标分成三组逐步分析，最终选取拟合度最高的指标组。首先将 20 个指标全部进行考虑，再根据问题 1 的结论剔除相关性最弱的湿地损失、无效防灾两个指标，最后剔除湿地损失、无效防灾、农业实践、排水系统、规划不足、季风强度、政策因素、流域、基础设施恶化 9 个相关性不强的指标，保留剩余 11 个相关性较强的指标。本文通过以上三组指标选取重新训练已有模型，并对各模型计算测试集分数、均方误差、余弦相似度以评估模型性能。</p>\n<h3 id=\"712-基于过滤法选取关键指标\"><a class=\"anchor\" href=\"#712-基于过滤法选取关键指标\">#</a> <em><strong>*7.1.2*</strong></em> <em><strong>* 基于过滤法选取关键指标 *</strong></em></h3>\n<p>过滤法是一种特征选择的方法，用于选择对模型预测结果影响最大的特征。其主要优点是不依赖于特定的模型，通过评估各个特征与目标变量之间的统计关系来进行特征选择。该方法可以帮助我们仅从题中 20 个指标的角度挖掘分析其价值高低，从而实现特征排序和选择。<br />\n在本文中，我们基于上述方法，从 11 个相关性较强的指标中筛选出 5 个关键影响指标。这 11 个指标包括森林砍伐、淤积、滑坡、城市化、海岸脆弱性、气候变化、侵蚀、人口得分、大坝质量、河流管理、地形排水。由于森林砍伐与洪水发生概率的相关性最强，因此我们首先保留该指标，并从剩余 10 个指标中筛选出 4 个最具影响力的指标，最终选取森林砍伐、淤积、大坝质量、河流管理、地形排水这 5 个关键指标。</p>\n<p>使用这些关键指标，我们对模型进行重新训练并进行评估，以验证所选指标的有效性。</p>\n<h2 id=\"72-各模型结果分析\"><a class=\"anchor\" href=\"#72-各模型结果分析\">#</a> <em><strong>*7.2 各模型 *</strong></em><em><strong>* 结果分析 *</strong></em></h2>\n<p>以上 4 组指标选取后各模型评估结果如下表：</p>\n<table>\n<thead>\n<tr>\n<th>模型</th>\n<th>性能</th>\n<th>全选指标</th>\n<th>18 个指标</th>\n<th>11 个指标</th>\n<th>5 个指标</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>多元线性回归</td>\n<td>Model score</td>\n<td>0.844453</td>\n<td>0.740756</td>\n<td>0.374618</td>\n<td>0.181427</td>\n</tr>\n<tr>\n<td>均方误差</td>\n<td>0.000404</td>\n<td>0.000674</td>\n<td>0.001626</td>\n<td>0.002128</td>\n<td></td>\n</tr>\n<tr>\n<td>余弦相似度</td>\n<td>0.999213</td>\n<td>0.998687</td>\n<td>0.996832</td>\n<td>0.995851</td>\n<td></td>\n</tr>\n<tr>\n<td>梯度提升树</td>\n<td>Model score</td>\n<td>0.841497</td>\n<td>0.735467</td>\n<td>0.378759</td>\n<td>0.185468</td>\n</tr>\n<tr>\n<td>均方误差</td>\n<td>0.000412</td>\n<td>0.000652</td>\n<td>0.001615</td>\n<td>0.002117</td>\n<td></td>\n</tr>\n<tr>\n<td>余弦相似度</td>\n<td>0.999198</td>\n<td>0.999132</td>\n<td>0.996853</td>\n<td>0.995872</td>\n<td></td>\n</tr>\n<tr>\n<td>决策树</td>\n<td>Model score</td>\n<td>0.053015</td>\n<td>0.047629</td>\n<td>-0.37999</td>\n<td>0.061217</td>\n</tr>\n<tr>\n<td>均方误差</td>\n<td>0.002462</td>\n<td>0.003184</td>\n<td>0.003587</td>\n<td>0.00244</td>\n<td></td>\n</tr>\n<tr>\n<td>余弦相似度</td>\n<td>0.995203</td>\n<td>0.994738</td>\n<td>0.993019</td>\n<td>0.995241</td>\n<td></td>\n</tr>\n<tr>\n<td>随机森林</td>\n<td>Model score</td>\n<td>0.499236</td>\n<td>0.306385</td>\n<td>0.156919</td>\n<td>0.089517</td>\n</tr>\n<tr>\n<td>均方误差</td>\n<td>0.001302</td>\n<td>0.001864</td>\n<td>0.002191</td>\n<td>0.002367</td>\n<td></td>\n</tr>\n<tr>\n<td>余弦相似度</td>\n<td>0.997467</td>\n<td>0.996748</td>\n<td>0.995727</td>\n<td>0.995385</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p>表 6 各指标分组下模型的性能评估</p>\n<p>通过横向对比各个模型，我们可以发现预测的准确度随着指标的增加而增加，这表明我们需要选择所有指标作为参数才能得到最优的预测模型。而如果只能选择五个数据作为参数的话，经过实验表明，如果只能选取五个指标，那么通过滤波法选取的指标表现是最优的。</p>\n<h2 id=\"73-最终模型建立\"><a class=\"anchor\" href=\"#73-最终模型建立\">#</a> <em><strong>*7.3 最终模型建立 *</strong></em></h2>\n<p>在本文中，我们采用 Bagging (Bootstrap Aggregating) 技术来建立最终的集成学习模型。Bagging 是一种集成学习方法，通过结合多个模型的预测结果来提高模型的准确性和稳定性。</p>\n<p>Bagging 技术的基本思想是通过对数据进行有放回抽样生成多个不同的训练子集，然后在每个子集上训练一个模型，最后将所有模型的预测结果进行结合（例如通过投票或平均）来得到最终的预测结果。Bagging 的优点在于可以有效减少模型的方差，提高预测的准确性和稳定性。</p>\n<p>在实现集成模型的过程中，我们首先创建了一个包含多个模型并实现了 fit、predict 和 score 方法的类 BaggingModel。在 fit 方法中，我们通过对训练数据进行有放回抽样，生成多个数据子集，并分别在每个子集上训练一个模型。随后，在 step 方法中，我们调整各个模型的权重，使得它们的和为 1。在 predict 方法中，我们使用各个模型对测试数据进行预测，并根据调整后的权重计算最终的加权预测结果。</p>\n<p>最终我们得到了训练的最优解模型 (二十个指标) 和如果只能选取五个参数后优化的集成预测模型。</p>\n<h1 id=\"八-问题四的建模与求解\"><a class=\"anchor\" href=\"#八-问题四的建模与求解\">#</a> <em><strong>* 八、问题四的建模与求解 *</strong></em></h1>\n<h2 id=\"81-结果预测\"><a class=\"anchor\" href=\"#81-结果预测\">#</a> <em><strong>*8.1 结果预测 *</strong></em></h2>\n<p>我们采用 7.3 中建立的集成学习模型，通过对 test.csv 模型里参数的读取和预测，最终得到各个 id 的洪水发生概率，并且保存在 submit.csv 中。</p>\n<h2 id=\"82-结果可视化\"><a class=\"anchor\" href=\"#82-结果可视化\">#</a> <em><strong>*8.2*</strong></em> <em><strong>* 结果可视化 *</strong></em></h2>\n<p>本文使用 matplotlib 库绘制直方图和折线图。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps147.jpg)</p>\n<p>图 16 洪水概率预测直方图     图 17 洪水概率预测 Q-Q 图！[img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps148.jpg)</p>\n<p>图 18 洪水概率预测折线图</p>\n<p><em><strong>*8.3 判断洪水发生概率是否符合正态分布 *</strong></em></p>\n<p>满足正态分布的直方图呈现钟形，即中间高、两边低，且直方图左右对称，左右两侧的频数大致相等，正态分布图像只有一个峰值，数据集集中在某一个值附近。由此可见，可以通过直方图 16 初步判断洪水发生概率符合正态分布。</p>\n<p>但仅凭直方图并不能得出最终结论，因此本文结合其他方法进行综合分析。<em><strong>*8.3.*</strong></em><em><strong>*1*</strong></em> <em><strong>*Quantile-Quantile 图 *</strong></em></p>\n<p>Q-Q 图将样本数据从小到大排列，根据个数 n 计算每个数据点的理论分位数。对于正态分布，该理论分位数根据正态分布的累积分布函数计算得到，第 i 个数据点对应分位数常用方法如式（20）。计算后在图上绘制实际数据与理论分布分位数的点。如图 17 绘制了洪水概率预测 Q-Q 图，数据点偏离了对角线，特别是尾部部分，由此说明数据并不完全服从正态分布且存在重尾现象。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps149.jpg)              (20)</p>\n<h3 id=\"832-shapiro-wilk检验\"><a class=\"anchor\" href=\"#832-shapiro-wilk检验\">#</a> <em><strong>*8.3.*</strong></em><em><strong>*2*</strong></em> <em><strong>*Shapiro-Wilk 检验 *</strong></em></h3>\n<p>该方法将样本数据按从小到大排列，按排列后的顺序计算权重系数，这些系数依赖于样本大小 n 和正态分布的期望与方差，再由式（21）计算统计量 W 值，根据 W 值和样本大小 n 计算 p 值。本模型计算得到 p 值远小于 0.05，拒绝原假设，数据不服从正态分布。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps150.jpg)           (21)</p>\n<h3 id=\"833-kolmogorov-smirnov测试\"><a class=\"anchor\" href=\"#833-kolmogorov-smirnov测试\">#</a> <em><strong>*8.3.*</strong></em><em><strong>*3*</strong></em> <em><strong>*Kolmogorov-Smirnov 测试 *</strong></em></h3>\n<p>首先从每个数据点中减去平均值并除以标准差，将数据转换为均值为 0，标准差为 1 的分布，进行数据标准化。再使用 Kolmogorov-Smirnov 测试，比较该样本与正态分布的相似性。最终由式（22）返回样本分布与参考分布之间的最大差异 D，并输出 p 值即表示观察到的数据或更极端的数据在零假设下出现的概率。该模型最终预测概率的 p 值为 0.0，小于显著性水平（0.05），故认为数据不服从正态分布。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps151.jpg)          (22)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps152.jpg)      (23)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps153.jpg)</p>\n<h3 id=\"834-anderson-darling检验\"><a class=\"anchor\" href=\"#834-anderson-darling检验\">#</a> <em><strong>*8.3.*</strong></em><em><strong>*4*</strong></em> <em><strong>*Anderson-Darling 检验 *</strong></em></h3>\n<p>该方法将样本数据从小到大排序，计算该理论分布在数据点处的累加分布函数，并计算统计量，如式（24）所示。计算所得 A2 值远大于所有显著水平对应的临界值，拒绝原假设，数据不服从正态分布。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml23228\\wps154.jpg)(24)</p>\n<p>综上，预测洪水发生概率不服从正态分布。</p>\n<h1 id=\"九-模型分析\"><a class=\"anchor\" href=\"#九-模型分析\">#</a> <em><strong>* 九、*</strong></em><em><strong>* 模型分析 *</strong></em></h1>\n<h2 id=\"91-模型的优点\"><a class=\"anchor\" href=\"#91-模型的优点\">#</a> <em><strong>*9.1*</strong></em>  <em><strong>* 模型的优点 *</strong></em></h2>\n<p>​\t本模型具有多个显著优点。首先，模型在数据预处理阶段对附件中的数据进行了全面的清理，确保了数据的准确性和完整性。这包括处理缺失值和异常值，从而提升了模型的可靠性。其次，本文通过详细的相关性分析，使用了皮尔逊系数和斯皮尔曼相关系数来评估各指标对洪水发生概率的影响，并可视化结果，使得相关性差异一目了然。此外，梯度提升树模型在拟合优度检验中表现出色，说明其能较为准确地预测各影响指标与洪水发生概率之间的关系。本文使用多个模型（如多元线性回归、梯度提升树、随机森林等）进行对比验证，确保了模型结果的准确性和可靠性。最后，本文在建立最终洪水发生概率预测模型时采用了 Bagging 技术，提高了模型的预测精度和稳定性。</p>\n<h2 id=\"92-模型的缺点\"><a class=\"anchor\" href=\"#92-模型的缺点\">#</a> <em><strong>*9.2*</strong></em> <em><strong>* 模型的缺点 *</strong></em></h2>\n<p>​\t尽管本模型在多个方面表现出色，但仍存在一些不足。首先，各模型训练后计算的各指标系数的相关性并不完全一致，表明在某些参数调整上还有提升空间。其次，尽管模型采用了多种技术手段进行优化，但在实际应用中，模型的泛化能力和鲁棒性仍需进一步验证。</p>\n<h2 id=\"93-模型的推广\"><a class=\"anchor\" href=\"#93-模型的推广\">#</a> <em><strong>*9.3*</strong></em> <em><strong>* 模型的推广 *</strong></em></h2>\n<p>​\t本模型具备广泛的应用前景。首先，本文所建立的模型经过充分训练，可以随时调用和调整选用的指标重新训练，以适应不同的实际需求。其次，针对洪水指标的影响分析和预防措施的提出，对政府、相关部门和公众采取防洪减灾措施具有积极指导意义。此外，本文使用的多元线性回归模型、梯度提升树模型、随机森林算法和 K-means 聚类算法适用于各领域的问题分析与预测，具有很强的通用性和借鉴意义。本文采用的模型性能评估指标和方法，如余弦相似度、均方误差、K 折交叉验证及测试集分数，可以有效评估其他模型的性能，值得推广使用。该模型可以用于洪水风险评估与管理，将洪水风险评估纳入城市发展计划，识别并减轻潜在的洪水危害，指导关键基础设施的建设和维护，以更好应对洪水灾害。利用该模型评估森林砍伐等指标对洪水风险的影响，可以规划再造林项目及其他相关措施以降低洪水风险。最后，该模型为分析其他自然灾害的影响因素提供了思路和指导，能够帮助预测和分析其他自然灾害的发生概率。</p>\n<h1 id=\"十-总结\"><a class=\"anchor\" href=\"#十-总结\">#</a> <em><strong>* 十、*</strong></em><em><strong>* 总结 *</strong></em></h1>\n<p>本文通过对已知条件中的数据进行分析，研究了与洪水发生概率相关的指标，并通过数据集训练模型来预测洪水发生概率。在模型的构建和分析过程中，本文综合运用了多种方法，如相关性分析、多元线性回归、梯度提升树、随机森林和 Bagging 技术等。通过对比各个模型的性能，发现梯度提升树模型在预测洪水发生概率方面表现最佳。此外，本文筛选出森林砍伐、淤积、大坝质量、河流管理、地形排水五个关键指标，并验证了这些指标在预测洪水发生概率中的重要性。本研究不仅为洪水预测提供了有力工具，还提出了切实可行的防洪措施，能够有效降低洪水灾害带来的损失，为相关领域的研究和实际应用提供了宝贵的参考和借鉴。</p>\n<h1 id=\"十一-参考文献\"><a class=\"anchor\" href=\"#十一-参考文献\">#</a> <em><strong>* 十一、*</strong></em><em><strong>* 参考文献 *</strong></em></h1>\n<p>[1] 耿晓君，杨晓茹，李爱花，等。现代化防洪减灾体系中河道治理思路探讨 [J]. 中国水利，2023 (14):11-14.</p>\n<p>[2] 刘影。水利工程对洪水的影响研究 [J]. 水利技术监督，2016,24 (05):15-16.</p>\n<p>[3] 冯燕。气候变化背景下塔里木河流域洪水灾害的经济社会影响及应对 [J]. 环境社会学，2023 (01):83-105+197.</p>\n<p>[4] 原文林，杨逸凡，赵小棚，等。降雨监测与预报技术在防洪减灾中的应用进展 [J/OL]. 人民长江：1-8 [2024-07-06].<span class=\"exturl\" data-url=\"aHR0cDovL2tucy5jbmtpLm5ldC9rY21zL2RldGFpbC80Mi4xMjAyLlRWLjIwMjQwNjA3LjEwMzQuMDA0Lmh0bWw=\">http://kns.cnki.net/kcms/detail/42.1202.TV.20240607.1034.004.html</span>.</p>\n<p>[5] 杨羽菲。中山市防洪减灾思路与对策研究 [J]. 广东水利水电，2023 (10):60-64.</p>\n<p>[6] 刘欣。水利部将全面增强海河流域防洪减灾能力 [N]. 法治日报，2023-08-25 (005).DOI:10.28241/n.cnki.nfzrb.2023.004825.</p>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        },
        {
            "id": "https://enjundu.github.io/shudian/%E5%AE%9E%E9%AA%8C%E4%BA%8C%E6%8A%A5%E5%91%8A/",
            "url": "https://enjundu.github.io/shudian/%E5%AE%9E%E9%AA%8C%E4%BA%8C%E6%8A%A5%E5%91%8A/",
            "title": "复杂组合逻辑模块设计",
            "date_published": "2024-07-04T13:15:48.000Z",
            "content_html": "<div class=\"hbe hbe-container\" id=\"hexo-blog-encrypt\" data-wpm=\"Oh, this is an invalid password. Check and try again, please.\" data-whm=\"OOPS, these decrypted content may changed, but you can still have a look.\">\n  <script id=\"hbeData\" type=\"hbeData\" data-hmacdigest=\"0c543bc18cc959a1c5bf1dc5de354130bff4e1fa54f7ed8d2d1cfc26aa0f15ec\">56e217ffdf260fcd20c20879edd7e57f5f5414d966c0642e8cbaa1edde36166badd0dbf7f24201f1e85d2cf92b74087d7a1d8268c95e204bd432eac3d94e2406a37f325c13a3bb9691e6808a029c6979d969f30497a358f448ea931f67b7605a2801603d7fcc3f1d256d68eeb0e82f4f73856d3ffd7ba425a5dc0b121e6e37dbc29b5e1f426b1cad47a12bbe77e73cd0bbb59dba9d7c48db5d901522fafe275f319bec8c5e69017e17a94e594fbecd9068f6a6c67cfba9d2afcd86826c32214cc9e00a7751f85439e21bce97e9355c4f5460280d259823f44fca9901c9ec5843baf81244bf0a036d15f6c82add32b0dc7b0e8310b6aa07bb0519c27646fd38dd3b0b0d28714fe5405482320285e0c6d3a927c5fa3132856955bc6043419a353e6f45c764d969bd371e6e886256dd24efada9191fbb0d9b5bd8b593ec3a7b7fd584321e4d04381e196f7ac2d2758c5e1b2ccc122a58dfc656250ae329f756771f883953ae8367afc7cf8dabb495073b6f6a55ab3075402c191a67d36de7b16b8e0b69641cceb1bca704b63e8c8200b058a1cb0cd69697ab0e3f7e874e2b1c02ed769f1833416303e15adb1d36a6fb3dcc2fe890ac353a74960a1825712d8f7e220067a7a83635fdafc2ce8d4cefb13eb2a3c62e0ca3f95027cad9fa2ace892c78be03822a4b702f585a87e6a5e1daca9211c9a74abe98ede80ad4d7622f0dd070ec54669190458a36b2b253eaf5832a5f5a8859b5be1144f2d76f00e560b2bac4a27bda41926b6d62be226de554c2a08d6a795c7c421e6a0e041aa1eab2b82c3bdb1c77543c865868fd763faed66eb03ba4a6d940153f2ab319f48e7fe026bad02f145bb145be253ba9a600608a64a36f4a349b8263de5b3174fdc67dfb180febe01a45d583afcb7410404691fbb2fc78fa9caa812b1a720abf3acd2aca7a606c3cbdc22e5cf940d1a23907789f165532570359f5fb1e14106a6b6a479e9ff9e48f84753e70b63d09f506a7497da0d1cc9c3779ace10396cf2c7e961366bcbec01dafd542eb7c5c0f414479017623d17074c3eb6cccc2ef6994bc2f9a8f537a3ef9e293eba7aa3b1b9875e9c157f60a3292f5842244498e02d4b8759745a382757b8b4fb860bffbb4167e233606842ec03917a90f6609874e728c303b4d5d137750e5b1ec1d3d8ab315584581c087a6ac566a2fd088b0f445967839ddcd7ee5c8c6f6208361019b60761ffb3f48fef642e235f68a4c10f1f817a603e3554a084bce0f9369fe470fc08956b8ba0c19f6efe4f69bcd9dec64f302e8380d91a214aa791c0580573b6729b8594ccf3df153034705a4520b8b15e3ffa7cf5c97109b93976a4adbc14c4e17429ec117061a3bd194f7fea5b9ed2bf1d0d25cea9a3b27148a29fe736c2da0b4b2975df3197cc67161402ccb9a4f0eb01408d8d37d9551853783da2396f313fe0fca8a8bd477f65765e5b6bfe0b52eb4a608dc6eb600c108f356733b2f51767a51ffced8275a01d1cc1e040746c3d1b8f6de8c2f0741c3256b0b1e3ead727aafc1a97ff4f8e9c44d9dc5dd084590a0e7d54e32429068595ef39378ec7debf44dc0a2258bfeab60ca59c2ee664848979caba8b193fdb704c9525b18a84b22e9f619ade2d1a2c0e2dc0b37e4625404f1db6820e76edd55e2e6a5e782559abff851b98785d11e47b90261660a13cccea5650223a47f932ee36fbb736cd5e358945cf71e0ece0503b75322576b67fa30b65da73d2997b9d58646b2cee859db00564a5303da0ba595a0451f11a184506360f149368cd0aac2f5b1e7bb8f7210bdc2a9a78607c09b0fa87308619187db55a29ced8721ec4d70081817f7410e14f034395e0f29edbf87474de3ec965ca631b081b509d7661e96b1f22c73007742dc7de1e94606df36fa04715dc3e29a3a1c2c4cf0aa3a2bc164d9b3683c151c69c783a8d3f15e07c1baab470904b41a761b3d826890f80956299ff6ace4caa686afa7ff08f81ca1bcb3d8600533793a86bd5ca881ca4e6fabf9558dde62569b73f69667eb94aef367f155066ae8331d2c52177a0bb64bb3d33810863a11e0d6de3597586fb6e18e3c633b421cdaa4ac3a60a8a620e6e7ac9d59cb189d8f3d17de85426277793081af6ef840b588517aa5ce440f3676722fad8e32c7bcdd5efb6925fe4557b54699897ef6d0404277a485ddae41e786d1f2e21ea4639a24a6ddf3ba3143b4caff476dce5311230b21238d509a335e68a8629c7225f8dfcce1d26add6e633f7b037dc69640851ae7342b3d46c3000710980c052fcaa60ccab5dea2e0a8c249e6ac698d880a1d825acdad93ddfac13583f6a807b5123fb1038fd03ffd3ab23c54ec78c2f3220e4d43c5c4d822a2823b4a91f5b54ef20710eaa55beb2d424186aeee4bd7e2cc47db1fd6674a7726a746e54642b4b4ea6eb57fabe262e472c8a67bdb90bda02e1b790fd9820597f915b73847b8d65a46e397112f45407439e8146233a74dd7a8e16335361786975c0033259046cd67f41a36b27f563b98d636791b197913d13de23b7bfd77bcebe5cc9ca0653b1416b21ebf09f75bb1102fce4d652200de3a056c1a15db3a0ed01e4012aeff7951bd37242daa88336495755b9b1aace662cd4c59fdbd7ab4440099c783773dd5874b380f2258f0449fb430b48830665383a070b27ec42d1658606ea79b1e81d3aff97f3709c179c7c350c0428fb8022c637d82c4f8f087e8ed03fbc729f41e19d538b07161ae152f57403d39899910cfd3b8cc691c9eb34d24cb6a162d51a88da1cf676e22bfe8f0b569645a7cc43edf7173c64204780f00a77ef6d18f29cb6bea73fb4caa200bdddbceee43b029614b06b02072f458d3d96b53b8b3535b297c3363b0e41e3734cd024608803f32a0221219fd4faf6af275db598d73f0d055d178ac988440a0806ff3f69cb67596ac93ac6f5772495c3c263341c08df741730526d87dabbad5b6461058c75c1fa82e6cb8ef7c1eb70e205f14d0fd564a75429320c59eff2e63a25307cdd2416e34394516283c117dea737ead9486029954f1c3a38c6a13c62153612008ef69e6a13e1e693213fb5b0b11fda3eabf2f42bfbc026b9eb48f84e1e36b861bf658e1c5e4e0036437b3e240bfb66c0e6afcd6ae90236902e5e51d68c5570038496d1a1d46cae31445999d43fed34673546c03d2f2e8fb3f09853e2876e7eb87e088d1880b8edabdb911a46eea8979b7b8f2146c981c4a4118da0fbe61758356e9c1cb4865bfb11042c6cbb15655c483bffa4dd5811c389f2f3df469b155eecc3dbae07cd1c9991952fb993b06c4d134ddb74ad20335151900cc64e34380e4206556b8f05b2a6ef121dfba5f674a710a8754a6a23a51b6a8fe5217347340b26a0db4d482546937d18422222c13d4174766b1020f5155b86992c6732fe56be6076342eb3c6c027a6af0679b950128e68a85481ce936b90e96372135312f25fe25188d0bb8dd528d34e9e195868406de015ea9dc268eddd905aee5821c5bcae7dcef9272208288905f5614e10f8af201b0a82327d2fe0e96dffb725c16b5e30b2563fa1243902621f093b5eb550d55af5e5aa23f3d6e5a1492c7032df5c08c5cadbd9fc1ffb3f057e0200afe479bee934a9d213bb7d3acb7f876e69e8c8a72bfd1cf9c49c8d6ca161e4e12308c3bcf5f25f0e63da73b1de491f3a54cdf78c7bdecb08c6fe1fe836debeb05dca50483fc0285f7646b6198fc643356a9f932c9bc597659ba80080a6ba760652057d21eba507a29a724e3dfbd86f88775a2e3584ddceb422bf47ee4b68851a3ccc98de10580acca002780ef47d091bbec02388536ac755db5a778066486305a3b74481f0ea43bfbb03ab777cf1a94420232a76c9d12ea6c917317231c03a29740987195cee8a65103618c725dae36710d069d1622ef6afd42240cd80fa908fcc4e953375e2ffdabc963860589734d723d0a3e2066d3e1f75c0392646797edd6f912e5683afdf06188c0180d5aefbea30cc7b02759d75f5e03f6b506da353e635b049bb78479844148770753ed00511b1069c75bea42bd15723600cd9018af1f70bf0d3638cd5ad04cf13ade5900eafffd09e4480d9d6e692128b1d6b3807fe1e52d86c6d97f8c19f0c7a285d1936c03f46ba79c1fd614b6239ec10963013d91d446c08d27018e622034c436c2ae97653daf65586d63bbf8625bdebf5b4856eb4304b35d0b65be7021d94a0de4d06028fde433cc77d9867e009880dfe36acc02f2371db545d5126ab029c8f3509c8d8cf85c837c6e218c0d63ae2c214a242932592ab14688ebc11e3b40c0985d6e5dbad2841581664274f61a873573e0ec1d9d5346494a9a5d1420d035372242aaf3db9afedce9cd82a831f0e1dd898ccd736331d269579a8e6b422d35ae6d3d82aab84fb421866111805cefcf8082652a860d4bf09a72c06abd57c88c983acbc523589babf2a264188ce04fff56c75de9a313430b438ad6778aca4086903aff7be43d3400acfe137967b42fd82b9afa98864003fbdf1411113c1c23207df289b9f3488b6775c331843b505e1b08dc97394140cd8f488fc09f36c46d113c734e06c22a23e33805b9a466b4e21d72b98e774ffed8131e2e0abb8ab7942066130877ce0a48664e5b62b9c4e4a1a4a688f7153506870477c9a33ce135b60691ff38dba7616e66d5c0e765663679a0726bdf21317aaea7e31b9d4c9dedbf369798032bcc8d1bd470f670aa7ea78c446261b9da4aaa70fd9f59ec701b1b2e0413d2ebf8159a321608fed8978276c7886051aa5fdd06e162f511637dc964e5d808a50721393f653097cb46ea9286ec75fcfbbabdb0f8d19b994632b4e8e23eb63f5fbd53a9e1390422c040cd405aa94d60f721c046d8ec8ccc5da15358e502554728d06b3676ac741316668a341a31dc7647276f6d91577278464fe84372892e7498401eacd3d4192cbfc96bf1b247493ff8ca0e5a27ce1ee36f245db680219b582f35a6117f679507648bf6074ad00630f44aa898eb6fd2dc478694d3b0b7a74ce4740f64757bf7127fa7c95032ecfe2b098358985d893af4a2b767e97fa306306aef1adcc4aec4c8342e68ef32db0dfbb2171cfb1992fb82121008878ea3feabca1d3eff9538c848773a10f4e4fbe751fb555529021c546ad0f660bc633c9631d0c3ac1c33c14fb0f7fc69b48079529fca1d6649dca0c828e08c436a53c8a245dc2539a588c068c5ede1254693538b70838670b02e74be9b04bd9785367e5988dbb62561ea8fbe39a860973a8f9c5b2f47b52caa38e1427791d3f898acfbe4201a0bec7b500ebaa0da0cbed458ea3f856c115ebc067ca44bc171418386984f1768b1b1c0b0204af6ab5e9164e53ba2cb8736b3ce7f9e462131d265907f754557ffc68c76bef5012c0f3320459c07491d799233f2ce5bf24cb9d047a7c74de05328ee4ea26f5db5f31fb3cac8ba4f29475d3c8ade1c8e78784efa3b7ee6f1a7f276353faddb1b8e9919bf971ce9d24a85dd72e6a27a1553dc79a44a99d56d37c8080eeeab2068873d2c22ba536310f66e369db1be8941f8f0c06efff2244bd85698618eff98263251911027aa48c1a8ccc7bf90474b833f5f32149db0119266a969e30e917bb84c5fa38c51bf9c10f5252cdfed9ca45a18a50ec7584a2c16431546bbe67139743a7f19398bb48b03da226314df8a3ce8aef67121cd3a702434b60fbf389cbf860ac6572a4bbdeac823208967dbda9ccf1262c358985931ffa12f8066a70e30c43d9278c74a95da09f30e407693764c9d60fcb5097918188c3bfb271b726cfd95cfc764d93acfedf15cdd0395d51312c53c3189ccda4e0a5a5228fe5a2893a01b395df6119ce84dfb669a4f31a32630326d88dc97dec99329dde2e2304dff8096648ca7eaa5d9996a964c5157708d613015675e54624ec92e3ef5b72811b31bd3d6d50ab7ea0f0b860953446e61c102940c6c03af78a1aedad2bfc6ece5fc21ea64b70f416468fd29c5abcd7c4ebeca8555861c97fa9d8292b2d9799c29f51be3926ac085b445f6807e8259f9cd063cdff162836ef33dc80661171a9827ec531a34f4cd5b6924a8d85aa64143655bd3670df3b578715eab7834b56aaa223e11190799ace44dc54e3e633f5e9051b0eedac98d41f6103ce9ce6a71193a6ed95b9d94017704835f2929542fd83b41721b9c0bda42125e3959c64b517e4390fa5e393742bbcfcbc7d24c1b04258cb7835e4d6122a0800d4097192f80ed4d18d4b30fa802abbd062057f60c96ed9dfc065096e86c220af9b35e1a2c436b96f6002856409e25174aba61752858820ba7b0c1f414967e0a5f45b6b14261624ac2266056f9862698521df6237e337870769f77068443b5658983d83e1da448c6d3abf8d8f36377010651eb8c16954e002e91545a1480018b944a52105840429b9def8069313f2cafedce1477bc8eda14d41cfd2f06165208c8023bd48a4567b2bb81c5c113f2fced237a2f9463eedb58ea054f6db10eb68ffd07a1e45c7657dc7dd478e30cbb35b3c1126d070cb74188d1b2e6393514839bce1d05001b8564af0a42580ef8229a7557f668156f0591dc8134cdf9d43d2a3b1a64c603bce03ff81e2f286573b47a937f106e72c7afb7032b6f0e98ace6e2cd3716a0aee46569ccc374248f2e53474f5affe2ba4f438a9aba0784a6265cf33711e3c66547c7b5bd18515538e0246eedf5dd721200ce653535264e129d11a8a805ba03a192e4e1de3774d88fd54ac3053878c2c4b122147a83fbd779ce42666626849a15c2bbbeed959537aca9b455739f5298c520e68b0a6d2565842cdd7be90275395219e0da178f10239becb978095fd91f07ff2cb52811990efaaae3fd0ae735279cb0531bc8316c86bbc7a1e0452df86da61c76cbc57b9096f8b53f0e08cbc337ab3300a56ec5e3f01732db8cbc496a38a9a3804077081ee778ddcb6ddbe1670e43e40ee84c1b15bb142cb619de23fbc8faafeceac596dd228379ff2cc0b64796d0b42bc4b23ba5eaf002d47f2ea68b3484918ed08e27edadca76738cf26d8251ecfcb603ed872f90982ce428c2f9fa04994725cb68db32d9e92c4205242cfb4f29470a03f5c57ed8b17d6b5db4850a41e8fdc3b24f1b74fc8826f524e1165d178a857c9f1a21e62c46dc6e1506c656f2078ece1c8966eaec472f12f1722c9723012b8e3a2c7a3086865aab0da72cbaab0decf195b46ba946f3acd3df2257f934ddf08945c917bf7d87c365f8f9a4b8676979dfb8ffd7d376b44749ca1cc2ad8f8e1016b316c9d6a1e9b45d32db1e59a9f55345d3c48131a20f697f101492dca1be4744290bf1a89b0379746cf06b4ba9bd0f7c1516c440c04e06dcab3ee0dd780dba83b97a099862a04bc01aab7f30b0f6903396b74f24a2822079a8670e961a6b9e5790519f1d48dffde6e22093053459cf50bb2acc6d6d13dded4737b8cc66992aa9d9f0864fb1ad85c60d12515ff05f537c600a5b2fd4315a9802bfe637e6dd307c60a1caf7727bbb47df30a9fd191f559bd8278ad2ce590bc9e229f555139ce3fcab5cd67a2210492667fae7df59d260553e194498ff0f910a62e5423fdace31aa50e5157c6da8e3c1ba2aa749b71b9e7fd67f023b8dd1150cad4ea653e915ec322c4a9fc06b01d203f4090eeb92be99db18d023abd8403936c1f526e0dab1c5e1aede95e9a0a70fbb004e6e484616c850f3f854af1c72f29ac7dacb83dbd6fe90a49a2559ad834b0c9ab5095bcdee6a6ebcc14febef7b3a66bc572d9951f3f77b6fc78ba45a328a69eef89f1e371d3d6e97f42bba2e7341409875941796f510106c3b4c9c00846282b3bbaa87fa897f1d9e73f0986a05c66d8aec554a9e8b3360f55e887e53ea844e063ee5c24f15f3c6a02238eb86ea0118d54b5a176107d3e8638a4216350ecc5ead3299fb2ec1f06f402ceb5ec98fc1a1418c0a914071dbbb6b3c2bc8eceb1cb5e113ee04ef8fea4a77ef9bb80e72d243f949a4089a914a2a73624843189fed79ba98f3f344da9f9bc0e0c852a776503319f388b6d9d82980f21206b5ee3488f6e80af67a95fda84f68aad764370a21a6252397e72c1c1349e1a6e683930e716dccfe6f39a2b249240641385ce92886a771904fd0531a27a56f62141a46068ad183eff04d283772aae79316e9ec8ba1dbb6a235a6a62233e6039aecfab6b65827e5cf9ea3e7fdcf54471be2b77a8d425db2b9c268b99bf50fcf6767d6cf94e347de83418db4af182340c965cac31ed05720d23aa6cb85e6f3b19499f42ea51577779b3aa2ec080b068e6aeedef26bc97e6889a4acf09865fe795838c998070f2ed3bfaae666c77a2119d4add523138985dd1b8655b68d69a24aa85bdab1b9e834dc36d2391f552933aad3c9bfba62446671c80e4841559ac8449b0cfa4eb2180f9d90f9780ca382c9b3cb2b0985b7a38b1e4b10d5e0560ca64a89a90a71dc715e1aeaf97c10a7de5c0ed2a4e3ccd08fc7942b6a9acd3eb4eff5ef5a449ff5734d073e50ba9420774274eb2df59460f9c4c27e9a981ac67177ebd2d26d67b969811f7470372f3592d53272869b6bc8ff653341d5f52b0ceae6ea16227edaa0def91abff6edddab8da41403770e09e020b553c5ec20ad6019281dfab8126545f89dab477f188c30fd2f60a7de4350beb96703da5854a35648db59c7c6303555e9c2cc7f85ace432c45a85c2f940bb60e2c0e40db9f506b68fde42713c8f895a1dfdd25e3b2865a3795429aa1e44e6c78bbbbedc5b1aaa3bab0ea20e94875975066b41eeb22411530ec27b5fa11d71f2f119a8dcb965f0b8e50f41ddcf14b752b7859e34c3ac232675cbf3ebaf5972596867e564ab4bfcb293dac61e42284e9a07e5dd4d7b4ea232fc649c2a12852341c50af30d6193a4c7edc8aeffedb6402b1841283436dcca4288d12f3874c963788e9b445c86971ec164bdad58c95e0757c561767597d67e7e5a67b0f1dfc207bad79ce76eb9e1e1e3067ad693efd1428578c39bab32f21eef1cd8aa6e8e9da29498f479db2e53eade6157b54ee30619719fa7efe34fc0b7631cedd4165381fb03546798c288c4c77e97dda727f22024d9e475e99a49bbe1fb184897e382e89444b7706749789c4b4c4d0ad5fb3dd362a5b19a948d5c7551b4e502986b9ded5ff858497e099fefd3695728c04dfacc632ff4d970872971f015bed2a9b197f6b946236a404606e460eec15b7fb059bfb81b0e293c79ed5c0bfd5d21dfc5772f5984ae954be8e0a7d6325394b58acccc3dd1d481affdb3818951f505c522ec20c1d7578fb14a2c49bb16ff4500611c039775b0ecf180c775ae2e3a6501ac973fc7beb10dcbf70bd85aae0c0e77d45e99ddeb6708f2ccba0aabff8ab1d0b8e6c3bdd30087e005166a2e76c283b26d0d93dc915254ec6f7e5a1962875aa45873f023b1a1b293a05bff2df66dcd5f1e843df8f6e2f05bf12de27b3a84017ae8181b10cae9ea3e5e7649e07ba93900a45647b28879759fd8804c32c3bfd39f3644a9617335d84901d30827fc51c7ba502976bee57175fa382f2c5c2ad5ef80bc7b2e8f20068ec6094fcea40708684e2f38acd0a49859c6c2ac6d89e23557a18108d360560a6327ed332730bfd723d89987bd3d9c9b819522e0b4e10aad7c1b77290ca5c17fd18c5fc9c99c15756b6e5cfe329b95af9ad3a37c8f8600d64ca2549646b7a01cc6105e6f38d0444ef08cb003babc931d34e7abff59ecd2f972616597d82942267c7703c51dd247ad7a16e4235a48ef20f43dd6a9aa3326156f773d355c3b12411dd9e4cb114b53ba68f13e40976285defe900f34afddf193d242d7e6dce8d103fa8c1bdf5633ec8e3d7f9a4b297e814cf592e40ace5ee096de0dbdca74904584a19eb2e8081c5019380f41908817ac040742c997f4a8881d3f539c4a9c1c412351d4f23b2d6f1f60e4b8edd134f8c55b394073a65cd03f8d19cf25bc6c92cbf858aabc9df6ce370f0535fdc5aa19b2c1841d5ffc974972ca3adfd30be34d35206823782cbddc50a409d3a819c05e07b8cb1412b9c1efaf571a9bbed5acaeb93b689121caa184d6ef6ffff6349728bf458a888172c836cb9515b784d8914eebb380c2a6603e21d0dce46b560e2c302472a71380f2ac718a3436957a0d3fcfbf570bab45b03d8ed0ac4a60970f1cbef486762b5b9a17087230bab92eaa11b7d5842d4e33706da99d684b287e7f8f8487cb4d4159912fe4e1381e3fcedc8d8ebec835f917fe7568c04099e182dd00d1b8d7e645822226be8f8553676aeb2ab1b1eb61935d4c0138c5889709a6bd97fa469faf6e6939f7b76edd62925bd6d8480fccf6f4508b56a300f691a20240ec48cfde455ce912ee99a2a6dffb3de057fa99233c66262b9c79e2b9fcf4517dd8c332001a75a35b0847bf5c9535b04b5db542a72186c255c7c805c6f2a9b65df7f7437a7d822501e53d4bc6a6cda98ec3e314dcfef4933902f6a16a27345bc503e6e5eeb256b33f0d041f57d478eaf5b23a5cb42198e3b2e8c3fad30ba3c509474fb0aa7fa67a021ca7b5e67ea41dbd826aebe5221aee74d74517051ed757379b9fbe3935cdd0a3bd8e1967a90ba0df8b3f500a5b916b7954c2ad531ffe83983970ed268ea95e3774772f5caffb5964de1868a5e27b71d13758018097c6a47d469e4cef740f2ba39539d77c37f5d65597d1f0a51fecb3fb1cf4e18f673eba8f89b7a5d47a294dc4b2b08b101b2d48dc9c3d4ca3d6e4698669f4bc3e34a9802deae3745ab5cc9cde61a66304272ec996f89025c994a2d194b9ac92331f367d20fbe0723cd11ce244b139dd2c034673b738a8ec9d421709792cd1ae8b24a030beb2c93b8386b211d2da9f23980c4381b47c8fd7e83a1a7b91ec210a0b380f52fd1667c0332300778afb2673adef7991213873fee7e11b66b6536218e49183c8a915e7f18fba0abdc90e1b37293387626174be08adc8b45441b1ad5bea571c370fb490055228a7008b472669469f8c952a26ec56b271a63efd419a486b47786ee37096f7e4694b3bbe3896ebd46fff62d9147393a674f60c78deb9934c435a8f23659b11570de76e0ba4c9abf4566c394a8f2c0b1f16d518eb7a4cecc112685bf764c08ba92e37be0df590c06a16353d7cd57affb1a1e15be2e3538d6cca637565ef270cf2fb4ad064725b1339f0bcd133079f105ef62f3298eb33dd534365f25a1679c3292c291974d76bb1a523b5cbfc15215436882e15a5ac1e3f8c3a82f96c70ece6f835c8f7b709e8316839d3781895f93a54c1d9869f32a215017c012ed0235a5e8bb81aad854007a724b1841f390471642234e0450746446a6a60a1b7f6c2ecf0d7a217414f885d44e78dd3f706db79d02ad690eaaa51ba84fac88908a29ac88babb442e7169039008ee102c7b67435ff16bf06c394efc3fe5bebe833bdbb5dfa6d5af9cb79c1518979b6299456b50138f2847576b0fc07898279605a2707bfc23a823eabff34ce129c2c7e9a81941acaad577fbac2d94bbaead182acbafd24e30bf089637d1b2dfd48eb72baddf3ab891a9cebe77ec98a7044345718bec7aad512b16d5fe4fea1b758504333810f61295dabf6519e5b3d60c66236e4d2002b3964206061264bced689d0d392ef836361f044ce31f42978b417680abe188144c8778095317a9f7d75d46a7ab29cbab066eb462141879af6973605cc664e854c898a2772b5d18e061a2db8a039b02cfe55a2e684796aa2c8b97cf5a2909519054a0542a8c1cba1343ba19070d9700adf3a2e563adee7c3efcf3de66b7c2f2d6e4f1a9edcc3f08fd8d36ad1365c4d5cda6658ed63dfeafcbcea65faf689ae6b6760154dd6c4d9367815361f0c732a0f2e5265465614622ac9aca9e91244c960d8b82b0ad188fa51356c9ebc95725cc5a6d80d4e7184362ea4fdfa7b88b8371dfd84918301ba7ecf02326bb03fffb4e268f5fb2dde1cedb43a14deaf1389417b0d0c03424f1a295da03a9cdecb94362d4fc7dcf3fa96d802991e34624b92b04b4f9f890bca68f2adf76d7365c88386c70bb5ba9e629638b8bf1ec917d78fe7da90c890e795300b5bb05bf824a5d3db15e2e67ce2e2950d500f8467c84248d3f387022f4eb224457c092a50c4c27fce2eb811cba3e54870ad721d18b41898359c7921d96028d3525eebe340778f991589e42d19bae5360a0a2d9f4ddc17ac734b0e507c50e8af8a777336584efdc79b5bfa3da49b0fe5918972d9af0decbafecc031566ee7bb4ce5a9c6aeb29711be22c64d05abfcb9337684ccf81a9cf4b0ab804910095c2354cbbc33c60e1dc77e3800cba37c81da376df841c90a47c0e4a707612d238823a72e02fe7df990bf68847fe8100a9e80339c465cdf6ad545e29941e61be2f4321ef1b69eca82c987587c36029a7b3f2384e4b8a77a06bc3e36eb1fa1a0115d92be21765800a3f6a4710f0c97f60504e3572522d9a31ef65b2f861dfffd8773361bb5fd2315f7015ccbdfe4b2806cdc26b4fa69c20c2bfbda54130ba4e7646611b117e219e7c21b0a074b65a7da7c6a0a55bc167c51c9ec6f98549fb8b4471dde09d78187e582ec42c8221f6b4ac7366e5edc40f6a56665a9113f61b8becba2260fee3dbc102d4475c32aeeef6d8061f1143b5352a1316e1be0ea2eabcdd5f331ab49384735aa16c5a2a54f07cad418092cfab693264da9f9ed1c96448cbcca0f9ed64a82ac1513e37124aaf81bcbb109d4c479bc05cb1ddc6b1f46288dc854539df465ad6c5a8173068b83fd9602768b9451cb05ade83bf57cb6687174537c9d511ee2e1843943343deb2c01b9f94c98ee3f542966824301e7e5f05f78ed0a2bc0dda71130de5df41411280e72abc417acf427226ecb2252cddd86a2616bc562d91db9b3b963ee53e6febd0eee3d82683d73c2805a53b976663cd79cfadbb5a0288ae11c374c5c72b92a157ed47a5d8b405150d3355c5acb56ae81c900886f0b80ba83bc6380521d5b8e951f6f6c8fa3fe5ce9ae3b5896c154486cceca69a5b90243db794e7f9499fb8faf9373c274c02a95624007df709c30643e00559b9ceb3dd4f5f45af232136f6315a0f77f255b19b1d595c91b6ef0ac7364867b416ddd9559fd6ac74d116772aa58ce1d8019da322c818454ddaced6bc67c72c46fde32c37fe9c4bc3f0991ada2e3ee07d34bac9319b3246c2300f82c833831ef6b76882d7f7228ca34b18b7d855678b63c4b54175537bef5019af5b44263e157dd4869bd036df332e9d3dabbd7e8b74a000e1c0c690a4c56abc6a6257afa73c5b5d016d8dcf86110efa87a8f634f574583e5735205d59854e1433ca60b729a4f8e861a38a3815cbfefaafdf639a9c02db7299b1010db36dd47508aa5f422929f0d1914d2cbcd8e1aeafce6be7de1e1ea4de9522ac3b136f0a028c1ab7f98756f5742ebaeea26888d1e3aaf602b9faf945dcef5b36770a7179e03e53301fefbcf98d9c46b08b72ecddcacc134bc9cd47332c01aeb269ba7808451cdda67fa87c85055a5e687bcec64a6fd23776ef81bb9fdca4784849e3838a7859aaabf709f1f948cd118fe5a67cccb3b06b2e3c46d49d10ec0202408ec7ee956713d987d71b8eed602844c6c28dcd3a308870e0fb6d02450cc3b7e469829ebf879309f052071b29cae9ac5b1cde646195c60b917cc4a632dd5fc96ce9d085ececaca552a1e4f2d4d8a17c33815c0cf607d78d18c7401513d26cd050c8a0a1ade7f98965866e7e169167cbcafe2795c3aba8fe5765078fc928b312edc0edbafb86b3e7f92995e3ea3e107b37ffc9af9f3fc6b4a935969e3801daeea6ed368246eb71d2a42db105c6f7d42c312984fade231d415c54074d90f98e527d5e3f27a9187bb1fa7baf96bcfcc4c3b2971c73ef3ba2c71c74875a35d26695b440293554def674eaa48d58fa4d075c56918912c4b1893c60fc7a0ed93d0e4ceaac01315a07da48439c11c4def1a1cc67b259592f7d61314bffc365304b2f646f15ef98001edd71a594dd6689910f45d98a8928101ae1dd11913f6d3a6eb8716627590551b4309c5a2534f78305c0e7a246f16e3bdc13017ddf0ff1017dde13412eebe259d9278365d2819091365cf77bfd66b11ca0eb925cc6369d95385582b733e69b52774f4c317cfb3fba979fa6917e52cfaa44385fad0f2e7038106074308f35e642f417fc7a37b449c1d633a4e2a2b56b007a34e53c5004445ccb946cfc9da6dfef2063501c9c6834bb63562fca0b6c6686645a4c0912bcbf99dbb435abf90b4ae56eb2723c77eac41a38457f9ba06a3753d134c39721e6203e6a9f11a0ffabe1e8fa4b164d4569689f061db6261019923f82b2e077790ef69d41a8d1779e698a42428339295d98879dc74a91e9b22d29a396eb25368ed94cfc657f56ec142ac7888d5f76e18a4fb0b84736b27f3685dbcfb5dc2caf9589ecea92c34eab866923e2b72255560f1691a4c418370ba00909b83039199afedc4c4a0175c903f600cada6549c935d27315010ca7bc52806c37c16e62ce3080cb43dc3d9422a5094c665754fdf94241d9b6b148a0379ab35a4a779816517b539b6a882a1409c8659f08aa5bd04aa3f9c4e1b1d5b42e09c38734ce34742c0c412696a3171fc3942e52f8789356f660fddb0461803ada39ec5558e448ce7740b031ae50d6479e96c64ccc9ad3220945926793dfdd6e09d8bfad9acef3dca402d5358be480ab1eab06a99c38b305aef9eb3d5a5770156452d6681c31f346ba20a0e65bed6737c48b96c4a375fb48d3f38f0bcbae0abd1f08e5c72f6c87ac52eb374356c3608e0e2c4517b35f41bd848a581f79fa17049a091d5ba2bd55861509dcf642c3f6ad76cfb885bd753e6dbc880d2b51e84123d576f6747b7b2033f9dc0d21596eaf22557e892966bc1deecea6a0482842aa12c43181354f597e5c6d04f8b264793de4ba7f017ad2234580e093d9a8066715a5a26a53594f00e6a6262d63d05946bf36dedb18fdafffd0fce05df0899deb3bf94d570a16e1a2ef439e32718052abe2675a6d0f8888acf5d0017afb2716c6b3444f8f31c37d43618878ce25924021e5bdd7af723667af576269b1a3863261ef490ae3bca4f6934e688609ba0081e37f76ebff6e293a90e9a749d27b43e2ab860a6926485d69942b952c2ab395b46fda9b3511c181576c48b052cd185c908a90788943a0ccb81f19b18bb4aa760f0efdd3ff8ce8da86a08a8ad98a8c316ba63301faacca9f3ffad0b3c45bff22b89481f5e2dabcdce6108125c25fbb701666f69118aae0c50755322b795b11ee0fc5b060ad9893f3c03bdfafd271eaf2fc7414b9d51d3a30872ee9ed3ef9d0880fcd8152d272dfaf9b5f070fbbb89cb8d07910bd0c4435971a65053cce247099bf0136a197d3251a99939e8ac0af3923caaaf88187de86e996104a101ba252556cc477fdef0bf655ca12f54da357f6522be6d60aa537b7e2114a31a0090dc08536c64faf86bc15622b3d53a93ef10d4f41836340caaec711675c888e6bc0a1f0f3f5cc322852216e86f7c92bae0f24f11debe4bd3c941d49e232abff5c7488b0f3b1b90d5fc0f61b6502897eef06cdda752d644f9e49be658058a36769bf1b3dec6d7974eb66679f891794be508db8178aefd260a6d9128a07daefb571fc9853a768b3a2fc8f597b110382e67e2258824d16c6a69d200dd668b87a7d0f08fc905c2daad446e703cee4d467c2c35b150e38f24e81aee163bbc8e58e1b17b61f7e5116c7eab4b45f1b98a86bfb80cea04cfbe5397b4cdcd342bebc3468e1f904d7fe40af0d9bbf30e50f26f03cae60ce1e9e07f3b1e8d355aeb90928ca24602ed52270e1ba3072198a0a0034b01b51d917c53655fabd0d2519f7eb6ab784cf64d67558d4a2a7fe0236be1d01c75e5ba821cff5839efc777e2be248950a930ad2462862d714663228bb5781246cddbfde1560ff29959e08167fb70ae9d91dc495666f050167febff57eea7c9c38ad27eb74c5331d736d2f58fd3b618a2494b3e29a592cf5ba0cb685d304ca83f158a55f9a60cb79d4be2153ca0ecb094803230aa7687e8a972e4e601347aac4dc5a97f19cf83bb4e4de52939839d9934625738f131dcea2e1cf630e5ce50e242a40f841d3e9bcdd2bb5b35bfa49ad837fe88a9e147b53a6d2856acb754534244ced46153ad283258f19d263f528de577d2b4f9d04066eb58f69d6a33cec31c381200bb2ec6b90db2d81b2887c7a92ea6e2842a3218a4b2558b3aa010c292776209d0960dee3376b96d08b0b612170563eaca8a7e5083e68f99d99c4b461b6aabfdb728e54e6816a1aa357b55104f75d07466c3acdcac1a378e77d9a78b50adcbc9d2b0ceb4cdb753df2516e4c93dd1837e3625723c79b9f5c4fc8837eb577e17e00eb8423c8b27d5cc57843094acfa15ec5ab154f5dc2bcdf9564aca1fc5544ff67d68a9d8832ec523ee80d10f6de5a35401a6aa7a3ea4bf5cdbf5c2d4e0552bfbab0b3f4d9f0baabe15126895e23b2e5e21e61f29cceb543a8da21bae148fbde6f31599d05ac00ef930735807928a691e2c7535dc422cfd3afccb35e5cee410060330bf403ed12f02b28e8b2cfb34e65cc81838c8da6c4af776c92dfe485dcf0b7b1344eb3f06e7ba8db501b02437e3dae6233eb11cfc4cee3015479539cad742d5c49aac3b85411ff166353173109b43b50054d12ac0ca38ed9bdebf9eb5501029a26f10790466a7f54614b8353acd04846d52e244923d4d42df2499faf704d82a43a8649f43ca3c5b330c7f008579bedf4f927bf7760c097e456a1a40d16e51523bef3bf0c28c0b7f9a6b7a96c491da299b12488584f49141802b4a4920a819894078e2d1d3c8e97562cfe0ae1eaea4e67fe77ea3884fa6eaa4c88e1e8be1a5a4ac4a7adbd242157772466037607cabac1a613d9e7c9ab72e74402b4003eb30ed48cb599405161da2f250ddbf80bd2c56fdaf6e21ab9edd1fa8da83bd5eab7242cde6bf58ba95b7d6dda08ff14d90b139ab111023cbeb420be876158f53c45ffbe09d8fde574714a18aa0161b6425976926804cf69c2d911d39ef7e7b31f9137bdb5824526d19929ae88997a2631a15505de0df4d17fc7ebeb4e282aefa2f963b0362ba35030542b32f67ec38dee235fe128589a61d32a5094c4371ade75322e1eb351fb371102f52985691990057b7f004d229f2da38542bf32c58ca798ff8445463fcdd9bb143412f5da8f95f1a6c66cb4cba5631a77ee79cef84545cfc6aa2841e66a8b878de713c1c41a512c32dd284a117e0600e40fa23e318a2c55b4482dda032a318ada2f27984b4eec529da33b5d3fc714a14fb469ca0dcad6a467049e8c51caac75a328d45c188cc15a3d5d2b553434af1a82be43a986fc5ad8a3bd41d282975cda098aa27b00713aa4e0534a5a92550eb1f2b89942dbbb467e27ba8618be7a30fa4fcea9a8756e869ef9a2268ede8366b914869a943505bd57593bebc91219cbc45569cd46d93d252984457e49846d02a85670f8b7882055228b42c8e36696fd6b7b5524cf98e007a2d0bc367cd4dbf7c3d2c5a4a74f42486e943879148408f69ba5cd7f8673e91063bf9ce87561204efd46e750608e62b8fa587836cb20aba44e707f0d3a26014d5ee06e61b23039136e10cbcb730e1e4409e828f5f5a54ecaebff96876b54a375df980b52335b359d0e10403673a5d6411a3cd60db0c239b16b37b8c519d3237dfd17e4a99bb214f17fc6640e5573a65d3d64becd468a66a089944f0b9197d30d714c507084f4215d0aceb11820bd47bb5bce6eee2dc1291be99014afe81a3a897c2f10ee84bf952b0160bf0ffdde7712b04cfefd94119097d3f9fc48db3448af679ba6b49a2b92bdafce0eb8bfe2349519609d8bea2935073cb620b5a139776cd6ca5f78ba7d5968dd3b5d71f0982cf093947360e816404aa322a1e511940db6d95eb7a4036fdec24bc4df65b410565a4316a537c2f7aa68e22d4a681a09a9bd3de45581f52819ee9878576b5be418eab2e5435e157db908c7355510b319e84e702b855876a016fa3ac495aa6d63078e52b07371656c442f528c3dd77719bb24e89661c7e060287e14758b5a0fb13464d2613a49257e2f59194c36a5cae1f71740e29a0c9306fd0d513c135053dbbd3d01ed25ccdc06ab5b73461b022ded5e1e4c0ce8d61f9aaecb0a9a416a46afb04839127585b26269efe8bad6df1a85a606095c5004020b516c225a271dcdc634f3ba13e7156a9ebd6a4eaa9e2813b44e674e67fb6c88ed058e7545bdb7a267584462bce649234a089062d73bef9b3739dd7d3b2cba1d9c4c7ae96cff9522ebf603bc6a6b7a6b1756a80f824f982caec620841d461b890c7755584a804b2ead42e158b5a8fa8c2ea81f7aed62dd7ba7ef999eaba6f26d091a63363607e92381843a23d5238c69d88b638ac932139bd4508b5488e4d692072e8cfacad1f08a47b6cad50962fc57fda82dbcef19fbde21665aaf03dfaaac20b494d4e319a0f88767266b68d76280974400d22b728f272b8fca5a5ed6523208db39616d70122b3ec329598ccea8f58fa1896bf771c4250f3959f3f54fb59d99539405d812cfee1f60286400661df36d662b939eecbea2896a83080ff98eb5f8b3caec68abbde367f032c97dd31107f2ad991ecec446aba817d744c8e9d1335747af751d1b136debc4c26a097a977e1f9977f82a6e59e6d19ba3a0ab3a1f7e483a62e67f34877579eabc0485a8c687ed57b66117dcc2bb2bd65c63b88d9212035831a3f94b105a05e57519a4518a9da05f357bdb2e8fbeaa95cd528422cd6bed2603f8b0ea07caad6fa8025bba662a04f9e8043db20b51e99f98e42279d95435a8cef6fd9bcc1de4dc480f16c0ba3d65e32896b4e003a1238c1676c78445d53fa27971993dc9404c33ea00d38c599794566c488848958cc4a6619d1ae1c0214c97831c3704e89553451fc5ebc76af92f1724a9f35f05c391d20b7611f376bd66d40f4c645a56aada47201f0de7d3fbbb506eb4232d129a68c6b8495792fac503efc63b79a6888f2a86c93908a1d7dce1750392f09503cd5e8d9d8c314b6c0e680499947d83bafda062aea406d905d30e6212850598b502b66b745bc97932f03e27314471f0787629b333f9e440653f395fbc0c1b0038a05cb05ccc2aa36e23be779731cc5ada5907ba04f2c3028685591e24206507b5518eb6cc951b667132dee716691461d4c40163bb685c0374ab78f9acf4e3e1a82a9a07e4bd5d122c4e653d2e705a2f950e488838a93fe5e25af6a6486c0e1db0738b11e076ab4d45a08dc46dc4c01544123269c0bb733fa332fc8ef98993f368fda2fec492139fbc6911bdf8c67823f96768ddf01a37450953e828bdf13397e195ebb7a6af1aff1c0b4567a2f898220d91be004f9f537fd5fe9468cefa6420aa0ae5d7e2deded5dea8660d01a76875db014dbfc621a332ec478e1aadf45fb90bd8e6f6e3397997d8e4fceacf263049775453a0ec738f46aad21d33584cadb69057259220b1d1372e4bb45ff0dc60f96c42e0718a869b4e0182f8e0d529cc26163ad4ef1eaf6d8d5fd4af823320b9dd163623f92075094bd94782012c7a6c9b25a1261805f82706dd5fddf2bf4372fc0d13f6c0e410abee39a7ead4ad078cce7e404180036eb9403bb00021be22793227743faafd5f69755219a4517bf17bc599d795091e97a8f40fee265fcdfe5b6fb2046481bb605da5e382bf9a020922bb125858cc5cb6aec22540df8f8a082478f4013d6162f2b62627d7859b963237f349b04d173739d8e9aa2b46e6d0ca17119a48e575920786ddf6d47919fe353c37774de6fcf5ad4c24a06030eeaee251f99c65193a4b8886a3e638b0c4532d3d03646038b992cecf5766cc647bdf8943fdd5d0b43e17fd72e4078378b918d0b157cf2b9642769e1e071658ebfbf7a2a2586c23e2331b58378d76ccae014401208fa4d77a5400f9d16f82603754ded66108ff14f2f09af5fa1678527a0ba12fcccf61cccfd3dfb555e7ea325a06370b0cf712e53b451e45d650401b6feffa1e13950dee46881045395da0789893f4f7ae654ad07827802c95339bdba2e2787b62862d51bc2cc05e55fd0c65aab758bff29c14a771d99851d5f0b095ace2124e1367e51f2b9f95f018a4c8181eddcd3ba99f510c4b18a044bb4a32a74febd49387c0732228075bdab427b48be33ccbf573b94fc27d45208f0358fb7fc957c720d239c4f2ef3376796e308713eb05f1990f07f85a8167429f5308bba7b23b5d5c7a737c560f46356be4698f2793bb6b15528fb6aed2ac2d818504a6d3ace584d597abcca9eaf318602e2e0027ce22b748c22ac04c4bb79ca06a715502fb4a000fc9a1b60eb7a131d10d01ff1a12915d2e382d4f9ee90d785f2caad9d0f1c6cddb409a3d99e68fbc388776c58fde42b9c63e3bb18747bf1e18fd1bfa520601ea9f000b0378957a92981912dc88990caa689be3cf7f1a457fa0eaaeb9d718079bb7b74e8238c46ee0c20a2d8f55a2e38d731e224f34be870df62097d3c1aa2971cb9753e9cffe56966ab0ed7b8c96c609efaabd50be0e100a016020f6b3b36ae690ffdf694ad9fe0884d3b1b4edaf1817f7a21ac9eb0c6b97b5ad2d191d5b8d2b97c54c97898c857249cb840b43399ce3ca2f05f18c97dd0e075c7f888f5596bbc6be48b91877ba252d22bde827b4cf57e2f94e2c1e6fbe6a926076cc24aa79235f0d28e98a07c9f6ed1aac5d1051067521896f56ec1e2c7a112a5540d1b2540a37fcad1fc266b1f928ce70cde26b3b0dc0e81a78a77ef3ca01d667b64bb35f69097474faf681a348539b07b67be91da0c9a099f579b23a79f6ded692dc0f73101821bcebb5b01da8e8c8937b16d5a0d51ad754b846e173b76742a24df96a1763a0276a632858310847a3f3b250da3c14fa4afdc88eb27aa549ccd5b81d61d1bc715b852c190a256d125a70b762df7c7d45b84a940c4b7f330719191a535263afc0ccb4ddff83f3b4b04539be1171bcf13f3473a231aca546f0148496fad46cbe9595bf6e645d8f70b1bda3840b045e749ce496c001c963f4e0649092896830db86f5068b9ba64088bbef5afe87a58e1a7895aada54503c0e87ea95552810bdc8ee40e9787b89e07d6a3bf298e5a232e8f312dc25740314b77d093aa45485cf55f82a1a617efd149938876b9e69b7a169b9756d3657b3e608c351881c19890c8df86eace915bacaa3c55a39c9ff125c78a993ebeb25fed93bdf96ba84da0392cb4a28b695d91e48ba3fc53a3cf43d995fc583ba29b48273902e4f6ea750413be8a56e8236e974e7ece55e9f89e2e564b3bd124577a0554ff7f5c6cf33a9bddbf033dc447d5f9b569c28db8f4e1648a0a7bb7d5e93100bcfe3756ce6128fda903018635d2351cd97e1ccd049b6e4058894810ac45179145c095d4f8f9973ca708f0094a8fd6dab738508c986874e083929c65c4d006eb52c5e5b6bd465bbff03130ce47544d954cc61cfe3c33cee5b47c5dcf373c5b635b1a172e66063654712e6d34cda865a5c1efbfc221bef4b677a4915f82563e34b3c1eda44adaae09bac000191ff08a2c424ababb59b323c9080530ba56a3e54bdddc9d5bd3bfa9efccb18ea7b8f4567a495856b9eb248913d15105e611732fe70b883c78501970270fdc28d69ba08e68c5d45e0d69314f00beb4d3d0ef6e588b2784f3a2c8ee4e11e0733d4e63221a4feaeb6b322db30e418d76f2cd34a42ee19e8dd43180fd63675a889831062fc6a4ddae9fab4569689d3c3110e9142adc20952eeebc3d836ad14a73eaa378f8504bdb6ba4dadd1b69ca1f08441b49c531c6eb97dbd809bb559bafcf0bfaf068f25317893959c14692ae802eceaf1ad21709faced2103e7b236bf99a476ccc0af93d198f782af93a24cd876e1646a33ab895c23ddf3aa4c5dfada1722972513c1649c4c98bd1fff608333eb4ac847e451d07d2d35afe66bc8f2087a87dd78868d91b2995edf674ea0d20234a34c836540a52ade4511aa396634198f1351b22b72e4ec59d0d91c9196e812ac76af2142e4226978a18f68b1cda64658d19f7aa0fb30221a76a3b1872fdb486e18b1e4e919926dcc10d325babc37c4e181091982eb490b5b32d822defdab111fe52e9e9ce27ffa8fd9c85061683636ca2b39aa2b0e275c1c1588d66f053485def15f4635857f4b56caf9db7291bd622c604bc30518f74be2215c27f4baf4cd65a9e72b3ad160b080e8f8c7d14d59a77b5b197f6b07c8cced7b62060f3e5152599fb0d6eaf3f5256ec086c92e6d9d75a1c8513b57db1084c358ec9b6e6318bc74508d8a8203d7a4e74998ccc34921d7483c375841e3c629e7ef81d62622cfdea3352c20121bc94d5af4c5689470da8a470a1d883dbca33db6b54a4502d7cc5661b71ee76e67d28166cf5e0793458b81fcf005133185f44d103a6ed41a957239c2d06c63134928769c7f6a45f837c8aa6818b427f1007e4e152eba83b45590718c56a21cdbb018838f50d1cb04f6ab05dd35aaa408fc2d100ae31bc2d2868b819d90046e3a707080334ee9c0ec8f0f87d7a8b46ed47c1559be4f5e6997faed39fe5ba99ac98c9c23cc1e94019344c9e71d808978a43dca1a58dab6ecae36c6aef7dc854563f230e959784413f767a47fd16cbc4a160b33986392afdfa2ea5cf519f49ce700030568eabfc56ab897946e6fbe04386ab4a8e564564e577ebb20121d2320a7fd44888a5c0875e65984b90706e0ded415b470e0b4491318285f5a73818a8e5ed5d158592165bf78ab79af02ce227599ee226f6c3b84beea8ef408f3aa6d2e6dc6c77f428ff85090bdcd1a53ceb09bc99698e79980042b90c77e7ea44cd7a414d95f10d958ba7b2d9c2e588e430a7b841ec4da6368301d76af777d3120d4ec826716c7cdc71755bee8786d1fdd6b677f48b7b083ffa690caf7a95d92c22a448ad5612b50622818f321a523ec807014c71efb4e16777aa33cfebc14e29df818a8ad4a11c39cc4395e3013e8a61c3a56696065b2dc0f8155ea52c7f4c99ac48ac0f5944c1ad1abde305f41266d8ee6180ae032aac22044452b06f31a9ab4bdb39e576ff543f5ae6e98f9f30cb336d75ff91b18bdf126831d6b4dbd372932bde5916ab3e8f0297e3bd002300838ce67ded2c7083297033dde419583198c7552a330f156fade2e55547c54b155be0ca373323f0562804e8c006008040cf3812e1a7f28f61dc569eaaee88fefb3dfa7e87342dd07cc55c7766caaf0efe0c73a1f34e8207796ad698025dac7ae7d933476838740cc4b70185e6b95aba6b5b463dc1a5bf79939bc108dba4ed5a684e7b56b534fbdaf44b1e853c6b3866f1632fe61f656a93013976a7840072e50aff0b9d06e9c44e0317ecf8df912febc4eb5a0422a092bb2836fcb76e6e0d8b397ff6b140c38fea66e5439c5a65ce15afa3b2c30aa420da20796333be19b67a24935cf3b923d5040a1b716ae845fd7a77e5a7f460196154cc87a674940e0490a5ef2f670716d5eb70139b2a20491956af1e581620e38d5b9cf952db5a7ff6a72bfd3545bbd391a86299ac67df2366e56e2b385b4b56cadd7dc785d3335a246c6c82a1d3fe87960f8f82a8404a810bdcdb3e80b27b779bf4a6d9c97dd204d722ed5d8ce7a586e1cb53eaeaffcbde478d51d50affbad651b7c4d761549602a1839a5a844cc19d500526094a062dd0499cb9e37c08e759ecf5dd538f352fa0c58ee49c6e874c8e298c324e5032c6ba1bd544f9b47bc519ab1ad01d33503243c4a6145481826222da2df652a2807f2a9879dc28bf960acbc4d157f22e0419166c1843e42d24822cfcb6894b1b66da7e1a8aaedc2ffdd767fee418ed7a52f73ca60779b8d087d7e341f58b875aa3bff8072d0264b94fc59bc1f7b1090e8d66efd7e24cd42bf7ab7497b1a53713dc328a00d57a35a5bbeb233f02e6c67543e05cad90d6ee5faa01f619a8d478bcfc7a38828fdfe03b5fb140b4c23fb3a5393ec10b8cafd0af8c3875da4afe9cdbb130d75e60cf13c96ac9ec3c6e4b92a44f3df2f0e8ccccd12a3502dee182392facdedecf48af6f8f1a5c4e3bc4c812254d1931032943823179e1178db4723eea1e199b9ae7046e560139cb9c5f0dd128d142a3545c376079c932bee5f5af940af8b4c5c0f379ebeea9a7ff4254fb8a119296fcb19d814436c679d84e6473717d358fa9b03212e33b961d88192e4818f76064eb7ea4cb21f98c0c0401a94f99a6e4af7d3db2284eab52def5da4f950f41e8df359e4604dde682fd321ee4ba212bc42611645bea02317bed7eb1ef7adf85b91f9c69fa7ee32fb1617f1df5e281e81771169c62aa924c76648660f60c0deaff484b274b9efb467d96f2e2453dda75ff08018649f269b73ad5daaaf0a85f3fef50875967d6cf94ed30eec4bba50530abfa0ecc834bd7feef3d42061d2334d40bb6f83e12c9c1ed11a4362d019613b7d7a5f7018fa72eea65b1599962dfe98620a2ae8cff610c46951a240bb5df5141cd87811368d1ebd4ebfa3390605862c030c2ca649b3a487e8a7681bfd32cb6f208271fca79cd5a2ccc40f10b8e6a3efe0b764c0304dfa89c3d3f0574ed1da70962f147bc5d6deeedce3f0f98136e81b42682d7a3ac22a91cfc6a6d6a3772ae7435aa4ff372a379187563d5cbf023e1f4d9acc3f70412221a7371cbb59d73b20d0a31c6b71b45b603fa5277f9d80c640ee6f4f059f9d52d0b083e968ef28831569faa364541550e614c99aed83ca0cfcab436c43771651a5f16a7521807f9e298ea260e4850aded897a65792dac98c05235a7835e9bfe2e71ae59f38602eaf37d1652ce78f7fec5ab2c91c673b244e41356c1a72e9cb966fa9b5d4acf0597300fe96f65dc70ef7e090e27d2baaddb9979776d1051398cfef9e4115002be5d4c86476620e6ff9f4343f979cf9313b2bed3b18c5a776d6d531e53b910fe9a78161dfcac79d687e9a4c8da027d70b956bbdee8d5bffdece3691c05344b84dd2064f4b4d0cd808e6d7c89486129beef9ba7da0cb215d90088dffb0f503d99c7ada4d04b223eb5e3a405e8635465a056a0fb7e5c95e9c73994bc938ed69caa8a9f5e7c9528907c8e2fbe71ae344a120a425969d747eefac8e905ab9d85086a181cc7c878496a53b44f6b1357370c7e522a3101f4d7d50671976bc7ee961ea29c4deeef0d2e56ca800b3876660c3795fd1ce1b9eb12ee6284b5dba8ce6b6224bf4bda2050c0a7bd248ca4745efb1d5848959437029a51ffd552365abc1bf7e852187dfa575073028ffe0ee32cc5939c5a07b1a60c91672ca2c154411d545c1b68c60d958ea091089b81dc12a9804b9afd5059ebada532b92494d57babec42d9ac28d4d1b254c7e2cce2cfb73606afddad02fdad5895d805f6786d704de3d75aecf84647e115f353a53e703529ec79707656a0dc40edec7423ddb3d82d11371cc488a9555dae73c86eb51695a9ec3e1c98bdb603d7692d69fd20194360540ffbe99f713e8eee98e1ce160399ce0774e200f9cba6acb8369908e82b615b9de7fbad37c42aeba5d445bed95ee5249ad5c367fdc211afebd5b6ad5157b165d703fca7b0425d03ed2b449a7022d2f70c31e85119aed09ae0ada2d4ceea63e7c84a2eae148cc011243c63efa34e1d4fe440a1f1b302a0f95b699b87b2cf1fbd15c55d71435d450cabee5bdb469cba773d8402ca46e4a13697d26d166a563bbee2f1c5f402bdc523bb3b59af766ccf654a3fffae6b1eda90f5db641e1e364752ca8970e49b0d3941dec56f0c7fec4d4f756e3c3535c4822a1bbf0f91d4b0969120f922c7cbe5bb7f093901b85d86831de11cf510e972ef0345d248861284f9d775edb3965a2e67bcffe24c952831fb9636d5be122eaf5d9770951e81fb23408097f2c2883cfc39c39059f1fabb0d1e5db9555e9355fe4c59ee32ee845ffd32312786a10fe7160637f12c6bc7ccaf7cc6d73b5a35458d2eaa3bfcca86216ee21ee32b4472d7d219a92f94d78c33392b29938a4af3afa88b5aac43717698146d0af58ee5494be0c81ce02c7a50e20b30e0484bad137ed4c68f68f8b5cd01589451113b28e4266cd0bb04384b9df8d0b546e702bb0ddf216e3244e4f5e87b4aeb74cb0fcc475c8a0ba652b0090f4964d303b0bf2f7dfd9ff6773913e4d7d0e9baadfd1ea07386bd091919f7da2ef9bbaaee53646a62d4955abf3766786d6379df6eca0d79c0134354b7e8f4d38b459bccbcce6a31d55278acf168229b460e7f413e86a79b151530c85aa58b1baf445f54a98a9f1c9a345f3f68a40c1f22e0c68af06b30644586e914b9ce2e5a1e005c399c521d5561d119920608e97198589caef1209565f20130fa58ee5f49a54691b6fb1716b25a8add0bf50babcaef44a6956f46f62783cb657f00c2f53630653712682bc896eb3bdc7ba527b15456a795d874ab185c0c4a9fa2417f175ffa8f8ba6f38c80e30f47cd99f6bcdf51d25db6ce57949e9e2ed38601ecf24f4ae65edc599faadac47d0b47ac30950691f1425c5d2c9d1b35460a9aa47e6def9ca0ca42ef59033dcb2761d3632442cb1b1a55f4bb36c90bb98e15d6e9777206094d28a5dc88c0273c5ed5f0c0b20134e7ea59e08bc8ec7df4596ff0cefd01b530c21702f228d29a26ba83afb4853910b3144c82fbf0bfec8629b2b05093bc3c6b5583ef2cd1aeb17e6185d65320f18eee779833ee9c5fd545450bded8bdcda1481d169f72e7b86ef366adbdbda7b00d4fb5bb0975e1d1d807b16a707690acbccfcf1e790a95161ae4cc0a71da53214d48acede1091b30febd286691bf0e8adc0873222eb09f407f328b6eac0ff5c1c1e127d70702d78b49d2f82fcfc4819b3687f9c7281fa2e1404e950d5c28c5dc569b2ac4a31c729d9ffe9e290cd1f688e7ca68a661b4e079a493cdd2eb92b5d4400d607841be71ed5ab42e4bb775445631e7b0483e0390b313acbe4602e3efd527c836297b8d3ae96264075c917307e744678174a7d6d09bba1adf3d7a25397479f8432283ccef4d0651d6694fe31ae23fcd34ad3bd2eedc42685aa24bac450536d37ab5cca02caad0a486a3e0a700930bd45a74b6daf2fbf7504dab9ec66b6a5be42d31367dbe084dc43e08a0a0ccf7ebbf08e5428e71b3b6a04d11aff8acbe50a5c4309e73b2e1bece3f8cc83bbeb6d072a1dedd94d426c9e645039ed07538f35959cbfa2af6d874ff5ec7a3f1a9c25ae486c749214bb3036fc46b34fcd9b2dde22cc83a7e03d379117ea965fc567677f5bbe367cf436bc567751840cd5e2061fbcc7ad77a48a806f8a224a556b9fdc66363e4ea989b910d79bb9e55ab56e7645bb1d8ae2fdc46c36bc0884e33e129e866378d7cb2b9d6e62f4f0b6ab1cf3cb36164393d5db6acc0bd87bd4d8cd79018f74c4af5eaa0b90df056037fbcc603d9cb1b67a3c20f76885c315770c1adfef8203c0b3416dda17e2208d31b0fafbd970f1d4fbe87d01fb53f03c55e6a777fff9171736fc9f05b5f115b9501de7d774ccc822f45993058501acb4f3e24282bb6d54a51b45c2975336cd3693835bd4e1ee38d71ac95a049c8ed050f7964a2de98216f6b8d5401754013a2157144514764768066b1c9ec45c21e74d4feea3a90ec6ce63ccd28b81953d71f2758bb2590af5a355ea321360af4af3cc0cc532ee7ecf91c0ef135fb868f231ebd20832ed63381f17b6919bd5623dee244e7faf37ebba87f054833355da5ff81224d47dd29bde19443eb7a1b9a581f5579cdc613916b3635214f8fede7baac5e231257a953248579f934617f4db377620e3df095a05a3164230cc3dd11a777760cb1428f3956a5625c510d731f9e2c6eb902f1692864ebdf2b10501c72523eb8aa348f6df21e23d6535da51d0aa6fc281ac981c84d50140466421a2e4623d85da24b11324b3c52a1b1955e8d827db6033d8a38860dd68c94782709656baf7a620c35f86058e8ce55995b4eaee945cbc60d1d265628f727679e2ed4d923c58131f7ddac4f36471b78c2f5a5b25558eec2511260ee452ecc03737fd69e94562777a2cfcb6f62f3fa872192d72539ebadef830c63d8354ea922a6120654d3b16e3e09f743233962dd8bc4a450a838037058328da6572da241db52dc014af0160a845e2cd97a21e554a3bfd99588c994edfc0b582abeaae4b0509ca12ec953f7d7184bab8ebdf11545ced301ce5975f37c9fac9ba9ff97b74f97cc99bc80a404079bd959160265290ccd50075c5404fb5d6ccb12ac9e7ab6c18fa8acb893711654147695e5c40d056d25ffeab84b7a294beae3267c307b1401d0f0fea4430e94c79c90bcf3f5a3706cbe87153b37154c282944ba2039eca4985419976f901b5266d922c2514384c941869332eda28b16ef04f7f77ba27db1ccacf71e1a0e20fc29deea749776faa4fb82948e541b7b0a80560a2b80f19b3487f9e73ad839359049a28758e86f52d3a8de552670c0ad9ca360c17a3f84a8154e16314820ee67a1c331896af5c3cebd7ef0d291a7a3f47bda4102283f9126df1c63cd3d16579348dbc3729550caaae4958f8af6a12fad5bce6f107cbb60db962889ad18eca6376408a7d216cb257ff696960a3384163d4086f1167776fcd82f5c56e7ade31412f31fc70309d3ea63701032bd03fa27938a47e27b4e88eb1e5ff365d8cc3168a818d5b63b3d5050745fd1c1d98b2eef050f3e95f30335dc4382ca55ecbe75720e40fcaedcc42c3ef77692c79d047f44c7f0e24b736f73bc2260923a3246a28ab4402bdb28adf3560ff69bf052f7f5a31f1efc2d58641c910035c3bba3039e55c8f681ce0dff8697e78846f159d7d080cde429ad995a683a525767c6aa2cecfa90dec157e20725f7a56b858e82fa8c4e83a5ea3b0114161d7bdf76918e0220a30831455316ef577774dba52c63fbb6d0f4e7e5fe5b2e421df7d2b788539c26ce63626d5ff0162ba9b561ad7fadcc681ced43354945c129c56740da4598cd37a94af8688ead214ce2e05047146ab412e49238488f915aea3e0f4f03e8c4ca405f206fdec6596c4affaa0fb8d7b3950d6812fa16e258383a685ed5f41b1763a428dab8559ad3a0b018c31d0a24bed34cf40c0ef77a73c6498c6907e05124e08b858ed1f9a134aa3eef1ee704ad4aae2db4400eea639d1569c5cc57a7ceb1b18fc0ae4e71ef3dea48c502c9257f82a2443495582cc79340234d2639cc26c295312971f93c461da83e8fda451d09f531d18f2062e0ba6a36093953e9cfb2d09dc30540094c4c8ab77ad462b201c4f16f3de4f9e90553a819b321582cebe4c4196fbd7caa033ec1e09042fd453de1f2230181b35bf5c6a65e6a7f1d4cf280dded340c1ff99782913c5783e812c7553f32f4d4e341d7925c83e23abc3a12bd225afddbf8d48786b098ad542c25753982e2cf4790e94b9ae087f86e171f8b222db887b348cc344a53b495dfb5d9369206bf384ea0ff1cc6c0c192b358bcf54968a131d0f7f4e0b0a69bfe28b38071a07f4dbe6ccd6297d41d7b1e7f514a20f26692c437b87eef4776d7e56bd6dcbae637a6e029a30bb74aa971c4a770dacccd470d9a06332e078469cc0e1fc97faddf8b3d2741bb94e8c2927b994b14ef8751e802f10fef2b9d3661ec2b04b3c2e053fd5fa0ba64002fd03f0c3a865bb50cef85b0d014e7b3424b13048afb0dc2945c4f157bd6048afca538508f42cd4d95546d521dff7107881c8cfa9a06dea1c2b1be49caa6774fd1316f1a757217aec4c14207db4db94b584cacc5385a6877a5023e2f61f13091b80d257b14af71ac9ba7dbe341fa546eace0d99b834f244be1915e042913ab6ee36be434920d51f96f487a47052f24c681ab397fe049c627cc02675b1e7c249ce73f5f953d38503e3e62f50950a65c889cfc54384a1dd7e2bf44197cf108df097043ebc2bfd0e09b6f6fe6a32355e0c2bb058607e59ec83f4f896a022a63510eecdfd026c24e3a5a815963ba1fe39acbac5edc9121c1952ff5b0bcaa51cd8b5c36f4e87740a41199b59ec94e7336828165d2f4edc8f40311bf57244a1b1fdefbe241207cfe4811c0b8843f21a9126cb13545a0aece43baeabc781a7a1bbf3b076976a9715aa9f2ee850a0a68633b7203884cf6ced84b81c33368b53bac07105566b0785342b6f5295e14f80e0f842507fe48d83d486717a11d6e0043706d5d9ecc7cb839f0b67f995823f11763b94d1776ddf5530f57244093e33cb1b77b06d944d080195b9120fec31ca724a376749d81c4ea3573f04e70ae01ba8a00a4fb437ab443ceeb3d7374b2914bd95f8b83a706a18a1d6b86c80c75fd791db05ee84e310c1e2ab6609bf5829dabd77a169afe153a07d920f6e4962b8df9b7f971fe1841fc1a01039e639cc91734fb0a03dd93baf6081ee5237da7ac2311b8ec30d6444cec5492eb2678fc1324f1d4542d29fade4a71dbabbcad2b4b3f209fe790735e8f5730e21e262936e6f581fb9c1d27848f66e7b280cb184aec8e0ab85d4187de1e21680b5e113a92b7ae5e49ff1ce3bc8aa50fed1ff203bb767b94a7759388acf162d54c790bb91099506e47bad7cee4feddbf2f315ab478a3c2c4ef8c348f8538e2cb4b2e6b99432929319e0c55adcaa7125e5271c0bc1468edae2dca05383a1a1a175124772c23e05606e63382a786d33d59b1145a54df9ef9dc88402300a1857ed23fd0f494c82623ac9ea6d12278ad05a9f1068011d894e7696dfad9183334f4f6aee5032fea58d65826bdb19ab706db05dba7c107a2f4f0573a9eba17481e479b0e1dd5ce78a1fa5d7e70932f10c45914975ef4a94875ed1fa2cda671edd86d432a5b1435e9f82a19104790a256f216091e2c9246f8e1a239bb1618a45b1e44a83b64894348452e4ad5c54fdfd74b318f2c4449d695af4a2e31e5036306f18fcc4fa1e029b4279e54f845fc9ddae2f830f4132b3de4c2b4ecc526c667cb98d202f38d4578a7e9c8b1a7fe0d09bca116181e2db68c00fa8da6d5f6e2886d6f6bf94a55aa709e6670f6ce01c878766efedbf6b0f0f992ce6bbef9aaeb98630f791ac2905b67805de86449bacc1ec95e4976439de0954922b14ebe48ef5d9a0519c178bc416c650945cb5e47d2f28e09567776636ad9d9089bae5731ddf7481a89963ef219a37624aa83eafe3ab0879f02ad825623f7b2c7113cb02da8f0587432f3fdc6cf97782315a78af1a2af5b6d1a60d1697520f0e694f229a8df162f7b561fc4856b1971c5230a44be27e944b50869641bc44fd0b411d701522ef17c8dbbbb4d6e0426e1a4e04147a688a0e8eb690e1c2072b7f66dd17bc75050fcab85a62ce3fad6db13254e276197778962c6c9bf05f3f95de2f4cccbf50e3a9fa163c275506a3b59d08863e1af3e498a19cdd8b4b33f7233084e34f398a21c97d1567e70d75cf5a80778c54607f00ad2bb8019892eb24fc45439c5b2208d1c0b26f4d33ce3cba3f0ae7290b0329408cab61cbf73bbefa437533dc27e8c1f40b35b7b90c3a750a90db0b9176dfe34bdfcf577ece6a268590cffe2b9ddd6e3d7dceec5b2730abdd9ebd7cf9a32753b1e05d68b1e84f00cd9847fa7056475b428e84a7969b4328d5be7fa3a8cf42a1e67ace44965eed61946045a09b9197a212890ffd527ba037bee974192ccd922e9b09c5d6ee4f4fdedf8d35b7e1255b8b396f81a75ee7c822bf56bc2b8415af5d1169f16a4b7708334093f4b486914e9f1e87932afc2a0387c0ceb0670f4ec7fce2936ccecd58465a5cfb32245d6cec15b7141e018c59a93c900002475c263535b80d43a52318566cbb40bb2e168a19a98bb3e32a611520d43e83ed97d2115a7286a6f198ba1600d916d9162683694e0f8347d8a4bf3e5d39ee043fb8f8f8964e639054c76dd2ccfa69cd13ca76b7175dcf9fb15747bf0aee9b4a18c888cb992c124d13b32acba350a6485e9188a26cf0e274fd812a31d5243cf5999e814123fcb778d3189651a99963b71a983737eb69347d75699466bd71b7b32a186fe6b6d3e1642b09d48e5255db0eafd125c06e60e88ba47d064b44c27a2ec29e06ebf4f4d99b6ad2cdc2db12f095ea9624733e273f8fc88304d496693fa7f7922784f7d23a64e975796f28842ee08689f8da4fa8f2e92c7581bcbcf3a8606e6e1b615e81374525f12018cf3ed226c0221dee8fceb41c045ffa31f74cafe2e3a704ba21c0b425406e0fdf440c04e8ed4ee68a4757c8a5e34803c5a0b00dca62f88b8eb765db41852aa26baf6c8c9f61d09ca894f06e339d7466f099b70ecd375e9c1fd6baa81b83d538c3b4ea0cd1d16d6ec991914cf9635053a96728561b54181f278e2b6655cd06f3b0c8438f0337b46c8bf476491a53d00c8dd16f5021b1f16dd60ae88e6cb26ea81dbba5d8d3e5563f63e471a2376ff0666fd3dc6d4a997fbf5b931a5aab6f800de607169c8ed36acc7ce26928a81119c15cde4e74fd4f1e96b03eaecfc73dc0c94705e47c802775018aaa5010e4268191fc00da071d708ec416a5f1fda9e1be643fa50d00991435c6d59dd3ed00ced05251d6346dbe2e653068a2f3fd545712b52e660b136526eafe6a9510141f7e1440ecc89725b63ed6989bc48a17900d387ceb2b4411612121b3014e250650559a9d11aaea2b5a7cb1676cf7dec6083acc88e5f895c9e3bd1d1301c6c6d86e3d0dc562d5ba32f24d175a756bfd3d5d462312e591e173d6af03fa1042261247175ca19e246d33f929bed6b54d1e5d4f3f8b9fb33eb68c6cc4df612afa35d2b9243edf3869de2b960d31672afd5cf7b33b0900a1cd7cb494328993600754ff55222b868a811204f00d6111c1d3067a3588f151e11d378e10eb24260648c18e4003444951470b3a7e69c801842acf735946ca8dc15b738e862dfae5dc117c6f1d01d574ed6f1d58f1b81b13ac3c793ca6e37672d3829f46c927e91052fea60a1435c46aa79433c6b75cf9bad65531f53c8df633518486aa9d77c6caa0a0e525ad4c86fa5d89aa00de8817b21e88229fa868e7248c116d1e1ab10a775be646c178f9b86419f75a601919fcc3c151b3f3992cef8aef43502ed192c1dfe8b33f87b1ff684dfd064ba5d5d56bd572a0d6c894ddf21171abef1a5e9aeb01fcc768657239be9f3912aabb4ccfdfac37d6cbb483721995ced032a481d733a75729aef0eb3b8c3b36efaa35b2f00e8e5146aa3ee50b71182f49349d54ddb7439d3dc7e1c0f184ab25453a5498f607beaac2b5a55000681c6b99f3425eae7ed51e9e9dc0746c449946962da691bf6313718c68450e7805aad30f3b9317377cd3662df190f791b2e8049b5d850b48f5875d35510dc235cd4037f51ecfbd2b7fded91e2514d6a8c26c014d0f912380eec4f479ac6d76a4590aaa56e6582d7f741d20161e273b4f7465ea06b5b05bccdee7a3228b9b3c8f374ded7d2bf93a365979c347f5c12be9e0809c7a56f1a230314c45d48be918a0eec4842345bda7a7e31cfeefcfd67cd68e6cde7c8194ebf7ca833471295dacb1d702ecab76fdea0f5806ca0efb8c5ac58176ac9974f5cbcb0b5f2ef0c84f9eceed920c47e506a50d6fcd167412b3e42c1f1e3fc5312bf2f5e8a63cc4630a0750e4ea6ac05ccf9d5a60eeff7919192720318871c6d14cd46af43468b6f7bd276bb824e2eb979c60705a0d41672e065fac8d276527f220e826c3403cab4007690cbd59fcb599c6cfd5beebee4919cdee0559a787a26e9f8ad5708f353ff871391066a64b2b79446d4f2bfa5e384841b440b42b0c665808d38f983a2fb4d18cf230268727dc63bd34453f6bb3543c1b98f9481e02e63cf74e1e45948f365f3b690476084df29b81689f7b2f6b6bbb21210bda988fe32c158b970eb1b126d01cbebfd2f7def8f15a9c52acd251b3a1e488f3485c42f5086e736b2e4385320391314f01b0d57b8f891decc03bacf064e2096e8b1d386eb484082e556b506ccf6e8eae2ad3a1e4f5c03e07ac6022b30b9b692e74b7ddac26791e89853fa15d2ac3fce76572a90655e39cdc612edc31f55aa1baf63a933a11ffc3776cd42850b4c2911b33039ec3d4cce6d0f0fbf922348f8b2fd668380f93bde31f5269a7a36302ab43770571fc4c38a5af1698f819519e794a65bcbfa7076fd3680f3d901ddd4bf717698fc162fa3856eb0ec1a719b6b1597aa6465b9942fb364b190bbefd9a9bca0249550db1e54eba8b45e219c3f61e597ec5dcae9883dffa56e55e422f235ac3c66ffc868d3d2233a7b40aa5b98bc8023f268f77e60a488d418eb980615674036a71953a908c11dc2d66f47c2684a3b3f2fc3e08fd633d14b0c1b014138bd8e6563d2dddd885c2cd96f4bff11cbbb0bab609328326226e9d6fc1ccb77fa2a057b849730ec4506ea65c76aedb267f0f2f82c8c6c98b096d00a42d0438717e452c1743dc608d0647e2c1ed53ac335baa978844bae1463f1127b65b0f7a46391fdc5954b955afa91a52ebb75bc07cf2b6784ce43c4f6d891dca372341bafc56e0ddce4bf8b0898340ac7dcb0ed6b08c51e4930b0ed647c5fe70829742e2799de8ea3bc6b3eca3f6f3ec0d78b3dba052b9bde516680fb50716ab8ba9fd6a1baae94f7af2661ebae381d684adfb49e28cd36cb8e91369a868cc1b62b0e149fc8ed029aefcadaa28af4d647bd343cb9e24d1fe8cf947e8a4c8fa36ce07db7842ed2aa522275d8a1763279e58d0f6f2b6e42ae851225f2b0aae91a4248ef8dfbd12c89b87a28a0fd6e2112b5d3b2b2b1fea432e2c97b4a59c8d98ec7957cc92ce51ee31c1e100ad550d691dafdff7996eca0d7e0efe7db4ed0566f8faacc341e4bc69ced3b9dfc99b8b05a1fa770a8ed02a63a73cba588f61e4de57b0f61c85d2c4a256a8046777c6026d77dc204c4e57df2393563168b20542de06e5eb4af85b07d69364e6b2a7e35a05da270308c14ae515b9ed67e165901fa6cbf794cccb055833ba70003401155ad2a01f84bdeee51f2464593239fa81c54573c83ef10bdd81a99eefc916ff1919b33d93a6a6ccea0060c1588cc33c069987cbba150317c3fb04b6dbfa4e6f553fe7690de71fab7c58d57889a8a11fd3d4f4668adc86909d6d492a305d5ac4247a735c0200b4420f40fe45f29f0f49c01f09df6d1eba72d7591f26c25efd8d6dd005bbc910f59f87751a1856cb030f8640b81a9e6f4a990bed7e8362c9c5087c53f29c8ebe9b000d5d7f7d6e2b249c7054de1007ad9194f8a331e9080d64791891db596f160b7f7de5069ab3bd6e0a54aae9e2e68cbef24964c8744e883300d9d0191d556ddd4e9594ee6c5ada0c4cfcef2499a2c85a2773af3eeb45c622c761ecf134c3146f4b0e6bd83e1c517c8a07ea15e4ad6dba148ff1c1a0eeec0359b22339ea83f5d9ecd6e994391dc55316ef781e7fd08333454d3d4fdd42ba41824af639b2955a7174636f3f3e257508a29ec00ab84fb70b5d385bbe46c01def6d28be2c11aaa50eb4954c275c62d7405ae3490196bb95755844177aebbf7f3f74f9d188f9dc49dfdaf3b07c3784ec7b9b7487e2d9332e3f107a93a42373567f0455833cb7df2eea4a0d8ea518e690e5283c9f20374093a03d47b71e98a6e98af07112b58212d4b7463ba0ef458424e43653fb6b4ea2dc75d16780a679d79d55c23bf53fab1837d40ebe25cc45e7ff50588d0c57933e27deddb47b13b6a70b8859eecf3532a021dc0ef5fd58b84e6463ceebad6509bba73453e501917027dd9860d577656ebf44512ec874c3f5236575aa33412b23cb0eedc2dc2183297ce428906890eab8f86ab9ac8f21d5c2a4b83c8ce868700b13ed460b80ea641a6d3c5314a50cafb70f907c7701c40cdb66fbeaf8cde91e984e2edad4cca6730aa0dbd7adf50e0ee17ce160d3ed61e75edf4e701e23eb22d98ca5a9be7fafc907b7213f4eff548116d53dc84ea00ede7c820795609adaa49863893a23291c85800a9748212d0624fad7dea534660134cd0aba0910030c80162616efa29aae4ebcb8938e5ae624cb38f4d4945b71c0e75a99d4c6edd53789637e78a5e991924f97b24c847f285905312df2040bc06a6aa575247f49fa9508e84058fac0446f8885597aec6481eb35ef938e7e0bb8f724af53f67effaf6c95d3e2ea94cea9e3435612d451161da8d35f87500ef3c621e3d4f8514249ce8df5025f245c386627b43c5f8a78f8bd93b35c06bef0c9bd277bf364ea9b90079193e2f89fa6fc53c2ddfb077bd98f53927fa419d23b10014e577fcb283176d333f1bc51be37a472327c4ced26c7571f3ec0c7b8376bb7fe4dc62df4200e2775a8b56db648282717aca42bf99492bb26d27029adab6da85951022a8aa364a0775f77d707fdf870630fa2d61809e73b88a4ec5ae8d203f4fea02a11c54049791e7d4d390fde8173d9e3b266ef78872e23344e7abae995d2d85fe126722db32aba872137c9b7b75f8de0626fd11a1e2dedeb2f88c30f81ce1a1b76feecf6419394548b37a9824f83ef190a3b0f708c59ce569b8ad9f927621d4673c42193c99a018950bdb0677153e38fc277a21c3f1875c4adfe937cf005106f7634b77b92f67fd6da7fe17182d85fc93ee32ee8656bc5701ce2bcd3307ac31130ab1e00776cd6e9ada9e47a1c79194e64fb62f11fef132b8d03399a4c91e9d4a118873be1c276ca9a1cbc8d846f4e95a45fa6220738366c2e7103de359957ff3c5cb6f9f9dc67a8f88c94a62ae057f55b8b6ddcd7cbbf53d065d6ada31d7babcbe63e78bca5330866a93e58bdbb234f042f0f00e762dddd118d10899f7c4d95e05f6c8e6939825bad7b4d407c8cff92abd57de79b1571565896eb74bad62adbf6005f3888dc3b7d57f7d9f736786e447b44f04bf6b057a02663f8b304c67d9b33994457878bcfb7c4efc1ad97ad8236f15fb9c73e579ce5eb1e7b3238eb4b3c6f4bba6e41c8d43c7cf482b6335bd979838e1d42b9147e351733f1c4a32a03cbbb3cb90945fe98506529b2c440e2af2e8f6061410999b2f11b3e3bf1fff86b09c9468dcbafb6fd414fac6f0e38b341f85b05f44ecf2360c681bf24a0ad952f9f06d4a532d4237043d226c1fa8e163e67abb954f05b467416b4f8c5621bc808abdc9da4e8c7a79931820b260e51673404fad5f72d8e79848d6771c4623382ca8ad1f7a22458bf48d25d3720f8772742ee1c8ec836afa54b6d98333e009ccfaf86db361789d3b3b11c6a329fea14a1df0910ffc63ff7ba0b2cf59cd1f16865a6f5fb9ff24ba954760bec321dccfc16a4e04283592b561242cd3c367d9c4cbdbecab4fb881a2dc4c2fde7265bee29f71d3025074c812fbe8ed63a6da8b5b043f4e7c0d81f28135da3d119a3c16f825c32daa07015a4089703dc4c9ccc63c0608769c4b496a2f353bf4657d42379c3b603ee40d31bde7d6d6de551ffa82a5934e8d571818ba7a9296e372b570f8d7493ea8f5a43644d4ac1ef4cfc2ffab5b592390de361b28e3c0e07fb4e5d46c7d50eb955b75fefe7c7539da7cc4d1b9974973f92e3478ab963cd0c06dc1d2c7b55ef598b1662bc16b9b658e8713cd5473af898ebd804a2f722a67baecb2edf79e2850485b3826a540b8a428f616064f36aeae3477830be264afc560c03f421a30c76ff291369035bd4f31b7f836a0a383974de1d909808d62ca860c490cb256a5ca69be54f05bcd624f2af728d381485cbcffe24efac2f2e72475dc93cf9afd7f1a62175bda941c31893d2c4fb16802b5f3117bb6e610c8eee81783d9b60646cabe9d88bc3c71d95c66396b357186f84386754f9b2bb873451a894b8cadd54f2ecab8bce8742bb072110beb211739f6f75e958f065a9d62d91ab6ed390d2f4cc5ecdfc1bfaa433fddfd3220eccc22fd2ed75806ee101510e7009e9799e093b686dbe8ea45c7ca2d7dda3684e3065346fd21707bebf5c0f1130c6f9a1ada0bd8a79c5a60e9f56169cc22cb2d953d1cec400bb89691ebc61e255434196e7d4664224ec9265b2781822c0dd25fda4db82fb1ca893f87dd68daf1c104861e2479bac79d6da56c6ff6db60a2063f43b05883637abd86c44104ad6b8ebfb72b11af0e6dadb272fed1eed3a658ce76ebfc55213c8003f3573193edf2b64adf93b25da8864fe608001d78352e0e1334a59d07e0f3e1ed7ed2c70c643d1c2dbddc495c7f2a97f01c5477e7d558fa29476d05164ca4a217d392c873372541c4fb906e78307e9f192fecc41a2364f42fd24a9dcd5c2677ba757b7e96abff93c3e397db469ad54d760ff7da85130f6a6611c26161e1ce9d248e35f428a8d8e4315d676caecc14ef0c44018ffe52ad2ab2e0645256eb07e357be3fdb81115308cf0e21f71245887c2888d6eafe9ff1bf24878222f3fff0e7733646133d8fe3aa9f6c43f0364b6b29114a16c796746e350ecfddb5ffd1246ddfe960655ebe95f36671cde36acc2c20d12d043d5c9ce64f752dd0313467a91f1bab51b1d3a7e93b14ec87fb87132b7e7ef149e1bf750dbef1487edc607d19256304d7b96e121c885973eb12dd972e760fe0d73a792916b19d6f9816832eb7b8e72486f84dcb0cbf26c3cb7a740809beb0c39da0441a69f271194f58d6687a1c6f35d952c1fbf10e9edc9c2fceaa79778cbc0eda75ea3467887b556cec2ac668df2fed2e08c7412534ba36e0bab80aaa513f3b9caee18888c652dc609be0a7be90a8e192201bd99b112a13f5ade4daf630c514223e04869dc425c529a9842ee34040bdeaeee5bc8f56fe867e64329e5fe7ffae4880cde5e0bcae2607845272172312ed8483c36fd7ddc3c1c52bb5ac7c98b2f7092f8a54470573e5506f33a5e8462b42b4c9560dd50a6185990e6e18b2b9ad908239266b19808221b13944a087eba3ccd132865a76ace29cdf0c563e9425b0dd5e95c7c72ae3a73c71e9cc49e9c6edb7e96309c000f4141204545ac91358c5fb7cb3b2dceff91e79d93ca326f762291ec937c96e81c807373b816db00c0d2c06f6cef0fa9575d6c9a0633a26429564739b1c92cc94281941ecfa05b32b54d27ba46dd6c504191766d3f557487d4e3a6ebb7e13b69a6dfa29c7d72ca65b0ace5e275d16afb08bf6a7b2acae2e7a62ad7b4d0901be35f699532ef3fe019faad5d69f66a98aa98a485fb5a2c01a08acdf3ed909d29d28e6572e330344e5d7bdcb8d04e89d73abe848cc759d87679bb9dc041fb79659c09b25c5a62512c2005a63dc5de1958e8fa65458116c1769bf8dc5041f8e136f6f8920ba6f4ad207bf87a1f0a45f4d75777f54d0ba59d7e16c4760a519e138cea984559d0bbd8b09671b67034416db60785d313d53c01d623fd2da8845395d842beed66ca23d460cd66ba5c93ba5fd227f981b592ed7272f88b534500e088825b8cdb8c007195c0cae68a03d70efc6aca5a21a8d6434489094e4404d7bff538b1407ed82c4cd193691608e51cf09e939418951409c02117087b84f434e4c6a37937d55aa79df4ea50ad3061ee159ee70328051d071073e962e2633a312fa2e5e3f490828702bc3b9d5d554537088fd5fdbcb8203393a1997380a4590980d01c364887d1194cb165782ef055ab01243b08fa0a703148f2721959788414cbfd396a95cce3a58c8fb7296f041722eb2ef2f02e58cc23c590064c50e50dc5c175ee2a73a068e8348ab9fa7d988070a3b604c1d096ea1e1ada7bc0183cd914fea1f6d5d1ab8e56eb9f23cb514e7ba19808681aac2f39ca4dd6385f7dfde1f9204e8464500736f2bd916efe73fd4ea9f8cfe1a31123174af79c56a8737c8e8310a520c656e7ea674f2520f5408ea59dd4b66f8589b2add233b0ac72b9634c3b504c047f5febc6ac103ac4a9e09b0bb16ae2153d009ec734a5e7a3f458b309315fe512c48ab9f21e916abec50122865f9ab04c026e9385cc36d17677ff0a73684ebf92d7a5cbfe44e8809029c795c55b91ecdbf2d30af664208ef3fc2023669bc7aa2762d794b5f8bc00e3c9f99fc647f263e677a2ffbda78b3e8e23e03b6b614a429c439978ccf477aaf4a4782d9e4f18b9c00074f6f4bcd3b905b296620bd62fdff96f922cebbb4856886212dfb35916a9c9aee43b25361a3447a07a2b8f8f85a7a9dcff85442351c22584dc329851a8c57dd68d7f5b675397d6b672c19a142e5a7c3d665108af06a0a917b9390e9d57fd3c353d784d46a085cc87f1d08dd13a621f3e9f8badb59bee57147207b4c980e04ba8cc35397bda17ce2ac79fdd3903460ea250a412a8c946d666add70298e0b1dfa2c0320058315f3eec4dee4be4f686477bbba69027f10451a1b93f748d1c23449337a3df817b69800bd968fad62f5e0bebcc2412e9414a06434f1ef400cf4db786ab5d3402242815af3538596f26dae052ccbeafaa10b1b4d0188c2838b4788276f21b6ac32dbebc1367d3bb8402da0fa1279bdcafbdc53c8b3c503493338acba59e5c4c733c20c0e8ba2efcf4d406248fa2ec2e77f0a34f173567d1218e223032f1d49074c5415dfdc3b5ee327b83f7d51376837db9579739a641ba3d79e3c73b63a6c0952062e02697c8c3dc641977711dcc69f1ddf184905ec3e34eba29d8c57584f6248f959f5c8e15f82107b0268946f7e529c6b06947e81db15a7593e402452bb3323f00f66dad6fa2a10f892b206b278974cda3704415a67799dd013fa9bb1c21b59d331724fab8124903d5c7b6b707c7e2d74b3877986452e1b39743cec7642d2245b41136a9bffa4fe6304b15004eb55a2eb33323c703938c5bdf50725996beb958ef3b3c2ca4523e26fe2327266c6f50cf9507f072590dba9c63e53c8348ce4e2a9ab6e89e3bd6856c121a9925a7798bf5cd877e7b12b1f8312090ff2ecc850291d5032c43b36d084d873b9563f91ec9c309d9c1b756279d4f008cb3d7378683de09bb7d2314549a1946db5bf73c10f5bc677c95a968c4d43a4d526051951aba30a1ac48cefb495b1824556ef42b841a9300f7a05a180b7452e0b44874b25fb9b5396da1d9b3b801f262963487af8558eabab09f2b5f42dcf66f40822940453c1fe157da4ce50700630b35be28d9fd282b1d16c1a1910244f380b2e1cfaf99c08c72ccc9e20d9d6b3b12e36563409d07a871da5b60531794e608c432a4b2848c946e5f669b8d7e541068326f324f268f42f95a686a30b25170f777a51e667bf442702846b25a48f3337f646c8cf1e7c18d8aec30e0152c70f1a510aa09a74494facaed474cf4d3e5e6119c449a14feda6c3e6fc963934773088d7e16f4c5a97385930d6259833e87d5367182ca2ba214ed4d581c467360f54b2e50413981a7a035187b515cb3bb188c237fb590de1f5c6e87625f6708bab7afd8117c0fee87371c3d39879a423ee5106cbfabab68fc289ee2f042f380464ccc002d790a0a86f7195cb0cc809b589b384e0a2441604f11cd8c03ee2932b05c1a69e98a02c375f4ac2360713801c453a86420081ae0bfe93da5f3c5f702ddfa4b1b50e7afd311d82c832a1bcdf9a574bab0a9a28a72b8dc29ae83ac8f2e92fb969543d082a2bc02a9be56cd7629d21764a9186ee345429a3af8f01180704dabb3a96597a1ff0ebec824fc0ed8934a9663d21f628a48ed22f0af854fded241aef14f63f0612fe53f68311b8b38f025bac6f839d2d9e67e94ac8282c81cbf9e1e1c3bf48d2bffe97a4c86719bb1e486e4ac656af0dbca7ae03cca3720a3ce9deeb66ea279431a447fe7c8070ce9ca04a35e3aeec36af21ec2e43eb4fd5657dbcbf411ed0a2f6928eb4b07963f43b8bc3746bb9507cd10a3bf17a55b3a13412981f3b45e02688c0981ac11f6146b48b66bbe0a895fdbedb73245ebd855c3a2f35a53b12cb81b803e79af17f8e30e89347183a3e97133c8b5b9fdf055befe6de3e2a65cdb0fc916f679be9bdf966edf410a7c2358c4d4ac8ff5c37e9c850a622a19e04a348af322e6f077d297d689bbad29bdec6bd20f59a7b3ff95eac0712adc882186885ba0b3a4f9a4f8880492195dea5e55edf36b6c36db836583a50b52c4c7556ec53fb89149014b5287ae009d3783563ace30ee63ca5043b7de6190d7f2b0014ed1e7b440e83b1b867548c35accccd9a1b71f3f95912e786921835e58a0a3b0808ba431cb316e2c5cb7aa77415148a6310728bea7d410672a89b36e76ea1f2fb8a7c3b5bfef7b3b5d68190f3e3345161718a39eb3a3bd9e4ac31c78b19bd2ae81c7d09ff16b370f69be07a67dee06a7829dfc2c62a9ba2f8db7d06b75d6b15dc938d58c92676420cbe42247773ff4b6380d2a039f36f0cb6e9591ff8b59998598fb410345aac8ee4c37286d8cba3b9142466774a0cd1efd2eb77115b7d50c7516fa18e42d6ae7a5fdbadbd9a1796934467e24ed148bb874422ab8ea4c38e38e7b5c6b54daf8feac3e894bd792eb50e331cb8bad767aa72e67386b3d21a2eddca78bbd1d4beab37d5ebc3da2297ba4461e5c5fa4c10376bfb12daf3dc44fd8eed832b303fdbc2f8cebd9a3d034df8316dcddee804ee405fb555ed1277643c74e6fd6de2886632b8fa72aeafb133f06402d14594f63a4fafca768cdc9299ee71f4c413a6543e851cdfdd9ce85053fb73d6b03a3561781a7d81930b9ee23c08ef9c49e749311554890a7aeebdc0b720e587763da5b7f4a0ad7752da061218f8829df8518eb51e3e965af38dbe58bbcb71f5ab1d74553a34d8cac02cdd64b9409ae49773fb05ecfe8d8f24e2de0ab06baf7b0169b5473e5f2ea7fcd8b89c2056a495086967595350a70072d7f8336364cc04859e31ef10d36f6b3a5137d92d4d1bb4551f76b16705f393beddd283929180a144edb94fd2cc34027e9349b7ab539658d6f8780d36c07800d183e7fd2e41eb488dbe2ba814094a8c2199a042f6d38da931ccbb0c93603c7cfe74425d445591911b495168bd862bd1d6632e1b7d007dbb3500965e33297f9a0838f4c4d9ed2d77c4b9e0187c5fb2695d308a2ead9cad6a6cdc8eb22a69841ea16d36928a1ee4e6cbaad54d3f1a8ad2a018a47c0edd32d36189fc26dd64c25a7b752041220c8ff3b356656bf131f10970805582d918009c9a481b5c40653c34513238d51204d5b909f776286f55714333cafe72b631f2ee13bbca93a5edc202babad0ea82be9974f6ca48ca61033c6740269930ad2a9b41b3102b59b8cb5e8d1134a8adf2ef033fe612ebb3a214e37ebd957140b8e6708c1ea8b915048b424330ea98693e4c98bfec9747f50c0602746855e088647117b180be79c1cf275cce1f6ef1e2107bbbf6dab227e69aa8a8c272f4bbce5af277f433ec9cba0cf71c4f218c7bd4207c6c5e6dba0312e9960f780fc72ebdd8e70a5cad855bafc11442817ad08ef82850fdbd6cf70ef97e57e5f8240876a99a9089755890a45b109d922a83db2bb41dab93424bdff2b14c354536bf0760b22032a4be384995b184755fc27912429546fa0908fcd8b13c600d217c701a31e67b5405565ba1ed134a1d4465f29422e3fffdf9f6c05df0ce439d3f33d061f49811e50f21562c33c3f5c737f0ab5a26e59093015bbaf3906fe4ca098eabd01602ae46e98015533f2354b4fe6e3d64c38f6a460f57bfb7f392ca8e72801a2648679fce93884c85792400a04ff23107636c1dd8bdf4bbd3727592c87df22dc76aaa773dda31c783c03b6763c49eea78627e0fc4bc24637d25448fb8854f99d07e0c721e5e655c777930e79a4c60eca902624ea3cd7605c2533f88cf5c7c96b59f76834abfe54d9796c8c60a0f28be75db49fdfd6a13bb107fd18786490a7b34b68eacbaeb3f64d2ef0aaaadc3d325363f563cbfabe225b256f804aa9be58786ae4a5372ab2e9d90314ed4ba64ea3bdef343c12871093dc24362d21ca63d860cc2de95250c66febc1152a63b1a0305c4407fcf6f38f3c03a5c46eefe928ea96528760144821ff28a8c9dfcbab8c37a547a669348860ef829d671af0a978f15d2ffa2a36b979b4c35f21d346d14f5ae966ebc07d5f509e79e0277e5fc4084ec59768837460866e2fc9e5c340ea3482636fa2eee1b8d7b61eab85606cd9efe797a299d2eec96f91f51c5c322ddf965177291b9968b3589d7848698704781130624bd5c7f511443b43361cff892ce3e951dee426eeef55cdc7f36fb69febd3f07240e1aada84c81769cad02473b311213446e8635755f8d370e3e89cbe67aee608ea777f2f59cf4b388194fbd2aafcd52ef68f808cea3829b28568d69841ee39d2a99234091283acb0e4e08784645be85df14091049daeb673a5276e24ab53cbf88b224acd0b03b152c5c17fed6cc36aa9d38dd17a97678314064ac792c1b6fbf23dda50057acc8530146ce01cf0ff0b4331af00a54087725cc3ccf7d210d35b7e7c1ba20782ab885a31f4633c3e6dd76c9367e2ed0a099191ca2fc9ed079334fad24231c1e0181956c23a4772c13c074a6fee5f0bfdf1e898796a58fd166b7dc0a60329c8e3f12ab2c06169fbbe2065eb942200648aaca86f0b3906a450df741de0be89a7be684780f05e9c2bcd961add73a9bda1583475166d9aa8b44b948547910a43e287ad45f5fe10319555f271b1a59a271d8f3b0301481f9b6d1a7a3f40fea3c4db1cf027f62e930842d561b2a0b611728f8e7f7d48f8e22733231f9c90ad22f015f0f4c640109190cf1a6b088296d6594c77d5f925dc98569d9ddbeb00ddd7c7499241d4746507e21a07eab85ec7bc56cf2c20b4958be98a77b9b6068a986572da94c9e79aa5183b58f1d7ded5d1a426885dae77d72063df360122873be02ff763c527ec474f03de43a555713164b95c7c6543ca59fd18f473e4358a43dacdc8971783b8795db0ae16f7716fd41ab6d0bbd4930d9740fda5408ce482720400df5bef7c766f437dbcca33ff8873a53fb67d1277d628bf1e259777274cd8aad76810335263caf1c53cc8a508c0106565527c4f65785d8ed2a4536797dc1d083764a35e7a011e095083903a9a41b53897f59992fd0df399097fbbfc6295ac92478a0c1223a8565d48f3d6f8ec693afbd3811c65f8183a08e41b5c49557775c99310c589dc6f2bf892cc63c325556e978bb5913f877a76aa08da039b70f4f635340c4efef3c0e1c62f63c7588160c5b7ea98eb227375c73bbdc030f4cdfcf99caf621b18603c33e9eb03e820dd494830fbf5d64f74248f00b03edc2fac6ae9fe9407a41c69dddde47ee6372faf7aeddf62c0f889fd3bb5a4c169a3659de51afd9ed370291b83bc48a261cbbece9dd5bd1e8ab8f4e57ee00ec7c8fa4a1c5cc20d69aaae0a1121a9a699ac19b4db00f600728d402947839b3d7194e9e6dd8c54b94e85e29f1fb3687f38dde40e4e5c46295f1dbe1491219f8589789baa77b32d227c89f7f07079b95143912132c8b89b8a4774084b11d93f81780a880aa6af4fe821d6e8256169f13b4b0f0a7b998d9b9983f1917a4c60bf21da5ff9f3853a588dbde8dec9c243a16594b616a5af21d9075d04fa72f8f68eeb81a0d07646609b08735ccd77cebc8a1df223f186f66b206b184393889fced11cde1ce1b0e7efa758c92e1a2d7a13af3594469e2361e1abc389128e08178f751effaeb40827936c45ee9ddbf8bc03bfb2737f4e1f486db7851d2a94766b0ae0130cdca98a59ba68e45c1d3d986ae04be74b1531ed240b9d1ea88844fb591fed5cf88026b20bd14b24098d37116e87e1e66ced1814c519e5a3913c2c589f67a1c148307335e046f270a340b1426164fff026fb13135980dcd7f809fd85a1f37ddaf1bb3d0f714f6ef562880c36e6ee06bb417845eeaaa5676091f007ed6b908b0a725efda3920783bb2f446882b8213b1b7c6e8a0f7d78ed2999cd52296afdd8f14101d1fb4389bcadb23ddb42a9d8fd53281bc375ff944107ab2eb0a09b6b3d2a2cf5a5dd4575719853113921a5c6c35bd66988ba6067e1d8bdcf1360c31d8b0d6980f374e4cdfbaf3214bab727ac94f7ffef74cdcf2069facbff080ec66464e313e7905163b1ebeb4aabef180dd6baedd7eaefba272b27772a4808972fa337b69b48c18add1e746fe26bec5da6f95befff23c28b53c74cb7a08195f310e504f8fa061c01c3068987cd825749c196909f9af6a0d9d1ad4dd9d4aad9874864172f87c9475b512d8bbf98774621f4f2e45f15b7a075872a5853fb0342aaa1799b8d3a423fedea6b9b918b69c974c760eb28b73826fd5163f7c0406ada1fcb5b4a911901b809f1cedec9e4ae919e2a6387940189a8b649082458e128baf9fe7bb7949b0e34cc179eb12ea86463285d377a363267206ddb0a93379c7507f08116b21eacfbd73b98331d1d1e3f49ac576bab9a54695ae2b3a5f687be4b97ab8f5e8ac63be351daf3689b249bd913260d6937e0605c939f2b7eb88bfe1c80445348ea4c00cd8a793259a0dcf702a2bbe8c8aa22c351af7e4c61fa915323fbc3be21e3b9cc77f1be4c6fa9b1878f706996634d9d2cd375795ae6c9eadcd32580555ece01c8838e8ad1cd5788fc7b30aeda3bc7fec7087c52f7da4f276ededeece4cf72e9c6b92be0d48efb89faa32f15fa7dfcd325e5cd8e4bb392badcf7344c669bd279d75b515e9bc6a1d660027ebe3e319e7581cfe24b0f347837066b9ff970227573d70a82858e0646f3f55bbc0ee30a64619d7aa346269e238976f09fdb27a101fdae677e1a3d8ec81fa16a2451348360ec95e63ea20973252644d325afc43e175b4d435aaa753d2e58322c40dc42fb39bbaa28cbec7e3c10c020ea664ac624a39eaf80310306cdaa8ef93f6fe56936780049f1023ef1aa9063ae75eb912b10565611c7f2b5184ee1b1ec2e05d98f971aeedd7a6426ffd2c31c203375a5d72f2c435879e24fd6407a9e597b09e23d873aab61d66280a3226649e27eaa87edea8c08b6a96074ca095b62286da02fb232e3bf4a9c899aaed4291317d9fc407ad129e795aa3ffcf065f2f83283bcf688ee2cf0e3bd0eb3f33af8a93282670623c2418b17b65b5f5f8aaa0c9ad7a06c6952d624e5cd8348a97ae685350a7f11f38cc52cf906fbe656749a0837437292221892c09cd2176345db05d8c475d78da123b8d5921b70acb94aec599c18ff0b41a25457eba23503d1812b8997eccd2ed17f4b517bb96c6d28a3521def8a589e2b8e37fa52fe84b183795c7798964ed3c9dea5ecc55d89595e705fd5ca60818ad162cbf9c10b5bf746d95c76521c1a251614d18eb4c178723a93b9949f9e519f79ca1df37b84b182bdf110afce986c4e2700e3d73f5f11937d1fe34b7d59b2042b630cda6e7267cb7ba0d627a305594bf41ce0285936edf73188891c097cf00d35e52a8f7d37ecd3e411c36beaa1f303726322a702fc916bf82e70912952e1d40ef3d2cd4112aca8aa65a20417e447485f04f1e1d6ec5b48e96b4697f0216f1b1c38842cd2f18e7ce0fb1cd5c15f2512c2f76c48120f7845112628ea7c09290a1eda837ca0959e8fbf1e2febc0c03a08616095b08ce78d877de446c7e86c4f85a518780b8b9799915099b4886cb8a5b3d3189ffaea7bccc2bf91cfed72c5fbdc3914e7289af2c62b5ba1471828cdd0378273b75474b08716212a7107f25728fe10a3e0bbf7025091d49d7c3fd84e427e564faea535ffe90870f448de3f6763f596d9c848a7d74aa41e5509f65d51688550909882ac4ca91efd28f0639e27a3b53a7e6c501fd3d8bd5d3156143c69f75703075560485430d028d2b2271b779fe2e91f324d17a8d37fa8906eb1217d81fc34e862b19fcc5aa3ea809fd92f283e0c2f4e009933fabfdef38881d73d3542bf3e695a193cdf29610e06c2d127f360baa6729c49ffe1e52960bebb2b59068a3d377cb81718d3b3e47ab0561f90a44057a8e0bafec7221cbf18ae1ba99dc4003033ff89185dec582d924df0b9827e7dcd61a477d6ddbab2e33e32cc10e37f17c9a5f6a5c1a00eebf672b13a211e1583e53afa71741f8f451443697072cfdae39daf4b454fff8ec6b952764552355b4fbd017eb1b2379b650390f3fadd7691d82c84c5e6925b23f833047c153344d5cbe877c6580a061b771490e5b27b2832a51c13807292637a1cb19413d03a5977e1dfcd9e6ff12b542a3683e6447afce1a83c55ed7715f4178dd15cc830163b03c1ef5514f72428c47a751674be2ec5c1914abc6f83e129fa0a49188845ac1a11f0e330dc2b10f16a46f91e086ccc421016cc8c55433a571358ea52ca8f39b7e5d4a4513d73bb542b8828a207a9c0f7286d493f7a158caed2489eda376203645fa5f0095e1b30b5d15cf03bf248339c235590781920671c8ae4266b4744dda449819fe92872cb8387d5296ad549bf4603a2d5584d7da5ad2dbee114a8365f58cb604d5c427fd084b0535545d48acc45969670a89c29a607a626b347c666bf59e4df0373722dd9c07c16bef2aab3d005218b76ddf313f22a828f3a41905dd4a7c1344e345e31b4945ee0d6fffe165e336cb710f4a2159f22159f3b6d8b57f65fa6cfe4c817397dc0c75d27c3030f53b640660ad81797d2ffa5780b4f263488d35994ca6d9a01f62069386ee91f826386102427202661f8836a64c45e44992709251b7de6302fd13958f4391d658406d9d5638ce527a7357d7d63951931f3e7f3a12ad2dfbe675d37262d847e822f3ec42a1ce02816e68038963e794c8c91da9509beb376220b3df3f7f305c194191e41de5f98b6a777f2f4358ddbaa8a9d9412057cf2b6fa831cfc256b305250b7e26d1d7055f19b4ac475178e9839b1e6a7092d123b41c64cb9e273f318354048c9a4099c1086e7328931ee6288d6f421dcf1ec68341d8b973cb17d5f58ceabf98d19a2cd533b0de3a041e7aceb956fc3364013360ed902c86ef2f809c4a79e75317438e2006311c2dcbe2ed58c9eded48cba19e13461dc1657a78242de596d9d227577e873f79d82ada89dac2811b7b38fabaed773124b0b586b8a1c38817d67659c4ded8deef8a07be6132376189bcbc031b541eaca6e00efa144e6f32d2eb39a020ec26044606164e4bfa07b32322b98956453339a63ca824917305e9a09961492ae67042a9d22a78b9669072b26f4ac5eafc2ad64f287b1c2d7e188c28646da3d9ea06498fd55e122b71be8d8f78007a7e64bee7c4c8d53954e2a30876c42443fe52f824216ea97fa33d4b09392812d09ca32a28cc94440654ff373ab5d246938a477fd5ee1535e0118425145149f92d7061e79f4677305c4d9c4cb2f7a975d098aa58f372a5d391493c3e4de1c67674cf72968540dcfa03bddd870d7ed60ada735304abf207e0119301df156b773a584fa1cfa7fed181588deb1417a279e5d2f2d34c14906135f24fa5d647ca5c295c3230c779f1f6b5d887caaa9e921f75b2e0bd9643ac19cc2cfaf5c7f54303766850a39f28a55accee56ec5a76bf7272ffb6b8bb7b7d88b6ef4dbc5de7993973b4c84e3507910cffcabf83acf0dbfa191873a2db49fda346807950ab2a1552e7acc92b6bf4d611630b55f642848294f9ee52e1099c405785351588874f18f83edc591f8cdb377c1529810325b6d969beb4ee6cabd53b9fbaad2bee02e86e722c7e22b0bb9b1b73192f52856ce174fc1829fabc501643e7fee7bd9092eaf745456d4019e5ee081644ffcb3b77d429cec4e374eac343c5f393901bbf52275bcbd3fd6ffe2d5f036d3d629383ad71565b016d8f6770636f6509efaa9c34606ae2b2505aa1f02aa04c98bed934b62c1f534e5ecb391b4270ac34058dc17fa3391fa9297662a693edae8f9b393d3d5806461f5b33415763837335664e1f5ecf7f4d27086c22057825d55ccc3848cfac1697609711261f741c10b4e405878a9a8f1f84394d160f60389dc79afdc6f2c856664109defa081db936d2e165bb47370ac9cc909de205c57b9b0e3d967253479a5f26ee6d0a9aaa98b474b095f3dc1c7238ec86cbb659ce11a4895c8381236ea2a089fdffbe51016226abb0d1a769f58f940f401e71f8281b7d0770e791988b86bb2cc4a8b92b1dfea626b5d6ec1f0f25568a278611dd21963968678601600a6737caf2312d38cdf3c4ce31878038d7aa2ed35d80cacb2d833478d54d46be88f82c9ffcd2e16cb30579a50c1ebdc6462189e1a996bbddc437951b32a5044cb36a70b859ea0671244862c41a53e30647f08a0856081bfe94aa3bd719f8fd7728ae09de831a280e21852c4e486d4984f077b6d5ce7643e2615867e99b0abeba8143b0c7bbff64fa757232ff189ee5ba09e123929427874ca35efe419b3626d9e4e446e72df520b4bd221afdfc6e3d2ee02fbdcbf1377cd731a69caac94d8ca6ec7232d4a1bb232d69299bb6a1606ecdddc71fdd032d6d1f328b226c85962199631a8ce934bc4ac8b83a282ee2429abcf579d3382e99bfba50ae6a6d5259377d3670e1c2bc37383757bc0587cbfe40b1539f9d7f9200fed15f796ca3c95dd8afc3b4e04e60f244b65b56261f3a84d576a46bb50233a91879c08de2709a03ec02cb9b85a7255c5ebacf520177c411e1c5770bd17131bf09f78e6c426c9045b4ea9a77ea32d7d22d52276085025abefd8b0f4cc8999ce1b2b7422790b736933f559a9e6b36ae74d035239730d8ab5132b76139e308889250b7fbdbfb0786df2c3c2d525d416c5e6f02c2129c3057ede32ab2d0158bb5ec08914fb0cdee156f2b0e4db5c428e34dbb92d2377d46dd40a41ef169901ec7a577852da0012416eb9b3b902774c72b08d407ec3f51a030cf175a7485788cb3ec6c47791e5d2780282a9b2b6d77fd4771b29843d8500dc7f853a7152eea65f1da8bd5926cfd4b12d9ba7701b01453312e962e61ed769ab281320834b26ab4206d509f18fd8d9f4f78737bc5ff5890ce7cc83615d6646f66b50ab1e2db236dca9af73b9ae8dc71ad0356a2ebc2d1be0baea53bfaee02e6498502b5465440e5db7a7c0460a8590f6f752b807b77b24134899a1832b3b61d61ed7ba624b618210a6e63ca2b21886d72f8d5973ab0b2907d4171f2ad5c3efed95bd5f215290c2e3f8498f80641a3be836700cfb2943b3669ab48ec7895b42f8223848015c14a849d9e81eae8e919f27cdd74965e4bc84c4fea9ed14d6de41012525e2a34c76815e33313e7b8cd704cfd920d82b4341d5dad170b2ad31a3268d84357c540ea07fe05ab0fe638d7ce0088cf2a2cca2916b4bb6d2f0fed75cc060d916dc378f365a90e43556bda5d9cd95d045f6d9525c170d23008e5686ae5fb5bda1402299ced76cd77bc8fe35f43d960c0155fc64f04f6f5ae838c29efa0db81cdab724049898d6cfe8c2a94eb16d553f59f61562fedb6787106fdd4dc19319db2bacbce06f293e4089b229a33c2b5e7c722846cd4de22d56686491d94da5524c2958f4872f7cf938411235855bfda32826c6df7d30fef7218c263e2600e5e040959964d740c76416cebb1d92a83d2550d2b713ee35c03526f269addb61ca9387018aa4f9af8537fbc865ab858b4269117d121dcf72b98f5c8a3e96bd0a6e53c3ccef9c4a4d68c5b15a2d93c745c86f623ceb7f8edd223bc7b47a65366862cd3eb4557cc7e43969c07a0f8c6df25a4b8b7c84633c39b0e1c1e5e40a1dfdba4938c90bc6f56dde24cd8350e4d071f0aef4b16363b08170d94a8e0fe30c1bbd9a0831acb404ca529d940fb037f158ff3c4bb04462b59acb8aa315a4c2e8d6eb8439b08c6b6e6b7dc076ddc25f8be22226947a615ce70cb12df8de85d2b831b80cbab299bc04e8c663797f0ec4651f167940e0c678071e689987d8d14a27b38c223b8562e586675374cb74329beb5959b70f59f01d3eb708e9358d2587187062236e54348e142fa3d1ea4d91b3966ac88f93787e32166bed6e8ed462ecc3ff525ad81087fdda067c190ac859a428ce8f7d9b105ceebc55fa616d3f3f195aa1919ed5cebba6c3893f3efae4fe9730aba663713ab71f8502ed456693a6fa1ef8ab58ea8188f45e07a27fc1ba526a627f8d64582bc5576ba606f36f2a344117d9ba95a1ce1ce7339e4dfd24cc96af5cb59338f7d47cbae4fc3b21a0da2b6a9efc57c90871e400441eac47a57fd34b866427070d36ebe5d0d4a7738455f1156556286ba20e5594c2d7168f68ee22219488c212fcf9469533004d8e60c7aff85c696a5b27c906c6df898aeaa433bddebfca9dacdc4195ba0a493192de21ee2aaa74d8922640d1c802c845ca8d8ae3bc927e9e569fa6365cfa1182ae23302bb36f9eefce2615a766c59b7bd6c4a2f189621cc3ebfcd4c34c11b37f32db78b852192e5b43d087f4b54be7eee7f44e9c2ae4e6fe2eacafb15d8a081ac587c3a60af0d3bdbe8ad9181da3b8660d0052c2a4a6ca5b117c1070c917e4d302d075626a9ae7c4aa1ab8b30a9355bed15b94d8623be3d4d8a971debfc9fc6ab802c7eda36853f9ec45fb691270b8803d15ccc82781ad66d3cf4437b0032e8802fde7533b727f1df9eff6a72818c43319ddf2e78ec49bda240bc5eebacfd1f32bfd895f648543f0df3e00001f9c5b2c22c8a4a6dcbf78b58a8aaf9e52a8e132b434d565220bb5c56930798859de93be124886186b9420ad230443aa579fe7443f81a878fbcf80c2794716b4fc66261021f1e28f128b1cf1cb1917c98a71f5d5bbf516265fedea3480a41ae59532dbbadf48150202b8c3ad542f770a86c77c28045d0ecc48eb343aa18b2d42beac29abc1940eee1c3a9eccb93ce0b7656232c558b03bf8bd492589ffd7e3797411d167b46d6c347c8a5f631db7239d6c03dad4a60baf69c5eb59c70fe29f40bbb325cb732242064e8a4aa8c7a6abfc5741a0320c19d2b44a17674b85a201367e42ea475f82cae9da2d47aceeddc6dad23d2040ee482b15e1045d82679af871048cd7894b3bc7171dba277116d13e8de0bd5a3fd44b5e4efccb249fabb95982670db001f5d642c9cbcdd06359b50469cc60c811407a87d197c2d2af33a29e2aa633dd62f68a5bb109d7559a82c88d555a92129fb72ecb74bb2dec37ac9427eb3c75ad2f2c01df802830299dc3cd3726f736c19843c744862ec14c007fbff74725bb346c72f3abe89f420c875e387128df2ec90fe7158b183cd8957c0990df33e028f49f48a2a666a3cf5658036a01e2830d0acc891120e858f7e51626077394a08c1d73b3de2ab324e4a2a69ea941277d649adb20b13502f6e9325e9b9ec6051f22fc0422e1e96a49289a67773a4cb2eed71ca5b67cd4566db24523010a94faabd47129df19aef6bb2e6f2719b7c07a40afca7fa2dae65f334b70729c9f248839e227dd42073b4adcd535751d7f28be6da8e30d5800b61f1891f34287b73f8f3499111c0318dd6203ef6c33d1c799add1fe57e16d07861c2738a94f2a7d47594b5bd1ad1f3a43f26054aea270fd237a7a5acee30b58a8ac500e4ace4037d14199b1c01cfbe50dd2ccea224be0d7cfa72cefc66722b4f83cf6d2c2f85cc1615cb3e5b464caa2bd29d52382bc78c0a9d7c4bf80625b74d079f22053a8ba68b971093e7399fd8b0cbd119f2fc8612439ec2aebf3cf547295c742fc81d82d636d157dd8fac7ef2fb1c150afa9f066f035cced51eb3c043744e468f1d2e0e1359cacbece05b67f1ba7955cd22c9c086303f80f9e0dd23d591ba2365ead81125881abaaceb852a71e6f6b1f02bafabea4900ebd8b6404e088b71ce4009404ab323bd95739ede174d94742268ce644c67a371ba4b34b62c0c2d7e2855eae45ea4b9e0eb919ca1bd1b934cbebe12986d945a5a663e08eda7bbc6f77e3db1fbb0cb45956e3167633de59e5e9efbb524a25479e959207a51cbfe09cf7002b03d7ab61811b01b04cbfdaaae89c5b514c25a45ed66a758e70e2d5dfd40a6d4a272550ab023f7c12921835daac527b353012f6a3d1b9c2309339b31a4bed71b8abb30a53ed97e4aa26926d6e635d4fdd489cc45284ac76c5ff2033afadf142761af9f406ac8c7c7d744745ff5660b9aa0637384a999e02fc932bef83d1a200c6f63012e88fcf6dceff5f229d5e21a070c151da73d3542f59b47816dc3df6aeb56bdf2f0f004cf4943538a0f21edde61a5dde89421c1d183f9bf66ac47174885cbd062bf8652847e62fdcd9494d09d1e1ff8e68c7d52901a22be0169ad8d5bb1093d4bcca8ededb53f688c59814b6670d264d5b38a61b85a24e6e86b576006eb391cdbc64ac90e8cd53a51fd1bb368bc03971fa4de39bc1abcf8c0b2fa7232139ab968361a858d42235da6f30d4c734b0dbe614b7286cd9bb2c25648704b8c8babefa15589562dea9fd71966c399ec3549522b66edeee56370844c2f4cdecc7afe10b320121bc58db283f3c076fe7f7ef682c025dadd4dfc2ec2a253a4195527dac662ea22c7d8a47b8f8f23e66198fbb58054c27d62afa5302de95057931a0aca6ac3583246ebba2382617ac6eda93e10de9d272a58ddbfb4db8ea0ef300c64da4c93f8276815880945095c43527ab6bca8984d1ca01f81e1ee132aa3f49f428556970e764234f125dc076be859e07ef814d46e2d1ed87135c96d23902f3228b83cfc52cab2f60f1d8cb78fd9423f0dc115968cfb0f576554c79dcc15233a6d7f168f43c732537f64f6d647bcbecfe8f42f69fd553c061cc4ca414713b1b40d0f160f0404057f1e5bec4e1228ae299fc7f3cb9ac57e257a8d649b359c869432ea3699c626d97395e9765121429d85df265b5cc5ceb7092f31bc236db4e72a3043b9243d27429a286d9b5e21cf6e0001ab74b3cbc8bb9a64969f28f98bbccee820eb8c93010070bf6f2046f9ae59d7035bdffa7c0dced01b2855668bcb2bbedaf1064f462341fd48f5a976964c2df1a34538445ac58373604f67e46fa8623549178f031a98a51c7bcc539282828556f6823e1aa646777d6ae1b3f8911b1287329facf683a633db7bb5de974cefa1128d316d442613954cd606abefdd8bac3eacb534055cdb29ca5605bed86d50c8844271179fbdd7da974ef74b0fccadea748cca3e38e1834befb03f775850c7b92620da1a957d61513e51e1af7789a240e7558c79136af14aaf452142199584174632ca80b945b06a0d9fbb365530ae24c56fd0225868289009631f2272bf259f975e30c10c886cffedb575270006ae04e2c9688400f20ba1c605903b264297552fd36c11208e3cfddb009aae79fb22d4bd87aefe56dcc1af723b403fb527236c5951036b69af5c66c71e7dfba1043f4783086401b043f2bcae67270fb0e145cb636ca648d65f5461bf2cec43954f7bfc31aa5ae11203d67ee6fe1f6504f8cb3ea58c24607046faa64e816e63c205faa45c4024321d851263a1cdc533eb4d54001194283d6546c953ba20b9abc0455b7e310a5e2736edf4cbd706299218b1b5066973b0a0147b8c99f4022ff7cfc5f7465f5779df5c6b59354288f7de3742978d89602470601f1fefc013ef2e99d3b964b2488d2ff984bf0aac47c5c6eee705c7f07cbf6cca8c9b114894933b08631737d61cc52063c892e567200970910e5b18dfef125663a378260f2cb79acee7c652269ce81ae412fc55ae288f26186d9696f8582b6649dc6e586262ba2320c76a8c1d62ba7c408288e095b2d4a78e85a944e0a0d2ac3f87f7271179d96e6ed99e37ee5c3c13862cf8d7d70ff226c795b4fbc5a8ddadb3b23aec84dcbf8c7e72fda09828bb28051c698e45fe0796168c8aeefcdd0a416f8faf58fda4cea7807c7d38a8f7562b1f4683e754f6cc8c52ba54bfef22020ac07427c8375ed9b7a186e1b09d745cd6596698dd3bcec5d54512ac17d4a983f8ac7300f5c1e2792121552562a2afe52e1841d1859d35731ebddcca659c7c7f97341fdada1f96b1a4e0290a04c97de8a1500fcf6b6a71ea4b36e54661ef3120fc6c599bb58c005970f8fbeb7af7a35097c5634222d4a9b447a200a21d368daeba3cf3316fab8b3282eb82ce104d2ae508bdc960fc0ed9cf3ad32a5f4942e0b64e5a53789af577577fd13b8764b0db6075b73274fd298f923176da4e8e95a526f34c539931a6483de5f83620525b0c3e5189632dcadb7f46aa9ed20217699eb3c62b345323e66fddd388a4ee2710100e7fbd84b1c34a0291b55ee185f87d0646759e87ce701eee8cc3e54717ba5b431e050eaf2acc5c37f598f5d29b2ab6cbcffd43f071f351bf99d4af5e4acc1d083aef4ef58dd3a96921db3e29dcdb03f034f9fac170d62674476539931831d556abdf472eaeb0851d5f00e7cdd8718b3de08740c020f6d87add5076a2e3f2a816d187afc6fb2b81f5323e2706d9319db64b29aaae4a21feac251b3f4911e02fa600b7aef08d177416e09232aa635cee535c2f27c61a3848dc086befdd087c81fc52b31305abab81fc2f32651b0c5da3716902df47e7c37e177ccef80e87e8c786452ce9ede98d2b5e6c60305d09308513e4ba0ae7527c6f68e3fe5b4e335ae93800a8f05639f6f5188d3ee3642c99a5359f45c5837c36af2d74115ec937a6526b950e0e52f9c266b890925e6e234193208b044277ec2b75898699b713b3dd6723fc88b5b5573c11e14988974f41dbf2522396915ac28326e4e6c203614978b9a698dbee273c445cb6138a2a054f67fe988964039428d89b8bcc0127d14949ca081728ebbd8a8156097af7b9ecbc24209f7aa862a54ce5c2912ccfe678a75bff3177aebcdc263c3b27f9078c77f636844f25bbc26c33181c3ae2f27b709deef6a367938aa4f3dfc49652064ca9a30b3c134dc77de9c0277d93d4f100f3bb294485082a807d0bb4a656b32cff6bccf1f2060340e83f3cea2206880aa8b178f5f412df152e436d44dde4316673cb72761ffacafa16d14225e2605b5f2221b558230fdebcb0b305f9a2e248ce9510abad7bf39ab449630da258015e7b0c44bc3ed1e6635aff97961053aae650fbcbf6c2f4b86c005b79481549e42843a979b164dce668491ce0ae4a955144ab815361d72c50659cbcb4fb4b9c0dbcb5344cc23c9ae2714afdc1184d7ced92e5710421817fed2672d5009f360aad4de2d28ee49dc7b978c8c310b7219d2fb9eba054966a9d7fbb565f2555b7d44a71db0ba3414c1067abca90bbbd65c14bfe4ce435f336e574317ac0783708b13e259e90527727dfa33ef992ce616f6c28634deb360b895da4f0bd17b7e9438c76cc2105c8c55ffdf4cc7dc890f6832d0609682785fff2d5b8b56de784db9c2d9c56269510ca731a0a5a26496026ab6ad029ae35ead23183c3599b980af5397abc900ac56a0182a334061afbf8837459859620abb25fda0fee67724111d76e997f23a5e97180fb6aa907460e667eecf6ab4e4e4be308fd53d7667f36c12e3d55684e7375e4a706538d7e9bac788c51856265834b03901bc19ba639c8bedc50f5b8e7823265ed62cc732d88bdf8b7b2f4e58e26e19338cc9404930d134e6d63486215e27dfeec5513563681af3dc0489e0ab8aec2983201ed74b7d3870bc24f415b8d25ce7f7a8f285bf9f6c7706d1287bd6ca9757dce079bac6a697ef932319de0bde39613cc61b7e0015eacda3e5b6acda2a88caa2ad9058d28970ce09aef41019b9de7dee8a2bef443e81ba6cf51cfa042a71e6fcbff0a742dd108e3fbffb3858d8ce989f2b146358f376b3726d2591f1c8593c2c6d85cfe0992b894c7df7e2791407e782beb855ab7bdb3962a62cf184feb4e1202543d1a70b1124d2d2aa1138d207d9d929a43cf91ecaa126221dbb779f30e71d3665502f3b708d43651a08ea90b821b35344903bee5cbdefe1d7d02cb11c8d86cd9149cf388b7426967eb31a92f9c95b6bc32a6cbd03eb6f392db0d0971ff23eca1266660d6098a7a44f2e6b0a3003dadda34987cd028e381ef86a3d9a0b7baa5c6523cbb17ea4661197c3a0aad6e96753a1bd67066da1325137924c2f19fdbeccb6642b59c5d52feb00eeb7b812c68099898b899390d40f21e252a9f5446c03ce028e0d835fe9d7efcb2e68d4da06aa13bc7e1862014b8274dc165b5178e61a7932ba431f8c7bb464ac5dace4dabb1fc68573dc26df84dfa64f406051bc8776fb449607317e485ebe2a07189156b0f3fdb50749b80b9ec8fdd0c08d43b9d4b9861d369cb0f1aea9f16895a0a2e041d3ebcbabd6a5c188d96803af7a296bf540ab882e9ddd048f0ecfe307765a406cc7b26b8cc447d2296b57ba909d8f1a05f2126371a5031eebe5f6225dfd502a74e5708ff411e1ebd3def21b508d433e50c14a22940e7883c85a02d682b72df92eea740030bbb2e309873b23c0c26ea7a046d7b7c27a4187a0de9512d69ce15e24735111ff108f4bb08361592c20f2cb263588b7683a8293862097373ae1a7c4bcddb5ac30c43409f6f8fb557ca523d30e767d432ccc74716df3c882e5e9e2c5ff2ca5e819d9213a64c84eef7c1b6b31b91d0d07d09861b6092e28a9c8eccbfe541efe0d993b62cfd8489be4aeab03ed2ac0279ad8a2071e777e4c7a88f257397d8c5bc6f85a192f4881183113fdd6644aed6549fda14469ad87dee7528130f05aa8d1639e5781c45274e34b81e507e58ca2f6e1673e986d6009ea82fde28847fcb8213d6cfffb3785f9883cc78a59af72d0968dc8e7993427e5ec3858f563ada18ba30f6f8f79996692ce421e7e57dea3a914e5e0cbd525352e63dae7d3f4bef0e3b656f1ed3fc7ca54df22dc1510380ffc991a96afd1eac75cd22d4b620ea936f5ecb1fab7e2e9fa890aa066020732ebac9544121ee86847e3de149d5a914022b0cb03dd12af5ca9a90796fbdca780282a311d8238e3b5ca605354241bcad4caf1c8d140b621896ba2dedd87d39e24191ab8fe77765d8e713af908c27a8d4e3e4d04b898a911edbb726b016e44b2e85b20cbff762501b498098625253a8a182fccafd7550abda37b78dde8c8c235cb912b83e76a4952ef437d28f3ad19d174ea992601dad1b5f76c1ec980e97e64115980acd425a80a73e1327ef02447cf8319295e4e0077f0d9a99d7033be0183c82d789492aa4271fec7f1b985a9c5194d16b9df7c0eefc00846ffb5126ba06000084699f9bdef90ce79cd510f882e5bde5fcebe7eece867d065a0b7d1c8039472f3acac37051ea0d0cc8c99e1885d68ef8653fc3bff9682dee25e3573477a83d01e6a53529db20f5faa3afa825681332e3d2c0d985775dc2811fe587976b950f5810d01f2332b37446a1e28bc403bdce9035b03e5ee5c450f491d561bb6db2e56d4f3feedecf08c4c15d9f38f0b401fd34566897e55b82f3e135b889579378d8f0b9699f59265a2bd60b1f7d3c803604336cc1725f1f6630aa537c12f5382c07b28c218a522b63234efd1afcd99434056978e1fe2db63bea928926a9525b8366fe83fc1421e68c2fd85f5f08df473428b885e51a6c3b482fbbfbe53b0f9376b24f60e2d454e3086cefeab3a3bf529a4ae408fab18d75ed1c17aa2f9c68d757e11965d937d05fdce759133ff3dc490af2eeb74a9aa81e6d254edfc385e05a47bc78f39aa992090d3007c1a56155130db5128cb23cebedec54eb45e816fb0d7b6856e6b25a8be367871d5377c169f0eed7ad95f56358392957da2d0721f978f09d75a322760bec300b5e4ad8852d820bfd032788b8049e46e6b006c47b98fed033fcbca79858237d922bcd1cf04591d91d18247bf371942a077ef1562c60df80f653b3319c1d8830d5f5922021ac99e703137a70eb4a8a9aebcb0f9b388a5066ceee1a7a5edae6394d70f3357d9f75364fd2bf72c3f69c75a5a2e4f3ff10dd5489e4fd06afbcf7e0beff068183ba0bc17cadc27e59fc8586b6139c29db24b63069f0200216dec9260195c4fd8da2cd4eadb616b07134f048915dd8ba618f68854b4ed3ab16344ff6d6f1966e4e822549b107c52e8b3fd5dad9b79a34a23f393be0dc1c2ab6b8288c2adf2f9f6b6ad70f4625388fa46fc6bd2294d928cf2e589c55f1b905202b5f92c0b71c2b83a7c6d925d200bf1137d25de3b14f67dead27c6bd56011f118199e04ec12e9fe9e2f24ec3eec580da7e638c700e891ea7516849e97f8ad7d14113b8d7e26f7ad0b666fc1c02d9da7d0ed9afbab993c47d9bb01b9becdedb12f2726ea690bfb71f1414675441f271f25cb7dd20c82712cfed56141e3b6403d5bf720f23177cc9a3e70e44ae5fe5648e3e05e2e3cf5993716717dc8a11c896987d4044bc12dd7289c929778b60f5c349194b2333ed31393ec634eb52e44817c8b9ccd1388fa81d32a91b42c094a3726c4163c31ce743f09d1947f41e998f5bec8380206a0359f3945b40f41e8ec14f9e6fbccde47b6ac4996e3a71a88c86e99d64ca7023ccf42a769f52a8498aba29adab5c630f4b7d8d62cf751a32ec0bdad46dcf232933fb37f53ce765ed64d3c1f0c7fa706d668a38dfafd2cc87307a7520d5b6d4e0b0fbe2decefb01cbeca5f5d8a560cb4132ed3082ff9d5d092bafe6da3feefc3f0342606866ae0c6542af9025ca96c0c2636aa8d768e0f11d4d4dff23c647162e649e5c7f571f3d60c6703344b5cd0b6fc6e524de27ab4789282b034f51a0e08d1de1cca7f65a63990d9deebc2206e93aace792027189ff6cc76a41c7f8eb6fb827d09e1be95ad771e4db736bc73f498a464648dcae27ea662346765ccc2fd47a6d680fc35427e5f8171305b1e04f1ea9c0e5c38ca1bdec55f8a3d45a2a9ee4ed7ee460348db4f254dbc25c4f9a2ab7d0bb746946081da7d339c56b86b08fcfa7c0420fc2d6670b96cc4fb30a336cb23c61be0f916fec7049ceee68b4fd808ea7ef128133871fcf67f4181f7caff33d0e82e66d6c6a2cdc29fcd68e5bb5897232c13c20f68b9ceb825a2bc4e526f22c5c98740fe2e19e63ec356aac912531977e041ff713769bef5177986db29b86ef62f7fa0ab51e6c5c9d8f64773aba4db733e9d1122b23ea5e11bfc1d6d501aa4f811afbe219ca5eda5b4051c6b494d1412ef999c16aac78a336317ecb502c5c4ca69b46b4abffc8e96d6d9b05938eedd49a56f4335d05a7ec965736ce686d3f527e9647cbd64921c1b484b3201cfd11c66c2f4218670396e757ae8bf7c84ec754b73e5a2854cd3b77e62c0da50e261defd62029d797e3b1227c13c161ec24be65c5c7aa4e53e860374a4f76e9f1f8e00a1afbce6cbc2a63d01597b459d6f08f00878d6b76e212e52cc34223458d2ed09f3f3b0fb0382677b9c50c5061bed89383fc4a922da75a2243fb71d8e481dd17b78c078e86cc7366615c8e3009275e6aca78f4a6caaf5544fe29cc5ecb38396e0d57194b8cbbc1c09f3750add2fa8b9ef5ef1c9a7989bf73292e3b377813f26c5c42019727a7438aceab47948cc44994bf7e65894bd9aa9d18d76152e34d81eb902de46591d04d648bf93c19cc4c147e1a59287fad3af269e3ae8df3728c4fac359df7353574890c2641b2cd476352dc02a6c3eeb166fddd0f8d25b767e0d7164536fb23ba833568183777cec3e98848f8e44fc7adcf820f03aac1e80ca3fe3e70fc382f8df69c1da3dc591ceec50d201b3d27fbdef3708116d33f3e262580d31fde513e2f103712ef1f53143ce9e73052654b0f71c697f0a8a8ebd1fded965c689b7c3d22824f09bcebd2e71fe2757271fcb27a374b380fc228f50fb8afbafb166b88240555135b9d3ccb1041cc6a9002bf4c11dcac2117be80ac3a52a657b67ef41034b5b54505ce373e90e13cbe319364b5a72a081b776589bd925ec6207b31d0325b4776892aed24e2603b7645054206baf7f57e722ccdf3e8a4b027f4e8ce20d090252dbbd13f232f4eb9b01baa2beb979803bc1201b9c2be796ddc38868a0da7355a38f9787aa47b48cad119f62109d7f354b501de37f5daccbdc6c7d2954c3d25f0b4012ad0584f767bd975a80ed8d4ea2bb7431f70388fbc30bc2bb3d9fa60d6658c736a13c0231050aeb5f74ba73851817d0544f639cd6dcdc4dcc1c651e155e63cf4e2187aa4ff5290e725d3e970e109637f32e6499d86b0b78d7c27ee6196b3a65fbef1be223a32f54a10f26d0a11e6086fd76b4e6e8c4ddb4edbd8a541943c1209d5f431df30754cb8ecbf2a04ce09b1d20c9110efcb2a82536be5b4a325811f97fae2e04eddf4c943839fe622fc71512cf4f313fd1a67a6a6cceb39ce56ecb54656352cd547723c080891f751a5a1a68fa5abf79697fc36cd1e64d30475c5c81cf2d59091e912fcbd56fb0e1122b91812d59bb9a0e61ca23278dc411628132e39e81f8dda2a77e06abd465c8eead90eac91a371cc5a679b312d5af53abe89bf8e7c9e729c2d22be75ab67d432b150374816d9bccf9aa3fef635ff5064e79f6db8bba33fba7c3657108d526c646a67357164738875bb8961c3a73c6ff2c7446599b995d4e5517fc938c1ff98fe48f9535edca4c677b4cb21b130137cfb917f5941bf9916d3e4b1bef048ccf7c3699fade2832f03269c2473f5d26a6288e8ad049f6ae47dbdf659584707fe6639e0f6b2f79c21b79a9c026aa206f78af43bf4b94163df9a30a75a0f1ec3116d23c2eeac7938a8a4d66a16a7dcdc278d94c5bc9f27f536ea9b3892257a611ea2332d0f616d1ccf3a64984a81206fe92cda94ca6579f83f4934bc47c34fafa96c3a5fb5b0589f65d947d2811081a389a9e16fe1978b07fce47fb582f29b94590c0eac76731559cd0bc9d82efadcc109066b4af976a944630b8d526fa06217c75f2bbc4924599e873cea09a977cf1a9d0a48f5cf5f156301b53f0913fe3027ac47252fb582fa1fd04e4578342c19e42a88c3b338bb0a254e461ab25903fab2c92d85da2364cdb31f97ca4671c5c9c178118287c0c0951ec5fa0b2417a36307ceea73200149db154e3063f668bd6012969b95fb38baabdac3840a011c81f502fb1080a8cbd3fa0b8b5f33bca7d6c86b78c134ab2a21248d51bb47881d4d479e97636ac0eceef76047af7c4c8075c6dd058cb0f992de5289bb68d53be1ecf948fc37b007efc4f196e3fb43c244b54e8c9c7c9efb391f602f0b23c20fcf6dd9809f1e252056951a5767fd9d01601ea22386af82ef8ad869fdfbf9c02116b9e6fc68547d9e224655e6453bc9370f4023ced6e8f492c03cec8dd030f7e6f53da84be1bea4f5b3d7216e323de91b0e34c9db0e22eea0c9b7218a8ad50e85851380eb373f6036a53ff84a9e979903eb4d126d0d229a6f2b2a4ae856b61c53e3a0a7ad6c0bf49702274534122821186ac3adc8343d779fab2600ca4f1a38bde8ce8e443b78ce6222dbe7687f2f15bbb297dfa45140232f2326013da2ce4c11096736daebeb033f919455b2b114dbcb94bff1abdc2814bd6708cd327598dc4cf238844a59e7137fa89c8ef0159e6600d6637ddc9c7b700525b71f70200ae4ed73f3ec3ebf32947ff119a944117f280af2fe500ad9382be4f661cc8b18997051d6c</script>\n  <div class=\"hbe hbe-content\">\n    <div class=\"hbe hbe-input hbe-input-default\">\n      <input class=\"hbe hbe-input-field hbe-input-field-default\" type=\"password\" id=\"hbePass\">\n      <label class=\"hbe hbe-input-label hbe-input-label-default\" for=\"hbePass\">\n        <span class=\"hbe hbe-input-label-content hbe-input-label-content-default\">Hey, password is required here.</span>\n      </label>\n    </div>\n  </div>\n</div>\n<script data-pjax src=\"/lib/hbe.js\"></script><link href=\"/css/hbe.style.css\" rel=\"stylesheet\" type=\"text/css\">",
            "tags": [
                "Hexo",
                "Front Matter",
                "code"
            ]
        },
        {
            "id": "https://enjundu.github.io/shudian/%E6%95%B0%E7%94%B5%E5%AE%9E%E9%AA%8C%E4%B8%80/",
            "url": "https://enjundu.github.io/shudian/%E6%95%B0%E7%94%B5%E5%AE%9E%E9%AA%8C%E4%B8%80/",
            "title": "组合逻辑基础模块",
            "date_published": "2024-07-04T12:17:48.000Z",
            "content_html": "<div class=\"hbe hbe-container\" id=\"hexo-blog-encrypt\" data-wpm=\"Oh, this is an invalid password. Check and try again, please.\" data-whm=\"OOPS, these decrypted content may changed, but you can still have a look.\">\n  <script id=\"hbeData\" type=\"hbeData\" data-hmacdigest=\"660d93cd0b67f42b4ddbb74a1a62190871da8d227f219e04c5a4494f509f8234\">56e217ffdf260fcd20c20879edd7e57f5f5414d966c0642e8cbaa1edde36166b67b5a94234e10c54b4fde62c62de36cba3cc8c6bc1bc8e537e97e2b0d9aa27d011afe8df6a219c34f79caf189c48e813da9bcf151aef1fb6e0f79c17be106a0119f739f49c53496bc565ea3f9255e271a703c7344cbd854854e7531c4ea4d6f890908ac51596d44fc6cdcd65cca61da0ae64806fec8b3dfe433ba9045143658318c581c7967516c945fd17eefc218a8d9fd7826debb295dd5ea8d7421267d38b845862376b62174ae0225345291bddfdc41a2ed9ed33c858225ad8222cbb2bd82ba4e466d9a110920f6fe40783d8c5dd83fb3f6f2b08d3cd2b76a3601b1f47bf0100ffd1f025769e6ac3164d13180db76ba290c346be31eb684704b2ae6b2a0fb0207177bcc9d3be893c8d6393d0c58b384b259317e0ef207970c7c1400cbed8782486910a3123cb3b32bef71481983152b961d8c20c769416f8be15f8caba84bb74f2f6dfc49454cf5ffb195fa7be879a0c21d0a45083ae86b3d55657ae0a84d289b0f9fbd75f660e9410cca9acb41cddbaaacb4ddd1efa27f5095ebe2ae6185f1abd211db64e378588c05ba2cb061a034ce6cc439527c4a07aab88d88534ec7675f89c4cf09612f07377508a10114df471063fe7fbd6f318bcbc3ae0c0634c33bc80999990e6a77fa5478c9a28f59ab4fdf065cbec6fcaf7dcf3708b5b5b25373d1e75168a0f4086682bcb7e8891a48ee918b0034cccdd16042cb00d9da86743de086da1a6a55ce54f3bc72f5bc75f0a7a4f0c1cbcd68067383f7d463bd10260732d93e4d9e62faddde0e45e59be943c6753dcdcb4d383a9fb6d0bebcc78ccfd1b413eb20b66c59bfb049ebe8aa251cce25187bc95062fada508b9201697322c60d78225acb24c5d5374ad764daac65e6cb1d47639bec913e1749e2a96b7c0290e00d27c215771912e74b6a9b786860b57c6d22702fab82b2f7e610fca07dd3a845423806a3f4f6071e17db476db4730ec0b35b9ddca2d22d629f526633a39e6736896de7060c0e2cfac47615333260ba13ff51f85d69154d74069a13bb082b9dbbc223897206f420b18aa61cf2b77e2ae64c30746c3eca77fec548e2b23d477453a18782b07aa7cdb0660fd496382091171e4da9a7f42465acb20b19dd18731ed417e88e591da22af5c16e3ba8f777189a848f1bdd7e04b8c4d354c26827d10cb11754612817fc2ea7bc149fc0545f745476d3baa500b859c2d02af522c688010ad7b4c79563e4dc6f2b72e54f72448da000fac9f39399ed8175f70b7005d8effc8f44d780205ab825d570ad79fce30c91c75540dbe95e7159c6a9c52efb42f2080c4f39223d4b4a014e621495122d58537503a9b0549d58b96e226e9307082b3b65b58e57e24ab2605ff69dcfb3b9bd0d69cb7a45f63966075a3577e5da4c779f6e868343e60f6e63ecfa5e67ae9b3ae8e5095e72e22605b5ae33df65eb062d777194de1c66b2624d1feb09aa6fd289ff8f6975e229b9f72a884594728ea13b87e0fd3aa805142d1a49e0e7d0613a2200f909cf68a4340b742af36e065ff53a59689b7185ade3c961e728700ce6e46495995b596993483507d3e0bd1dc248ca21461824ce84f4532d24aa26db91e8364aece47245b8665f2cc2241afb2e05e5735a8a337269f1d9d09ff6aac34164fc5bf2f95f523100124a6f5f736d16ef70feed11972241168e6fcba49046fa7ecebf91ac3cbab73d2dac10c3d0f9d694e51e82db785a430e8a59fbbe9c54838e7571d74e983558b77401c138f3b459cd55b6b87bc0905207a7473e72089ec935045dae60a9972fe9dda57b192b0735336acc58e744118f1ffca434435ffdcae4e189832798464f9493c6324ba7cff5f00de8214f28f844c23bb7d0dfe968b574f78519295a32fca9cf5636d41157a402676fec203f703a59a31e5966548dc20cb80f41f9aa81fb4c6bf5f7b69f61b622c2a96f8ab8712ff9e3a66e03da33dabaf53a43c3bebc645fe199cfde3d78d654dcce75c00fbea6631c403ad5b6f91408eccff381ee8b626f3037e09b86375b438b15d22e4085953a8d0fe2436d460505b845a26b946fbb182ac6c4ba7debd5385d9afe55ca0baea4f4d71935bfd2d3b585c3414a20c4e6a0174d45f7a1c9f524313276c283bc670e3371e9dc3cad9d9cdebc53c2b0625fcd0968387f5175fbf1819f7b869e4f57386910370cfbfbf70dc1a4818b0a76ad9b1febc8564a90669e6da58e4576b23f08ddf998211cb018ed08bbaecd7dff741879304fe6469cce6b9a7db3c58c5c37ac4262a07eb9441efcff4305ac4b7b04bb9cd31b15c3679450ddc87696f49081c669f6db2850ad9f9e66802a375da874dc9c24fd4f857023984fcf45b9240cf3940130e0dc01ee4273097dfb522f29a7650451c5151aff9e8f1d3ad02fbd19d94df0b25ee62aeaa920b207efe8fce6f24f8167d4caa4a2b6029e7b3c31d14648b26663f2af12d7af02f6305e2f5eadd60d2d03d863df3c64d7f2a6253bff6a6bf843b7711ba03a40cf38ea85d6b2e4216175a4d57a5b17771598fb655d76ce4c17e1b39371e7dcead060464091fc96a34e05b2f943a3fcfabe631b91ce877c1a8d6b938d6a871aac1ad17543af16a1e045c59f999adcb501b8c555484ba70bd9fa0331d5066a312868422c438c800e57ce77144c6ed82e9ca09e7a7dff03fbf39271fb50a85d08dfdb89be1bfd8017288cead2b4db5378265b90e054661458b1df64da61b9c7f064654723f9bedba1a201f688c33180492d54010398d9f67228fb74dd4f97a7e846f2dafb120e0e5f767ee6d0095aa3bb19b4baab271c32f01dc33dfe1f920395b4fbde1103d94d9f1bcf22bb55bfbebb5c1425638375dbf6aa38628185d449d285bea7353356ebf170c068e41e50ae6452696a6dfa425d0601c202b5426d8bed387f9ae4a7ffdc042945c9cea7620d6771ab4f4c6c59df2bff5b9626f26fdd05cbd6de1a26f3c7525c1bfe51eed92893fa73b32f6d013cff7484d2d7a3cf457d677b3071a60d39f30ec70a9f152f6055bac76ac74d0745565548c6c4cc3e38fe9dfb616cb514ff72100a6f6bd9a2d963a557c635a938a2e680409beda3f0074f4dcc26d0fc0f390e6141d01be19a6b2055e1130d21d5d0b36daee54beb685b8561d0c8bfe75f657a82f87acc0b2d22813fb3cc3d8de3bc5a6265ac4786aac254cac110a7efb1da5cada0ba469a163801a0e7c96970b2c5305312af9a925d15a2e0e0956263c87f37b6d78280c5d4a241a753232d8079e41baa639bbbcb76d2447d2b2ef583680d07bc7dc3eeef56adfa3028e9833ed9760364d83f6c3c1e01bdfd910a12dd030b5e2e658c9e308b64b5b4dff209fa1d74f9bde56225de38601bbe526b2c6b79fa23ec42500f3c01473f21b9091f90a5100390a3c591395a02089a41ca292d223f0210dce08ed0f1f9cc9140c35716f0548d0c6234d85cadafb8cce2f76777cfcb86ef774ca6e3e0e78d60ca65c3ab2a267d8d051feeff46a0a0d5aa1bd80aa641336c46bc8128391ff700bca7609daf036256b64cf4fb21abacae3dd8a938cd2cb23b02e62d5099378d6319a0d86fef8a5302bf3d82d98f05246cdb8f4cdca6898de5030d0a5f1ad5dd77927128d94d352fc9dfe43c1b4d7234900f8a273c0acb63ceed3e47b5a4c3d4b30896ccd914c7a0e0e40d99180a42360c68c19f1ae5079ad66a5a2b89231201ffc8ef99660856a3e0059074fa9301e27ebbdb26b5adad79d0503b3add60fbf51288d66cd3e667ca6e1692e1d0fad0e5defc254b23b528c6f2138d5f4217b0f6cdbc2355bbd7fe22410e015eaafb6c682a9094b6a454b2a09dad4fa2d2f040df82e6796208843320107a1a159274db2a073f2369472d63f1a2220adaf21643d3d11e0f443726788b5f3562b592e718c9403ba1524eef079856edd55af31148198d352cfbd3725e7f28a693cd3a00a14c9ce40ae587451bb8b90da6e1dda0d17966b50b43a9d5add37aff744a023dc8514e73b12a917bb5f8620cbbba0894d21bb210b0fc26a2ec6f10ff0367281812e6779674b523e292ffb3614bcdef9230133acfce3c4f23b7516139b4c7087c16a96e29c6ac87cdeb5553b1cf1a0539e527729944c543acde227620f833942f384be2f91b81c6890e6404afd616a4d39d2e50cdafe3e569e41719e3c54d8bf8fe3ca25983c5e0aea4e51556c800d59692852c5e9540cefdc0e34eb80931e82633499120aa1bf0238e3be51ebd4c244d8027f9d08213d0078d69344d36ed94439c20e393e4fa77e44f22e25fea8220e9ffd645e5688835b37e32372d443f80515f20ad08a2a782c57a3649afb9fd033d1ce8d889ff0a79646aff463d7d9a5d3a38fa21fbcc397ae2060ff508bae74753b2f19fcdc1811bfa141919627cf23e22654ac54e92a455e932e361c133d8b1289b3f3aadd95211ab8b750760c1a30ac72b9598998b6b8d228fdf1b129d1c4af12335adae0159be33a680c694f70330b71ab393d1fd4e822c3f6e72a008d9e88ae9a783f6ca3550e265f009a83cac56708f04424247bbd2fb17542dee1a31b6845c95a5586cafc828c302712344c82430af53764dd4b65e9d95bfa0371c9e24a4134bcd09c1d79605f39def6f56ce0f3a798e8cfcf3903bca96d07e8fe6dc0478ef39444ebf06d797d9211d5907acd29bcd0a705e6222cc13d77480f94113596940bf77a21b199df94a4cfafb2fe2205292458926994527026c27f2ad2eba8d0a43bd5347adc3c9af649a999918286645db3755375909ebbb7b7bee43fd33d91ac490c0ecf0227016b5d902899583e28460847ae0d85aa8f94ba243f6d5b5780438c5c0e9ea445411cadb3d9b224eb8f1b25b1a2823332072a3fae327097dd4033a57aa7102667e8d67ec883380120f777941ee84259ae4129fddfedb1c14c78f19a6937990789ac1c531889174df4db0652e5fc7434f4e66fa37a59b860ef5469d82f870464cf6b36a15574f4aab011558417c9fae9efa96296de817b9b7bf614fc4b214417adacb8352a37d1cdb0fa71589c065ba2437eb70ea166c3a9ccec589d767921abd30f1ac969e3047d14fc84e6af37cdcbdcc569e337b8cdda45a99c64806e394f552968dca0c4c8a99d790caa87f799e48f9c2d11bd6c9c8aa8ad806c814830af7c3596c162063fbeb2adfd24424d05d13c24fe6e656f84fdc9dde9d77c9ef7d45eb94225008e7cce5222b127422fa27fa349ce73215425c02d2c8b5a11840f529719035e417b6da6f97565bcc4a08098442c5057ee85a5b1a0d27727b7736ba5a315fb2f211cac102fd9e05281ab8af7f23888fb55836608869d9b5842fd5807c1393baa827afa3d4d49b9f98c8d71b884b0c9287f873b2a586c876fc133945dc6f932b2552cbf6f499c35f14d1fcf2fedb017052b506c95148ec8b86ba748349a9fff47f927f325a4e6576336b5e6c96f8a385b09979dba77bf1bd3f3825c07be2398b41d66b6b03e64f94b3002dd74063baea4f3757b77712678cd6cb812091aaada79a98c6dde5c693823ce46bd24dd3983c8d8dac1ebfbbd476c2fd0f4831e7e939b857d05fa982ff9be9cb82b0692ea7af04f864ed1bc0ff2606d885216d232bbd5a3708f40276f5cadb4bf324f76928132ff7d2bba28b2625139ef0a3bc02d9390eb29383cfc5d0a9a8c35f96eed2717cffce06135319e36debc1c61719e7a2ad81a789b20e8e3e836b8ea8ecfafcc88a94a6f079f1203a7442b3205dcb50346253971f848e8e6edc99c9cae5549bd89111e1ff668ac94670dd11db9f343643be9608e707239c62d189aa5a0d6897e6efccc6ab75153bafc8934bd0438bd1d7929668c270806a0adf24c73e3e200f7724b899437fed09e6be439a5004abc0ab98811a7a622564f7422a480aa965d4195eb4470a4d95a4eb107413341a79152b33203dd0e92ed383f76a8413752d9efcffb6d37d1e32085d3f0e69e335bdb7a447d94f6db8e5cd10e032c445e0f96095d69104f1aff14cb57de6cc2528e43d71a4f63b00fd126ef142df91168ffe270ee25c2261dc111f4625fdf59c42bcc2e127c881388b98640f6667e602fa9eedab7df4d18b198967a199c1479c69d6c0eb23b35ca629c75bedb3e369c7decb753f46ea893c57a44359a52a9533f40ae45d0e2c9876f7f56d2f3d5bbd0806dcf7a9fc1572ae7fe3ff081de562e4d82331b7ddca95477925b52fc04dc6a88430503528548496ec6165ec8ca905eb12088d9c129c4ac95b2e35c58c77c01015ddfb075c64e3d12443843bbcddcadab8d20e8487ac59f5ebf415d51292fb8f877c1829cc1dc10add22f2870e4926a7eae18c101a70357495749ee8bd152938ef1f390d0512c1ec497d96ad66502d4aa56083097c7eccc234d29c20a07e920f72cc32f64ab8d02ac246ef2915e177ab0a751678721b3a4b77d12f1d86c4cd753732b9ee0a187a344830bc5d9b912e1fd63cf236966200c9f959688a2b61263e1c5ce61dcbf8ebdc2be4dc2219d8c3d50f012c42acd6d7d7d950c71d7e440179b963c775b427981deda81592d88acb55ed272a431fdbb36d430c5ac221af7bfc4b9b56851cb009e830a3d48f214b609247d0587f6fd1c83443c0a814fd44ac863a9f6fc2f3c4039d950a7c2a2662180bbea30492b5b724c9114ef654bda5bcbc45ce8e6616ff5338bf7d40530217ea0d73e04a213a287de59e53ce5f7ff4c3e83ce7d770cadf92fa22994570a8085f62a60405b8d08a5035f9b32247012164b6b1fd68ff2b74250f1379e41fef093ab7afd3c7825f22926bf08dd4e3ba60450e6e6528ab2a78fbc497c3f7c00508f58c123c5e56f5ccf1aad7d271c343ca65dc6097a5a02b9c7913cd316da720754988cef50bd3a4996fdded54379cdf30796f7aa5877bc9063b2bcfb0fde0a22f7fef8a6aee718e316efb5726ee3304fbcc142cf9da544eddace1df2382857a1f2fd14db7d11bb332354eabc8da1aebdb9fd4c864182f1fa4fa140fd2ce2f1af1ca70ab13574639ee1dae5daa005ca51520b86d4356f5426713d09bcb5f110604243f590a223d78df305d86d1a0976f067f99348ba6b6a10261cfe67fc23838f27b18b37bb88ce47a1f18de2ac30babe8e09ba88309c2eb0be61426bd2de69a8626bae3e73ce0f43b9c749075f5f28b67b575d1d7a77aca751ec3cf5ef9ad3bf0ae5667cb7c97a1eb4c60e2861e45c6e4956fd6fb3f74443e3de040dc16276015af72108d23c75456810633b1e96aa4602d3775bde9e05eaa567974022a4d22f5e8f0c9b5e1a955e5863e6ee4972537615583a3c76875a915576e79f475920e615c6e268e1f3d6616fdc15abc10af0bf044d615c5d8edc6fb838c2cae652f978c8233cdc6e16a10e32ded060d03d497aafe0c8df217df8ac42dd4b6125371e6677b33d456a38011a1aac5c3e5687960f74f03b699d9f3e0252e73baa86581605bd56803fb350fe3cce76d4ad1195ed74e2b2aae412dd8063a5dae1cae25c7c385c8cd007dfcd9bc465a6fab3de038d2a7291634cfaab6ff29cc12e4f4313445e9f0b27008cf6d688defa7c5b1fb83f4f2e6ba58ce16c667e1b2c9873d0445d32befc5827051009e1fc03aaf415f334006956ad14280d5855c7d981250a48aa96cea6e58586e3a3f7b685a6d585e1d9baae06bd93fc3e3fe7cb3b1647946f4a44b945644b8ba6e9ebd0216e65c13533338585fc64a9c9e47a394b30147318573ac919cc9bc3591ff340956db4105d4d98758016cb1e582dfdd49668b5b744c9ae2f4e6834cc70d6c10eb8873cd1342d8641a5d44b1513876366c5fe248f194d810d004dca40e637835376bc22d39bd842c0096b242cd4f9c0177eeaa0ad4a3804a271eb0a5d11d435559d4016f342cabe693f478591f7981bac9cd26bb73d2b07c3967b052223b8c76fae1c620db98d50403b49d693c2e2a6532dabb591e5aa2c4cadd817f9f3f3b06560723db99d1756efef66a2ea7b59251e83af00a45d63ccbc4dd34f35cfda6087553d9235b9a1e1f1e01c19db3db228250d8b0aafe705f37808628b54bcda974607399599fd8e8636cdd205f9f82870fda0e51f6cc46feff5aebee7d801da87dadc6c97b87b1dc3f3086908a580cbd2bcae397a2bafddea870aa03d74ab84ba5383a0601f0ed0987586b637f0904e7944c9f0ce634c401f71af1e914b34fae7268bcb0ff2bccb2941d3672c37732307ebe7f914b6fc536a9fd9f406d889ab032efc38559a17f01abf3239c0818664bf3ba41aeff189420387279a1779bd35326da408539179562de64deca10d0c4cbac9f9481c9a7c81356fc28a43cd26cc594c6b9e9bec67b790bd0d0fe9f784692b037d647a2bc2349f87ad4f116048f70c482d61a711fa7ff0f7f5511bb7ed78ef926f46c40be2324c3ab14ccf02d09baf95fb19bc823bf2057b8be392220215c4a9d9d92259dda0bf0f2d527d84e38a0ea7df7b626b57b2688e7ee9fa32d91fd6e6820385a8c7b25c47334d7d51a047d121506bd305d89a1d00cda0b359e036caf3c80d3129d3fdd5ddad8f144ffec4a22b4565cf1209e1080a2c1fef7a6b068d045ab139f0ae40ce928588d6f5da1b9a6b04513fcfbe39e2dc7b775513a175e1c52609acbb75d6588e142bea1bbe3c6e472d682475f41845bd813d4d5720a3af7166daf4271cc2683ec465eb422935014ccee3720faf1e07ff64a98418f19f01b22772596fef98930722219fd5a5408a0b6c3f63d34d6727508c8448ebf661968e5aceea237ef63165273a06bd7b2892784adcbb37c704289bb09ae2e02dc3e6f5f1ac3da7c8ee77e0fb1dfb7ffe477773e289abd88eee8f973f46f62d594e6cfc75b28f37cd63202a70d0c528fdb158eeb14889f2cf7dec1fa8dc04b0d22825ad6914ac247197aef77b08cdba99e00177afbf66784e5bbc73caa5d6a99c4c4aa18bdeca7dfa5878fd60b8a102f61438b7da9b9a2399caba59aad1c2e6e5c5720cb54b3dac347c7d7841c9d5c58c5383ac117f7076da24aa34e92e2e512dd5f6fc615e9026fe3d5b933adbbe67af308bf9d02991dccacbca77d4ac27bfd120ae2b3f0f4659436d3ac3f3e9e1b8159f69f7aacb70de523d3f7559816efb0eb6a5df313dc722575710f9e88fe3a8f49c86ee0b62925458753e240614a43dc894f727716ab9b82f4eeadfa572953deaccbbee2ee239d1291517e845465b47f4792fdaf66bf9dc03057afb52982b73bf6f6e5e003e19337e33c208e35890e27eb4fa6043d3edfc0b635b5d6d7e05b5b24c4fe9749de4cd90eed1386c0b11963870f9d776cb8bfb5fdc77d49f62a66c2144ae2227df8f9775305468949e7045249c0881e56a4c43605f14631ea60307d98e2657b279ddcce9486880d89a6873a92e04a26ba0059f81539f68c1631117fd01630edd6dcfb93be8c686c30d98726586980bad7cab1d38dcda33231cb3c312064f32dbf2262d5e85052b95858667221f999171dd33e0151ef08ea32df7e6095515cc538ab765155e0ec47051bd879b6737722dcd66c9082b1baec44153f7b88f018d0136d10f82a500996b9015491e06d0d75a8d5ac82e3f936dd29e2ddc847047bec1a0149e935be7633fe152cbfe0182f64e7060532abb77de4b94558620253f1857b723edc3593936f3b773285c3441b67b077725792c28ce663a5cc210489ead5933b25de11fdc5739f3628efffdd843b38f26a48f677948b9ad08954b43037196f60c1545d046d9cccb50a8b101973da7480870c2b801d201170f47e442a14761eeed0b5ac578dbc58c2f4b9fa8776ed1b3739c3ac3f4c5c80dfe9bfd16f10616af3227599480acb1f3a2670eb0ec1f1dd3027eaf0c80d521277bce1e0305db9c8be345f66d73d479bd0e95f871acc1aeb011d4cf9b7b1343ffeca4feca190aac7dcaeee36f8e8b9b5808fa85401a68107451e6a3a90992d92e216bf081539144d6938bd6b992497844d6ca29c8f386edfa5508aefc87109c82888bec1ecc7be5b7a1bd923069d289e0aa63cb91daa63b02ffa403f5e9b38d093207259f6a2168e6090cf717d0c912125a8e89529682901586fb33ddcef45de0d1b2bdee4eeceeafed0764238a86f73d09f6096f0194b770289054e57e42aaa5ae42d938488ed5f532abb011afbfe425143a15eddb17ee7ba442c4811e64b0fbd1c20353307f7399ca4e72c2cd05ab60ed74265281b9c833e273145d3853ff1f2e9508eca9bccf5052b9b7115aac284f2994f3c367133727346e23bda779339263cf0b281601c509d72e4078d0e878e471ace9134f1c26f4fe89223530dc0c61dd71a882e49801bacc23cfef05a25935f6e741b85dbdfa5209dbf93bb62a365b39c083e7e35531559da4a13c284cb296b5d047d6bcee725f82aa69c7bdff521945ea94ddc0b9a8a3824354c3229b423b0e7bcc0754ae9451bc12e9349f2a4408be7553527ebf4b0f68d4e8a8544223d03a0da3051511e5645b869abd82162d918b2e7715cd599fe47c10b1a4e3677212979a87078079d81fcd559f4a584c5075b4df98d67a001d5d4a2957649d094c73ace2192c463e16d3ee9f2fa6425f077638948de5e23f01ae40f281d4b3767532156f220f4516ae21f8dcb3ef2aaabe814180d99d3408ac9a9ae87106c04e7eec3aabbaad93e83d7a9e68ae527fc0eb42bf915db62426223cebb563596bf0ee4abf2c13d21d0e90ecb365002fc2fde174f317ea5a98615dbdae84787923103bda8080f4642bd764441940b4510f545539a1a068dd43ba5f7b6ad79a160701a8259640c5043b87f95961effaf445ab3cbf38dba5125982ecb2260854c248e8ab8f0e7f1ae61658c4ead34149850402538c91f3f20a77697d6c82a52f15e9829e4630e29936919b052c4010fc22b53585f4dc490624f279fea628ff1406ed645e898f27716913b669b9d9f37db251969c9c84bc73930396ff9374a04138d2cca3909d0a9c7db3220c55b7ec2e3bc9fcab9375ae51ba2ee894e32c65bdf3e8de9512b5fcb9f5d768b392246ac8f7e510745b5640241cf435cfc4ecf0ef759bdfd461d12ad7d997ee09a62f59a794451b2360e520ac68d10022408b647b53cb77dd43a9a00619724e8f427fe593c47d24f1a8e51b244765b2e1f202472d691ddb00ad9dfd1a6fe006e8fd9c5425c18071d407483095b7e281d3b2bd1fd886d71288b04f4d5e03583e43dbcf2b560799299b09014611beb03b1a6c8986e725bd037d2d8313c6897658bcf06f90148ff5c617b18cda8cb9b39ad34e347e7fc4469eee9fcbd3db70b8bcd425f5a3b03fe83d0d40167fcd820fb8afe1fe0ac7c424103b9f627413b2ce23f32c16177054654ced8f4b1f91532cde550f6713b4b8f71b29f53915081e9d7099fda6f04f8285ddf61c305346eebbbe925a285d446576dd5bff653f24baec2c5c4bf686f81f2f895d1797e12a23cdf84d3ead99ed29ebf7474210b554a7407ab3c76a0f856f4980baf0ad371b394a04886f232f719e9dc61625deaa3e2feebcdadd5433ef04059712e39e7a65c33639267dcb02d82453c080c3ffbb7158afa1de73928451211f1826602e77f924b86553c247de798ccf54d0e8bbd1cecfaea24d09cc90c781c4ff131b0f4bd04b681df27fba5f1446363525226cfffca3ab987a604c63a1d640fd8ed913029c3365f3a84f9272f97a0843af6be52ee19ec3510aa48cef0780771d534e5aceddbc106a76a6f12296b94187ee21f1037b051e7716a7647c492e94416ed97a54554cd51aa065bd1e5a2191e95de020bcc41988295a17b21f89850b2c79250fe0939975868d836bb5676d18ff2c4fd6b9a0ae3385de09f9ba0f191b60729302d02a1839c2f2449ba368e79a9a8960f76e588735182d4be1cf24eb216db71136ca060a3f1de8a2d7479b2681b0a80fc5b05cf8a5e088d3a9cb180fa5b8dc88685982c9efe602de123c77c40a9b0d1b8b86a36f76d30aac0f0780b187a76e9627bd39309ba191d8162a06d654890541d1b753014bfc7167fdd874ed99320e83da5f318b381bcb62a47f170d3413e154fe2b73197234e968ed98aecf7342a1aae79fcd1f49bbfc27001d3e0cc10ed14fbf427edadf9d51728866793192a46f8fd66bbf803c10c4053d1e5d8a83a1042bd40196783ccc368f37a3933de7e47dcc8b511fe139cb86a361551b61c17da517390db6ea68b4e554659f1377225860c4885b08f928966d3190ee9fe1fa38a426c6e1701d43d2c9eca7de8ecfd294fca53329739640ad1f00438e17a99a26d2ca57a69dc7a8150d6b491fbfa63141292f8b27a9ac9e19dae8632c75e15be6d33f8a8a86b25360bfbf2b28bfdefff813f3b79e6023f271c8f75dd4bf5cfe7f7164b6f5482141b5d1a8031dfa8e3204bd45aa8efadbe01ada8f1715a5f01aeeb2aa76523d0a7cfe81095480e3f6cc680da5a5b379f69ff5fdf04eacfe59fdddd9749282a6f69a867745965d7c83308915d69cf659d3e0f42e582085a8c3b50e5cfdfb3f6762fcd22b5aa3696b1eb6bf25de2e8712c2977f03d5b85d81dbb9629b10ac685c5c641cd2b25c945b653e69d334ac54e8206e842a18ee893f52443858ec2138a9a30a91981113a321ea302a8a939e3b23b5cb8a1bc326d0777542f12bc6366df16dd9cbbfff58be70bc4f9b60f3467c135b4694d056073c0284cb619fd12c3c6d04e3bd2cd4163c79dc35ffab977101474488665635aa37a8a48d9ed6a077eaf80df17c13433a435950f80a0b52a2c28827018de5cf5ff94d65517986fe1c65336bdfe2224c650bd9401e1a4b40d32b7f12f005d39f95e18e29b9227547ee2bde31f57cb19680327bd9617101608d4fb574e81d5c90ceeb0f909072d5255632a3cf81ddaaa00f909d1db35e7e52d782cf196bdea59f483435b1fc74e26e9964290a3cf9ccf7d2cf104a3e2fadfc73d4977f5376a8aa35e76923e4fb749313d52194855351b24eb31a8f8779269e7dcde95d4a93dc7945e8646481bbe4dc0a2047d57392d63005cd07ad8e76280105ba6ec5997c3f656c55500fe7ac403a40fc8404cf0cd4e545315057b5e65e23e7601b554f9686f87cd271eed64c4a2e578671d3ebd3cca7f39476b2143f1d7a28260b27fb86222edff9f08261c1a078b7bcaab0e10154323f8b298ee32a376874251ad3f05d3bfdfc3aa9c58c67da042d02532e31f1f2ebbec1d5dd147ac055fbdd17c4d1d65a63f0773666e5a98d5c6ab3e00a2aa28b8803621f53e90eddde86a579ebbee089e72d3f166dc5ec5b4f5d7307e22773579158e199628f585909a29cc5e447e9fa0a5e21f9792e6ef6d906a97ac7ede4533c424f6fc3ebee55c90f981c4bbc194c76598aae3c311d8055f9df52de055205ceb7cea0cf36d926e7a8b9b4d7ccaa0bcc18485295673782f8eb80597bc5b68dd496bf33c32b05279df6826ef51daa126ab1ced9348cbae6b2b87d0e4b803064b9892e9abf28b4df14e79c0642040748fa8cd2cb7a72d61d06bc0a849f420622e2444f60ac0626f139e0c8409029852520cd791bbecfd1dff2f39e634b4789766c657652978a83a35a0765401885eee8d053d465aefde92ea5612eb28d7e7e3d2cd1cda902d4d2e576adf9667ab3bc4b7b5fb455de00e834e4cf85d5c9c61d75f1ac6a0012589bfd8cc5025040b300c8315c47229d349f6ae4f2f3bc8c523a01fc9d17e2e454a787825ae3726ad3d39a835740f5fda08ac3beaa604d7e3526926ba0e03071bb21de4eefb9a9ffe1e325d433e6c0fc6bbc99f5c59f960d561383916173e085c1988b0a06cb3ddacbafadeb484ea6e68f4a8bb6665bddb7ae2e43772508fd61f745d4b9ba1b066a7744931a24d7dd91a5d325b906d477ca8755911e3940fc9b4e962a9204d2079f7c53015376c79ae015c138cb9e3e0746bcb4838f35bd09b28fde9e761bd4a7f941955f80d86a11baee76870c48900a2c86003ab88b41ae88e386456a7e2e2c5625fab6540b975c83955d6b0db761818d06dad6e2820db619745948798e8f3d510763ec1ca441210ad67049429ef411c0dafc42cb019e287e91ef05bf9e0dd6e8ceaa6f1c33515ade2e9ad8f8fc7700e59e0b73dc8a0607d06ba7273867a8845e1816822459bc52c2bf78556da6cc19c640a712d6b6feb1f4d2d2c1a08e3ad2b80e9afef17d988e3d6cefafc094de5be5f90df37718069d053f3afd7cc669cf7747101913ad58749b950ae57895557bca971724bf6170dd6b8b815c002bccd31e6fb145c6fc186338c588a3a04630c6b057f2fe86d63b6144ce5d65cd1d582a75143eeda3b427ff96f729a04920f9cd05bfb0419d18ddff83de2d174e66c6df5d2c5bff8450ae7e8ab2b4117b4d9e9d12b4f7a0c05d1b275674b64841f5e957ec2d00af820bc43cfee4d8ea29a9c9267cb37fac238447e4b3ecf468679af93779ac5929ab07c116f5174f91ac6dd9a7229912bcf4bc015301aed0853af2bfb19e674f2a6a2530a8ef868a2ab085e6d3901836668a737231b10662b6670e7c1e267d9ca8fc8442db2b382d88ad36c317e1a5f58212f740a4137c9afb956b4f12850ee268880c5ea132c539e485107d4d317e5d5c15cb8eb9eb0fddf155329b9996c7c0428eaa78be0394b6c8a0b8771037c1740f6c8ef9033565e8ecbcf0ca110fb25334b88964e5d538cc0b67c62c99c7eafff796f0c4869b57d11bcda7d1a7c2ef22afa5a44e45a7c33212013a2ff175147373f8bb9344ccf09a213949f62e818559245bf3632037097bbfcf4ff8c24fe8cf1ef909d7cf361e840a280343e1aa2f75b83ab807c7f5572057a3833ab34c3a0ff5cd728bb243938fd50ad5c49ec02fb8a0e584668830f76e3a2c1b749b53612d271f3dd17a269a651feabff4383c5b058298d6720120aaca32d13acd15f6ebfa1b276d9b8043c701b4542cdace448e813e04564970a9bc71f7754f203f635673f1df82e3ef7b0c217891af7925c95677a74e68578a0da3ccfe79ea58de666c092f0b9f3a4448dd19f8cb5399806655b2f9dadc418bd18cfde7e9826019f6404b7da6c68b413ed12cf8008d74d72ff97ef0c3c7f68609247906cc7979cb57efda6372cb08582309906b9fa4c13b345a5e737f65514120691f49e48143a58715b306451dfbb4ef98f87df4079444e4e87a52960afa04c0512995d32712c3699c85333f29e88c3d80a2ff12fb8ea27d2e2a2b755788cf85865f998f8a8b57288093f6d73fa20b007c583dbfd43e96a55b963bbc13520409f36d4511952010906091dbc12f41ecc73655c66dbfb09f32bf42dedf2c81ff74d5affad21e58c076331d5903420344a65dea010ace5a5ce699454d68b4522a29cf96a96a6feaf20b2da52719139189368837bae68c55d5fb4236c71f3e933bec7ecb7d3a90b391b11ae9438d636da1dab2490335d533f3eaf785be2037b3662ac5c28cd1e1f13bec2cc8bc17f25d9009ea8bbae2e36a58b782d272f865ecca798c89acd4262563c41a634c53646734bb539440c26db36934d89a72ca26eac67f8f68330d2103b8017b2aad72e10ca8c32c33894e14bf7bcb9efe431fa9f2c40db19da5b5b3084acddb09b5b336887733ba57a7872184c20555f9630c5049e3a31b77a7c38f2839301976af9189b4f09d7d1b75947f317024582207d1f711379ef552be2c841d5a20c3034cf711a6fc6ab29aa824f3a4420d528de4ade505ce9dbd1078a97ddf55e9cfb8760c811ecd6d33a52b909546db03facecce65f63615fdeaa72a9a51f3f1f4351dd359bf0a01f142f720a1c63633cffaafda3d5da39e65eab4092de29b22ac00770a8a26442b65f81c4768d3cd4783d21d7b764e22b6e8f9064ae59cb52818adf0f2a245d4bc655984ece24bd65e56f5151c185d2f06cefc7c4569cc2adfaa4341032f3201b537b4e163070b03c3166357462ef8d08ea35a6c39bf4106ae991266049a17b0929a2f2908225c898ec8a4a630924e8d2a8193fc8b7bb6957c638bfd37594081bba874b0e92776f79e499e237e677cbe0a0734a3a13fd288a2da3a94fb3b09df4d75e5f2398d83054fc0ff1256689d5f7eb434a5192f94c374f840738427e7088971cfa9f144a5e2d796a9792f4ab593db8dab0708b59c955d320d636bf33ab1e061eb6173304661ed359619e1a873c7d8cddd37be67d27d2f48f4535ab313976784cc15cfc649e849cf014d78fdeaf4157c79875323f052b5020ab6d5682e29c9def783157cbb36f3d456b0cac4c27ab07eedd272fd410ca2fc77b0d2bf8928f4d4ccbc36192e63a224f6844d1e0c203be6d6fd3cdd73d5094433bba3918d1dd4f605a658cc6801dabb00adf7fc0ad61842e1bb5497a26832bb2d59dd9cbe6cc34c1ce64231350035e984e3495bbafe6c3993c3f59605cc0573ef450df9be3b1c676d2ef40bff92229eb20c783c6b2acdfb085c38b2d0d39328ba42afd624c9d2994542b61833f65b4ff264f9dab08865482c53a9fb038db0926072250afde6a7fffddd0b2a58b865d045740a8693f781a88ec6a383aed45bd6013ac42f13e80592d67bb81406fcf2bdb17c2f6e109abd4c3c0d4f042d77938bc5bff5caad415b1c78c01c3d45f71fc1c2562064f422b55bad412d739c3ce1d24c1b1caf06bed2f3d90d7864376b92aa0e7416dd86575c2ac143eedb903dfa164ee8e03376366a1a52c050bbdcbe3548e1dd7eee12123e1af955afa7c8a32b3b35b53481627c9ebdaa4856dd8551f0f2c996e252294f2615a5dfeaa31347cbea409d4c460e137aecdec2b65ce2630ec87630b3b3192a588a86b4c03d943f5967a660d6bdf06da67e0650c86ac3a8d03ec0e572a43f53aa803b3d0f0c85fa6cab950d2c957a69e3cb766ba188c9b5ee90a0b6f613290b05c3b3cd2827bad6bb76856609c364f60b19aac7fea459e5b78b4e8a22291b87cba083d9c0cebaf0c2a58842b229d6a3ab43ce91e6937c7ec85bf155a1f5512f2955beb168268e80603314e253b0c1fe872c73d8889aaf257cde940372947a98ff6ea5592456a04f13dc73208d4ea8cf0c7dfe07ca7a0bdc71ffe1fd8841c4ec0db06321219efe5a74789d3a6dc4a41e10ba18792742ff7a63c5ddfe4c19bbac7e4b1d13949e9aaae9b8013b1658db30a423f38dc2ec827f48ccc0afd408ecdcfb9035395216ee27a09d05f15b09b504b826d0720ee4cdf2266cb84dac40e80af2fd4e8697e8d16e8dd67c2e45b8de152950991d79be13651898265e3d2ffd37cc6e7b1fb9a545ab02ebc264565dfb2644e51f9950709b24d44e09c450e2e8a63d8a3a258f535ebda0e86e8284198f2c0c1605e7046ec7d6d687cc80d2176091e46da6f3c7c004da58dabc8d1db71ed1454ac6b7a0f79d3032d875856f7a4ee6035d690e590d2dba39198ba35a6a1fccc355fdb3ed1d29e6a7a270307929e18426e4c4ef0afe01b0b0cfbf818fcfd10e95c915dc91ee0efe828be49f5b862db6de857a6d02a782dcce0baf4ad366618eb370e68e5e0654be55443ae5b7ea80a1615aab5bdfb5360433d03e39bce5521ed907fefa6bf39f9f8e407fbae9d83a344441ef29fe6afede68dd5ec16d0388f25f52819bdab822611ee7aaffb7e2ae5b8c550715e7e0a5ccc445e257295bb58e9ecf63630f5ed9da2ce34711274817c3c5b1cc47ceeb1b63ab3939f8e23500ca1e0378ec798eefbd2cd7d2b35b30559b483791c7cd6806deea9029d7766975e9dd7325276abea5bc2beb5898c3848923139ebcdd5ee6b378681a44b862722a3d2d5a78352825b94c95674c2250873d184d8a83469f07ec4cae9ecdab89aefcab81c7b844f7aa0da6c95007f261c194cb8c7597a18134cf3b62917f23249b77241738682fc086172ab92ff5f2101a8e4754b6f0fbe7df36bd60b79b633ffabfff485a6c48a55fac3d184127ce3e820121feb87f30070e1b094035e1e8d21f3800418eaf49b5edce1279aca639d091d0021b87b633af8f0489d9f4be496343f462482dfc2441bc7d1d652c40440d8d9fb01bdbb0ad2c7f1fe8e9a20b24bf4938f46c381e079f47e50414ea1861049da5f8a284f0d097d7323f631b3c9e2c33677618311778f9baebf66966ee40cda2dde7de9dabb84d3e10580d964f3b13f633f7064b8fbad0f14f0028ddff09833c7beb90a9c31ab1c9c763c1a8852f633a9ebf522f75cef169c225f9b54529606d79be4b1a5c3791f70503c080bc5a7205fcea499485e9a7ef54ba023d6e29d308a020a890019822a703f678f213dd4dc76648108720c486eec7853bb3fffd68c4501e3ccf45d721432e1914372aba3593bf472ff60615ad1043c84acd5fe36fee62799242fed7ac19c111d1a7b3b237ff4e7087d88ed1412eca19f5b4ee19e4396c1256ffb9920650d8cf5436279fa22c024889299c140778cf308a3bec36ad479729f488baf42c9840285b930d8fa9a96b2066b76cf2ab61e818239f84770e484bf8849379cb0538a537367361be4f655186184f637a68848e2375f5dd6bb872e3167d0e5359b8155b0ec8fd6a91cc10d0840f19fcff973da3beb4a79cc7017be56630e74d59d4fda59f6b8cd9a0533b0058e04a5a6dde2ecc44b4fa6bf52b61bc38edfc2e9fa1fbf33f288cad431511f4ef583b37aaac28bce78a72c3fad66495a18d659cd8fcbf13094e31951e3a332c0f5da0797ca6283f84670e05f49b9b70701f6c32857c6f5f4d3204e4b21f596b62df7c6072c5048aa17ccc16b33455e02a14caa1b21caed52bde896bdc5ff5ee6a9d8f1b93b45643631abe52abb50472f6f0af5ff3ae1d53cdb419c3c95589a3cccbdf537bfc7a0601553628e1615e1ffe2a7f8eb9e939ecbdd213294cf1ff73ebcc8d59fb36b8b512774ba4bdbc68aad2fefad965d5dc4c017efb01d22d7448c75e4bce4fefe49779734f37e26c7b085644ea8f113aa5b549d859f72336bdd932c38121c840bac1d78346663f13d5ed30289f7908c5dad5f14decca6a91fafab54be884d53617144da7cd1faa787fd2007b3ad28c52cd59ebcaf1d9f7dc76b9a570d3459c6e92803fca27f3e7525c35291e48f2b7b135f9fa1d3e2fb26e764a704ebb9906ce89d7e2bda47d58aad453c532eadc1b3e724ab52be3ac74b6cad208df8fba5c011ac25d0c389d3f8c41e7de3e34830d4f855b7feb1c24a0c08471e69e4e6386deb81d909775a710938c8010817d84f4ac8f7360758062d90f98cc03bc8a85d7e50af440d721b4667e68139c6f6660f9c9162523143d6971fafdf14f1c81296061839e76268188b8ef4f187f4789160d4532b5731675e096ee2ba1ec840ef6c86a0dbc1e16334968aa3d74cad1a496cf253003c334221b3c9b354b88a6940f33c7b26b6b72bf852179baa15dcb5d91641a522d09aba432238d4beba6cdfb49b95db25979f02d9ac0a83fb67f8328729e22bac15e9f92194349d76e21f167c0e0ae41b73217e2a2130296a4e7d18500fb8c0858a0f48bf31892de8f9da467df90fef1a63e75887caee5b4cea737e8c35ce232114a298ec70c43f52b2bebe631e25b604972088dbea87888eb7bd535a0667a20bd4b0ceb10b6882258c6e1c2e88ae10a0fa42e69ea570c9581db406718d7e1574f4ece583ee261007ce22d9f3701e39dfead00c983f1b92116eaa94364e7085aefd6a7a49aba04f8e3429d96478f8a0b024881fe09a45fc362f5d08959faeb1bfc3288c14dd27c768bbc0a928fd30d2ea9e7b7dc5e4a47a8ebc58c4ebc757cf70564201019acb5b09f6f7ee4be1ff777fcfa7e4ab9a653291b619e07e59457f849e6c75511d0ae5b3270e1d335ebfa52514e5cf1e3d3353cdae9acbcb3a141671d95cb89472b93eeb54534ee4381d8a8a5d967a3644193b5cd8ff492ddbd4345ce6f0a338a70b38fa8319895db626ce5877c99a8da4b7097356f9f92716f448f534077cf1a8f547d2ae717311216300723ebb80a66c8375db628d735dbaaa71009b3388aea6f82f5d2a8eef3e0e601d844bf4d8616b0a6a6ff793d4d46e21aff7d5936a78a1b96b4c2fc3c6cf872e95c6c9d1c8aee066b79656a009944697ff650931dbd2fda15666af32f90425a7597c8251fd5fda53e135cda3ec2916443fc71e53ac84e69ca12d8b8a6eb20ff1dc0369ccb902dbb64a9529ee0debbb21e6c5f6852c6bc9d18f3e109109b64563f6dce6511678359d94041bf07cee661b9ba57288264b4bd4170353d2212ad4bdce271a105606c4a12d7376360f9462f0070e9816e1bd88448fdc296f7728a4661400355c7c62cbcc4dc9123863eb291e419f2ce8eccfe88962b24e2474400d42f551460a005fd188cb9da4d17557b5f7efbb447f24b830942539d092444a618ff80156d200806dd06cd0ab60da81c0d964dec46867e102ef86680044da810df6539cca777d62996473cc9449ab2adbbfb0df17042df9b73ee949cfbe059ccda1fbcdf80224d8b1e0195a8bc617440db22daee3a9fa1c6fc3f2564fea474631a1fcd1bebc0f4e8714c509a910287a9521f9eceab0bfc762f295fb2e56d4b8d4b834b9f49ccdf59cc2666879b0c3608223622acabcd542ce9a96f64b88ed5e71658ef9c8e6b63f7152599b7e13ebf4bd21111cfed893e9bb162ff7c0c59aa239a94b617da508544a36e882658cc43b6f6355517955aab278585b4f986ef6e06e0ccc62d14f0bb64fa1f281d0fc32581b1160283ecfbcb22e73fc1a20a7131f0ed04860491cdaf1a98be45c1e745b960ccc044319c49c8324a67f3afb821bf69d0130ff2113b3c1be58f25e330e48789ba61ac7d01959a82f094ab7bbe4114bdc8f62ec8f9a7beda904b4a87fa0f5455f1bd9baee0674e064a91268285dd2d18e3b95d7910e5cf9b7f7d75fab2dd406c244523eee3dff91da7b0f242cf341fa47f60df18ca06b4f0eaa916842ad50ef18de0df140c0014288ddc18f523695989776a13008b4cd3dfb5a050a2cc7666025a87b4670b6d08cdbfe4c4cbdde836558bf9e1f117d58f1d0c63f67e456e700dff84af3812a95bf4aa067f894894cd8946ef44381ce4f91b3d8b3d01a8284a22fdb8431a857b82b413a135c87e9cb66a2ea1a6d7401168d6111ed6fdea17e08d114013af0924c1cd3ffb0046793f3e779520b3105aedb9a50677575261b6ccfb73722e3fcc04b8b71613adea87ae408f41f5f8aba702e961f7e728aaa0ead44df8cb135b16e2432437ca538316e57271c83c05cd676c5923a36ae75211d4278c5751731e4f07327f304ee4b12ba3186b46f9f5cff674a92abde1cac12649e7891ec1b8af0b5d30d6358b09a07823246137e3742734b3990d56fb265cabc5116bbc305cc7be7e4a1238898a3f81b412419fe17486043673a6fbfe884ae0ecadfa0f3b3c6407bdb044669beee31a6550a2390318372d230063106472bfa52eb3b0fd61fedc11804769b36a4d65aad78e82f14a64dc24cc795100fa87a721692b7815d0d71d57b1417150b3589c95985edbf45b3ffa0c2bbb5ec2379dc46aa7ca08356d41c609a6f4639793cb50b0e7207daadae68eb542f153190b3080700060e6803a61919b801b73a6bd89381c5351b094961a7c958f9413eca1ca2fa5535e7976f6385f696ea4831a8b71b8b6bea09ff0c51acd7af8dfd8b2d928a35fca113af947118ed62729b481c5db63f3f9fc8b423edcc38e71ca92c564a5aff9226359c8cf3ed40168910b52c4e7cf39388303ec21e32df1642d8ec1cfe999095c06579c953f71b3c09b9499f7f63cab90fc97720c3d16212e92f85971ad39add82841d30c197262c592d24c20d84c2b3636890683a5ca437fe0f328923ac4577c948abedeec8f3b1a4cfc8c8d4f9da97f8638ca23ddbdd4d034f538d78247e740b9f324f1bf645a9fb1205967384c638cff98d5fc9602610cddd2964c90fe709e5520f9dcedd8cc6e24bcfe3fffd0d62f83d170e0de9fbda97570c44bd6fe55ed3718809b5ed33e37b606b60712d76f1ef57d4455bfd1bf3882db794fd2857a13ad642d3745eb29a9a1c77db9ab1515f6654535b8569db9624fad741f35445e814ba6af14fb90c27ec557feb6ec7042e13e9b00b07aac23cda1ea061bb7e09fac79034c4879779795ea8f661a428fc9ad21266d2477c6fabdfbe4eb50e6d771816e81fda4d57fb120eccaa957d75131024c80b533e357ea843668e75892fa7b5ef38d8e3ba987b5ed7ffd6efac88303e428c19ab95422ec3610fb9d6d8a33ca7ee7430111be837073464ffb9c0066517aa031b5c74f5ea3dd6c63f5055caafb16a37502b299b613df0b35eb8a766cfc73f723b61e0a2c6841c619a80a370c3c2b100c1064425e84ba68aee2e4fb36fa8a4540dfcccc2a3cf941b04c0db2157fb9e05c8c24a132eea4d6f4d286b9ff1aca40f39ddc77e4d9f3b37aaf88c92bdee41ccb2e963d55efe4343b7b6d370d07cff7d218ffbac9189d3c9541280698817d4773b1193dcdbf6b0ea29e3e42e00fd601a2e400311760bebae3d2a4d83db129382d50ac565b09c2d71fb8cb80a3997c6f3d4a38d041d231f31e99cb4521ef6eb95dbdab49ee6ca0fb2434bf323b108de5845dbb3501aa1a663323aa99402c135bc7e983e014762c69cd935894ee558adbcdbc4c799abc7edcdb8d0919c7032c89edfc6b0c5983e9abbb14c42b1c3aa848a96104df1926c313263145d73cd96b505361124f2b1234333a0b0b51d633bbc269afcfb618ed9eca9747c3abf00c4798c477588c229e271c046c24ef2ccfd882ddeca013fd34526a37c6db98889c28af9f2087e30a6a2369969401393fb47f1d097274169c8910ae2d2f26d69bf3362fcee06826ef09d6243f83e031868228c578aa321b231852a5ecd2c50b53af7f574618b6510446e7a7756379c84fcc0e2e5655d0439caa29c5d9f66530e52ec0be0f05826c478a730f1bf5a751b30fcf50ca39fea3a76071aef3d805418ca229bf1c02f1e4797ef53f74c4849e938ab964ce0f65fda4ab0af642998ebceba295bc51ed3fb15e4e6226947873ad21eb3b734fce688bd1dc9f1617247ac412629445350a6b362ce2c3afca172469c04e27e35ebd1d53c7d1ae5fc5ea6ef8a3b28b1a553ec22f6ba427f14b6993415fe588688ee1f116276438d15caaaf418e6222ee3ae675a00fc9bf43b20c1af03f4cae6ac34b600029e69da251a59ff1a30f5004d7afbcb4a722f49a0e7fa7fbb4f8d126669fed6283a53ad22732d5ef37a705cf0c2344402debbd0218c83b3180fa15647a0efacbbcad7d74e02464225de788e50fdbc168cc179cf9d837b7f7a1c49d0c78d4926a61a812ec7a0df70f9789c76d21f832dfb134281fad7ef7a983cd11b2591e0a47bfc2acb9b56d69cf64788f067700505fb53512ba21c331bfa1925a11bc294518e024027de9beed11b628db6e6d0e0665a924f4965b08f8a17f709cbd03776ef9d49ca94a1d99156b0a780e345f46939054cf6a8c7e0cd60189de415812b98aa21a752bf83056cb5c9e48c80277365ec14163485e38b1081e3c8f0c55466a3abde264848d5d338a89bf798944dd7dc16bac76c64c4f1f0e983d9f0e5ddbce046a739b30f14bdccb02d1e47d383c5fd6e4c89b3015692bc5d159a92ec37b102bfb7b9af009510e9eb557a4520af2a5cc5e8288ab9a5498aa7c86155867a6af4a5ae6deb62df9feaccfcecca5e85811152bfae82facfba4ac62bf88afb0e908d1f9129c03070221ffe029e8a144eedaee69c8180baa7f8e77eedc28ee72873c5e8c719f3f2e50955fee2c1a65bc911226276965f96bfd4002abf1ea04ccf895a7796f521439ad33b049f3a2b7b4aed7de84df8afae6c2112e2e3e040e6b02ee120a63b9622b3f94bd9c0d539aa2968c8ba671fb9dbfadd09f4d44554364eaee9db3798586683a30f5b3bb48024f94446fa96aaad1d7ca56d120a7d0c721bf3ac17831b2073c29aff96b339b1a2b7a1d48b4b9409e1264d5e4aeaa8811dcd61a3c10bf71e73d3101a0f279498d1997b3cc10eff1f91e83ba8232539a90706695b0670a60b30e449a0e390b21903f455120f4a9194c351392d64a5bbd58a9e594095f14ff2acd7bb0aaf491ccf3e9a5a22ef50acc98bb453c98a458371424eb042faf66d4c9c63bf3ef2fd280bf5290a2c7ceffd200bdbb10eb5f5887a9f2d3baf939b76806d14d3ca33cec3face50ad5bc4987e86494fc7ba8bbb56ba024bba48f5c6d94b054e02511b220b27da0d9fed3b907cc427cb7ba34ac6f340185000e4f9906fbb2df16ea7c984106c9354f176e46f0bfdc0db1819e110eaf9a7cefdb70b09057e71d16311f53a84b26684aa4d882ade0f6e3dadabbdea8d5046aecb5d6bd0de9b9da724abb6ec75d71b7a0e48ea14c69f9e859cfdbe66fd135cf0fbec34ad0c5b0ade9d71a8d390844670c6f15732adc69af4b84a24008e578ca17f87974c1172d3169ee7ba3808bad9baf6097c294e7d22416cd8f6f2b5b792a7f9a679fd4e82698d4655bdbb3a5cadafbf75858cd8596803f8915266cf11aa612a60316633762dce8f77cf6100d554564a34ef326bd1dec1d4b009983c89c2c4cfef72ef3c7ba184a6d522c9401ee822a21788ec7c9a10767e613207eb969a6ad89a653e3fed9a51934a1e58c6d62f23e60598bc0dfb766428c3acc6bd021e9cab97167f229d70f457d1679154a5236bfff5c58ed3a1f64cd5ccb2f1284a8225ab235601a7fdccf0a31719fae14c8cf51ca8b19ea2f227871bf2d5fa4da7a298dc8dbc25877ac50b9ef941e025a24447b979cae618b85beb0cb2c9d0d96cd1ce20f8820b527aef134e138c5ffa1ca6e35f96f2b86b3d6a988f135c9a015d267c63fb3f1c918579f5dab038630f3b83435d5d05f0b9e767bfa06c7750e6b620cc86658e8576eff6260c9bed7321cc14fb9b8931f46ba56e41841285fef7ff730d61289835ece84f0dfe8741ee05570998fe54ae3ff62f4ca037ac89a60352f4a3e2d058fd911df34327e7e3a93cba090b95539d8f954ec30ee9655a69dd9758ccd5e61157607ddb79134e7df724823b0cc2223ddea97fda85eb223342bfda60336a87aa56bc98cd0908c511599f5114f0ca8eac815c9ef56a0b9fff9827b011f285e7ec59b65a51cb5771634d364d5a16924b83240917e76bb4d389795d0e4a9c7298753b9254406cb628cab14a388c1daf07bfde82217b26b0171d3be9b6fc2112649f7fef69ff51c4c8918b4bbe66f2a4b292916f7a07c6563cd61fc0ce95e7afd063227ce2bcc4bdb6c9ef1ace8c6a1a0778657382ce6da2179821a001cf869596bbc9bfe6c654446057e717dc311de6da3eeffc1c3dd735612bb02829ee995e2a3d89812536b77e654cbbc8b685a36057132b1a640c906c8c6054fdcdeccef9b5db61fb57f1653071324ad3fe61c0e4bacbc20f086e8ae1c926491541236976afe4c513a069deea6616fa3f154b7aa8272bc42612aba919cde95d0ac3fd435f39659a6b672e7b27ccf515fcb346a8599482dcd58205cf093db8c0a197990b0c1195654b01fa15689221f799261857fb62551efa58bffe88d126a74bae0a9246cced40bb9f6b025a097a366905cac11c99140357afb98cf10343c19146279702981a1789c613b7d994f7808a03b0267de836d4193b6c3746e737894ff283b8ad568ee89cab03f680f5ae9d0ac2a84a0c23c5d3cd66d55fe4e85ec37495bc174694be5470d8fc2853edef00ec0e7d377eef7db200c1cd6bbaf799f3819ce5303b7bb691b38b47abac279af8ffd7de8f9dfd8a0e2bf3d630910f8d18d4f54e6e0e57936e47ac3ba79d997b1f44568b14c5a4340d344643f027c2010c9be66aa2a92a3c1de42e85ffbed99bf98671bb67d120002b0a64ddcab3755187a9435d99e1502d40ab52933aac466b1310b205918c1754fae3d92be318815b12681476bcfc8612481de58769a1d9fd24cebaccbe206f198504544bd34d18f5617dde0189d5951af0bc33442b15bca5d520bc4815af3277835910c7522553f5bdb816c3f827c358a1320c48c19eaa130574c7a91dc6d072fc82d938ef641d516010623cbc8242e6a3e816de7f93aee0c4ed397f286f7bf81147328f7d7839bef948e60eea09d129240dc7c5badddfa04a3e876610930d5f86008cb2797906fbc6653600515bd230e559eaae7702c63c8514049d7f4ae6210dfdbcf8938e9f45d41c2197c6c705c7c46e5c995c50c7d5c8fd8565b8890a3c75f973cff2bf304b3165bb0e888410b1087da18cb8bb3bb467c2e1fe0f73b11c5989ef2b835a13e824907abda53fbe0b9332cfb9c1b8d1fea2bd86b81176d182e558196bf1f569b5eab493fba6e28d3eba897a7c587174ba184ce7bfc5e0ccc46c7933f3e4944ac940fa6f673a7af0197535d2139d6dcd18d9635e972404c81051c131a3cc50cb90fa1e24822e042b469f45249b8a7401861bf9ffdd26e54b22c748037d2a03363641e5ec17f2f0ccfb224897f3dd5a3e27a2210cee65a6b3c38470a5b697c869a1a48df0abd4fdb8ce7b8525e77107ac50fb2ebadc6ef539a10a031b50e3395432406b49108503a6ccea34418a4a12a291b2d03815322f8fed4a24bde62d9a7c8619d4b306434a63e4daf3abf06bcf87593823c05ba6e33cead0783488af74afed56be85105efdf6565d8a8a7b380e5e761411a4db924bd968ddefaac938c775e4fc6fb67cf6e3eb83fdd039dae94df8120e11fe9aeff83795b377eca92915b14d0a3f83bd94685df8ce7226cdb92ff6475e4a112a2244d9635c8658e5820794b09af171e605c3d817a730ae4a2deff40472f6c9de73fed49a3d70fb97d5dc3e00d1734829df23992ad6cbc2dffdb1574d05f75f24b5ef5208c3ba2d82d3160442b7de8a3b228bdf94ebd128a12804a9841bd64b094cbe9fe845a29c0c54f4388f0b0f88bab1e2c7558ec6b3a01d86131b78ad75fcb9bdff9b556c79e878a5bec594972d13251969b972fdb8c10d880b420f0ae32e5d653083e3af9f49a15a5eeabe3cead8501a20ce2473daf503e27990aa79ae495c4029d66c3099c1f2407a57fad869d7a04237e566dae88c6d8fee98a37e02ed8872e1ce93405d169e47035cf31a088578679a31ea4b8feaeb73647986d3d2b78019d06dbb32d59818a5018cc5207f74bd60a407c1fa40a1bac18773156069dd68aec1e0d8288432da70d3d588dca4ed6c90b7667b79dbf84b7a53e7f6a3da16fde2dfd6a5c730648bcb37bd37660d1ec66158bea806e7f9112ee84199d83b747cd82ec0875525e702a584b31bb9201033c462b5d32f5a96adbb97db20c458bf6d7bd5bae212984734a1025e03e679925edfb48354a93cd322354e7b38e690870d600a96e0c3adbb5ad3fc2b57678bd576d55c5e49c431898b93485daa67bf6cc0f9a2f7d9084827b816845e0878b30769299ce7d9e5adc83c0a6862255f758591eddf7ba7a12741cc97fcfc717368d7d48a6d04f1f4d93a7b96f8adfcdfcaf3ffc9226b6024f2a7da2b36834ac90374bab905838b962d7c8f016046f12d27b8d155540592ee2fc2d2d86f1ce540e663af2efc430da83bc8ea9babe6262bb2df6c013c0f00c640051696dbb2a8a46b30e9777edfe3914ec9b9fa1aad6f9524b38ffa0bca4d0dcfc57316602a7a8a9c19623107333cf77112a1a4b5cb069a17bc3925f6f98cc5918b7ab0a55ab4c3bf51175c323f71a4c61bfea8a03b6090fdf95240542dfdac637c949743e8ab96f0603f3f49eb1eb1f50ddf8d9cc3b384e34f4cb1fc256404dba3b8ebd9c451b136e44f4e1416b0d95be634293756c362d383a96aa01e29636b7260723d486696123f74635967ad532cd0793ee653d14f0dcf85c0b690ca9e3d08087b2b227dbb48d1a918fd33d44133991d13227a7838bc8be97831e11909aebcb75fccb4f59373e4ceac9ae01fa649045d6cc17f02a3bbfba95fb8607aae980c4eed406194edb3cff0c9aa6cd841e4452b64d572bc6b1439e9cc951f19a33f43d3c58b1b2d5648cc28cc87ea52b62e5a02b5f52b2d0937369de1e567e4da2be66bce209ad7a5eadf46800e40ff2550a7b473659a1d0965c35b13b94b81106069234a13ca17be5bb402288a13c1d00c0f4900501278fd3a695fba0a9bf5160872f1230d4f67db98bcdfb91c873dacdb9d9360700b795b1157c36d9c92bbe6e9a096f5b1924c486eaf7f56ec1135aa72331fd6e3be43fc3e694c4445230a436a730c4bbd68c2d476142e6ba511db7a9a0f30e68ffded026fb2ad8d6f99778642f4a4d6229a56d3c3d56507ebbfd0f0569131f36016d80af7c5e00888a1cbdd3566962b34c662b5bc737f49c494bb1d6091300db7673d1b2647c5092529c50fcbb80b9c994eadab5f3801eb44047d7fcd94dd4d38f2d18cf5e9dd93d7f1cd037b5fc1b8b72661936b9c2f37a49e8576c565851e331f2e31b7b649309b0db9d569a8fd6f1041d4dca3bca9c1c0c675050c292e82b47bfa3d152f4be11127637d3dabf3f8a89157e4d49e6eea230153abeecf1d0f921576765354760c3b2bef50b71720d4961c39dfea5e1da6ca3b80037945c5f59f0c8e38090460dca82fc4b80b07f2351675f052b0fc911dbb1cabade44bf9a8b2b162b3dd8a0b38d4c21c85523f96082e208e307d86e9d779febec4a6310c277b6871cf007072c5b8c714b601737deb62cabaea4be782443678776e0b71c3c976ad49e4a68cd23fd8d53d235f28556cd76de0597c9a0e93247c21b9a8ef2ec2401670006ff431948963424797d40aa4dc44c5054348aa11e8abc2b76ab0fc197eecf5132b5c509c71a8fe4344cce7d5ccb81893e31a19e1e857cfa4f51d34112f02997a3f6dcc69127e3340058076f138c9c23c842e68e3744161f4e3c8aa965b5f91232130253401e8d677a0a58016c29adf742256dbe79e73a56ef750a948e02197a1fa02ed151947a2297744c0b875aae9e4c669770dd52930469ca39eca434f2d07ea2516a16b9a98acfc56d99bec9585b45924a101bad94fe849558feb8851aa3abbea34be8dfd6ed06b047cfd75298b8c634869a9336735a908889a3e0812818dae76521fa28626d1d0490f101cd9bb3f54a75f4cdb4b71c13b4f5e6993e6f653e244e1bb67892fddb2210d38d9bb97b40200af57fb6f4e5a4302824bb9aaf9086f93eac163ae083d40a5656fd9c62540ced2aa0de04e557e2890f5be70bf1cc4a5cb40cf3b69fc81bd88fe4a1341a94f78424c525a47619d52e6a8ebe36e766c7cc454175b842e3a51ac7ac068685b8ae957cafd83158d959bb99095f0d20aa753ac692ee2b496f9a6285e243eb66e100bd3de61bc296a4712585a17d22d2f0bcd1301e1810647b18fbc4d80bb764517dd02a357e1170c8e42f426c09981ab6dc29f8656cb0f966f56af44e48966792a46d7d2f46f869579e318159402e5402302f74773212f1e737e4eaa1812a1c44268f9e71999ac5e131498f791559c945306a1955e07333fc9d7daf86b30720acf57cab8a473a0aaac269c176878d25da3e0813e46c0941c1f10c049e6b0e8fe26b0cae6eb4ab6afb8972211fd1e2f4feb6ca382e18d130dcab4620caf93e7afdd2f1f4240193f4d38baf31fea6bcfd546a6f123827eac3f7cdd92a7b700d7232e0343bf6fdee8320194bc71eadacae5624bc03c841ad7e66646e7cec01645dc197b1fd4a2eda77f16ac5d76f8c07a0345184e90463fe8ef14f0833a92481b052801474f2c6348c3b9a9f6fc3b237c985ca192578cc2adde34cc11a5f3cf3c6de3d643a79b2374b18544c88c79f0b92b5ade7f1b2e2e7db24d2871403eca849e863dee3e6c30b5d05058167d5cb94acbf0b95f55e987ac9daa99eaf64f644505774188e2c7510d53b72eed091f6349672d2a8b0826709379e456b7d3b69c632e116702a73a8dfb5dc28f8328ab0990cba05b7521413e417ca96bc1366e3eb0ae7a7a73748200c968ebaa573245134f065b111df15a5a8b5a12ba5496c9d19d48d8fe5f9dc399e1cd2a85c071181146832987d900e0a1b38d4c230aca78911b8a0ddc6e18f34a4ae44b0175197abedbe537f1ec7d840f979571511d8731a0fc18efea1c5c05883ac59125e252a35dfef3a9bf1ed56a8fc8dbfaad7dfee5a74263ce15f08a9ff9033f5c76360107452e01cbcce22ed8af08258bfacbbeee85fb892adf34cc21311ecaec20b1a34c27272a1c9797d14f9cf680072132653fad2708b3004a8e864c5fd6c07f62c73aab699ebe9d3dc7f06a900df0e3b91f0ca6d8a3c9de8b4b074138551ac8910041023a2d59306720d2e5dc5ebd98f071a3e1b7119deed30d0edf89bbd9192b7d99eb590e9b43f49819701c1c1ac26c0532659d81aa51efaa055a82697582a8c04888140adb5f2f14f6ac1c02469bbac259dfd14ee8381ec7c77b96e2640fac3e4d20913aff75aea2c4777b4b83d4820eb85379bc58d50f073760ad37a779d5738330431e95fab4fb227214e3da30fd44d3266a6663f61044e56343d5bf1578f15756529ce0b98b53020f0a66d88db03a461f215608d078f16357bf1f7c840131fc5217782f02ea43e4f99a534ae94e2681734281ff224003cd63046dd605e88adba60a4500d04423ee13325c67096ee7cc876cf91f769641fe0f98dcbd64474e6f76ef7c78f323e66b10bb3dafa27d77800024d08ee9d2bb96fa644d7900beb12d5f6512fd8d83c7d86f8f0e54e896428f71b11a90cf27a923ef223b1c66955b253251fd1e80d0c87aa23cfb5548d0654a38032e13f40d74979c8f6d7b4277ebc6de08c0fe3ba3d420c8c4114d7a922d421ec2fb8bdb0e8eea3572e79dead9e12d19faa3f7810ac93f2e3e964fe780b942282088ed2500535c2ea49348835674806d257e0aba186bb4e4c0c551d463bec4d84d5b97f10207f1d1c62d7d80eea185af5219dfbe25bf7847124bbdbe4d0c146095a2f1539eb4ce83dbeeb9414e1e6971dbd579c0e3f24b5f5ed6c9987da7d53426fd11688f9acb75639b3130a776ccdb35be50d21dba95794a97ae2c648f0014eafff45caa37a7aec94c7de76418f98b9d81f4034111b2650cdc349f2d06f155df980df529551470793d680bdafc00e987a5ab05e5e1995ede5313a73ccd47b7db733ac491b67f17cad777ded2ff404da3649d1e0d312e96e1dba0dccec4c821466d1fa434dff9a35a8511ff5acb7d157c66294d9df504d558ddbd4fea6535ceefa2e74741292b5573bace74472c478df156fa4d33247da6aaaadfc09fdc097adee0ded7e59f4127b29c726f0f8ff65980ebfd7c3136bc252c36b89504e3d8ad4a91aa7fd6be6923e0a40bdaee086e25d750ed2a336b8ee7b87a8a3232c0837cb82d1cc93475b8a7a984c33f6c78a7116b977ad812100cb36fe3d7293d8262f6d26eb76ffe145c3211986bc87d005acc32afac36aa16ff197b52425d7c97bbb7889f649c7a1020025c589fa3d1bc31fced3c4bce947dbb36c0fdffede51b0bcb4fa6c0cde843ed4d1b6db8bded88789c84b90e27f1b11aa1c24b9216c4d687d2189702a74d9ce7784afdffe8cadd722fc2389e9b65b0c94962279dca4fad67fe54396ea08c9229d1063076234b25892ef097396a94c5a0f5555b67fd65be539402a1c2ea9ddedf66e33bf586a68e9a9d367e9048a3b4c795a66cdb74553c69e9e9add2f128f705513a64f22cf5dbcae9523999018f8b0b80608b190c2dcbb383d860872b5eb2573a4c3a54d03be9144c255adda5d32b0404122ab7a66f8407fb5cb21ae1a0fbee5edaa0e55dca2c9c3bf7c303f29e3f062c8852a3c02067f3edcccc3f17d3e14a18aba3eabe52280e634d4311266b9d9fea968c78f3e0f75e960a7fd50ff4225a600cf0913c65b35273105f66bc6e5f725fdb9c8951a6b882d01b7e467cc5245112cec42dee45361ce9f0cb2c8d4a6b0abb30eb60fbd6ec93ac0c88e57f2e7775099ce92a1fe0736676fc5dcf64a9c72c7eaca5fe10d97134a9d40d57c95424e2ae1323bbc36e5ee1b343b17cb28d1368e52a31f1764a9a2dec3434f3c0b62ed1022971c467ca1d19343e2a4787583697d821e2f2569abd80660c167c025bbce4379bb5d6df3222e9e2a97420f68f03d1df2a14a0e165377f473b425e90a42910636233a6246664332d5a1971232c364eee229336ad68d41baa0e8204634780f02203289d14c5bcef1a113a87fde68f019c368cc16ed82dd4480f53fde843f68403b920c70faf12027f0745e91c25f20d1ad91d0ee87c0e0d651bab1c140ec754fbddf7236ed2272536a6ec9530b2d2f9f49154a86c159fa9ebd68465bbfb8d2c3c3c580500b072d5f50e3f089bf782e6c5bd07da400fb577ef460d05cfb945ab66a29ecdca42648f4e4850beb2bf0652713e398c0a88729cc0583a55485cd5a21073d17639392593daf8bf3d9956a09c7daeb0d10e4dbbc8c3ccd42e6990c2889614323a882a04505300e35861ef831617cc2a2290e32feb997c3cb526cbcddb765d8aa9624ea064eaaf63a85586cb8caa1d98d94e579266b1740fc0f176fd3572267cf6b7a0c624fd56a3b41841a2106af40a3518212a3d757337f7596ce4030a41c48dc3329d0ff564ac35939b64407d63b502e658baa0893214c1ff1051b0e9366d51c46b989503e4eca7550d3ddc0333df4421fb4216a4bfc702df3ebd59c0e0631e973804f0286487806aa085a29e5d2411f1a5126b37da5ea203776d6b73619778c3185ef8e4ecea6203a70c30d9e2168afc6c772b400cada80bcfdde1b2b23665b225a16d09662707b2ba3de503d6af9c6f96dbf11cae394df9b79c7e63e4f8315d673684a238c4e49c8ed2e395e47d8ee16552e08e0cc494397c84ebfbd0abad4a50b60366750e6aebaa61a408c36c168edc434fd24ed0f71478b6842528d0f52e57cec0e58bcd03bf6354507641a65761a2860ce7f29cc2ec2c89e667bfc51c2e70c943d22b2c42e3f7538f8184db3479c039c0559c45af8ca5c07e0e4217db821a8e5c37fb33e3ad6e7b3da7417fa56de661b122033925ed582801bc812ce29e6ddde3b4e03c43a8874a765e4fe2ecdca729d4719e8133d58335879aff019247ad03f2fcb843e1fba0eb2d782783f04220c3f196b5d9146b7a25e330b8d0e0153aa050909c31719022a6674332d9d369399fd44432193543c0b60637e5bedbb977d6952c0c507054780014c3b5df8d207077d7dfe8ddcae011511f852c3e2b5537394c6f642596e5cba10efe782b5148901b7cb21795999c33901f151fad0725985ffc06194cc9574bbec8d1ba7047a457064b11a0a793eb1931c21cc03dc3a4306dfc7c5e8ade179d3182d32fef80bad655b8cb6cbb5cddc90645aa0ba5586b93c120e579d7220bf50d0994fd9408fa695c59c3483b79d9a5f55a1fb0aa23ef32a0b07f4f0beef4a82c776b65ff48df0330f9d63ee9015b38cb9029a56d3028894476ce5145dfffa4a4a50be74ee20ef18cd66237c1f4cb89e9264ed2012d0fe9e22b5e554b674cb994b977c9367b34c8288bfcb5c154b1709eceb86e1c866989b64e74805008090942894b61109eb141d1014c6fdc8ef40f584dec89d04b3f533bafefccc73c6d25c11d597efac6c07a50ead8780bcf1905fdbafda1a8cdc8043e0c274c9b8dede45a88e6465556c0f162679cafdf0be5e6023d9882415504c7bead7bf60f45a6d79684e5856739e23ccce90d67516808f4aaedcf111ae74be92799b6ccc5a5e294d3a4efd10d523a46c5a02241c4591f54891020a2e985f6a09588c91ba30d38e1e05ea2b7709ae83e8bbd70edd9ccc8d437087c2259ef9089a64c0fb402edd06f47d6f3d52a9529fd2bfbbe6e74a39e69f34f7c670c4fd6943854a1edb3fc6d55adf002b1800e6c0af2f56581448aed586f014b995472a8dacc2eb56e39af58f74a924bf4941608e07de952a921777c7e0daecca9de6ce3b996a00c389624d5aa383019af7d83ea3c8d3636a57116410ffae529c5004d8edc108ccf9a955e3816fe1aa61640a759a357cc9d847e969bf5d8ff649f80ceba4a120c60439edd26c5fd8daab390a5e3b3dd852b03b733b88b00b8ccb730516f6cd7396924ef796ebae0c8937a11cddfcf122353820d0138df14dae2783f8f2a31534f70250a7aa994042b9d030799b1d90d8b4c2e40732aa56e43dc50111a81e470547150a590d2aa07199df0f55b4917799727a94d09bfe78dfac62fbf2e11ccc3b119f7fb7d21f5197cbc0b1d02be2ebbcf9a1b71c32d82fd68f2723f0824301f3272060bd4f9b91d6224e3e4c6174403a1e48315959bb6c0bbc586327ee30f0c2311eb2cecdd9c7beedb423542779953b1b1a8548a5c7cfc53bcb5ea51dbe7b00ffea58f255975767245b0b43124cd2021e108cf8fe144cdc8c45e3d9a14fc401552fa88648825e198e30634749d9938682471ecee561c83f4a0b3af183b5d24e9d81f2427bdb28535afca6d3cbe4bcc7cf5602d6f5d4e59208bbebb11d52e6cff3d7fb0f68797f7664140041b482ef54c90038ac82916cf75cc7273ecfd38de75146282d87a8ef1cbe272f4217c13cac76073d88825003009f11a164bd4186feada16e474af0c1a435d77e3b163ae4bf612e4a10e0ec876ce4ca22d889473f4a8520e0c4c6ee3f8d93acea49d27c197a38e7f8b9c6f3ad308763dc2335803e36f4364d4065274821019ae3f497dd812318dd9baf16122be03a2670063c6a2b8882b76602b221b39d8b96b38853963f698997e387eff0d2d6b5c5c25a93a085c8202a45a801f0baf6b79dc900161a574637213816d12850fb69aa0b3512e6c88c9c434d93f3f168b96ad3d5df4443ed026975f4b9b60665b207da31daff76306a286a3a6f79212a688903bf05c3c374dcadeb842b0826b994759a31595f3a0e4c26207261885ef69a2212140606122d21e0efa059375038c80457cd8ac115d5745f036b881da1240ea092e0dc6162c2559065183dc0225d918c5f647b74c017be8363370a898f010249bd1f3c11187bc0dc36d0abdcd8c6c2402011dce8d0562fc2c952829c512215b3fa67b33aef00a1703aac6a4e0f4e3a9be48ba413faf289423da35588f637eef85dedd330ed08b46bc7fef23929673745d07f26600a74cecf6226e85662bd0727d406e747f35918575214055d2bc79dbf282e4f6f101bc3b96de9099d84c166a5614e1780333a44ef477ef6d0592744cfe1fa4d1111aadcdb78bd2baa84baed71fbcd711573e3536340184b14454e23083edfca22a74624eb52b25cf6d602eb7c2aff1ce993d9fe8f10d91e8b97d2db767c116ace1f5ed9300b3d5e7fe6f089aeff7641e12f415c25fe881d0cd538fa29d80c4386c5412a9829f693bbf6e0ed8caa3c2d5c9d9ae28d6ed314b932670e6c19f5d12790971e4d689ba67acfd2d3dda8fbf9a4cde8f67876107abf8e36ac813d6a8d3df684306e63fb08ef492df328f50a87906e9893eaa4c66caeff89d0487d5adedc291aa01e592025102b19f8f3e64f106d7e6818b6cc89728ec30d62eb6091dc8299e2322092bd8e5841b79c0ed3b53a5f45cadfcb48782759b29934433de87a6c3685e37becc5a4886fcd1c1173c329d1f677915a1276e4e868c045b78a9364fe8fd81786440acc5689c1574699fc7d7b4996b081fcdf26028aa1412f1952aa1a7ec3cae2b4cae1be57408b8f6402c8cb6c351b5e739d99b93cd60ccf23cdfef89aae1b7f2034709523421228d33852f9521fdd2485b9d49c9743ab8b57fdae0d45b682bbceb092ebc886364d3107ded5cd845ad72ae688aa2a3f363e3345b697e8955cf20203df19de26069c4075eb75822496f1794f784239a1208ec116bd5a9b5c9ebbf39e80f056784bf54fa8b9aef8137f8766ac9a892962af29c1ab9c33656df646477618c599cf275799f7076f4674b65710edd0d988c56532e438a98b95f6c0eb7dd62fdec52bcb32babfe6d8279f8b906ccf15eeff154ef25062e70f23f9dbce98464077d6725ae3f8bf5d59be9544b9e4ebc75fce9e74cefdaeca990d83e96beb0252947f0bf4ff7fa9d43365ac5a49f6be592190eb8398e73e0e34ee643d57d2e3f3806cf0e9208256b5559856d7ef308204e5fca71c3e0ced9ef5657e5690aa46310268f22d936baefcd5297f2bcc33fa34e6563556db25c029cb23b743d92c943fd8c9d39b9a544c677af85a1e7923d16f58a9971b8fde14307114ba730ca31b8a1ffdb52513af5ae5ee5c5667865c709d2942702d7dd4e5f86d59c1c383d9f8fd01423b6cf6c0217287b2aa1a94df9ab8c192db030ad77d9f26057c3c29ed0663dca44f924fdc9d30894a872785b1aa507c072a9465cc8002b85dec650bcb91b2b9479f551a842a9a720891354d59bbaddecc404244cd676106552ba0e00a10775d07c0d3abdafe25bc1a5237c578e9be2b1d682c87062af1062a0dc9937b246a0ea27d4acccebb2215bd5caea03352b5f57e09ed493e22350cb3e49030ce6e2293baa3c9b6a13e84fee7c8215e5dfb7b3ba803a2fca128c7352cad4a9479508c0abc55ae8f1ba50b1b3067c104a508fb8f510533d94415b3215dda518f06b8e328d12e803a3ef9429df577bc54739850d5e5bedad2c440d9e34d1c321492fa3258661e97c5baf2c3c00df3370839e49adc961dd73d32694cbc4a9a13cef6171b71016dd65d0ed1cdca2ed05663424447688fa1fd6a9cf8426d8f906e1be20393c02056624b91792b673e16470199c31a1b13c22adf91e8723922fa28637e91f74e7e5caf9ae349653ac2e77146307bed16e6b3e57d07411b2732537d93bbe32888d9482979e9a26a75cb9f674dbe7c5b4afad1c38a5fc2543e2f7fbdf88f7b686fecd6d8dc4f93eccca46eec137de29935585df145aa62f766603c8eb54e0e95d3dd69cc46dc1f42e2603e3b58cf4641f0196c9c0f5c3c5e89a513425afad58ac84e985c5827b63b5471dbc4a5451ee4920f35dd6f8c49c6f9311f5079849f85b194dfe84fd29d0f5866fa758f16f4b84d2e68637d086b8ff94b509bb004e0a5b5a78ea5dbc28ff207e5ef91513902b2c3f966ecf5a8f273b29bd8fa8e595de02a42fc263bc4b86fd336fa96f7bfaf8a74cb7bd62a1d781a53df7943d5dbe043ed176f092f050f8b3e44c3951d5624230be7030259a992948286a325a11c6ca7ef70d87dcdaf968b4a0d6892ae45c72853eacb5d1775dd25ca12a27d25a97edceac82c091ae1eba751d97aa5e3ed94cbea479b67ef24733bf4e80013ff617f239916d10b7a1826d5d727da8eb8ca235038d0bb5f3991958cd2f4eaec5122c8dbeb2dd4881f46f7fe15a00f2342b2dcccc248b4fafd05de34a2d45c24d450b8588ff04374b6103aa3774411a857c74bdc63ea721f75223804976f0ba68cc2e55c01c5ee0c07ea086012525b7c02c8d22941fc5441759d9a603004a465077a517eab3f010ed319973541e1a4574098d720f3b65b371fa63cf8f13b0244b93caf3dd4389404f447307ad35b177fc7a234e1485b2f1a750a9a056fb4c01cb8339a5d3cc85d91775a536689261563a197d6cd843ba28468ae36febf63c859314883f5c5fd58e9aeb1afeef584ea5f221b14dab9f1b21a2bab1810111e9eeb6d1f858d18580cbfc90945e8bf44dbce52f05a4085ae9705093b21a2cd8565de6b8edc6f0383909b69ec44cd4c83266b95ec95ef36617824f74ebad8794ed95d813bbcac33deb316cb21472925e645a0763ba991a27b78932d1d2cd0ed23d00f26122530e5515e0f9684c030d7d8eeb8c345c246e3cc54aad3a3a865908495a24eb8da7bcf3a533850a8d67f8e116f4aea971f93a5c38d031abc442d73cbe718f2903ea2b912582363486b45f8c243d15e847c72bfbd7319b6ce60b63d8b480e03d1aff37fd26a3efb6ec7a90772c82b39426db95de5f1708d61b429eba36c9ffdc40d07d08c79be7e948ff9168c79557285fa55a96b7fa2af3f84654aec82b3dc1c521df49ce408c9ea94bef9aa2c0386a7d08feb52f1647012152762b3f64e3142b2fe65e539b645017d7a0274a8951fd63f8f4be1eea12121d48f77fd41f4a2795a0a86697306f125b456fd47eddf311d3e2058c32a3d64cdc1677398ef71df195490b5513788f8783688a48b21e86c734972eda31befbb9ce6f7ae41518c2dcb6013f71501d245bf0d769b18bec436eb8d226081fff7cd1ec8ad357ccc63a1b9312ddd76eb2a332445e26c66e75ff6fdd673ca16bd451f872d6a7c41822e9b175b9caf29086639d4c8296f8f4158b66e2fe30f5d3b62a13cc8eb8d33d973b191aa0d7a96849240d36d0787410f66a1543448de7a64e3d60f78cfecf379ecb3cedab7c11107fea1b16092f3eda93597cf294d27ae180d66450bf4685a5ba61d0a71e8fd002a181fa51637593ebe7dbdf8422f00a6c99d14ac249cc20661fde6638a507fd96062b0ab322ee68c936e07a3fdc9358eae69cc9ba4cca2a480cce7c88b9103250d314f7964a5855beb8e51185cae0ac209c62a974ae550db73f86b7c496443a9bda41c97312e8a6c025ab4d55e5dc75f0f01f702bd50b911d719904c7721c99e62c0b26792016d213f4cf8d57508539c060d4d651218c5fa79fdb9b2a870e10253e4a875e44ee6ad0ae277f4b7a315f4e9761aeba95a7896952b192f1f2818e8408ee3eb8c20c84fd1b34bbb0edcd979248e5a205cfc4682951c86f0d11e0462054169e986600e8b3134ccf267549fe9eef4bc61d45525789f3be9be64e2e9795a0877152e605a093d453e91f78682ceb19c370eefb2613183b6f018fdf93f79f40a347a52fb95b8a557421604e747fc4340fee866b14d8c3d068b2c0848b41cead8e7da837f2a7463bc7000ab04263f49e7b2803db0c3d5a2d20a6290ded42fa0de88382c11708dfe792ca8639be83d58c9258242f55e4d71f51764871774b8cc1827627f1a9a3890b37a73182db881621baf990fcd1acd72f07c99174e9e6ffad771ea00a5a166676f3506f469640fe04f46652a7a4906d202e8d69fc4e8f377c64fddda827165ee0e35282f6a97f619ed6f769212d25e71f78c273799ee4224e0626c1f2442fbe14896186121e8e2d3ed64461d7f022a36ca0939ead8b49122e9d44181eb57ebeceee264c563d163fffd1fed261ac01e41f39bc60524df762f8848f8e21224228fda0f91005231c48c51ed96aa0ce55560099779a7ee430d43878fbddb03368818e98b0b0f0c50e8ea01217db31a1d2c8b2bc33e0784a21595b81aa9b4ac1d9dba0a4ca5444c38cd571186badae5b6b56690e4f4c243fae07f5424b8d614c76ef65437d683cd189b2aad2ede7344a65d41eaf15d5458e336917794149a873b5045790f5c327ed3dcce24e2a67c0eda5c888a370a26d567b921d8e35786b40656b88204b8d36fd6fe36d385ea65f65efced23911617bea9a1c083b16462c41ce42cff2f634e8549be96f2362a2c1263a02b4554e63fffddcc0c169076d015e3fd872337b7df70beea45bbe7b95f754b8b0843d1e6fde2f978016d7a091476083279b4e53178b0b5c416c52dc7c0fe5ef8bc952c0355fc668b789afe7502a0a226cd3a999e84bfedb09be505b0d03b8f6648b2239fc97bedf749d0f932a501a4636dc40e64a2b907a33bfc8af1f118bbe57a5468775169960dc39f81706fa22a6335e4c4800be6cd61dc3a4743cb1ca12f39d391988ad4b42bcbaf420ef1c561c82edc6b2e5b50dfc190d7ee06cb2d7e3ce7e7d73d6cfc0e2d563e1f948069c1ac24da21170395212c3c76bc4a91d6f9299fd57845c00712cc89eccfb208646aba6fa32839d0b8761636c74673f418b07da392584147b0679e78e862e7f03fe7936c3c99c5599a91257316e596a5d0dcbf0d1f5164bb769a0a403bd8897aff4715221041e9006784cf2a03d91225a70a3837b3941606b086310f058ec7accbe7004d1eb70f8caf92123aa1186a13d54212e07b576757352767446239f0554fe8d6cbd6a8b31e1a62a32011e7198fdb36d18e2222258e6e71dc77dbb23f0c4eb8304cf825650da37edd18942c5774f231fa254deaa2bff0d734293cc029c7b2886f48822fecf202d8abad6a3ccc2fa6ae85d362cc59bda21645f2ff32b1e226020eac962bfdf66c2e133c79e8cefd2ce5a5bda7e474b8913414e29145b59ff2d8d8c38da9cfe04e70e32aada9e3a7fcc64e24a34f7edc40ef059b5d201c736750ee3b5c12f9f3a7c9cadb520079f398e6f44f26c9cf448b0da4b22b4f49703397786af4084df170d862b9fab3cb78db8de0f549881c5c780adcf1a8e0fe02837ec4cae490f1749d1c958215a0d8ac61511627c8e3da2f25db1f574069915592b2cce706615e2fdc9d754d8e1e02df67cd69c45b54ebc46501c190be7f7db2495c7a5f020a6f0db224bed99dc0e4ac8fab8aeccd8aa93a1bf2d158dbb78b0e0c243f2af77f6aea7bd081158eead1e81dc18f7fdf18aeec096946f24372bb85fadbeb58a30d85b865b5bb3af364b7d3d9717089a98cbfb0a3bc663b72f1df8fd755218bf7aff12698baee48241b2b75ad07ca25aefb08272ff38b9ba9961044faf4129428d3151aa5dd921383a9a0753b05deb79cde930a870f19a1df36484239fccfcef41986d0b45193ef0044a27d408981628d8d1aa34ea3684e09eeac919d0b121634e251648012cda346953e245a8500cb643902fb7a2f92ed5e5b3908df3203299582ae56924290cb485e392cd0bd22fea0ac444d58aac8776bb27e91b8c26fbe4931cf690a5b83fbe7e5df8a3968881ed756978dec3a8dce7c4186bf2bccae7d955cae687af416d283c60abbdb9e77ac9177f3d0edbd8b7d52cfea4bddbe5a9b180689f608b55f2411981d9f6e4b27d39a1993b05f37ffaa5e2b228a828d70a81d354076af9bd9d1b0bb213041ece81b81c62b85a0bfe19936b96ed8069327e914328525fbfe9377a22fc4038cb150ed01f751e7b0343b6a2694cb4d1e885514b47380eb02b4547b0db9418bc0f0720fda75bf1ce85c1671b6db38892a09485dfbd4d4c3522401f1f99894b55d932d891a7d5c72bc059775f22a2db5e37d46a701ff2139a6094d07c1bc44b0105a2de08eb0ee90ca4186379960749a7e0c84e8353aba0962bcef4db05820cf3fa93f190c4f785b5dc19487c7a771630ec5c58570507291057513eecbc033ce66a0295752c28f2b754deeb43465a2c5a2c1fb4f4e46244ca71fc7087cc8cc882691466c37257f69f824499f99158789fbc1d733d5dd81637d3e3e210dc01a5db821249e17219ea0ff6b008b0b51768ea8156547fc93297249d8457c26efae1915f564646cdbbee46b91882a7be8b41626c34eb74c058c603d9e4d70a043d5f7f04698b66dc3e4c6ee8e2919a2af0d8a18b77217b799b47c87174de03648e3d8880ac97a9bf3b5f20b6c5492a26f8f829610cc3eac63cac85ac0735e0f3e9ff08a35799df4e87b70acf83d1742e0167e695047f05fd9411f55b6cf8345336424249db0ce5b881f1bfd0ce40329b80316ab65e16118b5b52029100a2a01b7af128cc834165db477aec654e96a413d81705d0c50039ec14f34fb806a803f0a1181be4dcd1e578c47e77c5c68ccae90952759dcfcd086420f97ff2022ef081971347d917fcd65f12fcd51ced1ba72468b1d988e307b1b62be59a230f9bbe480b62ed394fee8cf366ddb18b3c56d46cefc1a8f559adf79ccb1bd643d4fc263d434db2f1b6baa149dcdbfc624e56cf3818af995ce4b1188c9433b51bfd27b2fae055b45aa47680fba818f60c270ea97c61ffa53a061bb5eeae7f07e51f37d1e8b962bd1ea5246e4ccdd4e35b7b17d05c4ae527de30d2cf372fb7e2ce1af2b5c65db24bf0593e5829a6128a7069e630f5dbce83d44ee4c8516278eb3dda02df240294d518e83bc731df07d432321835ce404ac3be9deb54b2552b5356df313fd364f0a60497a97a71e78d96d9648b26b2244b154d09a647c2adcfeb7b6a412e39fbadbe0ebc298b5786010944fef201631ccce21d29de505548e0db88035ae86779ddd53c52a0f612cea6e4f67ad8c9e246829eca12bdf525cb411946ed47f22eef5c329527d5987651c1ca4677f28399e47c3334c47c72133d4dcbc4df1867b534948166fbd8940b0efea7f7071a815bf23ab2f09894ed318826b7f1bb64c37a5770480c7cf98d3e28b87c5513c1c8b0a0e9402d65586895d9be2e60df2a99205079726b1ab387236e7efa1053e94623f64e8695773b39bff1c9098bb0b708a47178dc24d85002866de8ee5a4f69ef700fa9c0401ddea8e412917354ca58800fd0c17bcf27149c2ad7d257e6eabf521a77ef9694fc224e08c67b0a4d022dad56a8851a1b28d616c25db6580eafc7061a2f00e623d3c31cc98b9a837e4c240fe850078e848c4e8ec8c62a8f4debd22cbb7c9e9a0beb62451a6034219ba18b030de41af2f42bef19988b26bd46cdc046a5e36ae8a7d129fd4f3bd732381bfe9f021eeb491ce7dd97a262a099f5dc7a6343c6016b4f1b4c0539cc3ec81e3a45645368fc0d09aada0645773538b022609ba0774c7e99697fe4de87d1a4f160b0831993843b1678bdcc8cf1d224ba4a70b6afebf0e49b1b295b3ca97903ea95d035ccbd94c97d4ddcd5458b60dbdc80eca73f3833a5a4ea41bc4fc1a92da2e157096bedee65e26a37cd67c2ac77d3db6ee0e876167f7e400b3d36cc46b03738206d9e004f453c26df29466f611b02ff8f12f426b0b2822ec6b406e9449cf1fce9b881e9378cf3fa3d2b7eb03b4a9ddd6ffe29598335a218c3ba071acf5dda23e12642e9ebe33556710dd5573f26d37f11020e0e351d6cebe790b8107e9b8589236b1cad993e237bb5f012b951ef2f08720c290069120aa286a843d0b0cb8cc6176f066d73586a5345ef5f69e46a00b52e536fec1408c629ff6687a30d61f8b0ac5213474b6a6a7cbad51e47399470aeb781bdb97dc6513c9cf30f6ba8d5937bd9bf9388e28df4e1dac1b10ab6a5360df43afe39b22bfcbf67f712eb6708e063442fbe2717b2beeddaf1fcf9f48eb7e75d5da61ee3588a28e3c1292c8ca60d7c72998c4cd133627bb75ebaf915e7a7132f5d4a6dd7a8c7d07cdee7a7e2b4c8461bd13e1a3ae7627246a90f35a2cf7b0b0eaffc4f041fb8893ef7c7c7d8d70d1d31c8f16a2b5a5bab3dc6bd3d2ba01ab6544451ff760776d0a2e812284ec94183b3c1db341cf2a213cce881b25498d8a650b371e90137bde19372e755d96cc74ae7f2cbbcdfaf1fcc784442c2e456b49b8dfd308bbb0368f4e80ff3e7c582a3bdb962a85919c17fe026b54e990725304b76ea358cbe9fe2326630c89b9f5b9b493aeceedec7c1f99af65a59cd031e021d904954df6bd2315902ba82110ad9c665fb64dd123d2487e9e5035ebadc00afa1ac6b0a50499195d2f473e86acdfef84ae2bc4dc02151730fc28142c62a91ac40dc60c3a24ff7c48d7ab667e3c7780d1cc1a3ea75d47f4a1bf425d3bb744019588dc64457238b88cf3add46b8a480860aa7ef942c06198cf1a2ab47cd8e49e05ebc38deebbf6a0cf44af409b2888f35a0969bce687b672129cf74f7d7a4bafe305647332ec38ac333efc5819ecd949cf4471c3f80822fc4923034c6a0f7e145e1715f66e9abf684aa16779163b369e65d2892004f07da2ab1f376861a4fc9edf43d62b8e23775ef857639fa6f36d0afb43e8032919d44e20126dc858c33f2542185c3db37cf4f9178ab9d38ba56eb74ebfed75422e7dbfea1bb62188fb4adb013a4b59ba0ac7475b64e8b655606c56cc93c96a62869555b0fd6564ce75d872accda3179127338290435870ed1a0259aec3b4747de3203bfaa3bfdce1062625a61bad258f4bd6983d411b459cccb660d31577551b1549211cb0748b55f06fe4ef83d6edc70ef304dfe64786c65b400aef2fa60c050527abcf7d77d88aa6699434c6093e5b8839912c57ad401c8da67d111dd4eb1f9f82433a2e311a9576c382d38c9df9728f04b8d8778afcd84ec4d2cbd24d97b1f7379c33ab59efaae74c90e28a2e1301ed627ccff875e3f590171da37c9d6ae33ab96468635e9c2e70b368d4b4e423f42e601f8bcb1c2b28f80ddfab02e1307ea2ce5771aa8ef85b576389d5e7861ddb25a2c9e8da68e0a713696312959521ae59334b9277a9215896e540844ff42c62c760228d2b9d760a7fe0c3b951cc3f6c32c856a1f3b95e11706f54699573c54fa8172a06a1285c7e73d67ed2a9cce99d6293e6e23de08da3f01e4e2df2512e36cd20bd020a90c10a244e9fc072a8392e458399e0eaf979753e781b33264d25df93c3cd4216935ed70281c84ff284d5a3715d56c789b84c2ccc2b034cf1a6bff87218f799aee3e219ed6f3239ed6f93414b6e595dedc75158203c1829cb0a4b720f8583b4aa370af8c73cff5c91c2c2526ded4a2d08bd98c9fbf22b562b972e9fdbded4d6e0803e0cf9efdcaf2167d980afb28dfe369982ecf77aeb865dbaa4efdb1edfdad29e7bc36a3c3df27bf1e33c5e0338b1fda896c6a00996d52cb6136f22cdd083d798179c631e4be7ae0474d669ab760f3253b7c5e23384cb6b1930cc64b6e156a2189f5df61972928592c29890fad2f63df992ff203513761e4db5077529c5cbd2f243ed5b67a909ada945648589aadd33fa6ceca746fc72a6a1e74a39932bec462783bad8d11ac3afdf4126488bd79f6936517a84499551da5cb51e05009e1a9912ae60f6c0e7244daec64c4283fca05912abd74a268032ff73f657b09984e8c2d59492f4d3569ddcbaf23a212b96b15584883adc8ed6c7b19a4909e1bae26645c8fab66020a445b31caa51a1332ad9f65c3884b88efa0e318eeefe9b85c17737bb8fe70e5dd55c98b7b5f2b62169ae121bdcc74c3fca2bc388d2e94cf9e7a665d622fec88c1752187fe72572ee52f184a30b1005d79fb15eb830c2e91ac553260869a0a19866bc7d2328e24034eb323e3f3f7d73d8369e48e7078eca5e493a60d242d43f4a2cedb97956d46ddd071a3fd255695c1b413cb2d1c26cc5f146250a48366b54ad4559c25d1a5fc441a245a92592adba9f6feb4a4b21118c41ae6c6afb683e270d9a5d21ec07eb16e2d1ab7c1242923f923bd8cb16b3e602ea4c011dc5ae3e0e0e43dbc50d637ca8fefb497359277a4d9a191d0e98bcf11f121fc2040dfec1ddd5897d213e015db38cebd1d71d0d2d2d70a80c63cbfddfd660264d5b3c9afaf9b92ee091702364d840f42fc126a9a6b00b64ec9a6213359f9a32922aab2bdd5c583712898baf257ec7456de7fc63f96300834b017ebc1d27a1d872d90ecddd495f112c463751507f1805712f3b4baf70304df5836d920f5a768d81fe334c12069dd570d26edb13baac048859c0dabc9b16fae4535a87cfb1b546ed90ab50fa59e7443c7ba42eefabcac4be88c6eb1233d9dc6f62f6690054297d66b73ef446b73f6a1d479d2689051c2f02d553f1b80999ccc3f4f9038980d589ce2ac8f8d18020b283ea4752b6bc7cf15c3494d717439e7368edc1de217c41b6b750f9a3df05443ae04b96ffd72a6d7f9661fcbfaa099cd03d455e3267963c27d4dfbd5d9e0b4a3d474a108f42f12318011e41e9a29de8dd723e37eb34b55b2d6b73421a5aaa8880dc6533a13babe2ce926bf3d0d1a5f10543a42fcf34f0ad2ef8f5c604f5ae80c611e3a1e3063420ce64e4c2289400d031952349c1b523bd3196ade73ffcad1c674d06a271b82c865177734aabf81ecb1bf5ddd941de021c078ee2a6146d5a6a5f45e4f63717c3e97e10f06cf879187af593ae4ef416c4c28ea9a3b57b09c8aa6ae9b38c8d766598d576b4ad67ddddbd0d3da60947bd0ab7b20a0a4092a276c623265a527533fa189fa41fe74edc7df84923dc16010e0fc70cef754097432fb0f4f5d06da589feb519741bb9683c556b865b79d35f9599cb1c31e2e59542a7ad0d8469861a8093e5179333518b1b1083741ecb8131b2b7275664981bf35f91e2fcc207942c0c270175b7ef46bbde7c4b0a3e6e44c0147e75bb569488849d4aa2373eb5fcb62be715da4eabb1070d161a6865bbb5af051e72e8b7c6650276e12fe41156540bfdf96ce8304a0f058116ff925892e6779d5387a0b224ff0397dd80d6aa331853037677365d609a1a3ad20dc38ffbf0a3ea9156931375a521330ca14b9f6eb29ab7c36450b53badc2b6e96e1bf4d011bcf47c0b428d865f9da26f4c66396a6f0fe2e158c38b788773e64f14b711dbc9b1ea1fdf17030c21f52da2057deeb3e014f78ce0556b654fda1ccfd0e8d8e62ef4f419ab3f1e80b3f2c9355990b0f8fc798b23c48b7a0dd0882cd739e56134fc19db64b556ded31e67eb00e47d29ff0d5e1c781df534b59af2783c8ad43c0da5de268151c0c9e40245f161bac698c0b33b96a69b060027b58a9d68c673e3255b574cfca1907b01e5c686d84ebd4acbbe8d2c8e73c10d7d9e6a397b1782177e64d4fe0c95791319bb6c3c2d2a00f98fc0376df24381d88a20124ef41c7d3179b51eee89c0c128a3dd025ce1a281c69c8fc7c9a561802e0c8bc5f6836be5954569894323335098f3fda1cdebedbd09e92741dc246b58db4e01ab57cff3f7d883c23ad10850dcc4355659d44068fdeffee967cce4d303ef8d3b97f2e7984cea3f2cc6b088a797c72952dcdd327bd722fa1568c51f1b9b37855d4d0c8b2b52661eb928065b010bac1e6210a2921a0edad747622290605fe54118a96ae39cc61b9b60d4f3db9540d33c2f35076b24571de7efdf798fe6e0b8e8f596dffc945dc81d6b1102612781e862ae92b0a797fc04c1eea76b690eee1e8c31f7c95625f976a51a05d10cf7c9530cb433d94e36a0ac7fe4dc4132c5859ce4baf489a9997af62dec417221c8ddd47461e5838f40eca4000dba0aa236222222445bdfaa90f6b1c56919658baa4686a2f53a8ba5e51f4a0fb4153e5836fbe5ed04b59d57f1bbfe9fc244dadbf47017ce5dc4b19696f1873ee22967247c8a77668a2bbae4cd7c084ac78df35789eadd6f44365b890a6a3ba0befa8606a1d883de7abcb4386e1c967760190480bb52b6e5deab59957c016d02a08baa172e7825176962f746cdfe0cb8fb5a04c2af307b7397dd4212f166ea5f3e99aaf431e0c6399ebf2771a8f6eb0655679425957a9a242b5829defb22d6c6a9ae6f0f32fa20ca9323231e9695a4a5788df0bcb7a1d81b4da1286b2899c2bcda0ca3ee559dde548ae412aa90390a6a830fc237d66a4adb9a88bae37b4be736ea8c611272500e1a43d45cf7dadc7263a31d575216a4dd87a4ab0508961f9ab0359eda5477b2e8577c9d2c896e34d383209bb02f1ee038b7a1a223be759ba92c19bf8198a814073493d6c755e3735f9c215c22c0d1bac5ba2172d3f9a572c3ad11c652251956889313733cd4d4b057340bba6de89081e88b6ecb6db9b2b4e3629f67ef1dcdd4d180419ceb0ada04dde5b67d4018363daa819ab5594afec70b660173be7209105fea5ffd447023890e37b07e0d079693bf9aa5aa0713167c21cedf434f6918c8304cb5d5fcce2c1c8936fb6f3776bd8cdaf9a1cab8446e9edb6b3dbed96d61e0609b399600d14dbad2974283b740575e8df90ade6e95f4c5cde70c08d1bc627910cfde45032857c0ca382355553885dc2eedff36f3ad9ef0def342941f93ca02a5eb4b6e71697581e8d021554f80a66e5a1fed87951d5f7db4bbcfdbbc5bcfd07dcab0823e1d6805663f115d0986ee9c5a2405044352501c2094032eb9a7a2ece5f0b1c0e66a4c550977af62f6072ec505f94f9835981420edcdc494888f4ecfc7d636249fb777f0c32f86a316680ec5247278ef8c0dfe223b146d06f256213a1cde49472f3bd04f45404fcd09ba7eaf46031516f5221b43e1a39e9945427cb1e4428c3cf4992b04a7fb9ae5d65b8adbf0fcf1f7d502d1a302fdf26580f8f09fd369c6607c1c6537ef8294f264def6b6607555bc53dcb94c1cfaaf4c1b99e42e8d1a079f018dd2777e2520b3b1420f452f32878590a56bb51131394a6465cd113e5124867af5c0fc053b3d2b8b0e6762c3716710e49862cc315bb5cafbc8d16818bae7750ce9db9ec24312fca008dbea26b250b0f43914e8109e0efafaab1b83a071358d087b3db8a504e69d319a61fd2f8d53e4773dd81a6d749f21fa7d791946ed47281664cc52e55dfbdd24ad6edcea30a0f805c1032cfdf480fa87a4db6e2d0962fc97de73417ff83d7b3db9c7778da267c52c6573c97114d51b88ac4064d90e1ba950e5ce9d7792566a7c32bf2dbc63645403f6581de1a86d2693502c3a50ef41b718f6202b82e8949c02a3988ce7f43b01b4f007760003607e10cd996258c95d153e95f9b78ad565c49a08324cbae9a0b2c670a3c23fc604ba17227a293826b007eaa6ad07315fb5b15ed11aa113eae25939b62a4346e20b12bf8a4f4b4b2b754eeb254daffc15bf6237806ea276a4f12e248c85afaff8ce87efcdec151a72337f23d0e95f98b364b04bf803c103d594a208972453c00c64417e671dcf9df5d13ec892693bc81d1ae6f02a092567475e3e707baa1710f6d8d1616f52429627f7ab5ebcbaf16debec19aa4592039242a422174efe5001366f46e99289d1ec37c64f8d8099744f82c26e3667aa7bd5e8594625c24b800e324908b76b1592607bb4832b6733573e77d5b7d1c70141c48083ce2cbef32f2078839687bed9542af7dba6ef0bd2124cbc134c9452c846b9c9df346091b0d492c627e3be90ac770fa3f17771c51e34afa64121500ddf58331d86d3eb25cfd43ada47fef1dfbf1bdc0f5220bb53bc24f0f7f77ac7d54efc7021fecc4045b3ff70e6cbea8a8da4d31675eb20da5dd5b59d77f7b201e89de12022af66daa16e37c171b430344be8d0cb2d30f1f67af9256f05960771825576155d886f31b886182bf848bd64da513f0b412a81f505e7bc8323168da0e579d35ae45c8244bd79268e534b55d85b36f4ac532ca0c39513a958ac4681e2249f8e5ce5f49892edefb3f7251efe16aa380b4d49978849e51ddb4ed4c4099e44db7581ecd11eee99364120f7c6599de79a24d3453026d4c20ec5f2a79e46bd4b083858558ee19f68157929134ac302b72abc7a1dbd20a230dadb20f8d5343862e38b5e53db29b037c932b623125923f97b9832d191839945da5fed33597d1cdb77562542a8e84bf0ffbcfe2cf5886073a62e06e05d4171173162c577a0b4201407ac574edd5de47c5d0ce05111eedce832f63f921ce2363f0be49463474b601f0e462d3e72e5a58ee76026080e9b1a3f47e78791071d7cee84210f6856992faa6eb4904dbcde1b04b6b759d93204b113760244896cfc90fa68efb8af0ab720822fe5beadc58072b6af4b8c152a7c001e4ee37e51b2c0c809f52bb35030bd40b7a3408bfc05fdb37e7dfdc7e305801ba8ca547156506ebfc5db50a22cbfc3b098e70fabe9097a99052d95ce30674c8dec492ba83763ce24d283f14fe031f70aea961b1eed5e40949df53033ee56201c43c661182635979598d169f00b07b4e25fb1d47004dfc484341ad6e01d52605a070e371e148c542c96ffaa445211da1c97eeebcee2cf3e8c1aef9a3c0ce84bc31fd7a536a3c660dc9b0e8c9d9cacf356ba295d1d4c6b52f4cf342d804228ed8120d5a50aff944ac2ae59a0edeab7d80a32d69f13503bd2993df7b61d502c18098b63e42f8275fbe410a86d659047ff23d69b9d52e385d35625e5ce26d8ccbd33d246a49e402bf6cd23ad8a7ba87319208a4eceb218ff7d90615f5f5e71524a0c38043cce0b5dd16df421d006ab9d043d7ba5b19710080e350af0f1456643eccbf354d0a24632544690c3a8d7ab195510f7b9096e4411ce8c96e6637b611dee15fd63c6afe366f2cefb88e4dfa9e7caf726065209dbdf81bf805f2f4c2ec73d0001af1e6caf2e7e8d99907d8900c30b5b363950f070d29e1488eb70ea2f0033e3231a8cbab8f76aa3b16278a79b9baca59d4d0caf044328b615537b22dfa1d050c219665dbba0695b87c6c00a785236251d65f33e190c2ddca6ac45e21d6a2779e3b8f8460f7f09d6812c391f94a51e216553c90968083251c1653e97c077207a7c76d0b7d631c43bc0194676f1d2cc16e7dd567684926798d51a669eaabe6ca3dff73ed3fae0a9a224c1644b65411029663938fb5c8f7aee53299b44690c66fca646600170599199aecc374035bfaf9ee804963e8035a783c98a2045a3a62c83dfd829238b86ac53331fed86fa9991db302897f8b11ce634127c58e200b57b036a07c5bff4adba3ad766a879085ab65365bd31a710115dcb94b7ec09dbe18d647267371565a0ab93f62ff4ae48d4104a349ab0e4899ce8c1eefa96580991d097da50edba493692252b8697bca1f7cde8b8f52381ddd71d2a1ad060f770f79026e6eb8adf43df2d97223a688331121b67cc06010cd97ad8ca2ae7c3bf708e4b7f0a4ec1210eb880ac7e0fbc411b8e8ba88afee834ef317832fa67b3384c57486e292010a7f72a48af885bd5273bc112c79322cec93c463ab21adcb7f722f89ad7dfd37f20cb1cbb234d4f12e7ccaa223b918211eba622d427a942515e8628e23b414246fc0d2025978b8c64d523749fe18ed8971b8ddc4e7e7307e3315390e2717003d0f13a8ab2239bd3552ec8d3295effa2605a3b314d9937bffb9bb6fe449f6ea505111760accb8e07d4f5f11291bfff1d0cdd21333f8a120c949779fb56874a6ca1b819f8c36257f7bcf05098ca111e49ef00ec3c3d4445d1289cc3de50f269c86eeb7eccbaeebd9cdc98193fbbc766c98620c064ef3187abe4a4df521e4c4de4fb8ac5d0df594da4abdbd8cb5421eb237fecc1df19fefdbf19b70e46fe8a9acbe45de2dc3a301c8d21fad4c7d65118605ff752f3aa647d44fc71cb2bfc6af536ef0059b2a29de59009f6f1e3b89e197308410190f27dcfdab0700a2f1750fc5fa0ed76e88a8359a83552ad509b72f347110e8ca9cda257564db0be4a56f788a0d990462c5b657c71573d67c54c89ac1375809a7db98f6866e3b22f4e096cb5f8f6ef8d8c1661d815dc5362c04452005dcba6c0f0548c5ff9b55ff28dbc3186cc18bbeee92d371542429ac3cdb6d06945a56e07e6bc0f601199aca9e1bb67304a455bef5e728c0197ed72c2b9a34276d88a114889ca21ce1d9c87f794399c4c185fe7199b705b19564c01abf8a3691eb43f41459cd3396f9b01600bba7388e0a0a90c598ba2e84982d77b84890426759354620b8dbeef1d73f1c872b6061a42cec928b29f88f9a1be6152a30c8d0c3dfbaf7215e18c0c9fc282099905be3e156b2a45965485994a8f52d9109393229427f2295882cc5053fa0cf0b291232f306fae53a4aedfec8089a83dd5effd6c5466571b140157703062b05c38551d51ccb732500096adeee7fd476aef07c08ec09649c70bd8c1d7ea45f4ece09ede05ec9c73f6c9d5df759efe171d5fdeec0f638c6f9c46c26658ba1bee2733501409c71010151b6197d0ecd01c9cbb148ea1ba0a7e36c9418636b2f0d1d00328423ea42439914d3b3c40f59065994be1c1bdb39eab4390d24c54b3ae39033beef7b375d00231d2d32a6a1663b4d1e52db86afbcc2d6044d01672088718d5838b249c2db5f93336a123ea1511adada9eaa177585a1bf2a2e5b813cab3d834483ca8b285eb12f24b4a604149ff7ec08a5a5635ae6eebfa9c250371f4c08b47b54c1f2fde5b6d5afb50d9cce4be6fcc4e537966e0732ff35c9786978afed0caffcf20dc770be2c068cf3e475721253ca18082f11f08fc2b62ca65f4c49d55b649fae04da140486ab638e0b112be9b02f97084015fc5ab84179321cbebec68f3d6c755762d68843b375fc626ca9f81d39903dc877a06428d9fce5593f0a49de3ccbe10ebb1bc44f07fbcc3d4417b4aa9ded0397771417b3c15db5c8b20f2073f5161d77ae7b0590260dc73626424a4b250ab48fac334f6bcc3494803236fe9433eb056ec9735e3d91f7b9fcc7bba797def4adc6b638315b3bfb8337eb790ea43a3b7dae31fa076f735e3207526e912b776e6ed3133c329e0dead749aa00aaf62883b7b2e86c84dd88ee81bba667f1cde4aa3d23737fa110f30548ab43112de27393a29fb71f3afb0af5a1f54685e7dd9aa5dbfef5882eb6b810d92831a0e4e985507816dacdd52526972ac394ee6b4fccdd1d67d2720fa4d23003dc00326dd925eddafd53aabe2b90018834a70e2cee2b81ec374aec3dae40f7a4f4915b6283ec9c507b098bb5722185059945f77f52c14b96e85d1d8f6ff74a0d9cce49a5e6a6828a858bd49c189eded4eba8e6c8132432a75900e1fb82be4b38b42545f840e392e70b49d311a1c3217a89378a98ef19c40f4f23b1882d2ccb3f34563fdd146fd97b73e5fa9371dcd07a3c4a1258308e70794417891f65119e1f661838b820cebba8c6f94a5b76d3137df94ead0b27a793a47376bdf9e14e9ef34c8ad29e1de35f10c450a6afb4551c15c5deb3e18a5ea5bdab2c318e5875befd57c3f1dee174170d668c3913641e9cb540ff8e96427ff9b2fca44f73824487e3e36f50450a51f634d3f11b8aff40b55d502989f7da6614e5b2cc666e3948dc2b3eed238862141c9a4fb6c48d1506ca0b8471b6760e7072c75c74a8d2f8f082b6c2d018e4d20de0921a51dca40139da3ca5090315c4b1435292272f81b7183e95b020865fae78b863b16f329677f897c464b4b7bc754f12cf1982a5caaf7cf739b568cb3d12e1a8cbdd35727049e24fc247bae8b644143cce63f889b586bfa6c314373473ad85cf159902556fde0e69e0344ed336a5b87e8f7e187c74e16fe723b4f7eb6601ae81f84009a0eab6d9bbe08a181115d7b41b24f6315fd10822a62c9d6451a63cf0fa8e792304c0ff9e4aa983d69997890fd6359fc7fd3945ccaa7c8fbcc1cefea0fb8a89e540c5feece919bb52055cc83f990ddcd15ec28f46c016aa924abc1bff536202f3d41f796fd8202f5ef442e807f2e15bb026023c0e5ae6d30a91e2fe4c7f0cbf098c9ed334e1579fc42016e07cbd4b8642cc6f89971383c6843f283b87c7293db3bd746dac109aede50d0aaeb5ed64bab919ea19f89bef6d837a0b7c8785eac8fad437a65af56a8e5c988cf08c5f1425f7ff9316052d5ba8c914ced8f1ec22bd68861b22f4139e03e14042ee7fd946c16bc92470b2e9ed4bcf1f93dc8d7f11c98bf53a5fa1f3b8e3846addb7d6bd1b5a82c617c7ea5198539f8c5ad7dbc19c2148272369580c2f3656cade4b7b1122fc94069b9e6914dc31e53b8cba83147f024c874071614beee4c7a505fa9871e56fdc1bca5ac1ac7b6ed6ce4a5f87922d9f63571fd9e20b80b2f21769b647054cdf4a31f7cd95c7b77dbb78f709bef3388f62aafbe50a59ef9c559c54c2a7c6816d5cb3cd1d96abfee6b4cbc9690205d9bca03e750b57307c5eb0946de13355a2e5c48b69a15678c76da6980c5d11e35cb51c7042cbfb5a8a5ccab3f19180284bacffb99ab17e14e2ae2696b615196adbd283eb6e11ec7674dcedce51477caa3771a27ef4e702bfa505b1ff324c393689d2fafc87be5769b08b5524e522b8576c96621d08420a1905ba1804200a8beb2e082753faf2b27711353b9be44b96174f3aa57e1a3ea887b61bcb724d38d44cb55d2f5a9e1970596be40a70f56b2e6cfde632943a5c09724de58c7448e9413c45e12379fbcce0984e0012af858f647e2a8cb5a053b07640e7911600bf86c9b0fa2834df396e3d60a57b0113714966dfa6b68837c2a7f4ee66dff488da725f3d85785b330cc6839c13f070223afb7494f1a29802ddc16c84ffd86401335147eda230c9642e2eacee524034c760750f22af6b60d0992525646022d0e582e5fda8925a9631e402aa2eb83cd637e8b4e7a75f95b328c5d5f03b0d18177060566473e1904f01efba26f94f760ea9a86ae716f17c09ca1dbb3fddabd2fa990750d76c07f0a6da24729ef16264839da2fe9d89bff07ddfe0f82a26172021ea6340afad71aeb013c0eaa060f79696d7d4c8c982fbae50e35aa7272b13ae4f773727b997891357e67cab3c3e3c67764725dc78ce8fd30abc510548143b5a7efda34108e29a4620bb66bf27e19d5d036b1864599c7eb858afcd89370a71c865c164e12cca83d409d02479bb72dbfcc874cdfe600a36b8741a95d336b87527f864f5f3ca0407b7514ccb1c27256bfd0903ef4fd5895b2414ee9c3f66dc12e8f287b96aa2f061343b16039b3f8b64be0d79f75a9d7e24cca7ebfb61b62b572041559149a77e57c883bf085def05312b3f01a5695f473990b6ca0048d997a7aa847821c7dbe800dc53fd0be757763a2c82b0266b32a60a789340d1b62455ecf9817152aa3b7ae7bc57838b7c0d1c99c955e53f439454ed5d236239751147efe340669054806e0a1e178bd4bdcdafb1f0f6abede67ca28c839387e896600072575883b0510c77051e34684bd954497ad7909678a089a04667d7ff6f07a4530069dc72ab1334fa867ba6be969390cc91416a3c8d0c031e236f824b230bafdcd6caf2b7d38c62554f6ee1a4131271b1115f26d3b2cb02cc081a3c5afa5d07d8a43b3f38a484c624c6acefc8d7a0539c98a3f10222e79a8b91b6672d90d4e57961ea78bf2ba792a5edafb51e02ac983fd0fed07cb88fca62f9845a5d44c978fdd39f94bd4a2e80febc4cc431c87c04b0505f9f63f8661ff0bdb1a6f2bb94ef2314fdc0588ff4a97bf6e223a20c0631023038b4fd4949d6ede5e72b0a6d6923ec7f8d146cdfdf0471cec8caeb407daefa30a417386ca0d77896174e283b04ff5b02217629795f481781c3ae83520a35754a3f88534bee858d11e7c0475b72c1a4cc6777e17712f521376f7b940c115b08dde8f9d23e7e4bd4f1417f63d1dc76c3c9b0061173356848b5ed3f8d0ff7457911b8e5c14d7dbb10ef4456668426c0af74b61754884da8e52db1cd5eee4fcd40d2a11626f927d202a04dbc4d814371971829156a2d4fc69137919efa6ccb00ad54d013610058100e0fd0b4363198e4deaf95eeff87acd61d99eced304ff51a475dac4fba0b865e77936ad77cd07bde6fee754e9db73db7344d45599d489359fdfa5f5ebf5688dcdba65fb576c1f5e8bab3a44e90078912a04179b33f5f389921f6b13e1453db4e9bae1032c6e34c25b696f44dddd4eab8e33647671e7aa4c57cf805f9d6f79897cee857714422a0de1fb30af3bd9d7aba1b6e09f5d8de461a1462cb9b3502a626a39ffa24dff8e108e5b08716e11c02f037d2c0f77d58ce25a8f667a1efeb0772ddfb4a862fd60b4ea28a6cd0424eb4101159268bc56f259eac4affff9db8c876b014cb6e422c975887360aca3911581e1ca1c90e492bd8d059484077ee712ae28479fdad8fdd2693eb19695ef83733add167f9fc002d2f9ddfec9e585f5e7ae8bc2b76b5426126d7b196f7b256ff839b119bb5662c34381162258fb34734c1414dcbf36a4b366bc80fca8c25ca5e7051f1ce77a6786191ea9c99a3bf3b04e7aa95b7b47664711877d0283cb97418cc443645ae9d32bcc511283f3301986496f88a6c2eab23fd6b8cbc897eb1fc8ce68a4062b16dd04781ee51857bffe8941d3d9dc6f958efa753bb02aeab42d27edadd04c0714420e38693ce6634f05f733fd01dacc6ddf4a66f99445272fca866c0e4ff7f07ba874dcc50689aca7d27a01bf10e6d4866d5dd0332068959788aa2de9dc7a5f7db190ba17e27f90f75e593ba21455c1803c78b67d8da324c0e43f0f3b2c60572fff4dfd7723ab27cfc3f48b72bc457018514e9569671604f6ca0712e30b200f11aaedc5d54e54cba8515c8c07402dc49c991f7b2552a199e3881406b5c9d4fa946393c9e7f1a5de9c079549415c86c9f5d2e185bb09875ef73dbb79a66f1a9be8751b54d7c6ad1dca0690022cdc21a77ae012e11aba14697dea9b1555f65c2c0cab41e0df77f4e0e7664845ec4deb82a759a2763b3112a6451b86542cc8a1f0e740abec2c5f51576a763d120b29e3993fe713aa38c956d5745379c922e352f777f766370ce293f2c5877b765b0d18cb82eb66442b7b06a433c621df82812618c9b03720a688d42198c18da1c0b58c18b6b28be9be0eecbd3bbc89ea8c0210a12dd5edbed486e473f369b0c50936d4dbed4ac8cffb9372452d97f5546d6715cc81c507af48a8aa3c55b6a1c8be6a527c15e84071a2cd258253fa6a278fee357046f11683de4e7be95396bb3f27d613ea840eb7af12fffa6bed03bce1aceaa31ed2884e6ac4916d26ebfb7cbaf4feaf928f1a711c607c2ebe952ee509256121e185bb2bbccf0ac818ca41504d3a30b29e4453ee1e22cbe5b2040ae5f3b4bb29c51d2ae93672d3328fe067f7cdf87e4eb72fd67c8392a8336b5544e9dced853120b5c602c1e37f9f5dac38191bb784c4cb2a4e65612fd994c40728336c3739dd3f601414ce62397b5267ff640f417b337a497f2706966f058fea251f0352c8c714c943608f10186abb886b915f2589a6b3795dbd83d793168a25a57c0eba5415c2dbae21a8dd2ba618d141fbc8bb390e92c3bc20c17a204c096f3059f1a28775f5c6331d9353e72c1ddcbd186e488adc28f22aa6513317ed5db4dff9ac72eb996e7005338803fb29a3a42c7806929d3af8705b40e26f604cc11841a56d10d64231ad0c63b68dcb8f730a6c9fb3a24d94ecc87e834cab164340e24002dceb6f0e50e9a2d4652c416510a9c581b8b08f5540221c02f4f2bb49c24ffb9d8576a4688524a4daebe7df6a27bfe9bf123bfe9c42c7e6a0a2c60b0ea048b0256dae6bf4bc451516562b5ef6492fe1cc3d69616164fe966ada157932bc06984b60046e3d7bacde78214d4140cf54f7ec450effa18e17cb6b36792a384314d62b37268bf02332e1a22589aa46d3c53a1f8906b99ce4b947d47b799d98c053a0d1784aa3b2d6857368a6be28b9551cf6163211791ecd5da3add1efac9643ac42cffdef3674c135417ef5c314e95d6eb41e9efa01a2532dec51620b6a4158fd7bf2dad869f43f1e4e410b42006804ce9105e6bb106c8cfe84753ba8f31499ad5de075f87dddfcf9bb8e427c11203b7ee63326c592b50227c49c1e34d93c65fd868a2f8e70bd3ad0056cc15c6e2507d3057f1b17256916e56a5367d6b79cf8010d138c6957b03ab17ae240421fa08b0607c1aa1daf28b121352f84311238fef1757e59719341eda60dc9e740095c14afff2ad719a72826655ddc0826bd5e5713f8c3e24b4b3a7ba85f6f0ca8713a3893ad8175715b6f61efcfb8065ae26439a0a45efff49a9058fd3a61ffd8d96b0ffa06aae7bcd72d0ecf05c348b6a24e2b6f2256434ebda445db1214fae0dfde121c3b7ca938275d413e276f8a6fb2b060db219f56c224934f64f57b4e76cac4a44c5f988e470afe7b116397913b3a01b61ef607027b31c99686125e3d2f2661b369425bae8e474176d14ed50fb85fd81ab1d82ed49fd49bde4ea0c45fefedee792721953f9d928c14d2e13ecd54e3115fe8e54bc308f73cb313b2e888cd794176d60c97662194bbddbcfe4e73c6d8f26518397970b313fe255593bb0b934c2977d06977378314b82cabc36f94270686eea4e20ecde9ab43d84c616c6cedf97aa245f9140d9d627e55f1cef7623b1d8f4634c919c3cd0f2616f392b216c53354055fa0d058d1127d74358f5651d78b89bbb370957fd9adc86afce89113460baeae34cbfa1f30908d733af79b20a40910e22b144494abe9822b6525036dde4b3e7cbedcb4090eb034d408f5650c306191fecf38f43486fee4f80743d3ade266f9b0733df1a999ea150e691ea78d6d02ea028fe84d9badb9e165006f994e0f62f5d8ddb98828ab8b1d00ba3b5cce28703c8fce682c0bdc0fc656045ae5aa0a268c43464714364258ecaf22a0ca10423ed2300739cad339cd52e66ae99ad164e923a5eb53c5eb0dea2191a8e3e4ab3a05b1c733cff62fffefe91f93a55a8c180dcb1f12d88bc8b3eba6030e7b357c745ffa07a9f77e54609bb1198816643b2ab1d1d5943506e728404431bbf3b5f50ae94a119ace7420017aa239c9d687b0c2e671f9c77f0256bf569af9053</script>\n  <div class=\"hbe hbe-content\">\n    <div class=\"hbe hbe-input hbe-input-default\">\n      <input class=\"hbe hbe-input-field hbe-input-field-default\" type=\"password\" id=\"hbePass\">\n      <label class=\"hbe hbe-input-label hbe-input-label-default\" for=\"hbePass\">\n        <span class=\"hbe hbe-input-label-content hbe-input-label-content-default\">Hey, password is required here.</span>\n      </label>\n    </div>\n  </div>\n</div>\n<script data-pjax src=\"/lib/hbe.js\"></script><link href=\"/css/hbe.style.css\" rel=\"stylesheet\" type=\"text/css\">",
            "tags": [
                "Hexo",
                "Front Matter",
                "code"
            ]
        },
        {
            "id": "https://enjundu.github.io/bit/%E7%BE%8E%E8%B5%9B%E2%80%94%E2%80%94%E4%B8%83%E9%B3%83%E9%B3%97/",
            "url": "https://enjundu.github.io/bit/%E7%BE%8E%E8%B5%9B%E2%80%94%E2%80%94%E4%B8%83%E9%B3%83%E9%B3%97/",
            "title": "美赛——七鳃鳗",
            "date_published": "2024-07-04T01:41:31.000Z",
            "content_html": "<h1 id=\"mcm-paper\"><a class=\"anchor\" href=\"#mcm-paper\">#</a> MCM paper</h1>\n<h2 id=\"question\"><a class=\"anchor\" href=\"#question\">#</a> question</h2>\n<p>​\tWhile some animal species exist outside of the usual male or female sexes, most species are</p>\n<p>substantially either male or female. Although many species exhibit a 1:1 sex ratio at birth, other</p>\n<p>species deviate from an even sex ratio. This is called adaptive sex ratio variation. For example,</p>\n<p>the temperature of the nest incubating eggs of the American alligator influences the sex ratios at</p>\n<p>birth</p>\n<p>​\tThe role of <strong>lampreys</strong> is complex. In some lake habitats, they are seen as parasites with a</p>\n<p>significant impact on the ecosystem, whereas lampreys are also a food source in some regions of</p>\n<p>the world, such as Scandinavia, the Baltics, and for some Indigenous peoples of the Pacific</p>\n<p>Northwest in North America.</p>\n<p>​\tThe sex ratio of sea lampreys can vary based on external circumstances. Sea lampreys become</p>\n<p>male or female depending on how quickly they grow during the larval stage. These larval growth</p>\n<p>rates are influenced by the availability of food. In environments where food availability is low,</p>\n<p>growth rates will be lower, and the percentage of males can reach approximately 78% of the</p>\n<p>population. In environments where food is more readily available, the percentage of males has</p>\n<p>been observed to be approximately 56% of the population.</p>\n<p>​\tWe focus on the question of sex ratios and their dependence on local conditions, specifically for</p>\n<p>sea lampreys. Sea lampreys live in lake or sea habitats and migrate up rivers to spawn. The task</p>\n<p>is to examine the advantages and disadvantages of the ability for a species to alter its sex ratio</p>\n<p>depending on resource availability. Your team should develop and examine a model to provide</p>\n<p>insights into the resulting interactions in an ecosystem.</p>\n<p>Questions to examine include the following:</p>\n<ul>\n<li>\n<p>What is the impact on the larger ecological system when the population of lampreys can</p>\n<p>alter its sex ratio?</p>\n</li>\n<li>\n<p>What are the advantages and disadvantages to the population of lampreys?</p>\n</li>\n<li>\n<p>What is the impact on the stability of the ecosystem given the changes in the sex ratios of</p>\n<p>lampreys?</p>\n</li>\n<li>\n<p>Can an ecosystem with variable sex ratios in the lamprey population offer advantages to</p>\n<p>others in the ecosystem, such as parasites?</p>\n<h2 id=\"paper-begin\"><a class=\"anchor\" href=\"#paper-begin\">#</a> Paper begin</h2>\n<h3 id=\"summary\"><a class=\"anchor\" href=\"#summary\">#</a> <strong>Summary</strong></h3>\n<p>In this study, we first innovatively constructed a dynamic simulated ecological environment through the <em><strong>*Netlogo model*</strong></em>, and thoroughly investigated the multifaceted impacts of changes in the sex ratio of seven-gill eels on the entire ecosystem. Then we used a variety of models and methods to synthesize the analysis around research questions I to IV.</p>\n<p>For problem 1: We use analytic Hierarchy Process (AHP) and LA model to quantify the relationship between various factors and study the multi-level impact of sex ratio change on the ecosystem. Through AHP, we derive the weight allocation of the impact of sex ratio changes on the ecosystem, while the LA model optimizes the decision-making process. The results show that changes in <strong>sex ratio significantly affect adaptation</strong>, resource utilization and species diversity, and provide a key ecological balance mechanism for the system.</p>\n<p>For problem 2: Using a comprehensive evaluation method and genetic algorithm, we considered the advantages and disadvantages of the lamprey population in a comprehensive manner. Through the parameter optimization of the genetic algorithm, we gained a deeper understanding of the advantages of the dynamic adjustment of the sex ratio of the lamprey on its own reproductive growth. By cross-corroborating the two models, we conclude that the ecological advantages of dynamically adjusting the sex ratio far outweigh the disadvantages. <strong>The ecological adaptations and advantages demonstrated by lampreys through the flexible adjustment of sex ratios dominate in maintaining ecosystem balance and diversity.</strong></p>\n<p>For problem 3: Using the eigenvalue method of differential equation combined with Jacobian matrix, we deeply discuss the effect of sex ratio change on ecosystem stability. Eigenvalue analysis reveals the key role of sex ratio in maintaining ecosystem stability. Our conclusion emphasizes that the change of sex ratio is an important factor in the dynamic balance of ecosystems and provides scientific basis for ecological conservation and management.</p>\n<p>For problem 4: Using system dynamics and ecosystem interaction models, we comprehensively consider the complex relationships between lampreys and other species. By simulating ecological interactions under different scenarios, <strong>we found that changes in sex ratios have positive effects on other species and maintain the relative balance of the entire ecosystem.</strong></p>\n<p>Sensitivity analysis: We conducted an in-depth sensitivity analysis of all models to verify the reliability of the models in different scenarios. The steps of sensitivity analysis involve a systematic study of changes in the key parameters of each model. In the AHP and LA models, we adjusted the weights and decision parameters and simulated different decision scenarios to assess the sensitivity of the models to changes in the sex ratio. For the comprehensive evaluation method and the genetic algorithm, we vary the operational parameters of the genetic algorithm, such as the crossover rate and the mutation rate, and observe the optimization results of the population under different parameter Settings. In differential equations combined with Jacobian matrix, system dynamics and ecosystem interaction models, we adjusted the key parameters in the equations to evaluate the model's response to changes in sex ratio by simulating ecological dynamic processes under different conditions. This series of sensitivity analysis helps to identify the key factors affecting the results in each model, and provides strong support for the reliability and robustness of the model.</p>\n<p>Pros and cons evaluation and outlook: All models are comprehensively evaluated, and the advantages and disadvantages of each model are summarized. Despite some simplifications and assumptions, these models provide insights into understanding the combined effects of changes in lampreys' sex ratios on ecosystems. Looking to the future, the authenticity and reliability of the model can be further improved by introducing more ecological parameters and field observation data to support more accurate ecological management.</p>\n<h4 id=\"keywords\"><a class=\"anchor\" href=\"#keywords\">#</a> Keywords</h4>\n<p>Lampreys, sex ratio change,Netlogo, Analytic Hierarchy Process, Lotka-Volterra model, Comprehensive evaluation Method, Genetic algorithm, Jacobian Matrix and eigenvalues, System dynamics, ecosystem interaction model</p>\n<p><em><strong>*Contents*</strong></em></p>\n<p><a href=\"#_Toc15523\">1  Introduction\t</a></p>\n<p><a href=\"#_Toc13865\">1.1  Background\t</a></p>\n<p><a href=\"#_Toc16722\">1.2  Problem Restatement and Analysis\t</a></p>\n<p><a href=\"#_Toc32468\">1.3  Overview of our work\t</a></p>\n<p><a href=\"#_Toc5833\">2  Assumptions\t</a></p>\n<p><a href=\"#_Toc21803\">3  List of Notation\t</a></p>\n<p><a href=\"#_Toc24626\">4  Preliminary conclusions obtained by Netlogo simulation\t</a></p>\n<p><a href=\"#_Toc8651\">4.1 Preliminary setting\t</a></p>\n<p><a href=\"#_Toc21863\">4.2 Netlogo solves problem one, two, three, four\t</a></p>\n<p><a href=\"#_Toc12299\">5  Effect of variable sex ratio in lampreys on bigger ecosystem\t</a></p>\n<p><a href=\"#_Toc25511\">5.1  Analytic Hierarchy Process (AHP)\t</a></p>\n<p><a href=\"#_Toc21101\">5.2  Lotka-Volterra model\t</a></p>\n<p><a href=\"#_Toc11452\">5.3  Conclusion\t</a></p>\n<p><a href=\"#_Toc8089\">6 Advantages and disadvantages of variable sex ratio for lampreys populations\t</a></p>\n<p><a href=\"#_Toc8339\">6.1 Integrated assessment method\t</a></p>\n<p><a href=\"#_Toc13350\">6.2  Genetic Algorithm\t</a></p>\n<p><a href=\"#_Toc3157\">6.3  Conclusion\t</a></p>\n<p><a href=\"#_Toc1986\">7  Effects of variable sex ratio of lamprey on ecosystem stability\t</a></p>\n<p><a href=\"#_Toc4989\">7.1  Not considering the prey of lampreys\t</a></p>\n<p><a href=\"#_Toc6259\">7.2  Consider the prey of lampreys\t</a></p>\n<p><a href=\"#_Toc27275\">7.3  Conclusion\t</a></p>\n<p><a href=\"#_Toc1288\">8  Effects of variable sex ratio in lampreys on other species\t</a></p>\n<p><a href=\"#_Toc10293\">8.1  System Dynamics\t</a></p>\n<p><a href=\"#_Toc14325\">8.2  Ecological Interaction Model\t</a></p>\n<p><a href=\"#_Toc26957\">8.3  Conclusion\t</a></p>\n<p><a href=\"#_Toc3631\">9  Sensitivity Analysis\t</a></p>\n<p><a href=\"#_Toc9399\">9.1  AHP sensitivity analysis\t</a></p>\n<p><a href=\"#_Toc452\">9.2 Lotka-Volterra sensitivity analysis\t</a></p>\n<p><a href=\"#_Toc14368\">9.3  Comprehensive assessment sensitivity analysis\t</a></p>\n<p><a href=\"#_Toc24121\">9.4  Sensitivity analysis of genetic algorithm\t</a></p>\n<p><a href=\"#_Toc15186\">9.5 Sensitivity testing of eigenvalue models using differential equations\t</a></p>\n<p><a href=\"#_Toc29957\">9.6  Sensitivity analysis of system dynamics\t</a></p>\n<p><a href=\"#_Toc22371\">9.7 Sensitivity analysis of ecological interactions model\t</a></p>\n<p><a href=\"#_Toc14997\">10  Model Evaluation and Further Discussion\t</a></p>\n<p><a href=\"#_Toc2058\">10.1  Question One\t</a></p>\n<p><a href=\"#_Toc14527\">10.2  Question Two\t</a></p>\n<p><a href=\"#_Toc8408\">10.3  Question Three\t</a></p>\n<p><a href=\"#_Toc27028\">10.4  Question Four\t</a></p>\n<p><a href=\"#_Toc32058\">11 Reference\t</a></p>\n<h1 id=\"1-introduction\"><a class=\"anchor\" href=\"#1-introduction\">#</a> <strong>1  Introduction</strong></h1>\n<h2 id=\"11-background\"><a class=\"anchor\" href=\"#11-background\">#</a> <strong>1.1  Background</strong></h2>\n<p><em><strong>*Sea lampreys*</strong></em> live in lake or sea habitats and migrate up rivers to spawn, which have unique position in the study of biology and ecology. Both predatory and parasitic relationships.</p>\n<p>One of the most striking features for lampreys is that their sex can vary according to resource availability. In environments where food is plentiful and growing conditions are favorable, larvae are more likely to develop into larger females, while in environments where resources are scarce, larvae tend to develop into smaller males.This mechanism of sex change may be an adaptive evolutionary strategy that allows the lampreys to adjust its sex ratio to environmental conditions to optimize reproductive success and resource use efficiency.</p>\n<p>The task focus the sex ratios of sea lampreys under resource availability can provide insights into biological adaptation, sex determination, and ecosystem management.</p>\n<h2 id=\"12-problem-restatement-and-analysis\"><a class=\"anchor\" href=\"#12-problem-restatement-and-analysis\">#</a> <strong>1.2  Problem Restatement and Analysis</strong></h2>\n<p><em><strong>*Problem One:*</strong></em> What are the overall effects of adjusting the sex ratio of lampreys populations on the entire ecosystem? This requires us to explore how changes in sex ratios shape the ecological role of lampreys in the wider ecosystem, and to fully understand ecosystem interrelationships through modeling and analysis.</p>\n<p><em><strong>*Problem Two:*</strong></em> What are the advantages and disadvantages of the changing sex ratio for Lampreys? This requires a systematic assessment of the effects of sex ratio adjustment, including advantages such as adaptation, population control and genetic diversity, as well as disadvantages such as fluctuations in reproductive rate and competition for resources.</p>\n<p><em><strong>*Problem Three:*</strong></em> How do changes in the sex ratio collectively affect the stability of the entire ecosystem? Differential equations and Jacobian matrices can be used to explore the effects of sex ratio changes on ecosystem stability, especially when considering factors such as parasites.</p>\n<p><em><strong>*Problem Four:*</strong></em> Do lamprey ecosystems with changing sex ratios have an overall advantage over other species, such as parasites? System dynamics and ecological interaction models can be used to further study the combined effects of sex ratio changes on other species, including advantages in terms of stability, adaptation and niche differentiation.</p>\n<h2 id=\"13-overview-of-our-work\"><a class=\"anchor\" href=\"#13-overview-of-our-work\">#</a> <strong>1.3  Overview of our work</strong></h2>\n<p>To avoid complicated description, intuitively reflect our work process, the flow chart is show as the following figure:</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/RvtpDkwnb6fghdl.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture 1 Our working flow chart*</strong></em></p>\n<h1 id=\"2-assumptions\"><a class=\"anchor\" href=\"#2-assumptions\">#</a> <strong>2  Assumptions</strong></h1>\n<p><em><strong>*Assumption 1*</strong></em>: The growth of the lamprey population approximately follows the Logistic model, with a maximum number allowed by environmental conditions, i.e., the carrying capacity K. The environmental resistance to the lamprey population increases proportionally with population density.</p>\n<p><em><strong>*Assumption 2*</strong></em>: We only consider parasitic marine lampreys, whose juvenile lampreys feed on plankton and are preyed upon by fish and birds, and adults parasitize large fish, with parasitism actions reducing the survival and reproductive capabilities of the host fish.</p>\n<p><em><strong>*Assumption 3*</strong></em>: The sex of lampreys is directly influenced by the amount of food resources acquired during the larval stage in a linear manner.</p>\n<p><em><strong>*Assumption 4*</strong></em>: It is assumed that the number of male lampreys always exceeds that of female lampreys in the natural environment, and the birth rate is proportionally related to the female sex ratio. <em><strong>*Justification*</strong></em>: The data shows that the sex ratio of adult lamprey populations almost always has more males than females. Hadisty and Potter (1971) found that this ratio varies from nearly equal to males nearly five times that of females. Knowing that both male and female lampreys die immediately after mating and spawning, it suggests that lampreys mate only once in their lifetime. The higher the female ratio, the higher the birth rate.</p>\n<h1 id=\"3-list-of-notation\"><a class=\"anchor\" href=\"#3-list-of-notation\">#</a> <strong>3  List of Notation</strong></h1>\n<p><strong>Table 1: Notations used in this paper</strong></p>\n<table>\n<thead>\n<tr>\n<th><em><strong>*Symbol*</strong></em></th>\n<th><em><strong>*Description*</strong></em></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>A</td>\n<td>large ecosystem</td>\n<td></td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps1.jpg)</td>\n<td>Ecological balance, biodiversity, energy flow</td>\n<td></td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps2.jpg)</td>\n<td>Population characteristics of lampreys</td>\n<td></td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps3.jpg)</td>\n<td>Ecosystem impact factors</td>\n<td></td>\n</tr>\n<tr>\n<td>W</td>\n<td>Composite for initial evaluation of question two_ Indicator</td>\n<td></td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps4.jpg)</td>\n<td>Question three: Interactions between predators and prey</td>\n<td></td>\n</tr>\n<tr>\n<td>SR</td>\n<td>Sex Ratio</td>\n<td></td>\n</tr>\n<tr>\n<td>FA</td>\n<td>Food Availability</td>\n<td></td>\n</tr>\n<tr>\n<td>RR</td>\n<td>Reproductive Rate</td>\n<td></td>\n</tr>\n<tr>\n<td>P</td>\n<td>Predtion</td>\n<td></td>\n</tr>\n<tr>\n<td>HU![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps5.jpg) ![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps6.jpg) ![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps7.jpg) ![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps8.jpg)</td>\n<td>Habitat Utilizationpopulation size of the lampreysintrinsic growth rate of the lamprey populationcarrying capacity of the lamprey populationthe intrinsic growth rate of the parasite population</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"4-preliminary-conclusions-obtained-by-netlogo-simulation\"><a class=\"anchor\" href=\"#4-preliminary-conclusions-obtained-by-netlogo-simulation\">#</a> <strong>4</strong>  <strong>Preliminary conclusions obtained by</strong> <strong>N****etlogo simulation</strong></h1>\n<h2 id=\"41-preliminary-setting\"><a class=\"anchor\" href=\"#41-preliminary-setting\">#</a> <strong>4.1</strong> <strong>Preliminary setting</strong></h2>\n<p>Our time was refreshed by 0.1s. In our analysis and solution, we found that netlogo virtual simulation software could be used to simulate a simplified version of the fish ecosystem to initially judge a series of effects of the changes in the sex ratio of lampreys. We first set a series of conditions on netlogo with code: the color of the male lampreys is pink, and the initial energy is a random number of 6 to 16. Female Lampreys are red in color and have an initial energy of a random number from 1 to 10. Male lampreys have a feeding efficiency of 35% and female lampreys have a feeding efficiency of 20%. The color of the lake trout is blue, the energy is set to infinity (relative to the lampreys), and the initial number is set to 1/5 of the total number of lampreys, which can continuously gain energy on the lake trout. We set the color of the bacteria to purple, the initial number to 200, the reproduction rate to 2000%, carrying energy 0.5. The algae are green in color, have an initial number of 50, a reproductive rate of 2500%, and carry energy 2. We set the lampreys to consume 0.5 per step, and they die when they reach negative energy. Lampreys can reproduce at a specified time (time lapse mod40=30~40), when any two lampreys of the opposite sex can mate and produce 12~18 small white fish, both parents die immediately after producing offspring. Baby Lampreys have a 75% chance of dying as they grow. If the baby lampreys survive mod40&gt;10, they can be transformed into male or female lampreys depending on the amount of food resources around them. The specific rules are as follows:When there is plenty of food around (algae + fungi + lake trout more than 60% of the area), small fish are 56% more likely to become male.When there is not enough food around (algae + fungi + lake trout less than 30% of the area) the small fish are 78% more likely to become female lampreys.The proportion of small fish becoming males varies linearly between 56% and 78% according to the resource area.We also created human fishing rules, and we set the environment for lampreys to be able to sustain K.When the number of lampreys is greater than K of the square root of two fractions, humans catch 40-60% of lampreys at a time (of which 10% are juveniles, 60% are females, and 30% are males).</p>\n<p>Based on this preliminary setting, the dynamic changes of lampreys are simulated to derive the initial trend.</p>\n<h2 id=\"42-netlogo-solves-problem-one-two-three-four\"><a class=\"anchor\" href=\"#42-netlogo-solves-problem-one-two-three-four\">#</a> <strong>4.2</strong> <strong>Netlogo solves problem one, two, three, four</strong></h2>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/Qf9pvxKleIPXZ5U.png\" alt=\"image.png\" /></p>\n<p><strong>Picture 2 Dynamic simulation of each element with netlogo</strong></p>\n<p>As for problem 1, the larger ecosystem can be determined by the total resources and human predation. When lampreys can dynamically adjust their energy change according to the resource ratio, and when we adjust the sex ratio of lampreys from 56% to 78%, the curve shows that the total resources of the ecosystem are basically unchanged after 50 iterations.</p>\n<p>For the analysis of problem 2, when we remove the effect that lampreys can dynamically adjust the sex ratio with respect to the surrounding resources, we find that the total resources of the ecosystem and the total amount of lampreys both show a downward trend. It turns out that lampreys' ability to adjust their sex ratio helps them grow and compete.</p>\n<p>For question 3, we found that when lampreys were able to adjust their sex ratio, the human catch would first remain at a stable value. Secondly, the total energy of the ecosystem will remain basically consistent, and the stability of species diversity will be effectively guaranteed.</p>\n<p>In response to question 4, we found that changes in the sex ratio of lampreys populations not only ensure the adaptability of host populations and the diversity of ecological niches, but also provide opportunities for parasite populations to stabilize and grow. Therefore, we can reasonably infer that this change in sex ratio does provide ecological advantages to other species such as parasites, especially in terms of stability and adaptability. This advantage may be critical to maintaining the overall health and diversity of the ecosystem.</p>\n<h1 id=\"5-effect-of-variable-sex-ratio-in-lampreys-on-bigger-ecosystem\"><a class=\"anchor\" href=\"#5-effect-of-variable-sex-ratio-in-lampreys-on-bigger-ecosystem\">#</a> <strong>5  E****ffect of variable</strong> <strong>sex ratio</strong> <strong>in lampreys on</strong> <strong>bigger ecosystem</strong></h1>\n<h2 id=\"51-analytic-hierarchy-process-ahp\"><a class=\"anchor\" href=\"#51-analytic-hierarchy-process-ahp\">#</a> <strong>5.1</strong>  <strong>Analytic Hierarchy Process (AHP)</strong></h2>\n<h3 id=\"511-model-establishment\"><a class=\"anchor\" href=\"#511-model-establishment\">#</a> <strong>5.1.1  Model</strong> <strong>Establishment</strong></h3>\n<p>In hierarchical analysis, we hierarchized the problem as influencing the macroecosystem in terms of orientation (A), ecological balance (B1), biodiversity (B2), energy flow (B3), population size (C1), changes in sex ratios (C2), birth mortality rate (C3), natural and anthropogenic influences (D1), food abundance (D2), hatchery environmental conditions (D3), the waters of the effects of other organisms (D4), seasonal variation (D5), water quality conditions (D6), and temperature effects (D7). At the same time, we establish the hierarchical diagram as follows:</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/thozAHl7Te5rLSM.png\" alt=\"image.png\" /></p>\n<p>Created a judgment matrix B=<img data-src=\"https://s2.loli.net/2024/07/04/TdbYR2tOpgFqM3D.png\" alt=\"image.png\" /></p>\n<p>C=<img data-src=\"https://s2.loli.net/2024/07/04/Jys8Rn75Qbxl4rY.png\" alt=\"image.png\" /></p>\n<p>We calculate the weight vector of B from the code as [0.93103448 0.03448276 0.03448276]</p>\n<p><strong>A hierarchical general ordering table for B and C is then created as follows.</strong></p>\n<p><strong>Table 2</strong> <strong>A hierarchical general ordering table for B and C</strong></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/IzAZyiaDh7uO3Bq.png\" alt=\"image.png\" /></p>\n<p>Also we get the judgment matrix of D under C1~3</p>\n<p>Table 3 The judgment matrix of D when C1, C2, and C3 are fixed respectively</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/YZz6fTC2N4mawUX.png\" alt=\"image.png\" /></p>\n<h3 id=\"512-model-solution\"><a class=\"anchor\" href=\"#512-model-solution\">#</a> <strong>5.1.2  Model solution</strong></h3>\n<p>For <em><strong>*C*</strong></em><em><strong>*1*</strong></em><em><strong>*, C*</strong></em><em><strong>*2*</strong></em><em><strong>*, and C*</strong></em><em><strong>*3*</strong></em> fixed we compute the weight vectors D****1~7**** to get the following table.Multiplying the weights of criterion layer 2 by the coefficients, i.e., multiplying the individual influences by the criterion layer weights, yields:</p>\n<p><em><strong>*Table 4*</strong></em> <em><strong>*table of total weights*</strong></em></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/uipg9FsTJ2ZoV5d.png\" alt=\"image.png\" /></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/rq3dpSFUvyzCkcD.png\" alt=\"image.png\" /></p>\n<p>​                <em><strong>*Picture 4*</strong></em>\t<em><strong>*Various factors affect the heat map*</strong></em></p>\n<h3 id=\"513-results-and-analysis\"><a class=\"anchor\" href=\"#513-results-and-analysis\">#</a> <strong>5.1.3  Results and Analysis</strong></h3>\n<p>As can be seen from the above table:</p>\n<p>（i）The population dynamics of lampreys were greatly affected by the change of sex ratio, followed by the population size. Changes in the sex ratio may directly affect the growth and dynamics of the population. At the same time, species such as lampreys may have complex social structures and behavioral patterns, including courtship behavior and breeding seasons. In these social structures, changes in the sex ratio may cause changes in behavior patterns and dynamics within the population, thus affecting the stability and dynamics of the entire population. Changes in lamprey population size can be relatively stable, as ecosystems usually have a certain carrying capacity. It can be seen from the weight table that the weight of gender ratio in layer C is the highest (1.137930), so the influence of gender ratio on many levels cannot be ignored.</p>\n<p>（ii）It can be seen from the heat map that the sex ratio has the largest or larger influence on the other seven factors, so the sex ratio can affect the population dynamics of lampreys by influencing, for example, the population size of lampreys, the population size of lampreys and the birth mortality rate of lampreys. The change of lampreys population dynamics not only has an impact on the ecological balance and energy flow of the ecosystem, but also has a strong impact on the activities of other organisms. In our view, this effect is positive for the larger ecosystem, which is conducive to improving the stability of the larger ecosystem. In order to keep the energy of the large ecosystem in a specific range, and dynamically regulate the ecological balance and biodiversity to maintain a stable range.</p>\n<h2 id=\"52-lotka-volterra-model\"><a class=\"anchor\" href=\"#52-lotka-volterra-model\">#</a> <strong>5.2</strong>  <strong>Lotka-Volterra model</strong></h2>\n<h3 id=\"521-model-assumptions\"><a class=\"anchor\" href=\"#521-model-assumptions\">#</a> <strong>5.2.1  Model</strong> <strong>Assumptions</strong></h3>\n<p>Our model is predicated on the ecological premise that the sex ratio of marine lamprey populations is a variable trait influenced by environmental factors such as food availability. In our assumptions, we consider the following variables:</p>\n<p>Sex Ratio (SR): A continuum from 0 (all male) to 1 (all female), affecting reproductive rates and predation dynamics.</p>\n<p>Food Availability (FA): A key factor influencing the sex ratio and growth rates within the lamprey population.</p>\n<p>Reproductive Rate (RR): Tied to the sex ratio, determining the potential for population increase.</p>\n<p>Predation (P): Reflecting the food chain's impact, with humans as a primary predator, influencing lamprey survival rates.</p>\n<p>Habitat Utilization (HU): The lampreys' response to environmental conditions, which may affect their migratory and spawning behaviors.</p>\n<p>These factors form the basis of our ecological simulation, where we seek to understand how adaptive changes in sex ratio can affect the broader ecosystem in terms of resource allocation, population dynamics, and overall ecological balance.</p>\n<h3 id=\"522-model-establishment\"><a class=\"anchor\" href=\"#522-model-establishment\">#</a> <strong>5.2.2  Model</strong> <strong>Establishment</strong></h3>\n<p>For codes 1.1 to 1.6, we utilized polynomial fitting to model the impact of sex ratio changes on various ecological variables. The polynomial fitting is an analytical approach used to model relationships between variables in a system where linear assumptions are inadequate. In our case, we use a 3rd degree polynomial to fit the relationship between the gender ratio and food supply, which can be expressed as:</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/1Cy8LJnxFjYIPv6.png\" alt=\"image.png\" /></p>\n<p>Where:</p>\n<p><strong>N</strong> is the prey population (lampreys), <strong>P</strong> is the predator population (humans),<strong>r</strong> is the intrinsic growth rate of the prey,<strong>K</strong> is the carrying capacity of the prey,</p>\n<p><strong>α</strong> is the predation rate coefficient,</p>\n<p><strong>β</strong> is the growth rate coefficient of predators,</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps9.jpg) is the death rate of predators.</p>\n<p>These equations allow us to model the dynamic feedback loop where the prey's growth is limited by the carrying capacity and predation, while the predator's growth is fueled by the successful capture of prey but tempered by their own mortality.</p>\n<p>In your code for code 1.7, the variables are adjusted to reflect the influence of food availability on gender ratio and its subsequent impact on reproductive success and food resource sustainability. The simulation captures how the lamprey population, when considered as prey, is affected by the changing sex ratios and how this, in turn, affects the predator population over time.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/RP9Wc78TpkAadhU.png\" alt=\"image.png\" /></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/pUNxry97tlmoa4z.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture 5 Simulated Gender Ratio in Response to Food Availability  Picture 6 The effect of sex ratio on different variables*</strong></em></p>\n<h3 id=\"523-conclusions\"><a class=\"anchor\" href=\"#523-conclusions\">#</a> <strong>5.2.3</strong> <strong>Conclusions</strong></h3>\n<p>Our model suggests that the marine lamprey's capacity to modify its sex ratio is a significant evolutionary adaptation with profound implications for the ecosystem. An optimal sex ratio can enhance reproductive success, fortify the species' position in the food chain, and improve the sustainable use of food resources. However, these benefits are not without their drawbacks; imbalances may expose the population to increased predation pressure and reproductive challenges, particularly in the face of environmental stressors such as overfishing and habitat degradation.</p>\n<p>In conclusion, the marine lamprey's ability to alter its sex ratio in response to environmental conditions underscores a delicate ecological dance of adaptability and vulnerability. This balancing act is critical to the maintenance of ecosystem health, offering a window into the complex interdependencies that govern life within our waterways. Our findings shed light on the pivotal role that sex ratio variability plays in ecological resilience and resource management, providing key insights for the conservation and management of these unique species.</p>\n<h2 id=\"53-conclusion\"><a class=\"anchor\" href=\"#53-conclusion\">#</a> <strong>5.3  Conclusion</strong></h2>\n<p>Combining the results of the two models, we conclude that the species has the adaptive sex ratio adjustment ability, which has a profound impact on the ecosystem. An optimal sex ratio enhances reproductive success, strengthens the position of species in the food chain, and enhances the sustainable use of food resources. However, this adaptation also brings challenges, and an unbalanced sex ratio can increase predation pressures and reproductive challenges faced by populations, especially in the presence of environmental pressures such as overfishing and habitat degradation.</p>\n<p>Overall, the ray population shows a delicate balance between adaptability and vulnerability in the ecosystem through sex ratio adjustment. This balance is critical to maintaining ecosystem health and provides a window into the complex interdependencies of life in our waters. Our study reveals the key role of sex ratio variation in ecological resilience and resource management, providing important insights into the conservation and management of these unique species.</p>\n<h1 id=\"6-advantages-and-disadvantages-of-variable-sex-ratio-for-lampreys-populations\"><a class=\"anchor\" href=\"#6-advantages-and-disadvantages-of-variable-sex-ratio-for-lampreys-populations\">#</a> <strong>6</strong> <strong>Advantages and disadvantages of</strong> <strong>variable</strong> <strong>sex ratio for lampreys populations</strong></h1>\n<h2 id=\"61-integrated-assessment-method\"><a class=\"anchor\" href=\"#61-integrated-assessment-method\">#</a> <strong>6.1</strong> <strong>I****ntegrated assessment method</strong></h2>\n<h3 id=\"611-model-estabilishment\"><a class=\"anchor\" href=\"#611-model-estabilishment\">#</a> <strong>6.1.1  Model Estabilishment</strong></h3>\n<p>According to the Netlogo fitting results in point 4 we can see the advantage of the seven-gill eel that can dynamically regulate its sex ratio:</p>\n<p><em><strong>*Adaptable:*</strong></em> the ability to adjust the sex ratio to environmental conditions improves the ability to survive and reproduce in resource-limited environments.</p>\n<p><em><strong>*Population control:*</strong></em> By adjusting the sex ratio, lampreyeels are able to control their population size more effectively and reduce excessive competition.</p>\n<p><em><strong>*Genetic diversity:*</strong></em> changing sex ratios may promote genetic diversity and thus increase the adaptive capacity of populations.</p>\n<p>The disadvantages are：</p>\n<p><em><strong>*Fluctuations in reproductive rates:*</strong></em> If one sex is too dominant in a given environment, this may lead to a reduction in reproductive opportunities, affecting the long-term stability of the population.</p>\n<p><em><strong>*Competition for resources:*</strong></em> Changing sex ratios may exacerbate same-sex competition, especially if food or mates are limited.</p>\n<p>Through academic search on google, we built a comprehensive evaluation model after borrowing the paper of William D. Swink.[1]: firstly, we set up the number of initial predators, reproductive success, reproduction process, predation rate, and food resources, and then we set up the parameters to simulate the different sex ability and species change of the lampreyeel, and to simulate the population change of predators and so on.</p>\n<p>The initial evaluation indicator is obtained in our code by W = 0.4 * gender_ratio[gen] + 0.3 * predator_population[gen] + 0.2 * reproductive_success[gen] + 0.1 * food_resources[gen].</p>\n<p>The probability of predation on lampreyP = 0.2*(1-gender_ration[gen ]) to represent the effect of the gender shift on the lampreypopulation.</p>\n<p>The following code iterates the W loop 50 times.</p>\n<p>Then set the weights of the eight variables, i.e.Predation Control=0.2*![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps10.jpg)、Food Chain Role=![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps11.jpg)<em>0.3、Adaptability=![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps12.jpg)<em>0.1、Predation Threat=0.1</em>random(0.1,0.2)、Reproduction Threat=0.2</em>random(0.2,0.5)、Overfishing Risk=0.4<em>random(0.4,0.8)、Environmental Pressure=0.1</em>(0.1,0.5)，ecosystem_provider=0.2*![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps13.jpg)</p>\n<p>Data Setting Analysis:We set the weight of transitional predation by humans to 0.4 and used a random function (0.4,0.8) for the parameter settings, this is due to the fact that human fishing is the main cause of mortality in lampreyeels. Then we set the weight of reproductive threat to 0.2 and the random number set to (0.2,0.5), this is due to the fact that the juvenile mortality of the lampreyeel is also to important cause. And according to William's article, setting Adaptability to the standard deviation of W is necessary. Setting the role of the lampreyeel in the food chain as the maximum value of W, which can reflect the status of the lampreyeel. And his Predation Control set to the mean value of W also responds well to the function of the seven-gill eel. Here the total energy provided by the ecosystem is recorded as the cumulative sum of W.</p>\n<p>The final comprehensive evaluation equation is  <strong>overall_score=</strong><img data-src=\"https://s2.loli.net/2024/07/04/fURQqInYcloaB6C.png\" alt=\"image.png\" />,X for the factors mentioned above.</p>\n<h3 id=\"612-results-and-analysis\"><a class=\"anchor\" href=\"#612-results-and-analysis\">#</a> <strong>6.1.2 Results and Analysis:</strong></h3>\n<p>The results demonstrated that with the output of the model, we output the sex ratio in the 21 cases of (0,1,0.05) which is overall_score with the specific values of the eight factors and plotted the heat map between the models.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/2ubCiAYfn7Mc1kj.png\" alt=\"image.png\" /><img data-src=\"https://s2.loli.net/2024/07/04/VL2Dcsf4rJmaP7h.png\" alt=\"image.png\" /><img data-src=\"https://s2.loli.net/2024/07/04/WrBImgHf9hquVdk.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture 9 Thermal map representation of the relationship between the influencing factors*</strong></em></p>\n<p>Through comprehensive evaluation, we can see that, first of all, we observe picture 7, where the food Chain Role increases with the increase of male proportion, which is caused by the fact that males of lampreys have a stronger ability to obtain resources than females. When lampreys have fewer resources or are attacked by predators, increasing the male ratio helps them reduce mortality and improve their status in the ecological chain. Secondly, we pay attention to the change of predation control. In the range of male possibility value (greater than 50%) of lampreys, the threat of predation slowly decreases with the increase of male proportion. Finally, we pay attention to the change of environmental pressure, and we can see that the environmental pressure decreases with the increase of male proportion after 50%, which also means that the environmental pressure on lampreys decreases with the increase of male proportion. And as you can see from Picture 8, the total resources of the ecosystem do not change as the proportion of male lampreys increases, which means that the ecological balance will not be affected, but the adaptability of lampreys will be enhanced.</p>\n<p>So let's look at the last line of the heat map. It can be seen that the male ratio of lampreys is correlated with all factors, with the strongest correlation for favorable factors, which is shown in red in the figure. However, the association with adverse factors was small, suggesting that an increase in the sex ratio of lampreys can effectively enlarge its beneficial effects and reduce its adverse effects.</p>\n<p>According to our analysis, the most important advantage of regulating the sex ratio of lampreys is to increase the net birth rate: when food is scarce, an increase in the proportion of males reduces the competition for food and improves the success of mating, and when food is abundant, an increase in the proportion of females increases the number of eggs laid and thus the number of offspring.</p>\n<p>Possible disadvantages include: Reduced fertility: When the proportion of males is too high, it may lead to a lack of females, thereby reducing reproductive rate and genetic diversity. When the proportion of females is too high, it can lead to excessive consumption of food, which can affect their growth and health. [Note, this is not inconsistent with advantage, but in a different dimension of thinking about the problem] or over-parasitical other species, resulting in resource damage, population increase, overfishing, disruption of ecological balance, affecting population diversity</p>\n<h2 id=\"62-genetic-algorithmjavascript\"><a class=\"anchor\" href=\"#62-genetic-algorithmjavascript\">#</a> <strong>6.2</strong>  [Genetic Algorithm](javascript:)</h2>\n<h3 id=\"621-model-assumptions\"><a class=\"anchor\" href=\"#621-model-assumptions\">#</a> <strong>6.2.1</strong> <strong>Model Assumptions</strong></h3>\n<p>Our genetic algorithm-based model is founded on the premise that adaptive sex ratio variability is a response to environmental pressures. In the case of the marine lamprey, whose sex determination can be influenced by factors such as food availability during larval development, this adaptability may provide a distinct survival advantage. We assume that in environments where food is scarce, a higher proportion of males could reduce intraspecific competition for resources, while in resource-rich settings, a balanced sex ratio could maximize reproductive opportunities. Nonetheless, these adaptations are not without their trade-offs, as a skewed sex ratio could lead to decreased breeding options and heightened vulnerability to environmental stressors.</p>\n<h3 id=\"622-model-establishment\"><a class=\"anchor\" href=\"#622-model-establishment\">#</a> <strong>6.2.2  Model Establishment</strong></h3>\n<p>Our modeling process begins by initializing a population of potential solutions, represented by binary-encoded DNA. The DNA_LENGTH is set to 24, indicating that each individual solution comprises 24 'genes'. The POP_SIZE of 200 specifies that we will simulate 200 potential sex ratio strategies within the lamprey population. CROSSOVER_RATE at 0.8 and MUTATION_RATE at 0.005 are probability thresholds dictating how often genetic mixing and random mutations occur, respectively, throughout our generations of evolution.</p>\n<p>In the context of lamprey populations, we are particularly interested in how the sex ratio—ranging from 0 (all male) to 1 (all female)—and food availability—also scaled from 0 (lowest) to 1 (highest)—affect the overall fitness of the population. Fitness is a measure of how well each strategy copes with environmental conditions and is calculated by the simulate_environment function, which considers the deviation from an expected sex ratio based on food availability.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/o4RsirmxyGXMTIH.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture 10 Genetic algorithm design flow chart*</strong></em></p>\n<h3 id=\"623-results-and-analysis\"><a class=\"anchor\" href=\"#623-results-and-analysis\">#</a> <strong>6.2.3</strong>  <strong>Results and Analysis</strong></h3>\n<p><em><strong>*Picture 11~16 Food Availability, Food Chain Status, Adaptability, Overfishing, Reproduction threatened and ambient pressure were taken as the y axis, and sex ratio was taken as the x axis. The calculation is a 3D scatter plot of the z axis*</strong></em></p>\n<p>Our simulations reveal that the marine lamprey's ability to adjust its sex ratio confers several advantages. It allows the population to adapt to varying levels of food availability, improves its position in the food chain by optimizing resource allocation, and exhibits remarkable adaptability to environmental conditions. However, the disadvantages become apparent when reproductive opportunities are threatened, or the population faces environmental pressures such as overfishing, which leads to a decrease in fitness. Thus, while the adaptive sex ratio variability of the lamprey population provides certain ecological benefits, it also poses significant risks, underscoring the delicate balance this species maintains within its ecosystem.</p>\n<h2 id=\"63-conclusion\"><a class=\"anchor\" href=\"#63-conclusion\">#</a> <strong>6.3  Conclusion</strong></h2>\n<p>Lampreys show multiple ecological advantages by dynamically regulating the sex ratio. First, increasing the proportion of males increases their position in the food chain, and males are better at resource access, especially when resources are scarce or threatened by predation, which helps to reduce mortality and improve survival competitiveness in the ecological chain. Secondly, adjusting the sex ratio makes lampreys more adaptable, able to flexibly respond to environmental changes, and improve the success rate of survival and reproduction. In addition, an increased male ratio could help reduce predation threats to lampreys, reducing predation pressure and maintaining a more stable population. Finally, the model showed that environmental stress was significantly reduced when the proportion of males was more than 50%, suggesting that the presence of lampreys helped to reduce ecosystem pressure on them and promote the maintenance of ecological balance.</p>\n<p>But sex-ratio adjustment comes with some potential disadvantages. One of these is that it can lead to reduced reproductive opportunities, when the proportion of males is too high there may not be enough females, reducing reproductive rate and genetic diversity. In addition, if the proportion of females is too high, it can lead to overpredation and resource consumption, negatively affecting the growth and health of lampreys. At the same time, factors such as overfishing and environmental pressure may also cause resource damage, excessive population growth, overfishing and other problems, destroy the ecological balance and affect the diversity of the population. Therefore, while enjoying the multiple advantages brought about by sex ratio adjustment, it is also necessary to carefully deal with some disadvantages that may be triggered in order to maintain the balance and stability of lampreys in their ecosystem.</p>\n<p>However, for lampreys, the ecological advantages shown by dynamically adjusting the sex ratio far outweigh the disadvantages. This ability to adjust allows lampreys to respond flexibly to different environmental conditions, improving their survival and reproductive success. By optimizing their position in the food chain, mitigating the threat of predation, and reducing environmental stress, lampreys are able to better adapt to complex ecological environments and maintain their balance in the ecosystem. Despite some potential disadvantages, such as reduced reproductive opportunities and increased environmental pressures, the benefits of sex ratio regulation can be better realized through careful management and integrated consideration of the complexity of ecosystems. Thus, overall, lampreys' ecological adaptations and advantages, demonstrated through flexible regulation of sex ratios, dominate in maintaining balance and diversity in their ecosystems.</p>\n<h1 id=\"7-effects-of-variable-sex-ratio-of-lamprey-on-ecosystem-stability\"><a class=\"anchor\" href=\"#7-effects-of-variable-sex-ratio-of-lamprey-on-ecosystem-stability\">#</a> <strong>7</strong>  <strong>Effects of variable sex ratio of lamprey on ecosystem stability</strong></h1>\n<p>We use differential equation - Jacobian matrix to find eigenvalues to judge the stability of ecosystem. Select the points whose derivative or partial derivative is equal to zero, and analyze these points to calculate the Jacobian matrix near the stable point, and analyze its eigenvalue. We calculate the Jacobian matrix at two stable points (origin and non-zero stable point) and solve their eigenvalues. These eigenvalues can be used to analyze the stability of the system at these points. The real parts of the eigenvalues tell us how the system behaves around these points: if the real parts of the eigenvalues are all negative, then the system is locally stable at that point; If the real part of at least one eigenvalue is positive, the system is unstable at that point.。</p>\n<h2 id=\"71-not-considering-the-prey-of-lampreys\"><a class=\"anchor\" href=\"#71-not-considering-the-prey-of-lampreys\">#</a> <strong>7.1</strong>  <strong>Not considering the prey of lampreys</strong></h2>\n<p>We use the Rottka-Volterra model differential equation, namely:</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/FnJBo8GOHqWCAXK.png\" alt=\"image.png\" /></p>\n<p>The stability of the ecosystem is understood here as a stable population of lampreys and their natural predators. Initialize Natural_Growth_Rate = 0.5+0.5* (gender_ratio[gen] -0.5), make the probability of predation of lampreys β=0.4* (1-gender_ratio), initialize the number of lampreys and the number of predators, and iteration 200 times. According to the output model of the Jacobi equation, the ecosystem is stable when the male proportion is 55% to 81%, and unstable at the rest of the time.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/SyfGlPHKitk9hwb.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture 17 Population dynamics of lampreys and their predators*</strong></em></p>\n<h2 id=\"72-consider-the-prey-of-lampreys\"><a class=\"anchor\" href=\"#72-consider-the-prey-of-lampreys\">#</a> <strong>7.2</strong>  <strong>Consider the prey of lampreys</strong></h2>\n<p>At this point we call the ecosystem differential model:</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/R3Hy1V2OidnmeU8.png\" alt=\"image.png\" /></p>\n<p>Where G is the number of prey, R is the number of prey, and E is the number of predatorsSimilar to 7.1, we added that the predation ability of lampreys increases with the increase of males. Then we performed the Jacobian operation on these three equations, and we were surprised to find that the ecosystem was stable within the range of 50% to 82% males.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/IHDVN6EPCwpBfvA.png\" alt=\"image.png\" /></p>\n<h2 id=\"73-conclusion\"><a class=\"anchor\" href=\"#73-conclusion\">#</a> <strong>7.3  Conclusion</strong></h2>\n<p>Based on the results of the study, the change in the sex ratio of lampreys has a positive effect on maintaining the stability of the ecosystem. Without taking into account parasitism, studies have shown that the ecosystem is relatively stable at a male ratio of 55% to 81%. This suggests that lampreys have the ability to promote a relatively balanced ecosystem within a specific range of male ratios by dynamically adjusting the sex ratio. In the case of lampreys as parasites, the ecosystem remained relatively stable in the 50 to 82 percent range, even with the increased male ratio. This indicates that the regulation of the sex ratio of lampreys can maintain the relative balance of the ecosystem in a wider range, so that the ecosystem shows a certain resilience to the change of sex ratio.</p>\n<p>Combining the two models, we can see that lampreys show positive effects on ecosystem stability by adjusting the sex ratio, providing a regulatory mechanism for ecological balance. This regulation of ecosystem stability may be related to lampreys' ecological roles in resource utilization, predation control and adaptation, contributing to their relative balance in a complex ecological environment. The excess of the interval constructed by the model indicates that even when lampreys are hit by sudden shocks or sudden natural disasters, the sex ratio breaks through the normal interval, they can still maintain their relative stability.</p>\n<h1 id=\"8-effects-of-variable-sex-ratio-in-lampreys-on-other-species\"><a class=\"anchor\" href=\"#8-effects-of-variable-sex-ratio-in-lampreys-on-other-species\">#</a> <strong>8</strong>  <strong>Effects of variable sex ratio in lampreys on other species</strong></h1>\n<h2 id=\"81-system-dynamics\"><a class=\"anchor\" href=\"#81-system-dynamics\">#</a> <strong>8.1</strong>  <strong>System Dynamics</strong></h2>\n<h3 id=\"811-model-assumptions\"><a class=\"anchor\" href=\"#811-model-assumptions\">#</a> <strong>8.1.1 Model Assumptions</strong></h3>\n<p>Our model is predicated on the assumption that the sex ratio of marine lamprey populations, represented as R（T）=F(T)/M(T), can significantly affect ecological dynamics within their habitat. Given the dependence of parasites on their hosts, any fluctuations in the lamprey population—attributable to changes in the sex ratio—could provide an ecological advantage to these parasites. Specifically, we hypothesize that:</p>\n<p>A higher reproduction rate, facilitated by an abundant food supply P(t), will lead to an increase in the lamprey population, subsequently benefiting the parasite population due to increased host availability.</p>\n<p>Parasites might exhibit resilience by maintaining or even increasing their population in the face of fluctuating food supplies, suggesting an advantage in their life cycle and infection strategies that allow survival and propagation when host numbers vary, as expressed by the dynamic <img data-src=\"https://s2.loli.net/2024/07/04/38fOLsUykthHFQu.png\" alt=\"image.png\" /></p>\n</li>\n</ul>\n<p>, where ![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps14.jpg)represents the survival rate of parasites.</p>\n<h3 id=\"812-model-creation-process\"><a class=\"anchor\" href=\"#812-model-creation-process\">#</a> <strong>8.1</strong>**.2** <strong>Model</strong> <strong>Creation Process</strong></h3>\n<p>In constructing our model, we employed a systems dynamics approach to articulate the complex interplay between lamprey populations, parasite populations, and the food supply. The core parameters of our model include:</p>\n<p>The lamprey population over time, *<strong>*<em>N(t)*</em>*</strong>, influenced by the birth rate *<strong>*<em>b*</em>*</strong> related to the female lamprey population *<strong>*<em>F(t)*</em>*</strong> and the death rate *<strong>*<em>d*</em>*</strong>, as well as the external food supply *<strong>*<em>P(t)*</em>*</strong>.</p>\n<p>The parasite population over time, <em><strong>*<em>P(t)*</em>*</strong>, which depends on the lamprey population as its host and is subject to the survival rate <em><strong>*<em>s*</em>*</strong> and death rate <em><strong>*<em>d*</em>*</strong></em></em></em>*<em>p*</em>***.</p>\n<p>The food supply, *<strong>*<em>P(t)*</em>*</strong>, which directly impacts the reproduction rate of lampreys, thereby influencing the availability of hosts for parasites.</p>\n<p>The model is expressed through differential equations that delineate the growth or decline of both the lamprey and parasite populations, incorporating the variables of birth *<strong>*<em>b*</em>*</strong>, death *<strong>*<em>d*</em>*</strong>, and survival *<strong>*<em>s*</em>*</strong> rates<img data-src=\"https://s2.loli.net/2024/07/04/wpJXdxRlCK9gfQS.png\" alt=\"image.png\" /></p>\n<p>These equations represent the core of our dynamic model, capturing the interdependencies and feedback loops within the ecosystem influenced by the sex ratio of the lamprey population.</p>\n<h3 id=\"813-results-and-analysis\"><a class=\"anchor\" href=\"#813-results-and-analysis\">#</a> <strong>8.1.3 Results and Analysis</strong></h3>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/4mG9YzIo8NTr5t6.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture 19~20 Population changes of LamPrey and Parasite under High Food Supply(19) and Low Food Supply(20)*</strong></em></p>\n<p>Figure 19 and  Figure 20 show that :</p>\n<p>Under high food availability, both lamprey populations and parasite populations show an increasing trend . This may be due to the fact that high food availability increases the reproduction rate of lamprey, which in turn provides more hosts for the parasites. Under low food availability, the growth rate of the lamprey population was slower, but the parasite population was still able to grow. Despite the slowdown in lamprey growth, this did not appear to prevent the expansion of the parasite population. These observations suggest that parasitoids show some advantage in this model in that they are able to maintain and even grow populations in spite of changes in lamprey populations. This advantage may stem from their life cycle and infection strategy that allows them to survive and reproduce when host populations fluctuate.</p>\n<p>In conclusion, the model suggests that parasites can leverage variations in the sex ratio of the lamprey population to their advantage, as they are able to grow under various food supply conditions. The ability of parasites to thrive even when food supplies are low, potentially due to a higher number of females during times of resource abundance, points to a significant ecological advantage.</p>\n<h2 id=\"82-ecological-interaction-model\"><a class=\"anchor\" href=\"#82-ecological-interaction-model\">#</a> <strong>8.2</strong>  <strong>Ecological Interaction Model</strong></h2>\n<h3 id=\"821-model-assumptions\"><a class=\"anchor\" href=\"#821-model-assumptions\">#</a> <strong>8.2.1 Model Assumptions</strong></h3>\n<p>In our Ecological Interaction Model, we begin by hypothesizing that variations in the sex ratio of the marine lamprey population can significantly affect reproductive success rates and survival strategies. This, in turn, may have cascading effects on the growth patterns of associated parasitic populations. \tWe postulate that:</p>\n<p>The sex ratio can shift dynamically in response to environmental pressures.</p>\n<p>These shifts can lead to differentiated reproductive roles and success rates between genders.</p>\n<p>Parasites will respond indirectly to these changes due to their dependence on the host population's structure and density.</p>\n<p>For the lamprey population dynamics:</p>\n<p>![of the lamprey population size and the sex ratio <strong>R</strong>.</p>\n<h3 id=\"822-model-establishment\"><a class=\"anchor\" href=\"#822-model-establishment\">#</a> <strong>8.2.2  Model Establishment</strong></h3>\n<p>The creation of our model involved several steps:</p>\n<p>We defined the intrinsic growth rates for lampreys and their parasites, denoted by 'r_lamprey' and 'r_parasite', respectively.</p>\n<p>A carrying capacity 'K_lamprey(R)' was established, which adjusts based on the sex ratio 'R', indicating the population's maximum sustainable size under varying sex ratios.</p>\n<p>We formulated the interaction terms, particularly 'sigma_lamprey', which represents the rate at which parasites affect lampreys, and 'K_parasite(N_lamprey, R)', the modified carrying capacity for parasites influenced by lamprey numbers and sex ratio.</p>\n<p>Differential equations were developed to model the dynamics of both populations, allowing for the simulation of long-term ecological interactions.</p>\n<h3 id=\"823-results-and-analysishttpss2lolinet20240704onnwjqlb7ibsp1vpng\"><a class=\"anchor\" href=\"#823-results-and-analysishttpss2lolinet20240704onnwjqlb7ibsp1vpng\">#</a> <strong>8.2.3  Results and analysis</strong>](<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zMi5sb2xpLm5ldC8yMDI0LzA3LzA0L29ObldKcWxCN2lic1Axdi5wbmc=\">https://s2.loli.net/2024/07/04/oNnWJqlB7ibsP1v.png</span>)</h3>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/LisHxdGoZm6jOAY.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture 21 Dynamics of Lamprey and Parasite Populations*</strong></em></p>\n<p>The variable sex ratio of lamprey populations do offer an advantage to other species in the ecosystem, such as parasites. This advantage is reflected in several key aspects:</p>\n<p>l Sex ratio changes and population stability:</p>\n<p>The graph shows that although the lamprey population declined rapidly initially, it stabilised over time. This stabilisation may be a direct effect of the sex ratio change on the ecosystem, providing a stable host population for the parasites, allowing their population to expand and remain stable. Stable host populations provide a continuous resource for the parasites, allowing them to not only survive, but to reproduce.</p>\n<p>l The ability to adapt to the environment:</p>\n<p>Changes in sex ratios may lead to increased adaptability of lamprey populations to different environmental conditions. For example, during periods of food scarcity, an increase in the proportion of males may help to reduce competition for limited resources, which provides a more stable environment for the parasite as the host population does not collapse due to food shortages.</p>\n<p>l Ecological niche occupancy:</p>\n<p>Changes in sex ratios may mean that male and female lampreys have different roles in the ecosystem. This may lead to changes in ecological niches that provide new or underutilised resources for the parasites, thus increasing their chances of survival and reproduction.</p>\n<p>l Long-term symbiotic relationships:</p>\n<p>The steady growth of parasite populations in the charts suggests that, despite the limited number of hosts, the parasites have adapted to the conditions and have developed a long-term symbiotic relationship with their hosts. This relationship may be caused by changes in sex ratio, as such changes help to limit the growth of parasite populations and prevent them from causing excessive damage to their hosts.</p>\n<h2 id=\"83-conclusion\"><a class=\"anchor\" href=\"#83-conclusion\">#</a> <strong>8.3  Conclusion</strong></h2>\n<p>In conclusion, our two models demonstrate that variable sex ratio of lamyprey offer significant ecological advantages its parasitic counterparts.</p>\n<p>These changes in sex ratio not only promote population stability but also enhance adaptability to environmental variations, offering a consistent resource base and food supply for parasites. They are able to grow under various food supply conditions and when food supplies are low, potentially due to a higher number of females during times of resource abundance.</p>\n<p>Additionally, the alterations in sex ratio lead to ecological niche differentiation, thus providing new opportunities for parasitic population expansion. The establishment of long-term symbiotic relationships also suggests that prudent adjustments in sex ratio can maintain a balance between hosts and parasites, which is essential for the health and diversity of the entire ecosystem.</p>\n<h1 id=\"9-sensitivity-analysis\"><a class=\"anchor\" href=\"#9-sensitivity-analysis\">#</a> <strong>9  Sensitivity</strong> <strong>Analysis</strong></h1>\n<h2 id=\"91-ahp-sensitivity-analysis\"><a class=\"anchor\" href=\"#91-ahp-sensitivity-analysis\">#</a> <strong>9.1  AHP</strong> <strong>sensitivity analysis</strong></h2>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/MrymS8e5O2nilbZ.png\" alt=\"image.png\" /></p>\n<h2 id=\"92-lotka-volterra-sensitivity-analysis\"><a class=\"anchor\" href=\"#92-lotka-volterra-sensitivity-analysis\">#</a> <strong>9.2</strong> <strong>Lotka-Volterra</strong> <strong>sensitivity analysis</strong></h2>\n<p>The sensitivity analysis of model parameters is a critical step in understanding the dynamics of ecological system models. In our Lotka-Volterra model, we conducted a sensitivity analysis on the predation rate (r) and the predation efficiency (beta). These parameters directly affect the interactions between prey and predator populations over time.</p>\n<p>The sensitivity analysis results indicate that the prey population (lampreys) is highly sensitive to changes in the predation rate (r) and predation efficiency (beta). As r and beta increase, there is a significant decrease in the prey population. This sensitivity suggests that even slight variations in predation pressure can significantly impact prey numbers.</p>\n<p>Conversely, the predator population (humans) showed a contrasting trend under certain parameter combinations. With higher rates of r and beta, predator populations initially surge but then stabilize. This may indicate that predators can adapt to changes in food supply by increasing predation activities.</p>\n<p>The sensitivity analysis allows us to conclude that in the Lotka-Volterra model, the impact of the predation rate (r) and predation efficiency (beta) on prey populations is pronounced. The prey population exhibits high sensitivity to these changes, whereas the predator population displays greater adaptability. These findings emphasize the importance of considering these key parameter variations when devising strategies for ecosystem management and conservation.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/gJMQ1NOWbmfdjFZ.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture 22*</strong></em> <em><strong>*Sensitivity analysis plots for predation rate (r) and predation efficiency (β) for the LV equation*</strong></em></p>\n<h2 id=\"93-comprehensive-assessment-sensitivity-analysis\"><a class=\"anchor\" href=\"#93-comprehensive-assessment-sensitivity-analysis\">#</a> <strong>9.3</strong>  <strong>C****omprehensive assessment</strong> <strong>sensitivity analysis</strong></h2>\n<p>We obtained the gender through records_ The line chart of the ratio overall score shows that within the achievable male proportion range, the overall score remains relatively stable. After deducing the third question, the models of the second and third questions are mutually confirmed, and the model is established.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/weEfzsVSI7lFM6h.png\" alt=\"image.png\" /></p>\n<p><strong>Picture 23 Line graph of total IMRT score as a function of gender ratio</strong></p>\n<h2 id=\"94-sensitivity-analysis-of-genetic-algorithm\"><a class=\"anchor\" href=\"#94-sensitivity-analysis-of-genetic-algorithm\">#</a> <strong>9.4</strong>  <strong>Sensitivity analysis of genetic algorithm</strong></h2>\n<p>This sensitivity analysis evaluates how changes in sex ratio and food availability affect the fitness of a simulated lamprey population within a genetic algorithm framework. The analysis aims to determine the model's sensitivity to these two parameters by observing the variations in fitness outcomes.</p>\n<p>The genetic algorithm's population was initialized with a range of sex ratios from 0 (all male) to 1 (all female) and food availability from 0 (lowest) to 1 (highest). For each combination of sex ratio and food availability, the model calculated the corresponding fitness, which represents the population's viability under those conditions.</p>\n<p>The resulting surface plot demonstrates that fitness is highly sensitive to changes in sex ratio when food availability is low. In contrast, the model shows less sensitivity to variations in food availability when the sex ratio is near the extremes (0 or 1). The steepest gradient occurs when transitioning from a male-dominant population to a balanced or female-dominant one, particularly in environments with limited food resources.</p>\n<p>The model displays significant sensitivity to sex ratio changes, particularly in scenarios of low food availability, suggesting that the sex ratio is a critical factor in the population's adaptability. Conversely, the population's fitness is less sensitive to food availability, especially when the sex ratio is balanced. These findings highlight the importance of sex ratio management in conservation and resource allocation strategies for the lamprey species.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/Wu5bPqjHnfsRJKz.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture 24 Sensitivity analysis of sex ratio and food availability*</strong></em></p>\n<h2 id=\"95-sensitivity-testing-of-eigenvalue-models-using-differential-equations\"><a class=\"anchor\" href=\"#95-sensitivity-testing-of-eigenvalue-models-using-differential-equations\">#</a> <strong>9.5</strong> <strong>Sensitivity testing of eigenvalue models using differential equations</strong></h2>\n<p>When we adjust the sex ratio and parameters, within the allowable error range (5%), the stability of the ecosystem output of the code is not affected, and the model is valid.</p>\n<h2 id=\"96-sensitivity-analysis-of-system-dynamics\"><a class=\"anchor\" href=\"#96-sensitivity-analysis-of-system-dynamics\">#</a> <strong>9.6</strong>  <strong>Sensitivity analysis of system dynamics</strong></h2>\n<p>This report examines the sensitivity of the total population size to variations in birth and death rates within a population model. By altering these parameters, the trends in population changes over time are observed.</p>\n<p>The findings indicate that the population size is significantly sensitive to changes in both the birth and death rates. An increase in the birth rate leads to an upward trend in population size, while an increase in the death rate results in a downward trend. Within the parameter range analyzed in this study, the effect of the birth rate appears to be more pronounced, suggesting that it is a critical control parameter for population growth. On the other hand, an increase in the death rate decreases the population size, but the population can still sustain growth when the birth rate is sufficiently high.</p>\n<p>In conclusion, the birth and death rates are sensitive parameters in the population model, exerting direct and significant influences on the population size. Therefore, changes in these parameters should be closely monitored in population management and conservation efforts.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/FmJPS6LZ2OQxlo3.png\" alt=\"inmage\" /></p>\n<p><em><strong>*Picture 25 Sensitivity analysis of birth and death rates by system dynamics*</strong></em></p>\n<h2 id=\"97-sensitivity-analysis-of-ecological-interactions-model\"><a class=\"anchor\" href=\"#97-sensitivity-analysis-of-ecological-interactions-model\">#</a> <strong>9.7</strong> <strong>Sensitivity analysis of ecological interactions model</strong></h2>\n<p>This report presents the findings from a sensitivity analysis conducted on a population model concerning birth and death rates. Our objective was to determine how variations in these parameters influence the overall population growth over time.</p>\n<p>The sensitivity analysis was performed by systematically varying the birth rate between 0.01 to 0.1 and the death rate between 0.005 to 0.02. A total of 40 simulations were run, combining different levels of birth and death rates to observe their effects on the population dynamics.</p>\n<p>The model's output indicates a direct correlation between the birth rate and population size, with higher birth rates resulting in greater population growth. Conversely, increased death rates dampen this growth, as expected. However, the population's sensitivity to changes in the death rate is less pronounced when compared to the birth rate.</p>\n<p>The model demonstrates a high sensitivity to changes in the birth rate, with even slight increases leading to significant rises in population size. In contrast, the death rate's impact is noticeable but less influential. Therefore, we conclude that the population model is more sensitive to variations in birth rate than to changes in death rate.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/eoO1A2baGQBJkW4.png\" alt=\"image.png\" /></p>\n<p><em><strong>*Picture 26 Ecosystem interaction modeling for sensitivity analysis of birth and death rates*</strong></em></p>\n<h1 id=\"10-model-evaluation-and-further-discussion\"><a class=\"anchor\" href=\"#10-model-evaluation-and-further-discussion\">#</a> <strong>10</strong>  <strong>Model Evaluation and Further Discussion</strong></h1>\n<h2 id=\"101-question-one\"><a class=\"anchor\" href=\"#101-question-one\">#</a> <strong>10.1</strong>  <strong>Question One</strong></h2>\n<p>The Analytic Hierarchy Process (AHP) offers a comprehensive analysis of multiple factors, facilitating weight calculation and intuitive insights. However, it is subjective and may not always yield precise conclusions. On the other hand, the Lotka-Volterra model allows dynamic simulation, ecosystem interactions, and adaptive analysis, albeit with the drawback of simplification and parameter uncertainty. In essence, these two models can complement each other. AHP can provide weights and relationships for broader ecosystem impacts, while the Lotka-Volterra model delves deeper into species interactions. Future development should focus on constructing a more realistic and comprehensive ecosystem model by leveraging the strengths of both.</p>\n<h2 id=\"102-question-two\"><a class=\"anchor\" href=\"#102-question-two\">#</a> <strong>10.2</strong>  <strong>Question Two</strong></h2>\n<p>The advantage of the Comprehensive Evaluation Method lies in its ability to conduct a thorough analysis, set reasonable weights, and offer multiple perspectives. While it visually displays relationships through heatmaps, it suffers from subjective parameter setting and complexity. Genetic algorithms, with their adaptability and global search capabilities, are well-suited for complex ecosystem problems. In summary, both models have distinct advantages, and combining them allows for a more holistic understanding of the European eel's impact on the ecosystem. Future research can enhance model reliability and practicality through optimization, improved data quality, and enhanced field observations.</p>\n<h2 id=\"103-question-three\"><a class=\"anchor\" href=\"#103-question-three\">#</a> <strong>10.3</strong>  <strong>Question Three</strong></h2>\n<p>The Ecosystem Stability Model exhibits several merits: it is built on a mathematical framework employing differential equations and Jacobian matrices, providing a scientific and systematic analysis tool. The model compares two scenarios, considering and not considering parasitism, forming a foundation for a more comprehensive understanding. By applying the model to real cases, such as changes in the gender ratio of European eels, it enhances the credibility of practical applications and offers valuable quantitative results to decision-makers. Nevertheless, the model relies on simplified assumptions and may not fully capture all factors impacting real ecosystems. Future efforts could refine algorithms and the model itself for increased precision.</p>\n<h2 id=\"104-question-four\"><a class=\"anchor\" href=\"#104-question-four\">#</a> <strong>10.4</strong>  <strong>Question Four</strong></h2>\n<p>The System Dynamics model, based on system dynamics, comprehensively addresses the complex interactions between European eel populations, parasite populations, and food supply. Core parameters and equations are well-defined, and ecological interactions are explicitly considered. However, both models simplify other factors, such as interactions with other species. These two models complement each other, suggesting the potential for an integrated ecosystem dynamic model in the future to better understand the impact of gender ratio changes on the entire ecosystem.</p>\n<h1 id=\"11-reference\"><a class=\"anchor\" href=\"#11-reference\">#</a> <strong>11</strong> <strong>R****eference</strong></h1>\n<p>[1] William D. Swink. Host Selection and Lethality of Attacks by Sea Lampreys (Petromyzon marinus) in Laboratory Studies (2003). Journal of Great Lakes Research, 29, 307-31</p>\n<p>[2] RYAPOLLOVA N I, PARSHUTA V V, MINTAS A R. Fish industry lamprey larvae breeding-keeping. SU1565441-A. BALTIISK FISH ECON. 2023-08-10. DIIDW:1991034673.</p>\n<p>[3] DAVIS W A. Sea lamprey population control method. US4934318-A; CA2007417-A; CA2007417-C. DAVIS W A. 2023-08-10. DIIDW:1990208774.</p>\n<p>[4] MAURINSH O K, EGGERTS B V. Lamprey fry rearing method. SU1355200-A. TSARNIKAVA KOLKHOZ. 2023-08-10. DIIDW:1988167501.</p>\n<p>[5] WU F, XU A, ZHANG T. Performing artificial breeding of wild Siberian lamprey, by selecting matured northeast lamprey as parent, performing artificial insemination, washing and incubating fertilized egg, separating hatched eggs, and feeding hatched ones. CN104137799-A; CN104137799-B. UNIV SUN YAT-SEN. 2023-08-10. DIIDW:201505012A.</p>\n<p>[6] ZHANG J, CHEN D, MO W, CUI J, SUN S, WANG G. Method for farming river lamprey, involves feeding eel, Penaeus white shrimp and carp into pond followed by feeding and daily management including aeration, disinfection, microbial agent application, water exchange and disease control. CN103416337-A; CN103416337-B. NINGBO CHUANGHUI VEGETABLES ENG &amp; TECHNO; NINGBO DAQIAO ZOOLOGY AGRIC CO LTD; CIXI VEGETABLE DEV CO LTD. 2014-01-03. DIIDW:2014C16110.</p>\n<p>[7] OpenAI.(2023)Chatgpt3.5 <span class=\"exturl\" data-url=\"aHR0cDovL29wZW5haS5jb20vY2hhdGdwdA==\">http://openai.com/chatgpt</span></p>\n<p><em><strong>*Artificial Intelligence Usage Report*</strong></em></p>\n<p>Question 1: &quot;Please explain the Analytic Hierarchy Process (AHP) and its application in assessing the impact of gender ratio changes in ecosystems.&quot;</p>\n<p>Output: &quot;Analytic Hierarchy Process (AHP) is a decision analysis tool that decomposes complex problems into several factors and sub factors by establishing a hierarchical structure, and then evaluates the importance of each factor through pairwise comparison and weight allocation. In the study of gender ratio changes in ecosystems, AHP can help quantify different factors (such as resource utilization, species diversity, etc.)&quot; The importance of impacts on ecosystems in order to optimize decision-making processes. “</p>\n<p>Question 2: &quot;Please provide a simplified genetic algorithm example for optimizing the simulation of adjusting the sex ratio of lampreys.&quot;</p>\n<p>Output: &quot;Genetic algorithm is a search heuristic algorithm used to solve optimization and search problems, imitating the process of natural selection. Simplified examples include defining a fitness function to evaluate the reproductive growth advantage of the lamprey population, and then generating a new generation of population through selection, crossover, and mutation operations, iterating continuously to find the optimal gender ratio configuration.&quot;</p>\n<p>Question 3: &quot;How to use system dynamics models to simulate ecological interactions between lampreys and other species?&quot;</p>\n<p>Output: &quot;The system dynamics model simulates system behavior by constructing causal diagrams and differential equations between variables. In the simulation of interactions between lampreys and other species, variables including lampreys population size, gender ratio, resource quantity, and other species population size can be defined, and their changes over time can be described through a system of equations to study the impact of gender ratio changes on other members of the ecosystem.&quot;</p>\n<p>Question 4: &quot;Explain the application of difference equations and Jacobian matrices in evaluating ecosystem stability.&quot;</p>\n<p>Output: Differential equations are used to describe the process of variable discrete changes over time, while Jacobian matrices are a mathematical tool used to analyze the local stability of nonlinear systems. In ecosystem stability assessment, differential equations can be constructed to simulate the dynamic changes of populations in the ecosystem. Jacobian matrices can be used to analyze the impact of gender ratio changes on system stability, identify the equilibrium state of the system, and its sensitivity to disturbances Sex. “</p>\n<p>Question 5: &quot;What are the advantages of using the NetLogo model to simulate the ecological impact of gender ratio changes in lampreys?&quot;</p>\n<p>Output: &quot;NetLogo is a multi-agent simulation software that can simulate interactions between individuals in complex systems. The advantage of using NetLogo to simulate changes in the sex ratio of lampreys is that it can intuitively demonstrate how individual behavior accumulates and affects the dynamics of the entire system, allowing researchers to adjust model parameters and observe ecosystem responses in real-time under different conditions, thereby gaining a deeper understanding of the multidimensional effects of gender ratio adjustments on the ecosystem.&quot;</p>\n<p>Question 6: &quot;How to determine key parameters when conducting model sensitivity analysis?&quot;</p>\n<p>Output: &quot;In model sensitivity analysis, the process of determining key parameters typically involves evaluating the sensitivity of model output to changes in various input parameters. By changing parameter values one by one and observing their impact on model results, the parameters that have the greatest impact on model prediction results can be identified. This helps to understand the sources of uncertainty in the model and which parameters are the key factors determining model behavior.&quot;</p>\n<p>Question 7: &quot;How can existing data be used to validate the accuracy and reliability of the model?&quot;</p>\n<p>Output: &quot;Verifying the accuracy and reliability of a model can be achieved by comparing its predicted results with actual observation data. This includes testing the model's predictive ability for known events using historical data, and conducting cross validation to evaluate the model's generalization ability on unknown data. Through this approach, the model's predictive accuracy can be evaluated, and deviations or inaccuracies in the model can be identified and adjusted.&quot;</p>\n<h1 id=\"美赛代码\"><a class=\"anchor\" href=\"#美赛代码\">#</a> 美赛代码</h1>\n<h2 id=\"层次分析法\"><a class=\"anchor\" href=\"#层次分析法\">#</a> 层次分析法</h2>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">AHP</span>:</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    相关信息的传入和准备</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, array</span>):</span><br><span class=\"line\">        <span class=\"comment\">## 记录矩阵相关信息</span></span><br><span class=\"line\">        self.array = array</span><br><span class=\"line\">        <span class=\"comment\">## 记录矩阵大小</span></span><br><span class=\"line\">        self.n = array.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">        <span class=\"comment\"># 初始化RI值，用于一致性检验</span></span><br><span class=\"line\">        self.RI_list = [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0.52</span>, <span class=\"number\">0.89</span>, <span class=\"number\">1.12</span>, <span class=\"number\">1.26</span>, <span class=\"number\">1.36</span>, <span class=\"number\">1.41</span>, <span class=\"number\">1.46</span>, <span class=\"number\">1.49</span>, <span class=\"number\">1.52</span>, <span class=\"number\">1.54</span>, <span class=\"number\">1.56</span>, <span class=\"number\">1.58</span>,</span><br><span class=\"line\">                        <span class=\"number\">1.59</span>]</span><br><span class=\"line\">        <span class=\"comment\"># 矩阵的特征值和特征向量</span></span><br><span class=\"line\">        self.eig_val, self.eig_vector = np.linalg.eig(self.array)</span><br><span class=\"line\">        <span class=\"comment\"># 矩阵的最大特征值</span></span><br><span class=\"line\">        self.max_eig_val = np.<span class=\"built_in\">max</span>(self.eig_val)</span><br><span class=\"line\">        <span class=\"comment\"># 矩阵最大特征值对应的特征向量</span></span><br><span class=\"line\">        self.max_eig_vector = self.eig_vector[:, np.argmax(self.eig_val)].real</span><br><span class=\"line\">        <span class=\"comment\"># 矩阵的一致性指标CI</span></span><br><span class=\"line\">        self.CI_val = (self.max_eig_val - self.n) / (self.n - <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"comment\"># 矩阵的一致性比例CR</span></span><br><span class=\"line\">        self.CR_val = self.CI_val / (self.RI_list[self.n - <span class=\"number\">1</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    一致性判断</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">test_consist</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"comment\"># 打印矩阵的一致性指标CI和一致性比例CR</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的CI值为：&quot;</span> + <span class=\"built_in\">str</span>(self.CI_val))</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的CR值为：&quot;</span> + <span class=\"built_in\">str</span>(self.CR_val))</span><br><span class=\"line\">        <span class=\"comment\"># 进行一致性检验判断</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> self.n == <span class=\"number\">2</span>:  <span class=\"comment\"># 当只有两个子因素的情况</span></span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&quot;仅包含两个子因素，不存在一致性问题&quot;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> self.CR_val &lt; <span class=\"number\">0.1</span>:  <span class=\"comment\"># CR值小于0.1，可以通过一致性检验</span></span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的CR值为&quot;</span> + <span class=\"built_in\">str</span>(self.CR_val) + <span class=\"string\">&quot;,通过一致性检验&quot;</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">True</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:  <span class=\"comment\"># CR值大于0.1, 一致性检验不通过</span></span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的CR值为&quot;</span> + <span class=\"built_in\">str</span>(self.CR_val) + <span class=\"string\">&quot;未通过一致性检验&quot;</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    算术平均法求权重</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">cal_weight_by_arithmetic_method</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"comment\"># 求矩阵的每列的和</span></span><br><span class=\"line\">        col_sum = np.<span class=\"built_in\">sum</span>(self.array, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"comment\"># 将判断矩阵按照列归一化</span></span><br><span class=\"line\">        array_normed = self.array / col_sum</span><br><span class=\"line\">        <span class=\"comment\"># 计算权重向量</span></span><br><span class=\"line\">        array_weight = np.<span class=\"built_in\">sum</span>(array_normed, axis=<span class=\"number\">1</span>) / self.n</span><br><span class=\"line\">        <span class=\"comment\"># 打印权重向量</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;算术平均法计算得到的权重向量为：\\n&quot;</span>, array_weight)</span><br><span class=\"line\">        <span class=\"comment\"># 返回权重向量的值</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> array_weight</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    几何平均法求权重</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">cal_weight__by_geometric_method</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"comment\"># 求矩阵的每列的积</span></span><br><span class=\"line\">        col_product = np.product(self.array, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"comment\"># 将得到的积向量的每个分量进行开n次方</span></span><br><span class=\"line\">        array_power = np.power(col_product, <span class=\"number\">1</span> / self.n)</span><br><span class=\"line\">        <span class=\"comment\"># 将列向量归一化</span></span><br><span class=\"line\">        array_weight = array_power / np.<span class=\"built_in\">sum</span>(array_power)</span><br><span class=\"line\">        <span class=\"comment\"># 打印权重向量</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;几何平均法计算得到的权重向量为：\\n&quot;</span>, array_weight)</span><br><span class=\"line\">        <span class=\"comment\"># 返回权重向量的值</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> array_weight</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    特征值法求权重</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">cal_weight__by_eigenvalue_method</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"comment\"># 将矩阵最大特征值对应的特征向量进行归一化处理就得到了权重</span></span><br><span class=\"line\">        array_weight = self.max_eig_vector / np.<span class=\"built_in\">sum</span>(self.max_eig_vector)</span><br><span class=\"line\">        <span class=\"comment\"># 打印权重向量</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征值法计算得到的权重向量为：\\n&quot;</span>, array_weight)</span><br><span class=\"line\">        <span class=\"comment\"># 返回权重向量的值</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> array_weight</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&quot;__main__&quot;</span>:</span><br><span class=\"line\">    <span class=\"comment\"># 给出判断矩阵</span></span><br><span class=\"line\">    b = np.array([[<span class=\"number\">1</span>, <span class=\"number\">1</span> / <span class=\"number\">3</span>, <span class=\"number\">1</span> / <span class=\"number\">8</span>], [<span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span> / <span class=\"number\">3</span>], [<span class=\"number\">8</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>]])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 算术平均法求权重</span></span><br><span class=\"line\">    weight1 = AHP(b).cal_weight_by_arithmetic_method()</span><br><span class=\"line\">    <span class=\"comment\"># 几何平均法求权重</span></span><br><span class=\"line\">    weight2 = AHP(b).cal_weight__by_geometric_method()</span><br><span class=\"line\">    <span class=\"comment\"># 特征值法求权重</span></span><br><span class=\"line\">    weight3 = AHP(b).cal_weight__by_eigenvalue_method()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"计算一致性比例cr\"><a class=\"anchor\" href=\"#计算一致性比例cr\">#</a> 计算一致性比例 CR</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">consistency_ratio</span>(<span class=\"params\">CI, RI</span>):</span><br><span class=\"line\">    CR = CI / RI</span><br><span class=\"line\">    <span class=\"keyword\">return</span> CR</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 假设 A 是你的判断矩阵</span></span><br><span class=\"line\">A = np.array([</span><br><span class=\"line\">    [<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">4</span>],</span><br><span class=\"line\">    [<span class=\"number\">5</span>, <span class=\"number\">1</span>, <span class=\"number\">4</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\">])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算特征值</span></span><br><span class=\"line\">eigenvalues, eigenvectors = np.linalg.eig(A)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 找到最大特征值</span></span><br><span class=\"line\">lambda_max = <span class=\"built_in\">max</span>(eigenvalues)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算一致性指标 CI</span></span><br><span class=\"line\">n = <span class=\"built_in\">len</span>(A)</span><br><span class=\"line\">CI = (lambda_max - n) / (n - <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查找平均随机一致性指标 RI</span></span><br><span class=\"line\">random_matrices = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">500</span>):</span><br><span class=\"line\">    random_matrix = np.random.randint(<span class=\"number\">1</span>, n+<span class=\"number\">1</span>, size=(n, n))</span><br><span class=\"line\">    random_matrices.append(random_matrix)</span><br><span class=\"line\"></span><br><span class=\"line\">average_lambda_max = np.mean([<span class=\"built_in\">max</span>(np.linalg.eig(mat)[<span class=\"number\">0</span>]) <span class=\"keyword\">for</span> mat <span class=\"keyword\">in</span> random_matrices])</span><br><span class=\"line\">RI = (average_lambda_max - n) / (n - <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算一致性比率 CR</span></span><br><span class=\"line\">CR = consistency_ratio(CI, RI)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;最大特征值 (λmax):&quot;</span>, lambda_max)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;一致性指标 CI:&quot;</span>, CI)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;查找平均随机一致性指标 RI:&quot;</span>, RI)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;一致性比率 CR:&quot;</span>, CR)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 判断一致性是否可接受</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> CR &lt; <span class=\"number\">0.10</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的一致性是可以接受的&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的一致性需要适当修正&quot;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"遗传算法\"><a class=\"anchor\" href=\"#遗传算法\">#</a> 遗传算法</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> matplotlib <span class=\"keyword\">import</span> cm</span><br><span class=\"line\"><span class=\"keyword\">from</span> mpl_toolkits.mplot3d <span class=\"keyword\">import</span> Axes3D</span><br><span class=\"line\"></span><br><span class=\"line\">DNA_SIZE = <span class=\"number\">24</span></span><br><span class=\"line\">POP_SIZE = <span class=\"number\">200</span></span><br><span class=\"line\">CROSSOVER_RATE = <span class=\"number\">0.8</span></span><br><span class=\"line\">MUTATION_RATE = <span class=\"number\">0.005</span></span><br><span class=\"line\">N_GENERATIONS = <span class=\"number\">50</span></span><br><span class=\"line\">X_BOUND = [-<span class=\"number\">3</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\">Y_BOUND = [-<span class=\"number\">3</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">F</span>(<span class=\"params\">x, y</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">3</span> * (<span class=\"number\">1</span> - x) ** <span class=\"number\">2</span> * np.exp(-(x ** <span class=\"number\">2</span>) - (y + <span class=\"number\">1</span>) ** <span class=\"number\">2</span>) - <span class=\"number\">10</span> * (x / <span class=\"number\">5</span> - x ** <span class=\"number\">3</span> - y ** <span class=\"number\">5</span>) * np.exp(</span><br><span class=\"line\">        -x ** <span class=\"number\">2</span> - y ** <span class=\"number\">2</span>) - <span class=\"number\">1</span> / <span class=\"number\">3</span> ** np.exp(-(x + <span class=\"number\">1</span>) ** <span class=\"number\">2</span> - y ** <span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">plot_3d</span>(<span class=\"params\">ax</span>):</span><br><span class=\"line\">    X = np.linspace(*X_BOUND, <span class=\"number\">100</span>)</span><br><span class=\"line\">    Y = np.linspace(*Y_BOUND, <span class=\"number\">100</span>)</span><br><span class=\"line\">    X, Y = np.meshgrid(X, Y)</span><br><span class=\"line\">    Z = F(X, Y)</span><br><span class=\"line\">    ax.plot_surface(X, Y, Z, rstride=<span class=\"number\">1</span>, cstride=<span class=\"number\">1</span>, cmap=cm.coolwarm)</span><br><span class=\"line\">    ax.set_zlim(-<span class=\"number\">10</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\">    ax.set_xlabel(<span class=\"string\">&#x27;x&#x27;</span>)</span><br><span class=\"line\">    ax.set_ylabel(<span class=\"string\">&#x27;y&#x27;</span>)</span><br><span class=\"line\">    ax.set_zlabel(<span class=\"string\">&#x27;z&#x27;</span>)</span><br><span class=\"line\">    plt.pause(<span class=\"number\">3</span>)</span><br><span class=\"line\">    plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">get_fitness</span>(<span class=\"params\">pop</span>):</span><br><span class=\"line\">    x, y = translateDNA(pop)</span><br><span class=\"line\">    pred = F(x, y)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (pred - np.<span class=\"built_in\">min</span>(</span><br><span class=\"line\">        pred)) + <span class=\"number\">1e-3</span>  <span class=\"comment\"># 减去最小的适应度是为了防止适应度出现负数，通过这一步fitness的范围为[0, np.max(pred)-np.min(pred)],最后在加上一个很小的数防止出现为0的适应度</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">translateDNA</span>(<span class=\"params\">pop</span>):  <span class=\"comment\"># pop表示种群矩阵，一行表示一个二进制编码表示的DNA，矩阵的行数为种群数目</span></span><br><span class=\"line\">    x_pop = pop[:, <span class=\"number\">1</span>::<span class=\"number\">2</span>]  <span class=\"comment\"># 奇数列表示X</span></span><br><span class=\"line\">    y_pop = pop[:, ::<span class=\"number\">2</span>]  <span class=\"comment\"># 偶数列表示y</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># pop:(POP_SIZE,DNA_SIZE)*(DNA_SIZE,1) --&gt; (POP_SIZE,1)</span></span><br><span class=\"line\">    x = x_pop.dot(<span class=\"number\">2</span> ** np.arange(DNA_SIZE)[::-<span class=\"number\">1</span>]) / <span class=\"built_in\">float</span>(<span class=\"number\">2</span> ** DNA_SIZE - <span class=\"number\">1</span>) * (X_BOUND[<span class=\"number\">1</span>] - X_BOUND[<span class=\"number\">0</span>]) + X_BOUND[<span class=\"number\">0</span>]</span><br><span class=\"line\">    y = y_pop.dot(<span class=\"number\">2</span> ** np.arange(DNA_SIZE)[::-<span class=\"number\">1</span>]) / <span class=\"built_in\">float</span>(<span class=\"number\">2</span> ** DNA_SIZE - <span class=\"number\">1</span>) * (Y_BOUND[<span class=\"number\">1</span>] - Y_BOUND[<span class=\"number\">0</span>]) + Y_BOUND[<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x, y</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">crossover_and_mutation</span>(<span class=\"params\">pop, CROSSOVER_RATE=<span class=\"number\">0.8</span></span>):</span><br><span class=\"line\">    new_pop = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> father <span class=\"keyword\">in</span> pop:  <span class=\"comment\"># 遍历种群中的每一个个体，将该个体作为父亲</span></span><br><span class=\"line\">        child = father  <span class=\"comment\"># 孩子先得到父亲的全部基因（这里我把一串二进制串的那些0，1称为基因）</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> np.random.rand() &lt; CROSSOVER_RATE:  <span class=\"comment\"># 产生子代时不是必然发生交叉，而是以一定的概率发生交叉</span></span><br><span class=\"line\">            mother = pop[np.random.randint(POP_SIZE)]  <span class=\"comment\"># 再种群中选择另一个个体，并将该个体作为母亲</span></span><br><span class=\"line\">            cross_points = np.random.randint(low=<span class=\"number\">0</span>, high=DNA_SIZE * <span class=\"number\">2</span>)  <span class=\"comment\"># 随机产生交叉的点</span></span><br><span class=\"line\">            child[cross_points:] = mother[cross_points:]  <span class=\"comment\"># 孩子得到位于交叉点后的母亲的基因</span></span><br><span class=\"line\">        mutation(child)  <span class=\"comment\"># 每个后代有一定的机率发生变异</span></span><br><span class=\"line\">        new_pop.append(child)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> new_pop</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">mutation</span>(<span class=\"params\">child, MUTATION_RATE=<span class=\"number\">0.003</span></span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> np.random.rand() &lt; MUTATION_RATE:  <span class=\"comment\"># 以MUTATION_RATE的概率进行变异</span></span><br><span class=\"line\">        mutate_point = np.random.randint(<span class=\"number\">0</span>, DNA_SIZE)  <span class=\"comment\"># 随机产生一个实数，代表要变异基因的位置</span></span><br><span class=\"line\">        child[mutate_point] = child[mutate_point] ^ <span class=\"number\">1</span>  <span class=\"comment\"># 将变异点的二进制为反转</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">select</span>(<span class=\"params\">pop, fitness</span>):  <span class=\"comment\"># nature selection wrt pop&#x27;s fitness</span></span><br><span class=\"line\">    idx = np.random.choice(np.arange(POP_SIZE), size=POP_SIZE, replace=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                           p=(fitness) / (fitness.<span class=\"built_in\">sum</span>()))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> pop[idx]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">print_info</span>(<span class=\"params\">pop</span>):</span><br><span class=\"line\">    fitness = get_fitness(pop)</span><br><span class=\"line\">    max_fitness_index = np.argmax(fitness)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;max_fitness:&quot;</span>, fitness[max_fitness_index])</span><br><span class=\"line\">    x, y = translateDNA(pop)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;最优的基因型：&quot;</span>, pop[max_fitness_index])</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;(x, y):&quot;</span>, (x[max_fitness_index], y[max_fitness_index]))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&quot;__main__&quot;</span>:</span><br><span class=\"line\">    fig = plt.figure()</span><br><span class=\"line\">    ax = Axes3D(fig)</span><br><span class=\"line\">    plt.ion()  <span class=\"comment\"># 将画图模式改为交互模式，程序遇到plt.show不会暂停，而是继续执行</span></span><br><span class=\"line\">    plot_3d(ax)</span><br><span class=\"line\"></span><br><span class=\"line\">    pop = np.random.randint(<span class=\"number\">2</span>, size=(POP_SIZE, DNA_SIZE * <span class=\"number\">2</span>))  <span class=\"comment\"># matrix (POP_SIZE, DNA_SIZE)</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(N_GENERATIONS):  <span class=\"comment\"># 迭代N代</span></span><br><span class=\"line\">        x, y = translateDNA(pop)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">&#x27;sca&#x27;</span> <span class=\"keyword\">in</span> <span class=\"built_in\">locals</span>():</span><br><span class=\"line\">            sca.remove()</span><br><span class=\"line\">        sca = ax.scatter(x, y, F(x, y), c=<span class=\"string\">&#x27;black&#x27;</span>, marker=<span class=\"string\">&#x27;o&#x27;</span>);</span><br><span class=\"line\">        plt.show();</span><br><span class=\"line\">        plt.pause(<span class=\"number\">0.1</span>)</span><br><span class=\"line\">        pop = np.array(crossover_and_mutation(pop, CROSSOVER_RATE))</span><br><span class=\"line\">        <span class=\"comment\"># F_values = F(translateDNA(pop)[0], translateDNA(pop)[1])#x, y --&gt; Z matrix</span></span><br><span class=\"line\">        fitness = get_fitness(pop)</span><br><span class=\"line\">        pop = select(pop, fitness)  <span class=\"comment\"># 选择生成新的种群</span></span><br><span class=\"line\"></span><br><span class=\"line\">    print_info(pop)</span><br><span class=\"line\">    plt.ioff()</span><br><span class=\"line\">    plot_3d(ax)</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"intgr\"><a class=\"anchor\" href=\"#intgr\">#</a> intgr</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> scipy <span class=\"keyword\">import</span> integrate</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">Logistic</span>(<span class=\"params\">y,t,para</span>):</span><br><span class=\"line\">    <span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">    Na     : Sum Adult</span></span><br><span class=\"line\"><span class=\"string\">    Nf     : Female</span></span><br><span class=\"line\"><span class=\"string\">    Nm     : Male</span></span><br><span class=\"line\"><span class=\"string\">    Nc     : Cub(No Gender)</span></span><br><span class=\"line\"><span class=\"string\">    N_Fresh: Predator in Fresh Water</span></span><br><span class=\"line\"><span class=\"string\">    N_Sea  : Prey in Sea Water</span></span><br><span class=\"line\"><span class=\"string\">    Alpha1 : Cub Natural mortality rate</span></span><br><span class=\"line\"><span class=\"string\">    Alpha2 : Sea Natural growth rate</span></span><br><span class=\"line\"><span class=\"string\">    Beta1  : Fresh Natural mortality rate</span></span><br><span class=\"line\"><span class=\"string\">    Beta2  : Adult Natural mortality rate</span></span><br><span class=\"line\"><span class=\"string\">    Gamma1 : Fresh Predation rate</span></span><br><span class=\"line\"><span class=\"string\">    Gamma2 : Sea Predation rate</span></span><br><span class=\"line\"><span class=\"string\">    Rou1   : Female immigration/emigration rate</span></span><br><span class=\"line\"><span class=\"string\">    Rou2   : Male immigration/emigration rate</span></span><br><span class=\"line\"><span class=\"string\">    e1,e2  : correction factor</span></span><br><span class=\"line\"><span class=\"string\">    S      : </span></span><br><span class=\"line\"><span class=\"string\">    &#x27;&#x27;&#x27;</span></span><br><span class=\"line\">    Nf,Nm,Nc,N_Fresh,N_Sea = y</span><br><span class=\"line\">    Na = Nf + Nm</span><br><span class=\"line\">    Alpha1,Alpha2,Beta1,Beta2,Gamma1,Gamma2,Rou1,Rou2,e1,e2,S,k = para</span><br><span class=\"line\">    dNcdt = k * Nf - Alpha1 * Nc - Gamma1 * Nc * N_Fresh - (Rou1 + Rou2) * Nc * S</span><br><span class=\"line\">    dNFreshdt = -Beta1 * N_Fresh + e1 * Gamma1 * Nc * N_Fresh</span><br><span class=\"line\">    dNSeadt = Alpha2 * N_Sea - Gamma2 * N_Sea * Na</span><br><span class=\"line\">    <span class=\"comment\">#dNadt = (rou1 + rou2) * Nc * S - Beta2 * Na + e2 * Gamma2 * N_Sea * Na</span></span><br><span class=\"line\">    dNfdt = Rou1 * Nc * S - Beta2 * Nf + e2 * Gamma2 * N_Sea * Nf</span><br><span class=\"line\">    dNmdt = Rou2 * Nc * S - Beta2 * Nm + e1 * Gamma1 * N_Sea * Nm</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [dNfdt,dNmdt,dNcdt,dNFreshdt,dNSeadt]</span><br><span class=\"line\">t = np.linspace(<span class=\"number\">0</span>,<span class=\"number\">2000</span>,<span class=\"number\">2000</span>)</span><br><span class=\"line\">paras = ( </span><br><span class=\"line\">    <span class=\"number\">0.1</span>,<span class=\"number\">0.04</span>,</span><br><span class=\"line\">    <span class=\"number\">0.04</span>,<span class=\"number\">0.005</span>,</span><br><span class=\"line\">    <span class=\"number\">0.00005</span>,<span class=\"number\">8E-7</span>,</span><br><span class=\"line\">    <span class=\"number\">0.2</span>,<span class=\"number\">0.8</span>,</span><br><span class=\"line\">    <span class=\"number\">0.1</span>,<span class=\"number\">0.01</span>,</span><br><span class=\"line\">    <span class=\"number\">0.01</span>,</span><br><span class=\"line\">    <span class=\"number\">2</span></span><br><span class=\"line\">)</span><br><span class=\"line\">y = integrate.odeint(Logistic, [<span class=\"number\">20</span>,<span class=\"number\">2</span>,<span class=\"number\">300</span>,<span class=\"number\">1</span>,<span class=\"number\">100</span>], t,args=(paras,))</span><br><span class=\"line\">plt.plot(t, y[:,<span class=\"number\">0</span>]+y[:,<span class=\"number\">1</span>]+y[:,<span class=\"number\">2</span>]) <span class=\"comment\">#Group Population</span></span><br><span class=\"line\"><span class=\"comment\">#plt.plot(t, y[:,1]/y[:,0]) #Sex ratio</span></span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"遗传模型\"><a class=\"anchor\" href=\"#遗传模型\">#</a> 遗传模型</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 参数设定</span></span><br><span class=\"line\">r_M = <span class=\"number\">0.04</span>  <span class=\"comment\"># 雄性海七鳃鳗的繁殖率</span></span><br><span class=\"line\">d_M = <span class=\"number\">0.02</span>  <span class=\"comment\"># 雄性海七鳃鳗的自然死亡率</span></span><br><span class=\"line\">b_M = <span class=\"number\">0.002</span> <span class=\"comment\"># 雄性海七鳃鳗的捕食效率</span></span><br><span class=\"line\"></span><br><span class=\"line\">r_F = <span class=\"number\">0.03</span>  <span class=\"comment\"># 雌性海七鳃鳗的繁殖率</span></span><br><span class=\"line\">d_F = <span class=\"number\">0.02</span>  <span class=\"comment\"># 雌性海七鳃鳗的自然死亡率</span></span><br><span class=\"line\">b_F = <span class=\"number\">0.001</span> <span class=\"comment\"># 雌性海七鳃鳗的捕食效率</span></span><br><span class=\"line\"></span><br><span class=\"line\">r_P = <span class=\"number\">0.1</span>   <span class=\"comment\"># 猎物的自然增长率</span></span><br><span class=\"line\">a = <span class=\"number\">0.001</span>    <span class=\"comment\"># 猎物被捕食的概率</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始条件</span></span><br><span class=\"line\">M0 = <span class=\"number\">78</span>   <span class=\"comment\"># 雄性海七鳃鳗的初始种群数量</span></span><br><span class=\"line\">F0 = <span class=\"number\">22</span>   <span class=\"comment\"># 雌性海七鳃鳗的初始种群数量</span></span><br><span class=\"line\">P0 = <span class=\"number\">300</span>   <span class=\"comment\"># 猎物的初始种群数量</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 时间设定</span></span><br><span class=\"line\">dt = <span class=\"number\">0.05</span>  <span class=\"comment\"># 时间步长</span></span><br><span class=\"line\">T = <span class=\"number\">100</span>    <span class=\"comment\"># 总模拟时间</span></span><br><span class=\"line\">N = <span class=\"built_in\">int</span>(T / dt) <span class=\"comment\"># 总步数</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始化数组</span></span><br><span class=\"line\">M = np.zeros(N)</span><br><span class=\"line\">F = np.zeros(N)</span><br><span class=\"line\">P = np.zeros(N)</span><br><span class=\"line\">M[<span class=\"number\">0</span>] = M0</span><br><span class=\"line\">F[<span class=\"number\">0</span>] = F0</span><br><span class=\"line\">P[<span class=\"number\">0</span>] = P0</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 模拟过程</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> t <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(N - <span class=\"number\">1</span>):</span><br><span class=\"line\">    M[t + <span class=\"number\">1</span>] = M[t] + (r_M * M[t] - d_M * M[t] + b_M * a * P[t] * M[t]) * dt</span><br><span class=\"line\">    F[t + <span class=\"number\">1</span>] = F[t] + (r_F * F[t] - d_F * F[t] + b_F * a * P[t] * F[t]) * dt</span><br><span class=\"line\">    P[t + <span class=\"number\">1</span>] = P[t] + (r_P * P[t] - a * P[t] * (M[t] + F[t])) * dt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘图</span></span><br><span class=\"line\">time = np.linspace(<span class=\"number\">0</span>, T, N)</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">12</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(time, M, label=<span class=\"string\">&#x27;Male Sea Lampreys&#x27;</span>, color=<span class=\"string\">&#x27;blue&#x27;</span>)</span><br><span class=\"line\">plt.plot(time, F, label=<span class=\"string\">&#x27;Female Sea Lampreys&#x27;</span>, color=<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">plt.plot(time, P, label=<span class=\"string\">&#x27;Prey&#x27;</span>, color=<span class=\"string\">&#x27;grey&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Time&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Population&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Structured Population Model Simulation&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"元胞自动机\"><a class=\"anchor\" href=\"#元胞自动机\">#</a> 元胞自动机</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义格子大小</span></span><br><span class=\"line\">grid_size = (<span class=\"number\">1000</span>, <span class=\"number\">1000</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始状态</span></span><br><span class=\"line\">initial_bacteria = <span class=\"number\">100</span></span><br><span class=\"line\">initial_grass = <span class=\"number\">50</span></span><br><span class=\"line\">initial_host = <span class=\"number\">1</span></span><br><span class=\"line\">initial_male_eels = <span class=\"number\">20</span>  <span class=\"comment\"># 修改为雄性20</span></span><br><span class=\"line\">initial_female_eels = <span class=\"number\">5</span>  <span class=\"comment\"># 修改为雌性5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 繁殖率</span></span><br><span class=\"line\">bacteria_reproduction_rate = <span class=\"number\">2.0</span></span><br><span class=\"line\">grass_reproduction_rate = <span class=\"number\">1.0</span></span><br><span class=\"line\">eels_reproduction_rate = <span class=\"number\">0.0</span>  <span class=\"comment\"># 初始时七鳃鳗数量不变</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 人类捕捉比例</span></span><br><span class=\"line\">human_capture_rate = np.random.uniform(<span class=\"number\">0.3</span>, <span class=\"number\">0.6</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 迭代次数</span></span><br><span class=\"line\">iterations = <span class=\"number\">20</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始化格子</span></span><br><span class=\"line\">grid = np.zeros(grid_size)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始化各个生物的位置</span></span><br><span class=\"line\">grid[:initial_bacteria] = <span class=\"number\">1</span>  <span class=\"comment\"># 细菌</span></span><br><span class=\"line\">grid[initial_bacteria:initial_bacteria + initial_grass] = <span class=\"number\">2</span>  <span class=\"comment\"># 草</span></span><br><span class=\"line\">grid[-initial_host:] = <span class=\"number\">3</span>  <span class=\"comment\"># 宿主</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始化七鳃鳗的位置和性别</span></span><br><span class=\"line\">grid[np.random.choice(grid_size[<span class=\"number\">0</span>], initial_male_eels, replace=<span class=\"literal\">False</span>)] = <span class=\"number\">4</span>  <span class=\"comment\"># 男性七鳃鳗</span></span><br><span class=\"line\">grid[np.random.choice(grid_size[<span class=\"number\">0</span>], initial_female_eels, replace=<span class=\"literal\">False</span>)] = <span class=\"number\">5</span>  <span class=\"comment\"># 女性七鳃鳗</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义函数来执行一代的更新</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">update</span>(<span class=\"params\">grid</span>):</span><br><span class=\"line\">    new_grid = np.zeros_like(grid)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(grid_size[<span class=\"number\">0</span>]):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(grid_size[<span class=\"number\">1</span>]):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> grid[i, j] == <span class=\"number\">1</span>:  <span class=\"comment\"># 细菌</span></span><br><span class=\"line\">                new_grid[i, j] = <span class=\"number\">1</span> <span class=\"keyword\">if</span> np.random.rand() &lt; bacteria_reproduction_rate <span class=\"keyword\">else</span> <span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"keyword\">elif</span> grid[i, j] == <span class=\"number\">2</span>:  <span class=\"comment\"># 草</span></span><br><span class=\"line\">                new_grid[i, j] = <span class=\"number\">2</span> <span class=\"keyword\">if</span> np.random.rand() &lt; grass_reproduction_rate <span class=\"keyword\">else</span> <span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"keyword\">elif</span> grid[i, j] == <span class=\"number\">3</span>:  <span class=\"comment\"># 宿主</span></span><br><span class=\"line\">                new_grid[i, j] = <span class=\"number\">3</span></span><br><span class=\"line\">            <span class=\"keyword\">elif</span> grid[i, j] == <span class=\"number\">4</span> <span class=\"keyword\">or</span> grid[i, j] == <span class=\"number\">5</span>:  <span class=\"comment\"># 七鳃鳗</span></span><br><span class=\"line\">                new_grid[i, j] = grid[i, j]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> new_grid</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 迭代模型</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(iterations):</span><br><span class=\"line\">    grid = update(grid)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制结果</span></span><br><span class=\"line\">plt.imshow(grid, cmap=<span class=\"string\">&#x27;viridis&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&quot;Cellular Automaton after 20 iterations&quot;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"层次权重\"><a class=\"anchor\" href=\"#层次权重\">#</a> 层次权重</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 假设 A 是判断矩阵，每列代表一个因素</span></span><br><span class=\"line\">A = np.array([</span><br><span class=\"line\">    [<span class=\"number\">1</span>, <span class=\"number\">7</span>, <span class=\"number\">7</span>, <span class=\"number\">7</span>, <span class=\"number\">7</span>, <span class=\"number\">7</span>, <span class=\"number\">7</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>/<span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>/<span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>/<span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>/<span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>/<span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>/<span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>]</span><br><span class=\"line\">])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算权重</span></span><br><span class=\"line\">eigenvalues, eigenvectors = np.linalg.eig(A)</span><br><span class=\"line\">weights = eigenvectors[:, np.argmax(eigenvalues)]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 归一化权重</span></span><br><span class=\"line\">weights /= <span class=\"built_in\">sum</span>(weights)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 假设有三个情况，每个情况在层次结构的权重</span></span><br><span class=\"line\">case_weights = np.array([</span><br><span class=\"line\">    [<span class=\"number\">0.2</span>, <span class=\"number\">0.3</span>, <span class=\"number\">0.5</span>],</span><br><span class=\"line\">    [<span class=\"number\">0.4</span>, <span class=\"number\">0.4</span>, <span class=\"number\">0.2</span>],</span><br><span class=\"line\">    [<span class=\"number\">0.1</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.4</span>]</span><br><span class=\"line\">])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算每个情况的总排序分数</span></span><br><span class=\"line\">total_scores = np.<span class=\"built_in\">sum</span>(case_weights * weights, axis=<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 排序结果</span></span><br><span class=\"line\">sorted_indices = np.argsort(total_scores)[::-<span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输出排序结果</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> idx, score <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>(sorted_indices, total_scores[sorted_indices]):</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;情况 <span class=\"subst\">&#123;idx+<span class=\"number\">1</span>&#125;</span>: 总排序分数 <span class=\"subst\">&#123;score&#125;</span>&quot;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"热力图生成\"><a class=\"anchor\" href=\"#热力图生成\">#</a> 热力图生成</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Prepare the data in DataFrame</span></span><br><span class=\"line\">data = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;Natural and Anthropogenic Factors&#x27;</span>: [<span class=\"number\">0.998053414</span>, <span class=\"number\">1.124388586</span>, <span class=\"number\">0.505350047</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Food Abundance&#x27;</span>: [<span class=\"number\">0.010752428</span>, <span class=\"number\">0.004509764</span>, <span class=\"number\">0.000233752</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Hatching Environment Conditions&#x27;</span>: [<span class=\"number\">0.006704276</span>, <span class=\"number\">6.56459E-06</span>, <span class=\"number\">0.000756631</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Influence of Other Organisms in Water&#x27;</span>: [<span class=\"number\">2.83968E-08</span>, <span class=\"number\">3.19914E-08</span>, <span class=\"number\">3.24933E-10</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Seasonal Changes&#x27;</span>: [<span class=\"number\">1.07524E-05</span>, <span class=\"number\">0.004509764</span>, <span class=\"number\">3.33414E-06</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Water Quality Conditions&#x27;</span>: [<span class=\"number\">0.006704276</span>, <span class=\"number\">6.56459E-06</span>, <span class=\"number\">0.000756631</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Temperature Influence&#x27;</span>: [<span class=\"number\">1.07524E-05</span>, <span class=\"number\">0.004509764</span>, <span class=\"number\">3.33414E-06</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">index = [<span class=\"string\">&#x27;Population Size&#x27;</span>, <span class=\"string\">&#x27;Gender Ratio Variation&#x27;</span>, <span class=\"string\">&#x27;Birth and Death Rate&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Round the values directly on the DataFrame</span></span><br><span class=\"line\">df = pd.DataFrame(data, index=index).<span class=\"built_in\">round</span>(<span class=\"number\">8</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Increase the figure size for better visibility</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">12</span>, <span class=\"number\">10</span>))</span><br><span class=\"line\">sns.heatmap(df, annot=<span class=\"literal\">True</span>, cmap=<span class=\"string\">&quot;YlGnBu&quot;</span>, linewidths=<span class=\"number\">.5</span>, fmt=<span class=\"string\">&#x27;.8f&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Impact of Factors on the Ecosystem - Heatmap&#x27;</span>)</span><br><span class=\"line\">plt.savefig(<span class=\"string\">&quot;zuizhongrelitu.png&quot;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"calculate-the-maximum-eigenvalue求最大特征值\"><a class=\"anchor\" href=\"#calculate-the-maximum-eigenvalue求最大特征值\">#</a> calculate the maximum eigenvalue (求最大特征值)</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">consistency_ratio</span>(<span class=\"params\">CI, RI</span>):</span><br><span class=\"line\">    CR = CI / RI</span><br><span class=\"line\">    <span class=\"keyword\">return</span> CR</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 假设 A 是你的判断矩阵</span></span><br><span class=\"line\">A = np.array([</span><br><span class=\"line\">    [<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">4</span>],</span><br><span class=\"line\">    [<span class=\"number\">5</span>, <span class=\"number\">1</span>, <span class=\"number\">4</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\">])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算特征值</span></span><br><span class=\"line\">eigenvalues, eigenvectors = np.linalg.eig(A)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 找到最大特征值</span></span><br><span class=\"line\">lambda_max = <span class=\"built_in\">max</span>(eigenvalues)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算一致性指标 CI</span></span><br><span class=\"line\">n = <span class=\"built_in\">len</span>(A)</span><br><span class=\"line\">CI = (lambda_max - n) / (n - <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查找平均随机一致性指标 RI</span></span><br><span class=\"line\">random_matrices = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">500</span>):</span><br><span class=\"line\">    random_matrix = np.random.randint(<span class=\"number\">1</span>, n+<span class=\"number\">1</span>, size=(n, n))</span><br><span class=\"line\">    random_matrices.append(random_matrix)</span><br><span class=\"line\"></span><br><span class=\"line\">average_lambda_max = np.mean([<span class=\"built_in\">max</span>(np.linalg.eig(mat)[<span class=\"number\">0</span>]) <span class=\"keyword\">for</span> mat <span class=\"keyword\">in</span> random_matrices])</span><br><span class=\"line\">RI = (average_lambda_max - n) / (n - <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算一致性比率 CR</span></span><br><span class=\"line\">CR = consistency_ratio(CI, RI)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;最大特征值 (λmax):&quot;</span>, lambda_max)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;一致性指标 CI:&quot;</span>, CI)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;查找平均随机一致性指标 RI:&quot;</span>, RI)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;一致性比率 CR:&quot;</span>, CR)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 判断一致性是否可接受</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> CR &lt; <span class=\"number\">0.10</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的一致性是可以接受的&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的一致性需要适当修正&quot;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"第二问雷达图\"><a class=\"anchor\" href=\"#第二问雷达图\">#</a> 第二问雷达图</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 读取Excel文件</span></span><br><span class=\"line\">file_path = <span class=\"string\">&#x27;shuju.xlsx&#x27;</span></span><br><span class=\"line\">df = pd.read_excel(file_path)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 提取需要的列</span></span><br><span class=\"line\">selected_columns = [<span class=\"string\">&#x27;Predation Threat&#x27;</span>, <span class=\"string\">&#x27;Reproduction Threat&#x27;</span>, <span class=\"string\">&#x27;Overfishing Risk&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"string\">&#x27;Environmental Pressure&#x27;</span>, <span class=\"string\">&#x27;Predation Control&#x27;</span>, <span class=\"string\">&#x27;Food Chain Role&#x27;</span>, <span class=\"string\">&#x27;Adaptability&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建热力图</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">8</span>))</span><br><span class=\"line\">heatmap_data = df[selected_columns + [<span class=\"string\">&#x27;Gender Ratio Variation&#x27;</span>]]</span><br><span class=\"line\">heatmap = sns.heatmap(heatmap_data.corr(), annot=<span class=\"literal\">True</span>, cmap=<span class=\"string\">&quot;coolwarm&quot;</span>, fmt=<span class=\"string\">&quot;.2f&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置热力图的标题</span></span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Correlation Heatmap between Gender Ratio Variation and Other Factors&#x27;</span>)</span><br><span class=\"line\">plt.savefig(<span class=\"string\">&quot;123123.png&quot;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 显示热力图</span></span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"\"><a class=\"anchor\" href=\"#\">#</a> </h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">simulate_ecosystem</span>(<span class=\"params\">initial_ratio</span>):</span><br><span class=\"line\">    generations = <span class=\"number\">50</span></span><br><span class=\"line\">    gender_ratio = np.zeros(generations)</span><br><span class=\"line\">    gender_ratio[<span class=\"number\">0</span>] = initial_ratio</span><br><span class=\"line\"></span><br><span class=\"line\">    predator_population = np.ones(generations)</span><br><span class=\"line\">    reproductive_success = np.ones(generations)</span><br><span class=\"line\">    food_resources = np.ones(generations)</span><br><span class=\"line\">    composite_indicator = np.zeros(generations)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> gen <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, generations):</span><br><span class=\"line\">        gender_ratio[gen] = gender_ratio[gen - <span class=\"number\">1</span>]</span><br><span class=\"line\">        reproductive_success[gen] = reproductive_success[gen - <span class=\"number\">1</span>] - <span class=\"number\">0.005</span> * <span class=\"built_in\">abs</span>(gender_ratio[gen] - <span class=\"number\">0.5</span>)</span><br><span class=\"line\">        predator_population[gen] = predator_population[gen - <span class=\"number\">1</span>] * reproductive_success[gen]</span><br><span class=\"line\">        food_resources[gen] = food_resources[gen - <span class=\"number\">1</span>] - <span class=\"number\">0.02</span></span><br><span class=\"line\">        composite_indicator[gen] = <span class=\"number\">0.4</span> * gender_ratio[gen] + <span class=\"number\">0.3</span> * predator_population[gen] + <span class=\"number\">0.2</span> * reproductive_success[gen] + <span class=\"number\">0.1</span> * food_resources[gen]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> composite_indicator</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">evaluate_population</span>(<span class=\"params\">initial_ratio</span>):</span><br><span class=\"line\">    composite_indicator = simulate_ecosystem(initial_ratio)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 计算各个评价指标</span></span><br><span class=\"line\">    predation_control = np.mean(composite_indicator)</span><br><span class=\"line\">    food_chain_role = np.<span class=\"built_in\">max</span>(composite_indicator)</span><br><span class=\"line\">    ecosystem_provider = np.<span class=\"built_in\">sum</span>(composite_indicator)</span><br><span class=\"line\">    adaptability = np.<span class=\"built_in\">min</span>(composite_indicator)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 模拟其他劣势因素</span></span><br><span class=\"line\">    predation_threat = np.random.uniform(<span class=\"number\">0.1</span>, <span class=\"number\">0.5</span>)</span><br><span class=\"line\">    reproduction_threat = np.random.uniform(<span class=\"number\">0.1</span>, <span class=\"number\">0.5</span>)</span><br><span class=\"line\">    overfishing_risk = np.random.uniform(<span class=\"number\">0.1</span>, <span class=\"number\">0.5</span>)</span><br><span class=\"line\">    environmental_pressure = np.random.uniform(<span class=\"number\">0.1</span>, <span class=\"number\">0.5</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 计算各个评价指标的权重</span></span><br><span class=\"line\">    weight_predation_control = <span class=\"number\">0.2</span></span><br><span class=\"line\">    weight_food_chain_role = <span class=\"number\">0.2</span></span><br><span class=\"line\">    weight_ecosystem_provider = <span class=\"number\">0.2</span></span><br><span class=\"line\">    weight_adaptability = <span class=\"number\">0.1</span></span><br><span class=\"line\">    weight_predation_threat = <span class=\"number\">0.1</span></span><br><span class=\"line\">    weight_reproduction_threat = <span class=\"number\">0.1</span></span><br><span class=\"line\">    weight_overfishing_risk = <span class=\"number\">0.1</span></span><br><span class=\"line\">    weight_environmental_pressure = <span class=\"number\">0.1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 计算综合评分</span></span><br><span class=\"line\">    overall_score = (weight_predation_control * predation_control +</span><br><span class=\"line\">                     weight_food_chain_role * food_chain_role +</span><br><span class=\"line\">                     weight_ecosystem_provider * ecosystem_provider +</span><br><span class=\"line\">                     weight_adaptability * adaptability -</span><br><span class=\"line\">                     weight_predation_threat * predation_threat -</span><br><span class=\"line\">                     weight_reproduction_threat * reproduction_threat -</span><br><span class=\"line\">                     weight_overfishing_risk * overfishing_risk -</span><br><span class=\"line\">                     weight_environmental_pressure * environmental_pressure)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> overall_score</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 循环遍历不同的 initial_ratio</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> initial_ratio <span class=\"keyword\">in</span> np.arange(<span class=\"number\">0</span>, <span class=\"number\">1.05</span>, <span class=\"number\">0.05</span>):</span><br><span class=\"line\">    initial_ratio = <span class=\"built_in\">round</span>(initial_ratio, <span class=\"number\">2</span>)  <span class=\"comment\"># 保留两位小数</span></span><br><span class=\"line\">    overall_score = evaluate_population(initial_ratio)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Initial Ratio: <span class=\"subst\">&#123;initial_ratio&#125;</span>, Overall Score: <span class=\"subst\">&#123;overall_score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 存储初始比例和综合评分的列表</span></span><br><span class=\"line\">initial_ratios = []</span><br><span class=\"line\">overall_scores = []</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 循环遍历不同的 initial_ratio</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> initial_ratio <span class=\"keyword\">in</span> np.arange(<span class=\"number\">0</span>, <span class=\"number\">1.05</span>, <span class=\"number\">0.05</span>):</span><br><span class=\"line\">    initial_ratio = <span class=\"built_in\">round</span>(initial_ratio, <span class=\"number\">2</span>)  <span class=\"comment\"># 保留两位小数</span></span><br><span class=\"line\">    overall_score = evaluate_population(initial_ratio)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 存储数据</span></span><br><span class=\"line\">    initial_ratios.append(initial_ratio)</span><br><span class=\"line\">    overall_scores.append(overall_score)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制折线图</span></span><br><span class=\"line\">plt.plot(initial_ratios, overall_scores, marker=<span class=\"string\">&#x27;o&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Overall Score vs Initial Gender Ratio&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Initial Gender Ratio&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Overall Score&#x27;</span>)</span><br><span class=\"line\">plt.grid(<span class=\"literal\">True</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"雅克比矩阵\"><a class=\"anchor\" href=\"#雅克比矩阵\">#</a> 雅克比矩阵</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> scipy.integrate <span class=\"keyword\">import</span> odeint</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 七鳃鳗的雄性比例范围</span></span><br><span class=\"line\">Male_proportion = np.arange(<span class=\"number\">0.51</span>, <span class=\"number\">0.90</span>, <span class=\"number\">0.01</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> s <span class=\"keyword\">in</span> Male_proportion:</span><br><span class=\"line\">    <span class=\"comment\"># 初始化模型参数</span></span><br><span class=\"line\">    Natural_Growth_Rate = <span class=\"number\">0.65</span>-<span class=\"number\">0.5</span>*<span class=\"built_in\">abs</span>(<span class=\"number\">0.5</span>-s)  <span class=\"comment\"># 七鳃鳗的自然增长率</span></span><br><span class=\"line\">    beta = <span class=\"number\">0.1</span>  <span class=\"comment\"># 七鳃鳗被捕食的概率</span></span><br><span class=\"line\">    gamma = <span class=\"number\">0.5</span> <span class=\"comment\">#捕食者自然死亡率</span></span><br><span class=\"line\">    delta = <span class=\"number\">0.15</span>*(<span class=\"number\">1</span>+beta*<span class=\"number\">0.9</span>)   <span class=\"comment\"># 捕食成功率</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 初始化种群数量</span></span><br><span class=\"line\">    x0 = <span class=\"number\">25</span>  <span class=\"comment\"># 初始七鳃鳗数量</span></span><br><span class=\"line\">    y0 = <span class=\"number\">2</span>  <span class=\"comment\"># 初始捕食者数量</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 设置模拟时间</span></span><br><span class=\"line\">    T = np.arange(<span class=\"number\">0</span>, <span class=\"number\">50</span>, <span class=\"number\">0.1</span>)  <span class=\"comment\"># 从0到50时间单位，每0.1单位计算一次</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 定义洛特卡-沃尔泰拉模型方程</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">lotka_volterra</span>(<span class=\"params\">Y, t</span>):</span><br><span class=\"line\">        prey, predator = Y</span><br><span class=\"line\">        dpreydt = Natural_Growth_Rate * prey - beta * prey * predator</span><br><span class=\"line\">        dpredatordt = delta * prey * predator - gamma * predator</span><br><span class=\"line\">        <span class=\"keyword\">return</span> [dpreydt, dpredatordt]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 微分方程求解</span></span><br><span class=\"line\">    solution = odeint(lotka_volterra, [x0, y0], T)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 绘制结果</span></span><br><span class=\"line\">    plt.figure()</span><br><span class=\"line\">    plt.plot(T, solution[:, <span class=\"number\">0</span>], <span class=\"string\">&#x27;r-&#x27;</span>, label=<span class=\"string\">&#x27;Prey&#x27;</span>)</span><br><span class=\"line\">    plt.plot(T, solution[:, <span class=\"number\">1</span>], <span class=\"string\">&#x27;b-&#x27;</span>, label=<span class=\"string\">&#x27;Predator&#x27;</span>)</span><br><span class=\"line\">    plt.xlabel(<span class=\"string\">&#x27;Time&#x27;</span>)</span><br><span class=\"line\">    plt.ylabel(<span class=\"string\">&#x27;Population&#x27;</span>)</span><br><span class=\"line\">    plt.legend()</span><br><span class=\"line\">    plt.title(<span class=\"string\">&#x27;Lotka-Volterra Predator-Prey Model&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 计算雅可比矩阵</span></span><br><span class=\"line\">    J = np.array([[Natural_Growth_Rate - beta * solution[-<span class=\"number\">1</span>, <span class=\"number\">1</span>], -beta * solution[-<span class=\"number\">1</span>, <span class=\"number\">0</span>]],</span><br><span class=\"line\">                  [delta * solution[-<span class=\"number\">1</span>, <span class=\"number\">1</span>], -gamma - delta * solution[-<span class=\"number\">1</span>, <span class=\"number\">0</span>]]])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 计算特征值</span></span><br><span class=\"line\">    eigenvalues = np.linalg.eigvals(J)</span><br><span class=\"line\">    <span class=\"comment\"># 输出相关信息</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;雄性比例p = <span class=\"subst\">&#123;s&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Eigenvalues: <span class=\"subst\">&#123;eigenvalues&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    <span class=\"comment\"># 判断稳定性</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">all</span>(np.real(eigenvalues) &lt; <span class=\"number\">0</span>):</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;系统稳定：&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;系统不稳定:&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"雅克比矩阵matlab\"><a class=\"anchor\" href=\"#雅克比矩阵matlab\">#</a> 雅克比矩阵 MATLAB</h3>\n<p><figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">clear all</span><br><span class=\"line\">clc</span><br><span class=\"line\">close all</span><br><span class=\"line\">s=<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> ii=<span class=\"number\">0.56</span>:<span class=\"number\">0.01</span>:<span class=\"number\">0.85</span> <span class=\"comment\">%七思鳗的雄性比例</span></span><br><span class=\"line\"><span class=\"comment\">% 初始化模型参数</span></span><br><span class=\"line\">alpha = ii<span class=\"number\">-0.15</span>;  <span class=\"comment\">% 食饵的自然增长率</span></span><br><span class=\"line\"><span class=\"built_in\">beta</span> = <span class=\"number\">0.1</span>;  <span class=\"comment\">% 食饵被捕食的概率</span></span><br><span class=\"line\"><span class=\"built_in\">gamma</span> = <span class=\"number\">0.5</span>;  <span class=\"comment\">% 捕食者的自然死亡率</span></span><br><span class=\"line\">delta = <span class=\"number\">0.02</span>; <span class=\"comment\">% 捕食成功率</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 初始化种群数量</span></span><br><span class=\"line\">x0 = <span class=\"number\">25</span>; <span class=\"comment\">% 初始食饵数量</span></span><br><span class=\"line\">y0 = <span class=\"number\">2</span>;  <span class=\"comment\">% 初始捕食者数量</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 设置模拟时间</span></span><br><span class=\"line\">T = <span class=\"number\">0</span>:<span class=\"number\">0.1</span>:<span class=\"number\">50</span>; <span class=\"comment\">% 从0到50时间单位，每0.1单位计算一次</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 定义洛特卡-沃尔泰拉模型方程</span></span><br><span class=\"line\">lotkaVolterra = @(t, Y) [alpha*Y(<span class=\"number\">1</span>) - <span class=\"built_in\">beta</span>*Y(<span class=\"number\">1</span>)*Y(<span class=\"number\">2</span>); </span><br><span class=\"line\">                         delta*Y(<span class=\"number\">1</span>)*Y(<span class=\"number\">2</span>) - <span class=\"built_in\">gamma</span>*Y(<span class=\"number\">2</span>)];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 使用ode45求解器进行模拟</span></span><br><span class=\"line\">[T, Y] = ode45(lotkaVolterra, T, [x0 y0]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 绘制结果</span></span><br><span class=\"line\"><span class=\"built_in\">figure</span>;</span><br><span class=\"line\"><span class=\"built_in\">plot</span>(T, Y(:,<span class=\"number\">1</span>), <span class=\"string\">&#x27;r-&#x27;</span>, T, Y(:,<span class=\"number\">2</span>), <span class=\"string\">&#x27;b-&#x27;</span>);</span><br><span class=\"line\">xlabel(<span class=\"string\">&#x27;Time&#x27;</span>);</span><br><span class=\"line\">ylabel(<span class=\"string\">&#x27;Population&#x27;</span>);</span><br><span class=\"line\"><span class=\"built_in\">legend</span>(<span class=\"string\">&#x27;Prey&#x27;</span>, <span class=\"string\">&#x27;Predator&#x27;</span>);</span><br><span class=\"line\">title(<span class=\"string\">&#x27;Lotka-Volterra Predator-Prey Model&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% </span></span><br><span class=\"line\"><span class=\"comment\">% % 初始化模型参数</span></span><br><span class=\"line\"><span class=\"comment\">% alpha = 0.1;  % 食饵的自然增长率</span></span><br><span class=\"line\"><span class=\"comment\">% beta = 0.02;  % 食饵被捕食的概率</span></span><br><span class=\"line\"><span class=\"comment\">% gamma = 0.3;  % 捕食者的自然死亡率</span></span><br><span class=\"line\"><span class=\"comment\">% delta = 0.01; % 捕食成功率</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 定义洛特卡-沃尔泰拉模型方程</span></span><br><span class=\"line\">lotkaVolterra = @(t, Y) [alpha*Y(<span class=\"number\">1</span>) - <span class=\"built_in\">beta</span>*Y(<span class=\"number\">1</span>)*Y(<span class=\"number\">2</span>); </span><br><span class=\"line\">                         delta*Y(<span class=\"number\">1</span>)*Y(<span class=\"number\">2</span>) - <span class=\"built_in\">gamma</span>*Y(<span class=\"number\">2</span>)];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 设置模拟的初始条件</span></span><br><span class=\"line\">initialConditions = [<span class=\"number\">40</span> <span class=\"number\">9</span>; <span class=\"number\">35</span> <span class=\"number\">5</span>; <span class=\"number\">50</span> <span class=\"number\">20</span>; <span class=\"number\">45</span> <span class=\"number\">15</span>]; <span class=\"comment\">% 不同的初始条件</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 设置模拟时间</span></span><br><span class=\"line\">Tspan = [<span class=\"number\">0</span> <span class=\"number\">50</span>]; <span class=\"comment\">% 从0到50时间单位</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 创建图形窗口</span></span><br><span class=\"line\"><span class=\"built_in\">figure</span>;</span><br><span class=\"line\"><span class=\"built_in\">hold</span> on;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%为每一组初始条件绘制相轨迹</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(initialConditions, <span class=\"number\">1</span>)</span><br><span class=\"line\">    [T, Y] = ode45(lotkaVolterra, Tspan, initialConditions(<span class=\"built_in\">i</span>, :));</span><br><span class=\"line\">    <span class=\"built_in\">plot</span>(Y(:,<span class=\"number\">1</span>), Y(:,<span class=\"number\">2</span>));</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 设置图形属性</span></span><br><span class=\"line\">xlabel(<span class=\"string\">&#x27;Prey Population&#x27;</span>);</span><br><span class=\"line\">ylabel(<span class=\"string\">&#x27;Predator Population&#x27;</span>);</span><br><span class=\"line\">title(<span class=\"string\">&#x27;Phase Trajectories of Lotka-Volterra Model&#x27;</span>);</span><br><span class=\"line\"><span class=\"built_in\">legend</span>(<span class=\"string\">&#x27;Trajectory 1&#x27;</span>, <span class=\"string\">&#x27;Trajectory 2&#x27;</span>, <span class=\"string\">&#x27;Trajectory 3&#x27;</span>, <span class=\"string\">&#x27;Trajectory 4&#x27;</span>);</span><br><span class=\"line\">grid on;</span><br><span class=\"line\"><span class=\"built_in\">hold</span> off;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 初始化模型参数</span></span><br><span class=\"line\"><span class=\"comment\">% 草与兔子的相互作用参数</span></span><br><span class=\"line\"></span><br><span class=\"line\">alpha1 = <span class=\"number\">1</span>;  <span class=\"comment\">% 草的自然增长率</span></span><br><span class=\"line\">beta1 = <span class=\"number\">0.15</span>;  <span class=\"comment\">% 兔子吃草的效率</span></span><br><span class=\"line\">gamma1 = <span class=\"number\">0.5</span>-alpha*<span class=\"number\">0.01</span>;  <span class=\"comment\">% 兔子的自然死亡率，不考虑老鹰捕食的情况</span></span><br><span class=\"line\">delta1 = <span class=\"number\">0.03</span>; <span class=\"comment\">% 兔子因吃草而增加的存活率</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 兔子与老鹰的相互作用参数</span></span><br><span class=\"line\"><span class=\"comment\">% alpha2 = 0.2;  % 兔子的自然增长率，考虑了吃草的影响</span></span><br><span class=\"line\">alpha2=alpha;</span><br><span class=\"line\">beta2 = <span class=\"number\">0.6</span>;  <span class=\"comment\">% 老鹰捕食兔子的效率</span></span><br><span class=\"line\">gamma2 = <span class=\"number\">0.25</span>;  <span class=\"comment\">% 老鹰的自然死亡率</span></span><br><span class=\"line\">delta2 = <span class=\"number\">0.02</span>; <span class=\"comment\">% 老鹰因吃兔子而增加的存活率</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 定义模型方程</span></span><br><span class=\"line\">modelEquations = @(t, Y) [alpha1*Y(<span class=\"number\">1</span>) - beta1*Y(<span class=\"number\">1</span>)*Y(<span class=\"number\">2</span>);  <span class=\"comment\">% 草的增长方程</span></span><br><span class=\"line\">                          beta1*Y(<span class=\"number\">1</span>)*Y(<span class=\"number\">2</span>) - gamma1*Y(<span class=\"number\">2</span>) - beta2*Y(<span class=\"number\">2</span>)*Y(<span class=\"number\">3</span>);  <span class=\"comment\">% 兔子的增长方程</span></span><br><span class=\"line\">                          delta2*Y(<span class=\"number\">2</span>)*Y(<span class=\"number\">3</span>) - gamma2*Y(<span class=\"number\">3</span>)];  <span class=\"comment\">% 老鹰的增长方程</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 设置初始条件</span></span><br><span class=\"line\">initialConditions = [<span class=\"number\">100</span>; <span class=\"number\">10</span>; <span class=\"number\">5</span>];  <span class=\"comment\">% 初始条件：草、兔子、老鹰的数量</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 设置模拟时间</span></span><br><span class=\"line\">Tspan = [<span class=\"number\">0</span> <span class=\"number\">50</span>];  <span class=\"comment\">% 模拟时间从0到100</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 使用ode45求解模型方程</span></span><br><span class=\"line\">[T, Y] = ode45(modelEquations, Tspan, initialConditions);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%绘制结果</span></span><br><span class=\"line\"><span class=\"built_in\">figure</span>;</span><br><span class=\"line\"><span class=\"built_in\">plot</span>(T, Y(:,<span class=\"number\">1</span>), <span class=\"string\">&#x27;g-&#x27;</span>, T, Y(:,<span class=\"number\">2</span>), <span class=\"string\">&#x27;r-&#x27;</span>, T, Y(:,<span class=\"number\">3</span>), <span class=\"string\">&#x27;b-&#x27;</span>);</span><br><span class=\"line\">xlabel(<span class=\"string\">&#x27;Time&#x27;</span>);</span><br><span class=\"line\">ylabel(<span class=\"string\">&#x27;Population&#x27;</span>);</span><br><span class=\"line\"><span class=\"built_in\">legend</span>(<span class=\"string\">&#x27;Grass&#x27;</span>, <span class=\"string\">&#x27;Rabbits&#x27;</span>, <span class=\"string\">&#x27;Eagles&#x27;</span>);</span><br><span class=\"line\">title(<span class=\"string\">&#x27;Ecosystem Model: Grass, Rabbits, and Eagles&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">% 计算雅可比矩阵</span></span><br><span class=\"line\">    J = [alpha1-beta2*Y(<span class=\"keyword\">end</span>,<span class=\"number\">2</span>), -beta1*Y(<span class=\"keyword\">end</span>,<span class=\"number\">1</span>); delta1*Y(<span class=\"keyword\">end</span>,<span class=\"number\">2</span>), -gamma2-delta2*Y(<span class=\"keyword\">end</span>,<span class=\"number\">1</span>)];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">% 计算特征值</span></span><br><span class=\"line\">    eigenvalues = eig(J);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">% 判断稳定性</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> all(<span class=\"built_in\">real</span>(eigenvalues) &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>(<span class=\"string\">&#x27;系统稳定：&#x27;</span>);</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;alpha = &#x27;</span> num2str(alpha)]);</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;雄性比例p=&#x27;</span> num2str(ii)])</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>(<span class=\"string\">&#x27;Eigenvalues:&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"built_in\">length</span>(eigenvalues)</span><br><span class=\"line\">            <span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;Eigenvalue &#x27;</span> num2str(<span class=\"built_in\">j</span>) <span class=\"string\">&#x27;: &#x27;</span> num2str(eigenvalues(<span class=\"built_in\">j</span>))]);</span><br><span class=\"line\">        <span class=\"keyword\">end</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">disp</span>(<span class=\"string\">&#x27;系统不稳定：&#x27;</span>);</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;alpha = &#x27;</span> num2str(alpha)]);</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>(<span class=\"string\">&#x27;Eigenvalues:&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"built_in\">length</span>(eigenvalues)</span><br><span class=\"line\">            <span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;Eigenvalue &#x27;</span> num2str(<span class=\"built_in\">j</span>) <span class=\"string\">&#x27;: &#x27;</span> num2str(eigenvalues(<span class=\"built_in\">j</span>))]);</span><br><span class=\"line\">        <span class=\"keyword\">end</span></span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        },
        {
            "id": "https://enjundu.github.io/recommendation/README/",
            "url": "https://enjundu.github.io/recommendation/README/",
            "title": "b_README",
            "date_published": "2024-07-04T01:41:31.000Z",
            "content_html": "<h2 id=\"a-b-s-t-r-a-c-t\"><a class=\"anchor\" href=\"#a-b-s-t-r-a-c-t\">#</a> A B S T R A C T</h2>\n<p>一些和推荐算法相关的自学过程</p>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        },
        {
            "id": "https://enjundu.github.io/recommendation/SASRec/",
            "url": "https://enjundu.github.io/recommendation/SASRec/",
            "title": "SASrec",
            "date_published": "2024-07-04T01:41:31.000Z",
            "content_html": "<h1 id=\"self-attentive-sequential-recommendation\"><a class=\"anchor\" href=\"#self-attentive-sequential-recommendation\">#</a> Self-Attentive Sequential Recommendation</h1>\n<h2 id=\"马尔科夫链mc\"><a class=\"anchor\" href=\"#马尔科夫链mc\">#</a> 马尔科夫链（mc）</h2>\n<p>马尔科夫链（Markov Chain）是一种数学模型，用于描述一个系统从一个状态转移到另一个状态的过程。这种模型特别适用于分析随机过程，其中每个状态的转移仅依赖于当前状态，而与之前的状态无关。这种特性被称为 “马尔科夫性” 或 “无记忆性”。</p>\n<h3 id=\"基本概念\"><a class=\"anchor\" href=\"#基本概念\">#</a> 基本概念</h3>\n<ul>\n<li><strong>状态空间（State Space）</strong>: 马尔科夫链中的所有可能状态的集合。状态空间可以是有限的，也可以是无限的。</li>\n<li><strong>转移概率（Transition Probability）</strong>: 从一个状态转移到另一个状态的概率，通常表示为 $P (X_{n+1}=j\\mid X_{n}=i) <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo separator=\"true\">,</mo><mtext>其中</mtext></mrow><annotation encoding=\"application/x-tex\">,其中</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord cjk_fallback\">其</span><span class=\"mord cjk_fallback\">中</span></span></span></span> X_n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>表示在时间</mtext></mrow><annotation encoding=\"application/x-tex\">表示在时间</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord cjk_fallback\">表</span><span class=\"mord cjk_fallback\">示</span><span class=\"mord cjk_fallback\">在</span><span class=\"mord cjk_fallback\">时</span><span class=\"mord cjk_fallback\">间</span></span></span></span> n$ 的状态</li>\n<li><strong>转移矩阵（Transition Matrix）</strong>: 描述所有状态之间的转移概率的矩阵。对于一个有限状态空间的马尔科夫链，转移矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span> 的每个元素<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">P_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 表示从状态<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 转移到状态<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 的概率</li>\n<li><strong>初始分布（Initial Distribution）</strong>: 系统在初始时刻的状态分布，通常表示为一个向量。</li>\n</ul>\n<h3 id=\"类型\"><a class=\"anchor\" href=\"#类型\">#</a> 类型</h3>\n<ul>\n<li><strong>离散时间马尔科夫链（DTMC）</strong>: 时间步长是离散的，每个时间步系统转移一次。</li>\n<li><strong>连续时间马尔科夫链（CTMC）</strong>: 时间是连续的，系统可以在任意时刻发生状态转移。</li>\n</ul>\n<h3 id=\"马尔科夫链的性质\"><a class=\"anchor\" href=\"#马尔科夫链的性质\">#</a> 马尔科夫链的性质</h3>\n<ol>\n<li>\n<p><strong>稳态分布（Steady-State Distribution）</strong>: 在长期运行中，马尔科夫链可能会达到一个稳定的状态分布，即各状态的概率不再随时间变化。这种分布可以通过求解<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi><mi>P</mi><mo>=</mo><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi P=\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span> 来获得，其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span> 是稳态概率向量。</p>\n</li>\n<li>\n<p><strong>回归性（Recurrence）</strong>: 如果一个状态从任意其他状态出发，总有一定的概率返回到该状态，则称这个状态是回归的。反之，如果返回概率为零，则称为瞬时的。</p>\n</li>\n<li>\n<p><strong>不可约性（Irreducibility）</strong>: 如果系统的任意两个状态之间都可以通过若干步转移相互到达，则称这个马尔科夫链是不可约的。</p>\n</li>\n<li>\n<p><strong>周期性（Periodicity）</strong>: 一个状态的周期定义为从该状态回到自身所需步数的最大公约数。如果这个周期为 1，则称该状态是非周期的。</p>\n</li>\n<li>\n<p><strong>稳态概率向量（Steady-State Probability Vector）</strong>，记作 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>，是马尔科夫链中一个重要的概念。它描述了在长期运行中，系统各个状态的概率分布。当一个马尔科夫链达到稳态时，各个状态的概率将不再随时间变化。具体来说，如果一个马尔科夫链在某一时刻达到了稳态，那么无论经过多少次状态转移，系统各状态的概率将保持不变。</p>\n<ul>\n<li>\n<p><strong>不变形</strong>：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi><mi>P</mi><mo>=</mo><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi P=\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span> , 这里的<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span> 是一个行向量，表示各状态的稳态概率，P 是转移矩阵，描述各状态之间的转移概率。</p>\n</li>\n<li>\n<p><strong>归一化条件</strong>：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>π</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\sum_i\\pi_i=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0497100000000001em;vertical-align:-0.29971000000000003em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.16195399999999993em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 即稳态概率向量的各个元素之和为 1，表示系统必定处于某个状态。</p>\n</li>\n<li>\n<p><strong>求解方法</strong>：要找到马尔科夫链的稳态概率向量 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>，通常需要解以下线性方程组：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.3599999999999999em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>π</mi><mi>P</mi><mo>=</mo><mi>π</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>π</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding=\"application/x-tex\">\\begin{cases}\\pi P=\\pi\\\\\\sum_i\\pi_i=1\\end{cases}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.16195399999999993em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"一阶马尔科夫链\"><a class=\"anchor\" href=\"#一阶马尔科夫链\">#</a> 一阶马尔科夫链</h3>\n<ul>\n<li>一阶马尔可夫链假设系统的下一个状态只依赖于当前状态。这在序列推荐系统中意味着，用户的下一次操作只取决于他们的最近一次操作。</li>\n<li>** 状态表示：** 将用户的每一个操作视为一个状态。例如，用户购买的商品或浏览的网页。</li>\n<li>** 转移概率矩阵：** 创建一个矩阵，表示从一个状态转移到另一个状态的概率。矩阵中的每个元素<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">P_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 表示从状态<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 转移到状态<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 的概率。</li>\n<li><strong>概率计算</strong>：通过统计历史数据，计算从每个状态转移到其他状态的频率。例如，如果用户最近购买了商品 A，那么我们统计他们接下来购买商品 B 的频率来估计转移概率。</li>\n<li><strong>预测下一状态</strong>：根据当前状态（用户的最近一次操作），利用转移概率矩阵预测用户的下一次操作。例如，如果当前状态是商品 A，查看矩阵中与商品 A 对应的行，选择转移概率最高的商品作为预测结果。</li>\n</ul>\n<h3 id=\"高阶马尔科夫链\"><a class=\"anchor\" href=\"#高阶马尔科夫链\">#</a> 高阶马尔科夫链</h3>\n<ul>\n<li>** 功能：** 将用户的每一个操作视为一个状态，并将一系列连续的操作视为一个组合状态。例如，用户最近连续购买了商品 A、B 和 C，这个组合状态可以表示为 (A, B, C)。高阶马尔可夫链假设系统的下一个状态不仅依赖于当前状态，还依赖于前几个状态。这在序列推荐系统中意味着，用户的下一次操作取决于他们的多个最近操作。</li>\n<li><strong>状态表示</strong>：将用户的每一个操作视为一个状态，并将一系列连续的操作视为一个组合状态。例如，用户最近连续购买了商品 A、B 和 C，这个组合状态可以表示为 (A, B, C)。</li>\n<li><strong>转移概率矩阵</strong>：创建一个更复杂的转移概率矩阵，表示从一个组合状态转移到下一个状态的概率。矩阵中的每个元素<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">P_{ijk}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 表示从状态组合<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(i,j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span></span></span></span> 转移到状态<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 的概率</li>\n<li><strong>概率计算</strong>：通过统计历史数据，计算从每个组合状态转移到其他状态的频率。例如，如果用户最近购买了商品 A 和 B，那么我们统计他们接下来购买商品 C 的频率来估计转移概率。</li>\n<li><strong>预测下一状态</strong>：根据当前组合状态（用户的最近几次操作），利用转移概率矩阵预测用户的下一次操作。例如，如果当前组合状态是 (A, B)，查看矩阵中与 (A, B) 对应的行，选择转移概率最高的商品作为预测结果。</li>\n</ul>\n<h2 id=\"递归神经网络recurrent-neural-network-rnn\"><a class=\"anchor\" href=\"#递归神经网络recurrent-neural-network-rnn\">#</a> 递归神经网络（Recurrent Neural Network, RNN）</h2>\n<p>递归神经网络（Recurrent Neural Network, RNN）是一类用于处理序列数据的神经网络。与传统的前馈神经网络不同，RNN 具有记忆能力，可以处理和分析时间序列数据，捕捉数据中的时间依赖关系和顺序信息。RNN 在自然语言处理、语音识别、时间序列预测等领域有广泛的应用。</p>\n<h3 id=\"基本结构\"><a class=\"anchor\" href=\"#基本结构\">#</a> 基本结构</h3>\n<p>RNN 的基本结构包括输入层、隐藏层和输出层。与传统神经网络不同的是，RNN 的隐藏层不仅接收当前时间步的输入，还接收前一个时间步的隐藏状态。具体来说：</p>\n<ul>\n<li>\n<p><strong>输入层</strong>：接收序列数据的当前时间步输入<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。</p>\n</li>\n<li>\n<p><strong>隐藏层</strong>：计算当前时间步的隐藏状态<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">h_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，同时考虑当前输入<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和前一个时间步的隐藏状态 $ h_{t-1}$</p>\n</li>\n<li>\n<p><strong>输出层</strong>：根据当前隐藏状态<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">h_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 计算输出<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n</li>\n<li>\n<p>隐藏状态的更新公式如下：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><mi>σ</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mrow><mi>x</mi><mi>h</mi></mrow></msub><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub><msub><mi>h</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>h</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h_t=\\sigma(W_{xh}x_t+W_{hh}h_{t-1}+b_h)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.902771em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>其中，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mrow><mi>x</mi><mi>h</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">W_{xh}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">W_{hh}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是权重矩阵，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">b_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是偏置向量，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span> 是激活函数（如 tanh 或 ReLU）</p>\n</li>\n</ul>\n<h3 id=\"优势\"><a class=\"anchor\" href=\"#优势\">#</a> 优势</h3>\n<ol>\n<li><strong>捕捉时间依赖</strong>：RNN 能够处理序列数据，捕捉其中的时间依赖关系，使其在处理时间序列数据和自然语言处理任务中表现良好。</li>\n<li><strong>参数共享</strong>：RNN 的权重在每个时间步共享，减少了模型参数的数量，使其在处理长序列数据时更加高效。</li>\n</ol>\n<h3 id=\"局限性\"><a class=\"anchor\" href=\"#局限性\">#</a> 局限性</h3>\n<ol>\n<li><strong>梯度消失和梯度爆炸</strong>：在处理长序列数据时，RNN 可能会遇到梯度消失或梯度爆炸的问题，使得模型难以训练。</li>\n<li><strong>长时间依赖捕捉困难</strong>：标准 RNN 在处理长时间依赖关系时表现不佳。</li>\n</ol>\n<h2 id=\"顺序推荐\"><a class=\"anchor\" href=\"#顺序推荐\">#</a> 顺序推荐</h2>\n<h3 id=\"目标\"><a class=\"anchor\" href=\"#目标\">#</a> 目标</h3>\n<p>将用户行为的个性化模型（基于历史活动）与用户最近行为的 “上下文” 概念结合起来进行推荐。</p>\n<h3 id=\"前人方式\"><a class=\"anchor\" href=\"#前人方式\">#</a> 前人方式</h3>\n<ul>\n<li>\n<p>马尔科夫链假设下一个动作仅由以前一个动作（或前几个动作）为条件，并已成功地用于表征推荐的短距离项目转换。</p>\n</li>\n<li>\n<p><strong>递归神经网络 RNN</strong>：RNN 是一种用于处理序列数据的神经网络，具有记忆能力，可以捕捉序列数据中的时间依赖关系。RNN 的基本结构包括输入层、隐藏层和输出层，其中隐藏层的状态会根据前一个时间步的隐藏状态和当前时间步的输入来更新</p>\n</li>\n</ul>\n<h2 id=\"transformer\"><a class=\"anchor\" href=\"#transformer\">#</a> Transformer</h2>\n<h3 id=\"介绍\"><a class=\"anchor\" href=\"#介绍\">#</a> 介绍</h3>\n<p>Transformer 是一种用于处理序列数据的深度学习模型，特别擅长于自然语言处理任务，如机器翻译、文本生成等。它由一个编码器（Encoder）和一个解码器（Decoder）组成。</p>\n<h3 id=\"编码器encoder\"><a class=\"anchor\" href=\"#编码器encoder\">#</a> 编码器（Encoder）</h3>\n<p>编码器的任务是接收输入序列（例如，一个句子），并将其转换为一组特征表示。编码器包含多个层，每层都有两个主要部分：</p>\n<ol>\n<li><strong>自注意力层（Self-Attention Layer）</strong>：用于计算每个词与其他词的相关性。</li>\n<li><strong>前馈神经网络层（Feed-Forward Neural Network）</strong>：对自注意力层的输出进行进一步处理。</li>\n</ol>\n<p>每一层都有一个 “残差连接”（Residual Connection）和 “层归一化”（Layer Normalization）来帮助训练更深的网络。</p>\n<h3 id=\"解码器decoder\"><a class=\"anchor\" href=\"#解码器decoder\">#</a> 解码器（Decoder）</h3>\n<p>解码器的任务是根据编码器的输出生成目标序列（例如，翻译后的句子）。解码器也包含多个层，每层与编码器类似，但增加了一个 “编码器 - 解码器注意力层”（Encoder-Decoder Attention Layer），用来关注编码器的输出。</p>\n<h3 id=\"残差连接residual-connection\"><a class=\"anchor\" href=\"#残差连接residual-connection\">#</a> 残差连接（Residual Connection）</h3>\n<h4 id=\"原理\"><a class=\"anchor\" href=\"#原理\">#</a> 原理</h4>\n<p>残差连接是一种深度神经网络的技术，通过在每个层之间引入直接的跳跃连接来帮助训练更深层的网络。具体来说，残差连接将输入直接添加到输出上，即：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">y</mi><mo>=</mo><mi mathvariant=\"script\">F</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y}=\\mathcal{F}(\\mathbf{x})+\\mathbf{x}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.63888em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.09931em;\">F</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.44444em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span></span></span></span></span></span></p>\n<p>其中，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.44444em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span></span></span></span></span> 是输入，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">F</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{F}(\\mathbf{x})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.09931em;\">F</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span></span><span class=\"mclose\">)</span></span></span></span> 是一个或多个层的非线性变换，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.63888em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span></span> 是输出。</p>\n<h4 id=\"优点\"><a class=\"anchor\" href=\"#优点\">#</a> 优点</h4>\n<ol>\n<li><strong>解决梯度消失问题</strong>：在深层网络中，梯度可能会在传播过程中逐渐消失，使得前面的层无法得到有效更新。残差连接通过直接传递梯度，缓解了这个问题。</li>\n<li><strong>加速训练</strong>：残差连接提供了一条无需学习的捷径，使得网络更容易学习到有效的表示，从而加速训练过程。</li>\n<li><strong>提高准确性</strong>：在很多应用中，使用残差连接的网络（如 ResNet）在准确性上有显著提升。</li>\n</ol>\n<h4 id=\"应用\"><a class=\"anchor\" href=\"#应用\">#</a> 应用</h4>\n<p>残差连接最初在 ResNet（残差网络）中得到应用，后来在 Transformer 等模型中广泛使用，成为深度学习模型中的标准组件。</p>\n<h2 id=\"自注意力机制self-attention\"><a class=\"anchor\" href=\"#自注意力机制self-attention\">#</a> 自注意力机制（Self-Attention）</h2>\n<p>自注意力机制是 Transformer 的核心。它的作用是让模型能够 “关注” 输入序列中不同位置的词之间的关系。这是如何做到的：</p>\n<ol>\n<li><strong>输入嵌入（Input Embeddings）</strong>：\n<ul>\n<li>首先，将输入序列中的每个词转换为一个高维向量（嵌入向量）。</li>\n</ul>\n</li>\n<li><strong>生成查询（Query）、键（Key）和值（Value）向量</strong>：\n<ul>\n<li>对每个输入词的嵌入向量，通过不同的线性变换，生成对应的查询、键和值向量。</li>\n</ul>\n</li>\n<li><strong>计算注意力得分（Attention Scores）</strong>：\n<ul>\n<li>对每个词的查询向量和所有词的键向量进行点积运算，得到注意力得分。这个得分表示当前词与其他词的相关性。</li>\n</ul>\n</li>\n<li><strong>归一化注意力得分</strong>：\n<ul>\n<li>使用 Softmax 函数对注意力得分进行归一化，得到每个词的注意力权重。</li>\n</ul>\n</li>\n<li><strong>计算加权和</strong>：\n<ul>\n<li>使用这些注意力权重对所有词的值向量进行加权求和，得到当前词的新的表示。</li>\n</ul>\n</li>\n<li>允许每个词根据其与其他词的相关性进行加权求和，从而捕捉到全局信息。</li>\n</ol>\n<h2 id=\"sasrec\"><a class=\"anchor\" href=\"#sasrec\">#</a> SASRec</h2>\n<h3 id=\"培训简化图\"><a class=\"anchor\" href=\"#培训简化图\">#</a> 培训简化图</h3>\n<p><img data-src=\"https://s2.loli.net/2024/07/09/4buJp2oYK7MVcZz.png\" alt=\"QQ_1720514487872.png\" /></p>\n<h3 id=\"要点\"><a class=\"anchor\" href=\"#要点\">#</a> 要点</h3>\n<ul>\n<li>自我注意：发现句子中单词之间的句法和语意模式</li>\n<li>可以并行加速</li>\n</ul>\n<h3 id=\"符号表\"><a class=\"anchor\" href=\"#符号表\">#</a> 符号表</h3>\n<table>\n<thead>\n<tr>\n<th>符号</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span></td>\n<td>用户和物品集合</td>\n</tr>\n<tr>\n<td>$S^u $</td>\n<td>用户 (u) 的历史交互序列：$(S^u_1, S^u_2, ..., S^u _{</td>\n<td>S^u</td>\n<td>})$</td>\n</tr>\n<tr>\n<td N=\"\">d \\in \\mathbb</td>\n<td>潜在向量维度</td>\n</tr>\n<tr>\n<td>$n \\in \\mathbb{N} $</td>\n<td>最大序列长度</td>\n</tr>\n<tr>\n<td N=\"\">b \\in \\mathbb</td>\n<td>自注意力块的数量</td>\n</tr>\n<tr>\n<td>$\\mathbf{M} \\in \\mathbb{R}^{</td>\n<td>I</td>\n<td>\\times d}$</td>\n<td>物品嵌入矩阵</td>\n</tr>\n<tr>\n<td>$\\ \\mathbf<ruby>P} \\in \\mathbb{R}<rp>(</rp><rt>{n \\times d</rt><rp>)</rp></ruby> $</td>\n<td>位置嵌入矩阵</td>\n</tr>\n<tr>\n<td n=\"\" \\times=\"\" d=\"\">\\hat{\\mathbf{E}} \\in \\mathbb{R}^</td>\n<td>输入嵌入矩阵</td>\n</tr>\n<tr>\n<td>$\\mathbf<ruby>S}<rp>(</rp><rt>{(b)</rt><rp>)</rp></ruby> \\in \\mathbb<ruby>R}<rp>(</rp><rt>{n \\times d</rt><rp>)</rp></ruby> $</td>\n<td>第 (b) 个自注意力层后的物品嵌入</td>\n</tr>\n<tr>\n<td>$\\mathbf<ruby>F}<rp>(</rp><rt>{(b)</rt><rp>)</rp></ruby> \\in \\mathbb<ruby>R}<rp>(</rp><rt>{n \\times d</rt><rp>)</rp></ruby> $</td>\n<td>第 (b) 个前馈神经网络层后的物品嵌入</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"嵌入层\"><a class=\"anchor\" href=\"#嵌入层\">#</a> 嵌入层</h3>\n<p>我们现将序列<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msubsup><mi>S</mi><mn>1</mn><mi>u</mi></msubsup><mo separator=\"true\">,</mo><msubsup><mi>S</mi><mn>2</mn><mi>u</mi></msubsup><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msubsup><mi>S</mi><mrow><mi mathvariant=\"normal\">∣</mi><msup><mi>S</mi><mrow><mi>u</mi><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"normal\">∣</mi></mrow><mi>u</mi></msubsup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(S^u_1, S^u_2, ..., S^u _{|S^{u-1}|})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2469999999999999em;vertical-align:-0.49699999999999994em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-2.4518920000000004em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-2.4518920000000004em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6643919999999999em;\"><span style=\"top:-2.378em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">∣</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7463142857142857em;\"><span style=\"top:-2.786em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mtight\">∣</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.49699999999999994em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 变换为固定长度的序列<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>s</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">s=(s_1,s_2,...,s_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>，其中 n 表示模型可以处理的最大长度，如果序列长度大于 n 则考虑最近的 n 个动作，如果序列长度小于 n，则在左边重复添加一个 ' 填充 ' 项，直到长度为 N 为止 0。其创建了一个项目嵌入矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi mathvariant=\"normal\">∣</mi><mi>I</mi><mi mathvariant=\"normal\">∣</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M} \\in \\mathbb{R}^{ |I| \\times d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.72521em;vertical-align:-0.0391em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8879999999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">∣</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mtight\">∣</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span>，其中 d 是潜在维数，检索输入嵌入矩阵。</p>\n<h3 id=\"自注意力缩放点积注意力计算过程\"><a class=\"anchor\" href=\"#自注意力缩放点积注意力计算过程\">#</a> 自注意力缩放点积注意力计算过程</h3>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>Attention</mtext><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">Q</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">K</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">V</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mtext>softmax</mtext><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi mathvariant=\"bold\">Q</mi><msup><mi mathvariant=\"bold\">K</mi><mi>T</mi></msup></mrow><msqrt><mi>d</mi></msqrt></mfrac><mo fence=\"true\">)</mo></mrow><mi mathvariant=\"bold\">V</mi></mrow><annotation encoding=\"application/x-tex\">\\text{Attention}(\\mathbf{Q},\\mathbf{K},\\mathbf{V})=\\text{softmax}\\left(\\frac{\\mathbf{Q}\\mathbf{K}^T}{\\sqrt{d}}\\right)\\mathbf{V}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">Attention</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">Q</span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">K</span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.468361em;vertical-align:-0.95003em;\"></span><span class=\"mord text\"><span class=\"mord\">softmax</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5183309999999999em;\"><span style=\"top:-2.17778em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93222em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-2.89222em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.10777999999999999em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">Q</span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">K</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span></span></span></span></span></p>\n<h4 id=\"解释\"><a class=\"anchor\" href=\"#解释\">#</a> 解释</h4>\n<ul>\n<li><strong>Q</strong>：查询矩阵</li>\n<li><strong>K</strong>：键矩阵</li>\n<li><strong>V</strong>：值矩阵</li>\n<li><strong>点积计算</strong>：首先查询矩阵 Q 和建矩阵 K 的转置<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">K^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span> 的点积。这个点积结果表示查询和键之间的相似度</li>\n<li><strong>缩放</strong>：由于点积的结果在维度较大时可能会产生很大的数值，因此我们需要将点积结果除以<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mi>d</mi></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.10777999999999999em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93222em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"padding-left:0.833em;\">d</span></span><span style=\"top:-2.89222em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.10777999999999999em;\"><span></span></span></span></span></span></span></span></span> 进行缩放，其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span> 是键向量的维度。这样做的目的是为了避免在计算 softmax 时数值较大，导致梯度消失问题。</li>\n<li><strong>softmax</strong>：通过 softmax 函数将缩放后的点积结果转换为概率分布。softmax 的作用是将每个查询与所有键的相似度转化为权重，这些权重表示每个键对当前查询的重要性。</li>\n<li><strong>加权求和</strong>：最后，将这些权重与值矩阵 V 相乘，得到最终的注意力输出。这一步的目的是根据查询对键的注意力权重，对值进行加权求和，从而得到每个查询对应的加权值。</li>\n</ul>\n<h4 id=\"softmax-函数\"><a class=\"anchor\" href=\"#softmax-函数\">#</a> softmax 函数</h4>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mi mathvariant=\"normal\">s</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">f</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">x</mi></mrow><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><msup><mi>e</mi><msub><mi>z</mi><mi>i</mi></msub></msup><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msup><mi>e</mi><msub><mi>z</mi><mi>j</mi></msub></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\mathrm{softmax}(z_i)=\\frac{e^{z_i}}{\\sum_{j=1}^Ke^{z_j}}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">s</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\" style=\"margin-right:0.07778em;\">f</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">m</span><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\">x</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.648441em;vertical-align:-1.3070490000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.341392em;\"><span style=\"top:-2.128769em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.43581800000000004em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6064620000000001em;\"><span style=\"top:-3.0050700000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.04398em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:-0.04398em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3070490000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>其中，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">z_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是输入向量中的第 $i $ 个元素， <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> 是向量的维度。</p>\n<h3 id=\"自注意层\"><a class=\"anchor\" href=\"#自注意层\">#</a> 自注意层</h3>\n<ul>\n<li>\n<p><strong>旧方法</strong>：使用相同的对象作为查询、键和值。</p>\n</li>\n<li>\n<p><strong>该论文方法</strong>：将嵌入的 E 作为输入，通过线性投影将其转换为三个矩阵，并且发送到注意层中。</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">S</mi><mo>=</mo><mrow><mi mathvariant=\"normal\">S</mi><mi mathvariant=\"normal\">A</mi></mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi mathvariant=\"bold\">E</mi><mo stretchy=\"true\">^</mo></mover><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mi mathvariant=\"normal\">A</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">n</mi><mi mathvariant=\"normal\">t</mi><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">n</mi></mrow><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi mathvariant=\"bold\">E</mi><mo stretchy=\"true\">^</mo></mover><msup><mi mathvariant=\"bold\">W</mi><mi>Q</mi></msup><mo separator=\"true\">,</mo><mover accent=\"true\"><mi mathvariant=\"bold\">E</mi><mo stretchy=\"true\">^</mo></mover><msup><mi mathvariant=\"bold\">W</mi><mi>K</mi></msup><mo separator=\"true\">,</mo><mover accent=\"true\"><mi mathvariant=\"bold\">E</mi><mo stretchy=\"true\">^</mo></mover><msup><mi mathvariant=\"bold\">W</mi><mi>V</mi></msup><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{S}=\\mathrm{SA}(\\widehat{\\mathbf{E}})=\\mathrm{Attention}(\\widehat{\\mathbf{E}}\\mathbf{W}^Q,\\widehat{\\mathbf{E}}\\mathbf{W}^K,\\widehat{\\mathbf{E}}\\mathbf{W}^V),\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68611em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">S</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.17611em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">S</span><span class=\"mord mathrm\">A</span></span><span class=\"mopen\">(</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.92611em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">E</span></span></span></span><span class=\"svg-align\" style=\"width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.68611em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.17611em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">A</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">n</span><span class=\"mord mathrm\">t</span><span class=\"mord mathrm\">i</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">n</span></span><span class=\"mopen\">(</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.92611em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">E</span></span></span></span><span class=\"svg-align\" style=\"width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.68611em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.891331em;\"><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">Q</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.92611em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">E</span></span></span></span><span class=\"svg-align\" style=\"width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.68611em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.92611em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">E</span></span></span></span><span class=\"svg-align\" style=\"width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.68611em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span></span></span></span></span></p>\n</li>\n<li>\n<p>投影矩阵<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">W</mi><mi>Q</mi></msup><mo separator=\"true\">,</mo><msup><mi mathvariant=\"bold\">W</mi><mi>K</mi></msup><mo separator=\"true\">,</mo><msup><mi mathvariant=\"bold\">W</mi><mi>V</mi></msup><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{W}^Q,\\mathbf{W}^K,\\mathbf{W}^V\\in\\mathbb{R}^{d\\times d}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.035771em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">Q</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbb\">R</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span> 这些预测使得模型更灵活。</p>\n</li>\n</ul>\n<h3 id=\"因果关系\"><a class=\"anchor\" href=\"#因果关系\">#</a> 因果关系</h3>\n<p>模型在预测（t+1）-st 项时只考虑前 t 项，但是自注意层<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">S_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 的第<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.61508em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span> 个输出包含后续项目的嵌入会让模型不稳定，所以我们通过进制<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>&gt;</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(j&gt;i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span></span></span></span> 直接的所有联系来修改注意力。</p>\n<h3 id=\"点对点前馈网络\"><a class=\"anchor\" href=\"#点对点前馈网络\">#</a> 点对点前馈网络</h3>\n<ul>\n<li>\n<p><strong>问题描述</strong>：虽然自注意力机制可以根据适应性权重聚合所有之前项目的嵌入，但其本质上仍然是线性模型。</p>\n</li>\n<li>\n<p><strong>解决方法</strong>：为了赋予模型非线性，并考虑不同潜在维度之间的交互，为每个 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">S_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 应用一个点对点两层前馈网络，每个<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">S_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 的计算公式为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"bold\">F</mi><mi>i</mi></msub><mo>=</mo><mrow><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">N</mi></mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">S</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mi mathvariant=\"normal\">R</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">U</mi></mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">S</mi><mi>i</mi></msub><msup><mi mathvariant=\"bold\">W</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><msup><mi mathvariant=\"bold\">b</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo><msup><mi mathvariant=\"bold\">W</mi><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><msup><mi mathvariant=\"bold\">b</mi><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{F}_i=\\mathrm{FFN}(\\mathbf{S}_i)=\\mathrm{ReLU}(\\mathbf{S}_i\\mathbf{W}^{(1)}+\\mathbf{b}^{(1)})\\mathbf{W}^{(2)}+\\mathbf{b}^{(2)}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83611em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">F</span><span class=\"mord mathrm\">F</span><span class=\"mord mathrm\">N</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">S</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">R</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">L</span><span class=\"mord mathrm\">U</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">S</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">b</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">2</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.938em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">b</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">2</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>W</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mtext>和</mtext><msup><mi>W</mi><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">W^{(1)}和W^{(2)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8879999999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">和</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">2</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span> 是 d×d 矩阵，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>b</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mtext>和</mtext><msup><mi>b</mi><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">b^{(1)}和b^{(2)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8879999999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">和</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">2</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span> 是 d 维向量。并且<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">S_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">S_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 之间没有交互</p>\n<h4 id=\"ffn前馈神经网络\"><a class=\"anchor\" href=\"#ffn前馈神经网络\">#</a> FFN（前馈神经网络）</h4>\n<p>FFN（Feed-Forward Neural Network，前馈神经网络）是神经网络的一种基本结构，通常用于对输入数据进行非线性变换。它由一个或多个全连接层（也称为密集层）组成，每个层都包含一组可学习的权重和偏置。</p>\n<h4 id=\"relu线性修正单元\"><a class=\"anchor\" href=\"#relu线性修正单元\">#</a> ReLU（线性修正单元）</h4>\n<p>ReLU（Rectified Linear Unit，线性修正单元）是一种常用的激活函数。它的定义如下：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mi mathvariant=\"normal\">R</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">U</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathrm{ReLU}(x)=\\max(0,x)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">R</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">L</span><span class=\"mord mathrm\">U</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>ReLU 的作用是：</p>\n<ol>\n<li>对于输入的每个元素，如果该元素小于 0，则输出 0。</li>\n<li>如果该元素大于等于 0，则输出该元素本身。</li>\n</ol>\n</li>\n</ul>\n<h3 id=\"堆叠自注意力块\"><a class=\"anchor\" href=\"#堆叠自注意力块\">#</a> 堆叠自注意力块</h3>\n<ul>\n<li>\n<p><strong>问题描述</strong>：在第一个自注意力快后<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">F_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 本质上就聚合了所有之前项目的嵌入，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>(即</mtext><msub><mover accent=\"true\"><mi>E</mi><mo>^</mo></mover><mi>j</mi></msub><mo separator=\"true\">,</mo><mi>j</mi><mo>≤</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{(即}\\hat{E}_{j},j\\leq i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.232878em;vertical-align:-0.286108em;\"></span><span class=\"mord text\"><span class=\"mord\">(</span><span class=\"mord cjk_fallback\">即</span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9467699999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span><span style=\"top:-3.25233em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.16666em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span></span></span></span>, 但是我们可以以基于 F 的另一个自注意力块来学习更复杂的项目转换。</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi mathvariant=\"bold\">S</mi><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mrow><mi mathvariant=\"bold\">S</mi><mi mathvariant=\"bold\">A</mi></mrow><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">F</mi><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo><mo>=</mo><mtext>softmax</mtext><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi mathvariant=\"bold\">Q</mi><msup><mi mathvariant=\"bold\">K</mi><mi>T</mi></msup></mrow><msqrt><mi>d</mi></msqrt></mfrac><mo fence=\"true\">)</mo></mrow><mi mathvariant=\"bold\">V</mi><mo separator=\"true\">,</mo><mspace linebreak=\"newline\"></mspace><msubsup><mi mathvariant=\"bold\">F</mi><mi>i</mi><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><mrow><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">F</mi><mi mathvariant=\"normal\">N</mi></mrow><mo stretchy=\"false\">(</mo><msubsup><mi mathvariant=\"bold\">S</mi><mi>i</mi><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi mathvariant=\"normal\">∀</mi><mi>i</mi><mo>∈</mo><mo stretchy=\"false\">{</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">}</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{S}^{(b)}=\\mathbf{SA}(\\mathbf{F}^{(b-1)})=\\text{softmax}\\left(\\frac{\\mathbf{Q}\\mathbf{K}^T}{\\sqrt{d}}\\right)\\mathbf{V},\\\\\\mathbf{F}_{i}^{(b)}=\\mathrm{FFN}(\\mathbf{S}_{i}^{(b)}),\\quad\\forall i\\in\\{1,2,\\ldots,n\\},\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.938em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">S</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">S</span><span class=\"mord mathbf\">A</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.468361em;vertical-align:-0.95003em;\"></span><span class=\"mord text\"><span class=\"mord\">softmax</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5183309999999999em;\"><span style=\"top:-2.17778em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93222em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-2.89222em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.10777999999999999em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">Q</span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">K</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span><span class=\"mpunct\">,</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:1.321664em;vertical-align:-0.276864em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.4231360000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.2198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.276864em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.321664em;vertical-align:-0.276864em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">F</span><span class=\"mord mathrm\">F</span><span class=\"mord mathrm\">N</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">S</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.4231360000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.2198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.276864em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">∀</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">}</span><span class=\"mpunct\">,</span></span></span></span></span></p>\n<p>其中第一块定义为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>S</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>S</mi><mtext> </mtext><mi>a</mi><mi>n</mi><mi>d</mi><mtext> </mtext><msup><mi>F</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">S^{(1)}=S \\ and \\ F^{(1)}=F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8879999999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8879999999999999em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\"> </span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span></p>\n</li>\n<li>\n<p>随着模型深入出现了一些问题，采取的措施为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>g</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mo>+</mo><mtext>Dropout</mtext><mo stretchy=\"false\">(</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mtext>LayerNorm</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g&#x27;(x)=x+\\text{Dropout}(g(\\text{LayerNorm}(x)))\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.051892em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.801892em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">Dropout</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">LayerNorm</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left right left right\" columnspacing=\"0em 1em 0em 1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mn>1.</mn><mtext> 输入 </mtext><mi>x</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo separator=\"true\">⋅</mo><mi>x</mi><mtext>是上一层的输出或者当前层的输入。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>2. 层归一化(Layer Normalization):</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>∙</mo><mtext> 首先对输入 </mtext><mi>x</mi><mtext> 进行层归一化:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mrow><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">y</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">N</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">m</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>x</mi><mo>−</mo><mi>μ</mi></mrow><msqrt><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi></mrow></msqrt></mfrac><mo>⋅</mo><mi>γ</mi><mo>+</mo><mi>β</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>缩放和偏移参数。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>3. 应用函数 </mtext><mi>g</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo separator=\"true\">⋅</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>注意力机制</mtext><mo stretchy=\"false\">(</mo><mi>S</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">y</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">N</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">m</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>对于</mtext><mi>F</mi><mi>F</mi><mi>N</mi><mo separator=\"true\">,</mo><mtext>函数</mtext><mi>g</mi><mtext>的具体形式为</mtext><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">y</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">N</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">m</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mi mathvariant=\"normal\">R</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">U</mi></mrow><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">y</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">N</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">m</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi mathvariant=\"bold\">W</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><msup><mi mathvariant=\"bold\">b</mi><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">)</mo><msup><mi mathvariant=\"bold\">W</mi><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><msup><mi mathvariant=\"bold\">b</mi><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>4.Dropout:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo separator=\"true\">⋅</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>在应用函数 </mtext><mi>g</mi><mtext> 之后,对结果应用Dropout,以防止过拟合:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mrow><mi mathvariant=\"normal\">D</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">p</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">t</mi></mrow><mo stretchy=\"false\">(</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">y</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">N</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">m</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>Dropout的具体操作是在每次训练</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>5. 残差连接(Residual Connection):</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo separator=\"true\">⋅</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>最后,将Dropout的结果与原输入 </mtext><mi>x</mi><mtext> 相加,实现残差连接</mtext><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><msup><mi>g</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mo>+</mo><mrow><mi mathvariant=\"normal\">D</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">p</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">u</mi><mi mathvariant=\"normal\">t</mi></mrow><mo stretchy=\"false\">(</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">y</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">N</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">m</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n&amp;1.\\text{ 输入 }x: \\\\\n&amp;·x是上一层的输出或者当前层的输入。 \\\\\n&amp;\\text{2. 层归一化(Layer Normalization):} \\\\\n&amp;\\bullet\\text{ 首先对输入 }x\\text{ 进行层归一化:} \\\\\n&amp;\\mathrm{LayerNorm}(x)=\\frac{x-\\mu}{\\sqrt{\\sigma^{2}+\\epsilon}}\\cdot\\gamma+\\beta \\\\\n&amp;\\text{缩放和偏移参数。} \\\\\n&amp;\\text{3. 应用函数 }g: \\\\\n&amp;· \\\\\n&amp;注意力机制(SA): \\\\\n&amp;g(\\mathrm{LayerNorm}(x)) \\\\\n&amp;对于FFN,函数g的具体形式为: \\\\\n&amp;&amp;&amp;g(\\mathrm{LayerNorm}(x))=\\mathrm{ReLU}(\\mathrm{LayerNorm}(x)\\mathbf{W}^{(1)}+\\mathbf{b}^{(1)})\\mathbf{W}^{(2)}+\\mathbf{b}^{(2)} \\\\\n&amp;\\text{4.Dropout:} \\\\\n&amp;·&amp;&amp; \\text{在应用函数 }g\\text{ 之后,对结果应用Dropout,以防止过拟合:} \\\\\n&amp;&amp;&amp;\\mathrm{Dropout}(g(\\mathrm{LayerNorm}(x))) \\\\\n&amp;&amp;&amp;\\text{Dropout的具体操作是在每次训练} \\\\\n&amp; \\text{5. 残差连接(Residual Connection):} \\\\\n&amp;·&amp;&amp;&amp; \\text{最后,将Dropout的结果与原输入 }x\\text{ 相加,实现残差连接}: \\\\\n&amp;&amp;&amp;g&#x27;(x)=x+\\mathrm{Dropout}(g(\\mathrm{LayerNorm}(x)))\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:29.588330000000003em;vertical-align:-14.544165000000001em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:15.044165000000001em;\"><span style=\"top:-17.464495000000003em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:-15.964495000000001em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:-14.464495em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:-12.964495em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:-11.044165em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:-8.974165em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:-7.474164999999999em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:-5.974164999999999em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.474164999999999em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.9741649999999997em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.474164999999998em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.12383500000000103em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:1.623835000000001em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:3.123835000000001em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:4.6238350000000015em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:6.1238350000000015em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:7.6238350000000015em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:9.123835000000001em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span><span style=\"top:10.623835000000001em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:14.544165000000001em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:15.044165000000001em;\"><span style=\"top:-17.464495000000003em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">输入</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span></span><span style=\"top:-15.964495000000001em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mpunct\">⋅</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord cjk_fallback\">是</span><span class=\"mord cjk_fallback\">上</span><span class=\"mord cjk_fallback\">一</span><span class=\"mord cjk_fallback\">层</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">输</span><span class=\"mord cjk_fallback\">出</span><span class=\"mord cjk_fallback\">或</span><span class=\"mord cjk_fallback\">者</span><span class=\"mord cjk_fallback\">当</span><span class=\"mord cjk_fallback\">前</span><span class=\"mord cjk_fallback\">层</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">输</span><span class=\"mord cjk_fallback\">入</span><span class=\"mord cjk_fallback\">。</span></span></span><span style=\"top:-14.464495em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord\">2. </span><span class=\"mord cjk_fallback\">层归一化</span><span class=\"mord\">(Layer Normalization):</span></span></span></span><span style=\"top:-12.964495em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∙</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">首先对输入</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\">x</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">进行层归一化</span><span class=\"mord\">:</span></span></span></span><span style=\"top:-11.044165em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathrm\">L</span><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">y</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">N</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">m</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603300000000002em;\"><span style=\"top:-2.196611em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.913389em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.873389em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.12661100000000003em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span><span style=\"top:-8.974165em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">缩放和偏移参数。</span></span></span></span><span style=\"top:-7.474164999999999em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord\">3. </span><span class=\"mord cjk_fallback\">应用函数</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span></span><span style=\"top:-5.974164999999999em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mpunct\">⋅</span></span></span><span style=\"top:-4.474164999999999em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord cjk_fallback\">注</span><span class=\"mord cjk_fallback\">意</span><span class=\"mord cjk_fallback\">力</span><span class=\"mord cjk_fallback\">机</span><span class=\"mord cjk_fallback\">制</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span></span><span style=\"top:-2.9741649999999997em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathrm\">L</span><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">y</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">N</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">m</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span><span style=\"top:-1.474164999999998em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord cjk_fallback\">对</span><span class=\"mord cjk_fallback\">于</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord cjk_fallback\">函</span><span class=\"mord cjk_fallback\">数</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">具</span><span class=\"mord cjk_fallback\">体</span><span class=\"mord cjk_fallback\">形</span><span class=\"mord cjk_fallback\">式</span><span class=\"mord cjk_fallback\">为</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span></span><span style=\"top:0.12383500000000103em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span></span></span><span style=\"top:1.623835000000001em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord\">4.Dropout:</span></span></span></span><span style=\"top:3.123835000000001em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mpunct\">⋅</span></span></span><span style=\"top:4.6238350000000015em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span></span></span><span style=\"top:6.1238350000000015em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span></span></span><span style=\"top:7.6238350000000015em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord\">5. </span><span class=\"mord cjk_fallback\">残差连接</span><span class=\"mord\">(Residual Connection):</span></span></span></span><span style=\"top:9.123835000000001em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mpunct\">⋅</span></span></span><span style=\"top:10.623835000000001em;\"><span class=\"pstrut\" style=\"height:3.26033em;\"></span><span class=\"mord\"><span class=\"mord\"></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:14.544165000000001em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:-2.4461650000000015em;\"><span style=\"top:0.4461650000000015em;\"><span class=\"pstrut\" style=\"height:2.9379999999999997em;\"></span><span class=\"mord\"></span></span><span style=\"top:3.4461650000000015em;\"><span class=\"pstrut\" style=\"height:2.9379999999999997em;\"></span><span class=\"mord\"></span></span><span style=\"top:4.9461650000000015em;\"><span class=\"pstrut\" style=\"height:2.9379999999999997em;\"></span><span class=\"mord\"></span></span><span style=\"top:6.4461650000000015em;\"><span class=\"pstrut\" style=\"height:2.9379999999999997em;\"></span><span class=\"mord\"></span></span><span style=\"top:9.446165em;\"><span class=\"pstrut\" style=\"height:2.9379999999999997em;\"></span><span class=\"mord\"></span></span><span style=\"top:10.946165em;\"><span class=\"pstrut\" style=\"height:2.9379999999999997em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:14.544165000000001em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:-2.4461650000000015em;\"><span style=\"top:0.3841650000000012em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathrm\">L</span><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">y</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">N</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">m</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">R</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">L</span><span class=\"mord mathrm\">U</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathrm\">L</span><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">y</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">N</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">m</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">b</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">W</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">2</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">b</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">2</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:3.384165000000001em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">在应用函数</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">之后</span><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">对结果应用</span><span class=\"mord\">Dropout,</span><span class=\"mord cjk_fallback\">以防止过拟合</span><span class=\"mord\">:</span></span></span></span><span style=\"top:4.884165000000001em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathrm\">D</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">p</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">u</span><span class=\"mord mathrm\">t</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathrm\">L</span><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">y</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">N</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">m</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span><span style=\"top:6.384165000000001em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord\">Dropout</span><span class=\"mord cjk_fallback\">的具体操作是在每次训练</span></span></span></span><span style=\"top:9.384165000000001em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span></span></span><span style=\"top:10.884165000000001em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.801892em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">D</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">p</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">u</span><span class=\"mord mathrm\">t</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathrm\">L</span><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">y</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">N</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">m</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:14.544165000000001em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:-11.544165000000001em;\"><span style=\"top:9.384165000000001em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord cjk_fallback\">最后</span><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">将</span><span class=\"mord\">Dropout</span><span class=\"mord cjk_fallback\">的结果与原输入</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\">x</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">相加</span><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">实现残差连接</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:13.044165000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>其中 g (x) 表示自注意层或前馈网络。对于每层的 g，我们输入 g 之前都要对 x 进行层归一化，对 g 的输出应用 dropout，并将输入 x 添加到最终输出中。</p>\n</li>\n</ul>\n<h3 id=\"层归一化\"><a class=\"anchor\" href=\"#层归一化\">#</a> 层归一化</h3>\n<p>用于加速和稳定神经网络的训练过程。它通过在每一层对输入进行归一化，解决了在深层神经网络中训练时可能遇到的一些问题，例如梯度消失和梯度爆炸。</p>\n<p>层归一化的基本思想是对每个神经元的输入进行归一化，使得输入的均值为 0，方差为 1。与批量归一化（Batch Normalization）不同，层归一化在计算归一化统计量时，只考虑当前层的输入，而不是一个小批量的数据。</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">y</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">N</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">m</mi></mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>α</mi><mo>⊙</mo><mfrac><mrow><mi mathvariant=\"bold\">x</mi><mo>−</mo><mi>μ</mi></mrow><msqrt><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi></mrow></msqrt></mfrac><mo>+</mo><mi>β</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\mathrm{LayerNorm}(\\mathbf{x})=\\alpha\\odot\\frac{\\mathbf{x}-\\mu}{\\sqrt{\\sigma^{2}+\\epsilon}}+\\beta,\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">L</span><span class=\"mord mathrm\">a</span><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">y</span><span class=\"mord mathrm\">e</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">N</span><span class=\"mord mathrm\">o</span><span class=\"mord mathrm\">r</span><span class=\"mord mathrm\">m</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⊙</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1903300000000003em;vertical-align:-0.93em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603300000000002em;\"><span style=\"top:-2.196611em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.913389em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.873389em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.12661100000000003em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">x</span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mpunct\">,</span></span></span></span></span></p>\n<p>其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>⊙</mo></mrow><annotation encoding=\"application/x-tex\">\\odot</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord\">⊙</span></span></span></span> 是元素向乘积，是指对两个相同维度的矩阵或向量进行对应元素的逐个相乘。这个操作不同于矩阵乘法，它不涉及矩阵之间的行列相乘和求和，只是简单地对对应位置的元素进行乘积运算。</p>\n<h4 id=\"元素向量积的数学表示\"><a class=\"anchor\" href=\"#元素向量积的数学表示\">#</a> 元素向量积的数学表示</h4>\n<p>假设有两个相同维度矩阵 A 和 B，元素分别为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">A_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 和<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>B</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">B_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>，则它们的元素向量积 C 可以表示为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>C</mi><mo>=</mo><mi>A</mi><mo>⊙</mo><mi>B</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>其中,</mtext><msub><mi>C</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>×</mo><msub><mi>B</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mtext>。</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}&amp;C=A\\odot B\\\\\\\\&amp;\\text{其中,}C_{ij}=A_{ij}\\times B_{ij}。\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.500000000000002em;vertical-align:-2.000000000000001em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5000000000000004em;\"><span style=\"top:-4.5em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.4999999999999991em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.000000000000001em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⊙</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span><span style=\"top:-1.6599999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">其中</span><span class=\"mord\">,</span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">。</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0000000000000004em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<h5 id=\"举个例子\"><a class=\"anchor\" href=\"#举个例子\">#</a> 举个例子</h5>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>假设有两个矩阵</mtext><mi>A</mi><mtext>和</mtext><mi>B</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>A</mi><mo>=</mo><mrow><mo fence=\"true\">(</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>3</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>6</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>B</mi><mo>=</mo><mrow><mo fence=\"true\">(</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>7</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>8</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>9</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>11</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>12</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>它们的元素向乘积 C 为:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>C</mi><mo>=</mo><mi>A</mi><mo>⊙</mo><mi>B</mi><mo>=</mo><mrow><mo fence=\"true\">(</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mn>1</mn><mo>×</mo><mn>7</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mn>2</mn><mo>×</mo><mn>8</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mn>3</mn><mo>×</mo><mn>9</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mn>4</mn><mo>×</mo><mn>10</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mn>5</mn><mo>×</mo><mn>11</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mn>6</mn><mo>×</mo><mn>12</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">)</mo></mrow><mo>=</mo><mrow><mo fence=\"true\">(</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>7</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>16</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>27</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>40</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>55</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>72</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n&amp;假设有两个矩阵A和B: \\\\\n&amp;A=\\begin{pmatrix}1&amp;2&amp;3\\\\4&amp;5&amp;6\\end{pmatrix} \\\\\n&amp;B=\\begin{pmatrix}7&amp;8&amp;9\\\\10&amp;11&amp;12\\end{pmatrix} \\\\\n&amp;\\text{它们的元素向乘积 C 为:} \\\\\n&amp;C=A\\odot B=\\begin{pmatrix}1\\times7&amp;2\\times8&amp;3\\times9\\\\4\\times10&amp;5\\times11&amp;6\\times12\\end{pmatrix}=\\begin{pmatrix}7&amp;16&amp;27\\\\40&amp;55&amp;72\\end{pmatrix}\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:11.100090000000002em;vertical-align:-5.300045000000001em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.800045em;\"><span style=\"top:-8.410045em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"></span></span><span style=\"top:-6.300044999999999em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.6000149999999995em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.5099849999999995em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.6000150000000004em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.300045000000001em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.800045em;\"><span style=\"top:-8.410045em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord cjk_fallback\">假</span><span class=\"mord cjk_fallback\">设</span><span class=\"mord cjk_fallback\">有</span><span class=\"mord cjk_fallback\">两</span><span class=\"mord cjk_fallback\">个</span><span class=\"mord cjk_fallback\">矩</span><span class=\"mord cjk_fallback\">阵</span><span class=\"mord mathnormal\">A</span><span class=\"mord cjk_fallback\">和</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span></span><span style=\"top:-6.300044999999999em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">6</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span><span style=\"top:-3.6000149999999995em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">7</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">9</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span><span style=\"top:-1.5099849999999995em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">它们的元素向乘积</span><span class=\"mord\"> C </span><span class=\"mord cjk_fallback\">为</span><span class=\"mord\">:</span></span></span></span><span style=\"top:0.6000150000000004em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⊙</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">7</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">8</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">9</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">7</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\">6</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">5</span><span class=\"mord\">5</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\">7</span></span></span><span style=\"top:-2.4099999999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">7</span><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.300045000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<h3 id=\"预测层\"><a class=\"anchor\" href=\"#预测层\">#</a> 预测层</h3>\n<p>在 b 个自我关注快后根据<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>F</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow><annotation encoding=\"application/x-tex\">F_{t}^{(b)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2905559999999998em;vertical-align:-0.24575599999999992em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.454244em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span style=\"top:-3.2197999999999998em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24575599999999992em;\"><span></span></span></span></span></span></span></span></span></span> 来预测下一个项目。具体来说采用 MF 层来预测项目<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 的相关性。</p>\n<ul>\n<li>\n<p>MF 层（Matrix Factorization Layer，矩阵分解层）在推荐系统中是指一种使用矩阵分解技术来预测用户与物品之间的交互评分或相关性的方法。矩阵分解是一种常见的协同过滤技术，通过将用户 - 物品评分矩阵分解为两个低维矩阵来建模用户偏好和物品特征</p>\n</li>\n<li>\n<p>矩阵分解的目标是将一个大矩阵分解为两个更小的矩阵，这两个矩阵的乘积近似于原始矩阵。在推荐系统中，通常有一个用户 - 物品评分矩阵 R，其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 表示用户 i 对物品 j 的评分。矩阵分解的目的是将 R 分解为两个地位矩阵 U 和 V。</p>\n</li>\n<li>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>R</mi><mo>≈</mo><mi>U</mi><msup><mi>V</mi><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>其中:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>∙</mo><mspace width=\"1em\"/><mi>U</mi><mtext> 是用户矩阵,维度为 </mtext><mi>m</mi><mo>×</mo><mi>k</mi><mtext>,每一行对应一个用户的隐向量表示。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>∙</mo><mspace width=\"1em\"/><mi>V</mi><mtext> 是物品矩阵,维度为 </mtext><mi>n</mi><mo>×</mo><mi>k</mi><mtext>,每一行对应一个物品的隐向量表示。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>∙</mo><mspace width=\"1em\"/><mi>k</mi><mtext> 是隐向量的维度,也称为潜在特征的数量。</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}&amp;R\\approx UV^T\\\\&amp;\\text{其中:}\\\\&amp;\\bullet\\quad U\\text{ 是用户矩阵,维度为 }m\\times k\\text{,每一行对应一个用户的隐向量表示。}\\\\&amp;\\bullet\\quad V\\text{ 是物品矩阵,维度为 }n\\times k\\text{,每一行对应一个物品的隐向量表示。}\\\\&amp;\\bullet\\quad k\\text{ 是隐向量的维度,也称为潜在特征的数量。}\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:7.551331em;vertical-align:-3.5256654999999997em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.025665500000001em;\"><span style=\"top:-6.025665500000001em;\"><span class=\"pstrut\" style=\"height:2.891331em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.525665500000001em;\"><span class=\"pstrut\" style=\"height:2.891331em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.0256655000000006em;\"><span class=\"pstrut\" style=\"height:2.891331em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.5256655000000006em;\"><span class=\"pstrut\" style=\"height:2.891331em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.025665500000000563em;\"><span class=\"pstrut\" style=\"height:2.891331em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.5256654999999997em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.025665500000001em;\"><span style=\"top:-6.1343345000000005em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span><span style=\"top:-4.6343345000000005em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">其中</span><span class=\"mord\">:</span></span></span></span><span style=\"top:-3.1343345000000005em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∙</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">是用户矩阵</span><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">维度为</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord text\"><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">每一行对应一个用户的隐向量表示。</span></span></span></span><span style=\"top:-1.6343345000000005em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∙</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">是物品矩阵</span><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">维度为</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord text\"><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">每一行对应一个物品的隐向量表示。</span></span></span></span><span style=\"top:-0.13433450000000047em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∙</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">是隐向量的维度</span><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">也称为潜在特征的数量。</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.5256654999999997em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n</li>\n<li></li>\n</ul>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>t</mi></mrow></msub><mo>=</mo><msubsup><mi mathvariant=\"bold\">F</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><msubsup><mi mathvariant=\"bold\">N</mi><mi>i</mi><mi>T</mi></msubsup><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">r_{i,t}=\\mathbf{F}_t^{(b)}\\mathbf{N}_i^T,\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2917999999999998em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.454244em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span><span style=\"top:-3.2198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24575599999999997em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">N</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">r_{i,t}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 是物品 i 在时间步 t 被推荐的相关性分数。</li>\n<li>$F_t $ 是用户在时间步 t 的隐向量表示。</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">N_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是物品 i 的隐向量表示。</li>\n</ul>\n<p>在这里我们使用单项嵌入 M 的方案，即</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>t</mi></mrow></msub><mo>=</mo><msubsup><mi mathvariant=\"bold\">F</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><msubsup><mi mathvariant=\"bold\">M</mi><mi>i</mi><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">r_{i,t}=\\mathbf{F}_{t}^{(b)}\\mathbf{M}_{i}^{T}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2917999999999998em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.454244em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span style=\"top:-3.2198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24575599999999997em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">M</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>在此矩阵中嵌入矩阵 M 是一个大小为 | I|×d 的矩阵，其中 | I | 是物品总数量，d 是嵌入向量的维度。</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>F</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow><annotation encoding=\"application/x-tex\">F_{t}^{(b)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2905559999999998em;vertical-align:-0.24575599999999992em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.454244em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span style=\"top:-3.2197999999999998em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24575599999999992em;\"><span></span></span></span></span></span></span></span></span></span> 可以表示为取决于项目嵌入 M 的函数，即：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mi mathvariant=\"bold\">F</mi><mi>t</mi><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">M</mi><msub><mi>s</mi><mn>1</mn></msub></msub><mo separator=\"true\">,</mo><msub><mi mathvariant=\"bold\">M</mi><msub><mi>s</mi><mn>2</mn></msub></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi mathvariant=\"bold\">M</mi><msub><mi>s</mi><mi>t</mi></msub></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{F}_{t}^{(b)}=f(\\mathbf{M}_{s_{1}},\\mathbf{M}_{s_{2}},\\ldots,\\mathbf{M}_{s_{t}})\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.290556em;vertical-align:-0.24575599999999997em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">F</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.454244em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span style=\"top:-3.2198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24575599999999997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0001em;vertical-align:-0.2501em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">M</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139199999999997em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">M</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139199999999997em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31731428571428577em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">M</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139199999999997em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>注意：需要实现不对称 ——<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>F</mi><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>M</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><msubsup><mi>M</mi><mi>j</mi><mi>T</mi></msubsup><mo mathvariant=\"normal\">≠</mo><mi>F</mi><mi>F</mi><mi>N</mi><mo stretchy=\"false\">(</mo><msub><mi>M</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><msubsup><mi>M</mi><mi>i</mi><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">FFN(M_i)M_j^T≠FFN(M_j)M_i^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.236103em;vertical-align:-0.394772em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-2.441336em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.394772em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"inner\"><span class=\"mrel\"></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1274389999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-2.441336em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.258664em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p><strong>考虑用户之前的操作，并从访问过的项目的嵌入中得出隐式用户嵌入</strong></p>\n<h3 id=\"网络层训练\"><a class=\"anchor\" href=\"#网络层训练\">#</a> 网络层训练</h3>\n<p>我们将每个用户序列<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msubsup><mi mathvariant=\"script\">S</mi><mn>1</mn><mi>u</mi></msubsup><mo separator=\"true\">,</mo><msubsup><mi mathvariant=\"script\">S</mi><mn>2</mn><mi>u</mi></msubsup><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msubsup><mi mathvariant=\"script\">S</mi><mrow><mi mathvariant=\"normal\">∣</mi><msup><mi mathvariant=\"script\">S</mi><mi>u</mi></msup><mi mathvariant=\"normal\">∣</mi><mo>−</mo><mn>1</mn></mrow><mi>u</mi></msubsup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\mathcal{S}_{1}^{u},\\mathcal{S}_{2}^{u},\\ldots,\\mathcal{S}_{|\\mathcal{S}^{u}|-1}^{u})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2469999999999999em;vertical-align:-0.49699999999999994em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.075em;\">S</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-2.4518920000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.075em;\">S</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-2.4518920000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.075em;\">S</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6643919999999999em;\"><span style=\"top:-2.378em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">∣</span><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.075em;\">S</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5935428571428571em;\"><span style=\"top:-2.786em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span><span class=\"mord mtight\">∣</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.49699999999999994em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 转换为固定长度的序列<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo>=</mo><mo stretchy=\"false\">{</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>s</mi><mi>n</mi></msub><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">s=\\{s_1,s_2,\\ldots,s_n\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">}</span></span></span></span>：我们将<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">o_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 定义为时间步 t 的预期输出：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.3599999999999999em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mtext>&lt;pad&gt;</mtext></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>如果 </mtext><msub><mi>s</mi><mi>t</mi></msub><mtext>是一个填充项</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mn>1</mn><mo>≤</mo><mi>t</mi><mo>&lt;</mo><mi>n</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msubsup><mi>S</mi><mrow><mi mathvariant=\"normal\">∣</mi><msup><mi>S</mi><mi>u</mi></msup><mi mathvariant=\"normal\">∣</mi></mrow><mi>u</mi></msubsup></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>t</mi><mo>=</mo><mi>n</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">o_t=\\begin{cases}\\text{&lt;pad&gt;}&amp;\\text{如果 }s_t\\text{是一个填充项}\\\\s_{t+1}&amp;1\\leq t&lt;n\\\\S_{|S^u|}^u&amp;t=n\\end{cases}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:4.385em;vertical-align:-1.9425em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35002em;\"><span style=\"top:-2.19999em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-2.19499em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-2.20499em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-3.15001em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-4.2950099999999996em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-4.30501em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎪</span></span></span><span style=\"top:-4.60002em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8500199999999998em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4425em;\"><span style=\"top:-4.442500000000001em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">&lt;pad&gt;</span></span></span></span><span style=\"top:-3.0025em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.5625em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6643919999999999em;\"><span style=\"top:-2.378em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">∣</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5935428571428571em;\"><span style=\"top:-2.786em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span><span class=\"mord mtight\">∣</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.49699999999999994em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9425em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4425em;\"><span style=\"top:-4.442500000000001em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord cjk_fallback\">如果</span><span class=\"mord\"> </span></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">是一个填充项</span></span></span></span><span style=\"top:-3.0025em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-1.5625em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9425em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<ul>\n<li>\n<p>其中 pad 表示填充项，我们的模型以序列<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span> 作为输入，响应的序列<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi></mrow><annotation encoding=\"application/x-tex\">o</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">o</span></span></span></span> 为预期输出，我们采用二院交叉熵损失作为目标函数</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo>−</mo><munder><mo>∑</mo><mrow><msup><mi mathvariant=\"script\">S</mi><mi>u</mi></msup><mo>∈</mo><mi mathvariant=\"script\">S</mi></mrow></munder><munder><mo>∑</mo><mrow><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">]</mo></mrow></munder><mrow><mo fence=\"true\">[</mo><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>σ</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mrow><msub><mi>o</mi><mi>t</mi></msub><mo separator=\"true\">,</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>+</mo><munder><mo>∑</mo><mrow><mi>j</mi><mo>∉</mo><msup><mi mathvariant=\"script\">S</mi><mi>u</mi></msup></mrow></munder><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mrow><mi>j</mi><mo separator=\"true\">,</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">-\\sum_{\\mathcal{S}^u\\in\\mathcal{S}}\\sum_{t\\in[1,2,...,n]}\\left[\\log(\\sigma(r_{o_t,t}))+\\sum_{j\\not\\in\\mathcal{S}^u}\\log(1-\\sigma(r_{j,t}))\\right]\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.6010299999999997em;vertical-align:-1.55002em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8556639999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.075em;\">S</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5935428571428571em;\"><span style=\"top:-2.786em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.075em;\">S</span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.321706em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.808995em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">∈</span><span class=\"mopen mtight\">[</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">2</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mord mtight\">.</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mclose mtight\">]</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.516005em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0510099999999998em;\"><span style=\"top:-2.2500000000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.8099900000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎢</span></span></span><span style=\"top:-4.05101em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55002em;\"><span></span></span></span></span></span></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.28055599999999997em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\"><span class=\"mord vbox mtight\"><span class=\"thinbox mtight\"><span class=\"rlap mtight\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"inner\"><span class=\"mrel mtight\"></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.075em;\">S</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5935428571428571em;\"><span style=\"top:-2.786em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.438221em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0510099999999998em;\"><span style=\"top:-2.2500000000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.8099900000000004em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎥</span></span></span><span style=\"top:-4.05101em;\"><span class=\"pstrut\" style=\"height:3.1550000000000002em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55002em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>S</mi><mo>:</mo><mtext>表示所有用户的集合。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><msup><mi>S</mi><mi>u</mi></msup><mspace></mspace><mspace width=\"0.1111111111111111em\"/><mo lspace=\"0em\" rspace=\"0.17em\"></mo><mtext> ⁣</mtext><mo lspace=\"0em\" rspace=\"0em\">:</mo><mspace width=\"0.3333333333333333em\"/><mtext>表示用户 </mtext><mi>u</mi><mtext> 的序列。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>t</mi><mspace></mspace><mspace width=\"0.1111111111111111em\"/><mo lspace=\"0em\" rspace=\"0.17em\"></mo><mtext> ⁣</mtext><mo lspace=\"0em\" rspace=\"0em\">:</mo><mspace width=\"0.3333333333333333em\"/><mtext>表示时间步,取值范围为 </mtext><mo stretchy=\"false\">{</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">}</mo><mtext>。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><msub><mi>o</mi><mi>t</mi></msub><mspace></mspace><mspace width=\"0.1111111111111111em\"/><mo lspace=\"0em\" rspace=\"0.17em\"></mo><mtext> ⁣</mtext><mo lspace=\"0em\" rspace=\"0em\">:</mo><mspace width=\"0.3333333333333333em\"/><mtext>在时间步 </mtext><mi>t</mi><mtext> 的预测输出。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><msub><mi>r</mi><mrow><msub><mi>o</mi><mi>t</mi></msub><mo separator=\"true\">,</mo><mi>t</mi></mrow></msub><mtext>:在时间步 </mtext><mi>t</mi><mtext> 预测物品 </mtext><msub><mi>o</mi><mi>t</mi></msub><mtext> 的相关性分数。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><msub><mi>r</mi><mrow><mi>j</mi><mo separator=\"true\">,</mo><mi>t</mi></mrow></msub><mspace></mspace><mspace width=\"0.1111111111111111em\"/><mo lspace=\"0em\" rspace=\"0.17em\"></mo><mtext> ⁣</mtext><mo lspace=\"0em\" rspace=\"0em\">:</mo><mspace width=\"0.3333333333333333em\"/><mtext> 在时间步 </mtext><mi>t</mi><mtext> 预测物品 </mtext><mi>j</mi><mtext> 的相关性分数,</mtext><mi>j</mi><mo mathvariant=\"normal\">∉</mo><msup><mi>S</mi><mi>u</mi></msup><mtext> 表示不在用户 </mtext><mi>u</mi><mtext> 的历史</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>交互序列中的物品。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>σ</mi><mo>:</mo><mtext>表示</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>o</mi><mi>i</mi><mi>d</mi><mtext>函数。</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n&amp;S:表示所有用户的集合。 \\\\\n&amp;S^{u}\\colon\\text{表示用户 }u\\text{ 的序列。} \\\\\n&amp;t\\colon\\text{表示时间步,取值范围为 }\\{1,2,\\ldots,n\\}。 \\\\\n&amp;o_{t}\\colon\\text{在时间步 }t\\text{ 的预测输出。} \\\\\n&amp;r_{o_t,t}\\text{:在时间步 }t\\text{ 预测物品 }o_t\\text{ 的相关性分数。} \\\\\n&amp;r_{j,t}\\colon\\text{ 在时间步 }t\\text{ 预测物品 }j\\text{ 的相关性分数,}j\\notin S^u\\text{ 表示不在用户 }u\\text{ 的历史} \\\\\n&amp;\\text{交互序列中的物品。} \\\\\n&amp;\\sigma:表示sigmoid函数。\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:12.000000000000002em;vertical-align:-5.750000000000001em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:6.250000000000001em;\"><span style=\"top:-8.25em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:-6.75em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:-5.249999999999999em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.749999999999999em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.249999999999999em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.7499999999999987em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.7500000000000009em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:2.250000000000001em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.750000000000001em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:6.250000000000001em;\"><span style=\"top:-8.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord cjk_fallback\">表</span><span class=\"mord cjk_fallback\">示</span><span class=\"mord cjk_fallback\">所</span><span class=\"mord cjk_fallback\">有</span><span class=\"mord cjk_fallback\">用</span><span class=\"mord cjk_fallback\">户</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">集</span><span class=\"mord cjk_fallback\">合</span><span class=\"mord cjk_fallback\">。</span></span></span><span style=\"top:-6.91em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7143919999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span><span class=\"mspace nobreak\"></span><span class=\"mspace\" style=\"margin-right:0.1111111111111111em;\"></span><span class=\"mpunct\"></span><span class=\"mspace\" style=\"margin-right:-0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mrel\">:</span></span><span class=\"mspace\" style=\"margin-right:0.3333333333333333em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">表示用户</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\">u</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">的序列。</span></span></span></span><span style=\"top:-5.409999999999999em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace nobreak\"></span><span class=\"mspace\" style=\"margin-right:0.1111111111111111em;\"></span><span class=\"mpunct\"></span><span class=\"mspace\" style=\"margin-right:-0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mrel\">:</span></span><span class=\"mspace\" style=\"margin-right:0.3333333333333333em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">表示时间步</span><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">取值范围为</span><span class=\"mord\"> </span></span><span class=\"mopen\">{</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">}</span><span class=\"mord cjk_fallback\">。</span></span></span><span style=\"top:-3.9099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace nobreak\"></span><span class=\"mspace\" style=\"margin-right:0.1111111111111111em;\"></span><span class=\"mpunct\"></span><span class=\"mspace\" style=\"margin-right:-0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mrel\">:</span></span><span class=\"mspace\" style=\"margin-right:0.3333333333333333em;\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">在时间步</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\">t</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">的预测输出。</span></span></span></span><span style=\"top:-2.4099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.28055599999999997em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord text\"><span class=\"mord\">:</span><span class=\"mord cjk_fallback\">在时间步</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\">t</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">预测物品</span><span class=\"mord\"> </span></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">的相关性分数。</span></span></span></span><span style=\"top:-0.9099999999999988em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace nobreak\"></span><span class=\"mspace\" style=\"margin-right:0.1111111111111111em;\"></span><span class=\"mpunct\"></span><span class=\"mspace\" style=\"margin-right:-0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mrel\">:</span></span><span class=\"mspace\" style=\"margin-right:0.3333333333333333em;\"></span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">在时间步</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\">t</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">预测物品</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">的相关性分数</span><span class=\"mord\">,</span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\"><span class=\"mord\"><span class=\"mrel\">∈</span></span><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"llap\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mord\">/</span><span class=\"mspace\" style=\"margin-right:0.05555555555555555em;\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7143919999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">表示不在用户</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\">u</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">的历史</span></span></span></span><span style=\"top:0.5900000000000007em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">交互序列中的物品。</span></span></span></span><span style=\"top:2.0900000000000007em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord cjk_fallback\">表</span><span class=\"mord cjk_fallback\">示</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">d</span><span class=\"mord cjk_fallback\">函</span><span class=\"mord cjk_fallback\">数</span><span class=\"mord cjk_fallback\">。</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.750000000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n</li>\n</ul>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>σ</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mrow><msub><mi>o</mi><mi>t</mi></msub><mo separator=\"true\">,</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mtext>:对于时间步 </mtext><mi>t</mi><mtext> 的正样本 </mtext><msub><mi>o</mi><mi>t</mi></msub><mtext>,计算预测相关性分数的对数。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><munder><mo>∑</mo><mrow><mi>j</mi><mo mathvariant=\"normal\">∉</mo><msup><mi>S</mi><mi>n</mi></msup></mrow></munder><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mrow><mi>j</mi><mo separator=\"true\">,</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mtext>:对于时间步 </mtext><mi>t</mi><mtext> 的负样本集合,计算每个负样本</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>的预测相关性分数的对数。</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}&amp;\\log(\\sigma(r_{o_{t},t}))\\text{:对于时间步 }t\\text{ 的正样本 }o_t\\text{,计算预测相关性分数的对数。}\\\\&amp;\\sum_{j\\notin S^n}\\log(1-\\sigma(r_{j,t}))\\text{:对于时间步 }t\\text{ 的负样本集合,计算每个负样本}\\\\&amp;\\text{的预测相关性分数的对数。}\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:5.866010000000002em;vertical-align:-2.6830050000000014em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.1830050000000005em;\"><span style=\"top:-5.39301em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.6830049999999996em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.0269999999999988em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6830050000000014em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.1830050000000005em;\"><span style=\"top:-5.39301em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.28055599999999997em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29634285714285713em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mord text\"><span class=\"mord\">:</span><span class=\"mord cjk_fallback\">对于时间步</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\">t</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">的正样本</span><span class=\"mord\"> </span></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord text\"><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">计算预测相关性分数的对数。</span></span></span></span><span style=\"top:-3.6830049999999996em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.808995em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\"><span class=\"mord mtight\"><span class=\"mrel mtight\">∈</span></span><span class=\"mord vbox mtight\"><span class=\"thinbox mtight\"><span class=\"llap mtight\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"inner\"><span class=\"mord mtight\"><span class=\"mord mtight\">/</span><span class=\"mspace mtight\" style=\"margin-right:0.06505555555555556em;\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5935428571428571em;\"><span style=\"top:-2.786em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.516005em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mord text\"><span class=\"mord\">:</span><span class=\"mord cjk_fallback\">对于时间步</span><span class=\"mord\"> </span></span><span class=\"mord mathnormal\">t</span><span class=\"mord text\"><span class=\"mord\"> </span><span class=\"mord cjk_fallback\">的负样本集合</span><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">计算每个负样本</span></span></span></span><span style=\"top:-1.0269999999999988em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">的预测相关性分数的对数。</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6830050000000014em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>数</mtext><mo separator=\"true\">,</mo><mtext>从而提高正样本的预测概率。</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>负样本损失:通过</mtext><munder><mo>∑</mo><mrow><mi>j</mi><mo mathvariant=\"normal\">∉</mo><msup><mi>S</mi><mi>u</mi></msup></mrow></munder><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mrow><mi>j</mi><mo separator=\"true\">,</mo><mi>t</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mtext>项,模型希望最小化负样本的预</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>测相关性分数,从而降低负样本的预测概率。</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n&amp;数,从而提高正样本的预测概率。 \\\\\n&amp;\\text{负样本损失:通过}\\sum_{j\\notin S^{u}}\\log(1-\\sigma(r_{j,t})) \\text{项,模型希望最小化负样本的预} \\\\\n&amp;\\text{测相关性分数,从而降低负样本的预测概率。}\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:5.866010000000002em;vertical-align:-2.6830050000000014em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.1830050000000005em;\"><span style=\"top:-5.39301em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.6830049999999996em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.0269999999999988em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6830050000000014em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.1830050000000005em;\"><span style=\"top:-5.39301em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord cjk_fallback\">数</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord cjk_fallback\">从</span><span class=\"mord cjk_fallback\">而</span><span class=\"mord cjk_fallback\">提</span><span class=\"mord cjk_fallback\">高</span><span class=\"mord cjk_fallback\">正</span><span class=\"mord cjk_fallback\">样</span><span class=\"mord cjk_fallback\">本</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">预</span><span class=\"mord cjk_fallback\">测</span><span class=\"mord cjk_fallback\">概</span><span class=\"mord cjk_fallback\">率</span><span class=\"mord cjk_fallback\">。</span></span></span><span style=\"top:-3.6830049999999996em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">负样本损失</span><span class=\"mord\">:</span><span class=\"mord cjk_fallback\">通过</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.050005em;\"><span style=\"top:-1.808995em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\"><span class=\"mord mtight\"><span class=\"mrel mtight\">∈</span></span><span class=\"mord vbox mtight\"><span class=\"thinbox mtight\"><span class=\"llap mtight\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"inner\"><span class=\"mord mtight\"><span class=\"mord mtight\">/</span><span class=\"mspace mtight\" style=\"margin-right:0.06505555555555556em;\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5935428571428571em;\"><span style=\"top:-2.786em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.516005em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mord text\"><span class=\"mord cjk_fallback\">项</span><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">模型希望最小化负样本的预</span></span></span></span><span style=\"top:-1.0269999999999988em;\"><span class=\"pstrut\" style=\"height:3.050005em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord text\"><span class=\"mord cjk_fallback\">测相关性分数</span><span class=\"mord\">,</span><span class=\"mord cjk_fallback\">从而降低负样本的预测概率。</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6830050000000014em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<h3 id=\"讨论\"><a class=\"anchor\" href=\"#讨论\">#</a> 讨论</h3>\n<ul>\n<li>\n<p>因式分解马尔科夫链可得到：FMC 会对一阶项目转移矩阵进行因式分解，并根据上一项目<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 预测下一个项目<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>j</mi><mi mathvariant=\"normal\">∣</mi><mi>i</mi><mo stretchy=\"false\">)</mo><mo>∝</mo><msubsup><mi mathvariant=\"bold\">M</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi mathvariant=\"bold\">N</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">P(j|i)\\propto\\mathbf{M}_i^T\\mathbf{N}_j\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∝</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.177439em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">M</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">N</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>j</mi><mi mathvariant=\"normal\">∣</mi><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(j|i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span></span></span></span> 表示在给定物品<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 的情况下，推荐物品<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 的概率</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>M</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">M_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 表示物品<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 的嵌入向量</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">N_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 表示物品<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 的嵌入向量</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>M</mi><mi>i</mi><mi>j</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">M_i^j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.219436em;vertical-align:-0.276864em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.942572em;\"><span style=\"top:-2.4231360000000004em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.1809080000000005em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.276864em;\"><span></span></span></span></span></span></span></span></span></span> 表示物品<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 的嵌入向量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>M</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">M_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和物品<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> 的嵌入向量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">N_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 的内积</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"实验\"><a class=\"anchor\" href=\"#实验\">#</a> 实验</h3>\n<h4 id=\"问题\"><a class=\"anchor\" href=\"#问题\">#</a> 问题</h4>\n<ul>\n<li>SASRec 是否优于最先进的模型（包括基于 CNN/RNN 的方法）？</li>\n<li>SASRec 架构中各个组件的影响是什么？</li>\n<li>SASRec 的训练效率和可扩展性（关于 n）是多少？</li>\n<li>注意力权重是否能够学习与位置或项目属性相关的有意义的模式？</li>\n</ul>\n<h4 id=\"数据集\"><a class=\"anchor\" href=\"#数据集\">#</a> 数据集</h4>\n<ul>\n<li>Amazon：[46] 中引入的一系列数据集，包含从 <span class=\"exturl\" data-url=\"aHR0cDovL0FtYXpvbi5jb20=\">Amazon.com</span> 抓取的大量产品评论语料库。Amazon 上的顶级产品类别被视为单独的数据集。我们考虑两个类别，“美容” 和 “游戏”。该数据集以其高稀疏性和多变性而著称。</li>\n<li>Steam：我们引入了一个从大型在线视频游戏分发平台 Steam 抓取的新数据集。该数据集包含 2,567,538 名用户、15,474 款游戏和 7,793,069 条英文评论，时间跨度为 2010 年 10 月至 2018 年 1 月。 该数据集还包含可能对未来工作有用的丰富信息，例如用户的游戏时间、定价信息、媒体评分、类别、开发者（等）</li>\n<li>MovieLens：一种广泛用于评估协同过滤算法的基准数据集。我们使用包含 100 万用户评分的版本（MovieLens-1M）。</li>\n</ul>\n<p>将评论或评分的存在视为隐式反馈（即用户与商品进行了交互），并使用时间戳来确定操作的顺序。我们丢弃相关操作少于 5 个的用户和商品。为了进行分区，我们将每个用户 u 的历史序列 Su 分成三部分：</p>\n<p |S^u|=\"\">（1）用于测试的最近操作S^u_</p>\n<p |S^u|-1=\"\">（2）用于验证的第二最近操作S^u_</p>\n<p>（3）用于训练的所有剩余操作。请注意，在测试期间，输入序列包含训练操作和验证操作</p>\n<h1 id=\"代码解析\"><a class=\"anchor\" href=\"#代码解析\">#</a> 代码解析</h1>\n<h2 id=\"modulespy\"><a class=\"anchor\" href=\"#modulespy\">#</a> <span class=\"exturl\" data-url=\"aHR0cDovL21vZHVsZXMucHk=\">modules.py</span></h2>\n<p><strong>这个代码实现了 Transformer 模型的一部分，主要包括位置编码、层归一化、嵌入、多头注意力机制和前馈神经网络。</strong></p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"comment\">#/usr/bin/python2</span></span><br><span class=\"line\"><span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">June 2017 by kyubyong park. </span></span><br><span class=\"line\"><span class=\"string\">kbpark.linguist@gmail.com.</span></span><br><span class=\"line\"><span class=\"string\">https://www.github.com/kyubyong/transformer</span></span><br><span class=\"line\"><span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> __future__ <span class=\"keyword\">import</span> print_function</span><br><span class=\"line\"><span class=\"keyword\">import</span> tensorflow <span class=\"keyword\">as</span> tf</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">positional_encoding</span>(<span class=\"params\">dim, sentence_length, dtype=tf.float32</span>):</span><br><span class=\"line\"></span><br><span class=\"line\">    encoded_vec = np.array([pos/np.power(<span class=\"number\">10000</span>, <span class=\"number\">2</span>*i/dim) <span class=\"keyword\">for</span> pos <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(sentence_length) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(dim)])</span><br><span class=\"line\">    encoded_vec[::<span class=\"number\">2</span>] = np.sin(encoded_vec[::<span class=\"number\">2</span>])</span><br><span class=\"line\">    encoded_vec[<span class=\"number\">1</span>::<span class=\"number\">2</span>] = np.cos(encoded_vec[<span class=\"number\">1</span>::<span class=\"number\">2</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> tf.convert_to_tensor(encoded_vec.reshape([sentence_length, dim]), dtype=dtype)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">normalize</span>(<span class=\"params\">inputs, </span></span><br><span class=\"line\"><span class=\"params\">              epsilon = <span class=\"number\">1e-8</span>,</span></span><br><span class=\"line\"><span class=\"params\">              scope=<span class=\"string\">&quot;ln&quot;</span>,</span></span><br><span class=\"line\"><span class=\"params\">              reuse=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    <span class=\"string\">&#x27;&#x27;&#x27;Applies layer normalization.</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    Args:</span></span><br><span class=\"line\"><span class=\"string\">      inputs: A tensor with 2 or more dimensions, where the first dimension has</span></span><br><span class=\"line\"><span class=\"string\">        `batch_size`.</span></span><br><span class=\"line\"><span class=\"string\">      epsilon: A floating number. A very small number for preventing ZeroDivision Error.</span></span><br><span class=\"line\"><span class=\"string\">      scope: Optional scope for `variable_scope`.</span></span><br><span class=\"line\"><span class=\"string\">      reuse: Boolean, whether to reuse the weights of a previous layer</span></span><br><span class=\"line\"><span class=\"string\">        by the same name.</span></span><br><span class=\"line\"><span class=\"string\">      </span></span><br><span class=\"line\"><span class=\"string\">    Returns:</span></span><br><span class=\"line\"><span class=\"string\">      A tensor with the same shape and data dtype as `inputs`.</span></span><br><span class=\"line\"><span class=\"string\">    &#x27;&#x27;&#x27;</span></span><br><span class=\"line\">    <span class=\"keyword\">with</span> tf.variable_scope(scope, reuse=reuse):</span><br><span class=\"line\">        inputs_shape = inputs.get_shape()</span><br><span class=\"line\">        params_shape = inputs_shape[-<span class=\"number\">1</span>:]</span><br><span class=\"line\">    </span><br><span class=\"line\">        mean, variance = tf.nn.moments(inputs, [-<span class=\"number\">1</span>], keep_dims=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        beta= tf.Variable(tf.zeros(params_shape))</span><br><span class=\"line\">        gamma = tf.Variable(tf.ones(params_shape))</span><br><span class=\"line\">        normalized = (inputs - mean) / ( (variance + epsilon) ** (<span class=\"number\">.5</span>) )</span><br><span class=\"line\">        outputs = gamma * normalized + beta</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"keyword\">return</span> outputs</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">embedding</span>(<span class=\"params\">inputs, </span></span><br><span class=\"line\"><span class=\"params\">              vocab_size, </span></span><br><span class=\"line\"><span class=\"params\">              num_units, </span></span><br><span class=\"line\"><span class=\"params\">              zero_pad=<span class=\"literal\">True</span>, </span></span><br><span class=\"line\"><span class=\"params\">              scale=<span class=\"literal\">True</span>,</span></span><br><span class=\"line\"><span class=\"params\">              l2_reg=<span class=\"number\">0.0</span>,</span></span><br><span class=\"line\"><span class=\"params\">              scope=<span class=\"string\">&quot;embedding&quot;</span>, </span></span><br><span class=\"line\"><span class=\"params\">              with_t=<span class=\"literal\">False</span>,</span></span><br><span class=\"line\"><span class=\"params\">              reuse=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    <span class=\"string\">&#x27;&#x27;&#x27;Embeds a given tensor.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Args:</span></span><br><span class=\"line\"><span class=\"string\">      inputs: A `Tensor` with type `int32` or `int64` containing the ids</span></span><br><span class=\"line\"><span class=\"string\">         to be looked up in `lookup table`.</span></span><br><span class=\"line\"><span class=\"string\">      vocab_size: An int. Vocabulary size.</span></span><br><span class=\"line\"><span class=\"string\">      num_units: An int. Number of embedding hidden units.</span></span><br><span class=\"line\"><span class=\"string\">      zero_pad: A boolean. If True, all the values of the fist row (id 0)</span></span><br><span class=\"line\"><span class=\"string\">        should be constant zeros.</span></span><br><span class=\"line\"><span class=\"string\">      scale: A boolean. If True. the outputs is multiplied by sqrt num_units.</span></span><br><span class=\"line\"><span class=\"string\">      scope: Optional scope for `variable_scope`.</span></span><br><span class=\"line\"><span class=\"string\">      reuse: Boolean, whether to reuse the weights of a previous layer</span></span><br><span class=\"line\"><span class=\"string\">        by the same name.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Returns:</span></span><br><span class=\"line\"><span class=\"string\">      A `Tensor` with one more rank than inputs&#x27;s. The last dimensionality</span></span><br><span class=\"line\"><span class=\"string\">        should be `num_units`.</span></span><br><span class=\"line\"><span class=\"string\">        </span></span><br><span class=\"line\"><span class=\"string\">    For example,</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br></pre></td></tr></table></figure><br />\nimport tensorflow as tf</p>\n<pre><code>inputs = tf.to_int32(tf.reshape(tf.range(2*3), (2, 3)))\noutputs = embedding(inputs, 6, 2, zero_pad=True)\nwith tf.Session() as sess:\n    sess.run(tf.global_variables_initializer())\n    print sess.run(outputs)\n&gt;&gt;\n[[[ 0.          0.        ]\n  [ 0.09754146  0.67385566]\n  [ 0.37864095 -0.35689294]]\n\n [[-1.01329422 -1.09939694]\n  [ 0.7521342   0.38203377]\n  [-0.04973143 -0.06210355]]]\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    </span><br></pre></td></tr></table></figure>\nimport tensorflow as tf\n\ninputs = tf.to_int32(tf.reshape(tf.range(2*3), (2, 3)))\noutputs = embedding(inputs, 6, 2, zero_pad=False)\nwith tf.Session() as sess:\n    sess.run(tf.global_variables_initializer())\n    print sess.run(outputs)\n&gt;&gt;\n[[[-0.19172323 -0.39159766]\n  [-0.43212751 -0.66207761]\n  [ 1.03452027 -0.26704335]]\n\n [[-0.11634696 -0.35983452]\n  [ 0.50208133  0.53509563]\n  [ 1.22204471 -0.96587461]]]    \n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    &#x27;&#x27;&#x27;</span><br><span class=\"line\">    with tf.variable_scope<span class=\"params\">(scope, <span class=\"attr\">reuse</span>=reuse)</span>:</span><br><span class=\"line\">        lookup_table = tf.get_variable<span class=\"params\">(&#x27;lookup_table&#x27;,</span></span><br><span class=\"line\"><span class=\"params\">                                       <span class=\"attr\">dtype</span>=tf.float32,</span></span><br><span class=\"line\"><span class=\"params\">                                       <span class=\"attr\">shape</span>=[vocab_size, num_units],</span></span><br><span class=\"line\"><span class=\"params\">                                       #<span class=\"attr\">initializer</span>=tf.contrib.layers.xavier_initializer()</span>,</span><br><span class=\"line\">                                       regularizer=tf.contrib.layers.l2_regularizer<span class=\"params\">(l2_reg)</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> zero_pad:</span><br><span class=\"line\">            lookup_table = tf.concat<span class=\"params\">((tf.zeros(<span class=\"attr\">shape</span>=[1, num_units])</span>,</span><br><span class=\"line\">                                      lookup_table[1:, :]), 0)</span><br><span class=\"line\">        outputs = tf.nn.embedding_lookup<span class=\"params\">(lookup_table, inputs)</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">if</span> scale:</span><br><span class=\"line\">            outputs = outputs * <span class=\"params\">(num_units ** 0.5)</span> </span><br><span class=\"line\">    <span class=\"keyword\">if</span> with_t: return outputs,lookup_table</span><br><span class=\"line\">    else: return outputs</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def multihead_attention<span class=\"params\">(queries, </span></span><br><span class=\"line\"><span class=\"params\">                        keys, </span></span><br><span class=\"line\"><span class=\"params\">                        <span class=\"attr\">num_units</span>=None, </span></span><br><span class=\"line\"><span class=\"params\">                        <span class=\"attr\">num_heads</span>=8, </span></span><br><span class=\"line\"><span class=\"params\">                        <span class=\"attr\">dropout_rate</span>=0,</span></span><br><span class=\"line\"><span class=\"params\">                        <span class=\"attr\">is_training</span>=True,</span></span><br><span class=\"line\"><span class=\"params\">                        <span class=\"attr\">causality</span>=False,</span></span><br><span class=\"line\"><span class=\"params\">                        <span class=\"attr\">scope</span>=&quot;multihead_attention&quot;, </span></span><br><span class=\"line\"><span class=\"params\">                        <span class=\"attr\">reuse</span>=None,</span></span><br><span class=\"line\"><span class=\"params\">                        <span class=\"attr\">with_qk</span>=False)</span>:</span><br><span class=\"line\">    &#x27;&#x27;&#x27;Applies multihead attention.</span><br><span class=\"line\">    </span><br><span class=\"line\">    Args:</span><br><span class=\"line\">      queries: A 3d tensor with shape of [N, T_q, C_q].</span><br><span class=\"line\">      keys: A 3d tensor with shape of [N, T_k, C_k].</span><br><span class=\"line\">      num_units: A scalar. Attention size.</span><br><span class=\"line\">      dropout_rate: A floating point number.</span><br><span class=\"line\">      is_training: Boolean. Controller of mechanism for dropout.</span><br><span class=\"line\">      causality: Boolean. If <span class=\"literal\">true</span>, units that reference the future are masked. </span><br><span class=\"line\">      num_heads: An int. Number of heads.</span><br><span class=\"line\">      scope: Optional scope for `variable_scope`.</span><br><span class=\"line\">      reuse: Boolean, whether to reuse the weights of a previous layer</span><br><span class=\"line\">        by the same name.</span><br><span class=\"line\">        </span><br><span class=\"line\">    Returns</span><br><span class=\"line\">      A 3d tensor with shape of <span class=\"params\">(N, T_q, C)</span>  </span><br><span class=\"line\">    &#x27;&#x27;&#x27;</span><br><span class=\"line\">    with tf.variable_scope<span class=\"params\">(scope, <span class=\"attr\">reuse</span>=reuse)</span>:</span><br><span class=\"line\">        <span class=\"comment\"># Set the fall back option for num_units</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> num_units is None:</span><br><span class=\"line\">            num_units = queries.get_shape<span class=\"params\">()</span><span class=\"string\">.as_list</span>[-1]</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># Linear projections</span></span><br><span class=\"line\">        <span class=\"comment\"># Q = tf.layers.dense(queries, num_units, activation=tf.nn.relu) # (N, T_q, C)</span></span><br><span class=\"line\">        <span class=\"comment\"># K = tf.layers.dense(keys, num_units, activation=tf.nn.relu) # (N, T_k, C)</span></span><br><span class=\"line\">        <span class=\"comment\"># V = tf.layers.dense(keys, num_units, activation=tf.nn.relu) # (N, T_k, C)</span></span><br><span class=\"line\">        Q = tf.layers.dense<span class=\"params\">(queries, num_units, <span class=\"attr\">activation</span>=None)</span> <span class=\"comment\"># (N, T_q, C)</span></span><br><span class=\"line\">        K = tf.layers.dense<span class=\"params\">(keys, num_units, <span class=\"attr\">activation</span>=None)</span> <span class=\"comment\"># (N, T_k, C)</span></span><br><span class=\"line\">        V = tf.layers.dense<span class=\"params\">(keys, num_units, <span class=\"attr\">activation</span>=None)</span> <span class=\"comment\"># (N, T_k, C)</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># Split and concat</span></span><br><span class=\"line\">        Q_ = tf.concat<span class=\"params\">(tf.split(Q, num_heads, <span class=\"attr\">axis</span>=2)</span>, axis=0) <span class=\"comment\"># (h*N, T_q, C/h) </span></span><br><span class=\"line\">        K_ = tf.concat<span class=\"params\">(tf.split(K, num_heads, <span class=\"attr\">axis</span>=2)</span>, axis=0) <span class=\"comment\"># (h*N, T_k, C/h) </span></span><br><span class=\"line\">        V_ = tf.concat<span class=\"params\">(tf.split(V, num_heads, <span class=\"attr\">axis</span>=2)</span>, axis=0) <span class=\"comment\"># (h*N, T_k, C/h) </span></span><br><span class=\"line\">    </span><br><span class=\"line\">        <span class=\"comment\"># Multiplication</span></span><br><span class=\"line\">        outputs = tf.matmul<span class=\"params\">(Q_, tf.transpose(K_, [0, 2, 1])</span>) <span class=\"comment\"># (h*N, T_q, T_k)</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># Scale</span></span><br><span class=\"line\">        outputs = outputs / <span class=\"params\">(K_.get_shape()</span><span class=\"string\">.as_list</span><span class=\"params\">()</span>[-1] ** 0.5)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># Key Masking</span></span><br><span class=\"line\">        key_masks = tf.sign<span class=\"params\">(tf.reduce_sum(tf.abs(keys)</span>, axis=-1)) <span class=\"comment\"># (N, T_k)</span></span><br><span class=\"line\">        key_masks = tf.tile<span class=\"params\">(key_masks, [num_heads, 1])</span> <span class=\"comment\"># (h*N, T_k)</span></span><br><span class=\"line\">        key_masks = tf.tile<span class=\"params\">(tf.expand_dims(key_masks, 1)</span>, [1, tf.shape<span class=\"params\">(queries)</span>[1], 1]) <span class=\"comment\"># (h*N, T_q, T_k)</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        paddings = tf.ones_like<span class=\"params\">(outputs)</span>*<span class=\"params\">(-2**32+1)</span></span><br><span class=\"line\">        outputs = tf.where<span class=\"params\">(tf.equal(key_masks, 0)</span>, paddings, outputs) <span class=\"comment\"># (h*N, T_q, T_k)</span></span><br><span class=\"line\">      </span><br><span class=\"line\">        <span class=\"comment\"># Causality = Future blinding</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> causality:</span><br><span class=\"line\">            diag_vals = tf.ones_like<span class=\"params\">(outputs[0, :, :])</span> <span class=\"comment\"># (T_q, T_k)</span></span><br><span class=\"line\">            tril = tf.linalg.LinearOperatorLowerTriangular<span class=\"params\">(diag_vals)</span><span class=\"string\">.to_dense</span><span class=\"params\">()</span> <span class=\"comment\"># (T_q, T_k)</span></span><br><span class=\"line\">            masks = tf.tile<span class=\"params\">(tf.expand_dims(tril, 0)</span>, [tf.shape<span class=\"params\">(outputs)</span>[0], 1, 1]) <span class=\"comment\"># (h*N, T_q, T_k)</span></span><br><span class=\"line\">       </span><br><span class=\"line\">            paddings = tf.ones_like<span class=\"params\">(masks)</span>*<span class=\"params\">(-2**32+1)</span></span><br><span class=\"line\">            outputs = tf.where<span class=\"params\">(tf.equal(masks, 0)</span>, paddings, outputs) <span class=\"comment\"># (h*N, T_q, T_k)</span></span><br><span class=\"line\">      </span><br><span class=\"line\">        <span class=\"comment\"># Activation</span></span><br><span class=\"line\">        outputs = tf.nn.softmax<span class=\"params\">(outputs)</span> <span class=\"comment\"># (h*N, T_q, T_k)</span></span><br><span class=\"line\">         </span><br><span class=\"line\">        <span class=\"comment\"># Query Masking</span></span><br><span class=\"line\">        query_masks = tf.sign<span class=\"params\">(tf.reduce_sum(tf.abs(queries)</span>, axis=-1)) <span class=\"comment\"># (N, T_q)</span></span><br><span class=\"line\">        query_masks = tf.tile<span class=\"params\">(query_masks, [num_heads, 1])</span> <span class=\"comment\"># (h*N, T_q)</span></span><br><span class=\"line\">        query_masks = tf.tile<span class=\"params\">(tf.expand_dims(query_masks, -1)</span>, [1, 1, tf.shape<span class=\"params\">(keys)</span>[1]]) <span class=\"comment\"># (h*N, T_q, T_k)</span></span><br><span class=\"line\">        outputs *= query_masks <span class=\"comment\"># broadcasting. (N, T_q, C)</span></span><br><span class=\"line\">          </span><br><span class=\"line\">        <span class=\"comment\"># Dropouts</span></span><br><span class=\"line\">        outputs = tf.layers.dropout<span class=\"params\">(outputs, <span class=\"attr\">rate</span>=dropout_rate, <span class=\"attr\">training</span>=tf.convert_to_tensor(is_training)</span>)</span><br><span class=\"line\">               </span><br><span class=\"line\">        <span class=\"comment\"># Weighted sum</span></span><br><span class=\"line\">        outputs = tf.matmul<span class=\"params\">(outputs, V_)</span> <span class=\"comment\"># ( h*N, T_q, C/h)</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># Restore shape</span></span><br><span class=\"line\">        outputs = tf.concat<span class=\"params\">(tf.split(outputs, num_heads, <span class=\"attr\">axis</span>=0)</span>, axis=2 ) <span class=\"comment\"># (N, T_q, C)</span></span><br><span class=\"line\">              </span><br><span class=\"line\">        <span class=\"comment\"># Residual connection</span></span><br><span class=\"line\">        outputs += queries</span><br><span class=\"line\">              </span><br><span class=\"line\">        <span class=\"comment\"># Normalize</span></span><br><span class=\"line\">        <span class=\"comment\">#outputs = normalize(outputs) # (N, T_q, C)</span></span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">if</span> with_qk: return Q,K</span><br><span class=\"line\">    else: return outputs</span><br><span class=\"line\"></span><br><span class=\"line\">def feedforward<span class=\"params\">(inputs, </span></span><br><span class=\"line\"><span class=\"params\">                <span class=\"attr\">num_units</span>=[2048, 512],</span></span><br><span class=\"line\"><span class=\"params\">                <span class=\"attr\">scope</span>=&quot;multihead_attention&quot;, </span></span><br><span class=\"line\"><span class=\"params\">                <span class=\"attr\">dropout_rate</span>=0.2,</span></span><br><span class=\"line\"><span class=\"params\">                <span class=\"attr\">is_training</span>=True,</span></span><br><span class=\"line\"><span class=\"params\">                <span class=\"attr\">reuse</span>=None)</span>:</span><br><span class=\"line\">    &#x27;&#x27;&#x27;Point-wise feed forward net.</span><br><span class=\"line\">    </span><br><span class=\"line\">    Args:</span><br><span class=\"line\">      inputs: A 3d tensor with shape of [N, T, C].</span><br><span class=\"line\">      num_units: A list of two integers.</span><br><span class=\"line\">      scope: Optional scope for `variable_scope`.</span><br><span class=\"line\">      reuse: Boolean, whether to reuse the weights of a previous layer</span><br><span class=\"line\">        by the same name.</span><br><span class=\"line\">        </span><br><span class=\"line\">    Returns:</span><br><span class=\"line\">      A 3d tensor with the same shape and dtype as inputs</span><br><span class=\"line\">    &#x27;&#x27;&#x27;</span><br><span class=\"line\">    with tf.variable_scope<span class=\"params\">(scope, <span class=\"attr\">reuse</span>=reuse)</span>:</span><br><span class=\"line\">        <span class=\"comment\"># Inner layer</span></span><br><span class=\"line\">        params = &#123;<span class=\"string\">&quot;inputs&quot;</span>: inputs, <span class=\"string\">&quot;filters&quot;</span>: num_units[0], <span class=\"string\">&quot;kernel_size&quot;</span>: 1,</span><br><span class=\"line\">                  <span class=\"string\">&quot;activation&quot;</span>: tf.nn.relu, <span class=\"string\">&quot;use_bias&quot;</span>: True&#125;</span><br><span class=\"line\">        outputs = tf.layers.conv1d<span class=\"params\">(**params)</span></span><br><span class=\"line\">        outputs = tf.layers.dropout<span class=\"params\">(outputs, <span class=\"attr\">rate</span>=dropout_rate, <span class=\"attr\">training</span>=tf.convert_to_tensor(is_training)</span>)</span><br><span class=\"line\">        <span class=\"comment\"># Readout layer</span></span><br><span class=\"line\">        params = &#123;<span class=\"string\">&quot;inputs&quot;</span>: outputs, <span class=\"string\">&quot;filters&quot;</span>: num_units[1], <span class=\"string\">&quot;kernel_size&quot;</span>: 1,</span><br><span class=\"line\">                  <span class=\"string\">&quot;activation&quot;</span>: None, <span class=\"string\">&quot;use_bias&quot;</span>: True&#125;</span><br><span class=\"line\">        outputs = tf.layers.conv1d<span class=\"params\">(**params)</span></span><br><span class=\"line\">        outputs = tf.layers.dropout<span class=\"params\">(outputs, <span class=\"attr\">rate</span>=dropout_rate, <span class=\"attr\">training</span>=tf.convert_to_tensor(is_training)</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># Residual connection</span></span><br><span class=\"line\">        outputs += inputs</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># Normalize</span></span><br><span class=\"line\">        <span class=\"comment\">#outputs = normalize(outputs)</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    return outputs</span><br></pre></td></tr></table></figure>\n</code></pre>\n<h3 id=\"位置编码\"><a class=\"anchor\" href=\"#位置编码\">#</a> 位置编码</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">positional_encoding</span>(<span class=\"params\">dim, sentence_length, dtype=tf.float32</span>):</span><br><span class=\"line\">    encoded_vec = np.array([pos/np.power(<span class=\"number\">10000</span>, <span class=\"number\">2</span>*i/dim) <span class=\"keyword\">for</span> pos <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(sentence_length) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(dim)])</span><br><span class=\"line\">    encoded_vec[::<span class=\"number\">2</span>] = np.sin(encoded_vec[::<span class=\"number\">2</span>])</span><br><span class=\"line\">    encoded_vec[<span class=\"number\">1</span>::<span class=\"number\">2</span>] = np.cos(encoded_vec[<span class=\"number\">1</span>::<span class=\"number\">2</span>])</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tf.convert_to_tensor(encoded_vec.reshape([sentence_length, dim]), dtype=dtype)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>定义了名为位置编码的函数， <code>dim</code>  表示向量的维度， <code>sentence_length</code>  表示句子的长度， <code>dtype</code>  表示输出张量的数据类型</li>\n<li><code>encoded_vec</code>  使用嵌套列表解析生成一个 1D 的 numpy 数组  <code>encoded_vec</code> 。\n<ul>\n<li>外层循环  <code>for pos in range(sentence_length)</code>  遍历句子的每个位置。</li>\n<li>内层循环  <code>for i in range(dim)</code>  遍历编码向量的每个维度。</li>\n<li>计算公式  <code>pos/np.power(10000, 2*i/dim)</code>  生成位置编码值。</li>\n</ul>\n</li>\n<li><code>  encoded_vec[::2] = np.sin(encoded_vec[::2])</code> : 这一行将编码向量中偶数索引位置的值替换为它们的正弦值，即  <code>encoded_vec</code>  的每隔两个元素（从索引 0 开始）的值。</li>\n<li><code>  encoded_vec[1::2] = np.cos(encoded_vec[1::2])</code> : 这一行将编码向量中奇数索引位置的值替换为它们的余弦值，即  <code>encoded_vec</code>  的每隔两个元素（从索引 1 开始）的值。</li>\n<li><code>return</code> : 行将  <code>encoded_vec</code>  重新调整为形状  <code>[sentence_length, dim]</code> ，即将其从 1D 数组重塑为 2D 数组。</li>\n</ul>\n<h3 id=\"层归一化-2\"><a class=\"anchor\" href=\"#层归一化-2\">#</a> 层归一化</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">normalize</span>(<span class=\"params\">inputs, </span></span><br><span class=\"line\"><span class=\"params\">              epsilon=<span class=\"number\">1e-8</span>,</span></span><br><span class=\"line\"><span class=\"params\">              scope=<span class=\"string\">&quot;ln&quot;</span>,</span></span><br><span class=\"line\"><span class=\"params\">              reuse=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    <span class=\"keyword\">with</span> tf.variable_scope(scope, reuse=reuse):</span><br><span class=\"line\">        inputs_shape = inputs.get_shape()</span><br><span class=\"line\">        params_shape = inputs_shape[-<span class=\"number\">1</span>:]</span><br><span class=\"line\">        mean, variance = tf.nn.moments(inputs, [-<span class=\"number\">1</span>], keep_dims=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        beta = tf.Variable(tf.zeros(params_shape))</span><br><span class=\"line\">        gamma = tf.Variable(tf.ones(params_shape))</span><br><span class=\"line\">        normalized = (inputs - mean) / ((variance + epsilon) ** <span class=\"number\">0.5</span>)</span><br><span class=\"line\">        outputs = gamma * normalized + beta</span><br><span class=\"line\">    <span class=\"keyword\">return</span> outputs</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"函数作用域\"><a class=\"anchor\" href=\"#函数作用域\">#</a> 函数作用域</h4>\n<ul>\n<li><code>inputs</code> : 输入张量</li>\n<li><code>epsilon</code> : 一个小常数，用于避免除以零的情况，默认值为  <code>1e-8</code> 。</li>\n<li><code>scope</code> : 变量作用域的名称，默认值为  <code>&quot;ln&quot;</code> 。</li>\n<li><code>reuse</code> : 是否重用变量，默认值为  <code>None</code> 。</li>\n</ul>\n<h4 id=\"变量作用域\"><a class=\"anchor\" href=\"#变量作用域\">#</a> 变量作用域</h4>\n<ul>\n<li><code>scope</code> : 变量作用域的名称。</li>\n<li><code>reuse</code> : 是否重用现有的变量。</li>\n</ul>\n<h4 id=\"获取输入张量的形状\"><a class=\"anchor\" href=\"#获取输入张量的形状\">#</a> 获取输入张量的形状</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">inputs_shape = inputs.get_shape()</span><br><span class=\"line\">params_shape = inputs_shape[-<span class=\"number\">1</span>:]</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>inputs_shape</code> : 获取输入张量的形状。</li>\n<li><code>params_shape</code> : 获取最后一个维度的形状，这将用于归一化参数  <code>beta</code>  和  <code>gamma</code>  的形状。</li>\n</ul>\n<h4 id=\"计算均值和方差\"><a class=\"anchor\" href=\"#计算均值和方差\">#</a> 计算均值和方差</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mean, variance = tf.nn.moments(inputs, [-<span class=\"number\">1</span>], keep_dims=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>tf.nn.moments(inputs, [-1], keep_dims=True)</code> : 计算输入张量在最后一个维度上的均值和方差，并保持原始维度的形状。</li>\n</ul>\n<h4 id=\"定义变量\"><a class=\"anchor\" href=\"#定义变量\">#</a> 定义变量</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">beta = tf.Variable(tf.zeros(params_shape))</span><br><span class=\"line\">gamma = tf.Variable(tf.ones(params_shape))</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>beta</code> : 偏移量变量，初始化为零，形状为  <code>params_shape</code> 。</li>\n<li><code>gamma</code> : 缩放量变量，初始化为一，形状为  <code>params_shape</code> 。</li>\n</ul>\n<h4 id=\"归一化\"><a class=\"anchor\" href=\"#归一化\">#</a> 归一化</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">normalized = (inputs - mean) / ((variance + epsilon) ** <span class=\"number\">0.5</span>)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>输入张量减去均值</li>\n<li>然后除以标准差，添加 espsilon 是避免除以零</li>\n</ul>\n<h4 id=\"应用缩放和偏移\"><a class=\"anchor\" href=\"#应用缩放和偏移\">#</a> 应用缩放和偏移</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">outputs = gamma * normalized + beta</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>gamma * normalized</code> : 对归一化后的张量进行缩放。</li>\n<li><code>gamma * normalized + beta</code> : 对归一化并缩放后的张量进行偏移。</li>\n</ul>\n<ul>\n<li>返回应用了层归一化后的输出张量  <code>outputs</code> 。</li>\n</ul>\n<h3 id=\"嵌入层-2\"><a class=\"anchor\" href=\"#嵌入层-2\">#</a> 嵌入层</h3>\n<p><strong>作用</strong>：将输入的词 ID 映射到对应的嵌入向量。通过嵌入表查找，生成词嵌入矩阵，可以选择是否将 ID 为 0 的词嵌入设为 0，且可以对嵌入进行缩放。</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">embedding</span>(<span class=\"params\">inputs, </span></span><br><span class=\"line\"><span class=\"params\">              vocab_size, </span></span><br><span class=\"line\"><span class=\"params\">              num_units, </span></span><br><span class=\"line\"><span class=\"params\">              zero_pad=<span class=\"literal\">True</span>, </span></span><br><span class=\"line\"><span class=\"params\">              scale=<span class=\"literal\">True</span>,</span></span><br><span class=\"line\"><span class=\"params\">              l2_reg=<span class=\"number\">0.0</span>,</span></span><br><span class=\"line\"><span class=\"params\">              scope=<span class=\"string\">&quot;embedding&quot;</span>, </span></span><br><span class=\"line\"><span class=\"params\">              with_t=<span class=\"literal\">False</span>,</span></span><br><span class=\"line\"><span class=\"params\">              reuse=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    <span class=\"keyword\">with</span> tf.variable_scope(scope, reuse=reuse):</span><br><span class=\"line\">        lookup_table = tf.get_variable(<span class=\"string\">&#x27;lookup_table&#x27;</span>,</span><br><span class=\"line\">                                       dtype=tf.float32,</span><br><span class=\"line\">                                       shape=[vocab_size, num_units],</span><br><span class=\"line\">                                       regularizer=tf.contrib.layers.l2_regularizer(l2_reg))</span><br><span class=\"line\">        <span class=\"keyword\">if</span> zero_pad:</span><br><span class=\"line\">            lookup_table = tf.concat((tf.zeros(shape=[<span class=\"number\">1</span>, num_units]),</span><br><span class=\"line\">                                      lookup_table[<span class=\"number\">1</span>:, :]), <span class=\"number\">0</span>)</span><br><span class=\"line\">        outputs = tf.nn.embedding_lookup(lookup_table, inputs)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">if</span> scale:</span><br><span class=\"line\">            outputs = outputs * (num_units ** <span class=\"number\">0.5</span>) </span><br><span class=\"line\">    <span class=\"keyword\">if</span> with_t: <span class=\"keyword\">return</span> outputs, lookup_table</span><br><span class=\"line\">    <span class=\"keyword\">else</span>: <span class=\"keyword\">return</span> outputs</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"定义函数\"><a class=\"anchor\" href=\"#定义函数\">#</a> 定义函数</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">embedding</span>(<span class=\"params\">inputs, </span></span><br><span class=\"line\"><span class=\"params\">              vocab_size, </span></span><br><span class=\"line\"><span class=\"params\">              num_units, </span></span><br><span class=\"line\"><span class=\"params\">              zero_pad=<span class=\"literal\">True</span>, </span></span><br><span class=\"line\"><span class=\"params\">              scale=<span class=\"literal\">True</span>,</span></span><br><span class=\"line\"><span class=\"params\">              l2_reg=<span class=\"number\">0.0</span>,</span></span><br><span class=\"line\"><span class=\"params\">              scope=<span class=\"string\">&quot;embedding&quot;</span>, </span></span><br><span class=\"line\"><span class=\"params\">              with_t=<span class=\"literal\">False</span>,</span></span><br><span class=\"line\"><span class=\"params\">              reuse=<span class=\"literal\">None</span></span>):</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>inputs</code> : 输入张量，通常是词汇的索引。</li>\n<li><code>vocab_size</code> : 词汇表的大小，即词汇的数量。</li>\n<li><code>num_units</code> : 嵌入向量的维度，即每个词汇映射后的向量表示的长度。</li>\n<li><code>zero_pad</code> : 是否将索引为 0 的位置填充为零向量，默认为  <code>True</code> 。</li>\n<li><code>scale</code> : 是否对嵌入向量进行缩放，默认为  <code>True</code> 。</li>\n<li><code>l2_reg</code> : L2 正则化的参数，默认为  <code>0.0</code> 。</li>\n<li><code>scope</code> : 变量作用域的名称，默认为  <code>&quot;embedding&quot;</code> 。</li>\n<li><code>with_t</code> : 是否返回嵌入矩阵，默认为  <code>False</code> 。</li>\n<li><code>reuse</code> : 是否重用变量，默认为  <code>None</code> 。</li>\n</ul>\n<h4 id=\"变量作用域-2\"><a class=\"anchor\" href=\"#变量作用域-2\">#</a> 变量作用域</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">with</span> tf.variable_scope(scope, reuse=reuse):</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>scope</code> : 变量作用域的名称。</li>\n<li><code>reuse</code> : 是否重用现有的变量。</li>\n</ul>\n<h4 id=\"创建嵌入矩阵\"><a class=\"anchor\" href=\"#创建嵌入矩阵\">#</a> 创建嵌入矩阵</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">lookup_table = tf.get_variable(<span class=\"string\">&#x27;lookup_table&#x27;</span>,</span><br><span class=\"line\">                               dtype=tf.float32,</span><br><span class=\"line\">                               shape=[vocab_size, num_units],</span><br><span class=\"line\">                               regularizer=tf.contrib.layers.l2_regularizer(l2_reg))</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>lookup_table</code> : 创建嵌入矩阵变量，形状为  <code>[vocab_size, num_units]</code> 。意味着你有  <code>vocab_size</code>  个单词，每个单词都被表示为一个  <code>num_units</code>  维的向量。</li>\n<li><code>dtype=tf.float32</code> : 数据类型为浮点数。</li>\n<li><code>regularizer=tf.contrib.layers.l2_regularizer(l2_reg)</code> : 使用 L2 正则化。</li>\n</ul>\n<h4 id=\"填充零向量\"><a class=\"anchor\" href=\"#填充零向量\">#</a> 填充零向量</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> zero_pad:</span><br><span class=\"line\">    lookup_table = tf.concat((tf.zeros(shape=[<span class=\"number\">1</span>, num_units]),</span><br><span class=\"line\">                              lookup_table[<span class=\"number\">1</span>:, :]), <span class=\"number\">0</span>)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>tf.zeros(shape=[1, num_units])</code> : 创建一个零向量，形状为  <code>[1, num_units]</code> 。</li>\n<li><code>tf.concat((tf.zeros(shape=[1, num_units]), lookup_table[1:, :]), 0)</code> : 将零向量与嵌入矩阵的其余部分连接起来，从而使索引为 0 的位置填充为零向量。</li>\n</ul>\n<h4 id=\"查找嵌入矩阵\"><a class=\"anchor\" href=\"#查找嵌入矩阵\">#</a> 查找嵌入矩阵</h4>\n<p><figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">outputs</span> = tf.nn.embedding_lookup(lookup_table, inputs)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>tf.nn.embedding_lookup(lookup_table, inputs)</code> : 根据输入张量  <code>inputs</code>  中的索引查找嵌入矩阵  <code>lookup_table</code>  中的向量表示，并返回这些表示。</li>\n</ul>\n<h4 id=\"对嵌入向量进行缩放\"><a class=\"anchor\" href=\"#对嵌入向量进行缩放\">#</a> 对嵌入向量进行缩放</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> scale:</span><br><span class=\"line\">    outputs = outputs * (num_units ** <span class=\"number\">0.5</span>) </span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>outputs = outputs * (num_units ** 0.5)</code> : 如果  <code>scale</code>  为  <code>True</code> ，则对嵌入向量进行缩放，缩放因子为  <code>num_units</code>  的平方根。</li>\n</ul>\n<h3 id=\"多头注意力机制-multihead_attention\"><a class=\"anchor\" href=\"#多头注意力机制-multihead_attention\">#</a> 多头注意力机制  <code>multihead_attention</code></h3>\n<p><strong>作用</strong>：实现多头自注意力机制。将查询、键和值线性变换为多头形式，计算注意力权重并应用于值，通过多个头并行计算来捕捉不同的注意力模式，最后将输出拼接并添加残差连接.</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">multihead_attention</span>(<span class=\"params\">queries, </span></span><br><span class=\"line\"><span class=\"params\">                        keys, </span></span><br><span class=\"line\"><span class=\"params\">                        num_units=<span class=\"literal\">None</span>, </span></span><br><span class=\"line\"><span class=\"params\">                        num_heads=<span class=\"number\">8</span>, </span></span><br><span class=\"line\"><span class=\"params\">                        dropout_rate=<span class=\"number\">0</span>,</span></span><br><span class=\"line\"><span class=\"params\">                        is_training=<span class=\"literal\">True</span>,</span></span><br><span class=\"line\"><span class=\"params\">                        causality=<span class=\"literal\">False</span>,</span></span><br><span class=\"line\"><span class=\"params\">                        scope=<span class=\"string\">&quot;multihead_attention&quot;</span>, </span></span><br><span class=\"line\"><span class=\"params\">                        reuse=<span class=\"literal\">None</span>,</span></span><br><span class=\"line\"><span class=\"params\">                        with_qk=<span class=\"literal\">False</span></span>):</span><br><span class=\"line\">    <span class=\"keyword\">with</span> tf.variable_scope(scope, reuse=reuse):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> num_units <span class=\"keyword\">is</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">            num_units = queries.get_shape().as_list[-<span class=\"number\">1</span>]</span><br><span class=\"line\">        </span><br><span class=\"line\">        Q = tf.layers.dense(queries, num_units, activation=<span class=\"literal\">None</span>)</span><br><span class=\"line\">        K = tf.layers.dense(keys, num_units, activation=<span class=\"literal\">None</span>)</span><br><span class=\"line\">        V = tf.layers.dense(keys, num_units, activation=<span class=\"literal\">None</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">        Q_ = tf.concat(tf.split(Q, num_heads, axis=<span class=\"number\">2</span>), axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        K_ = tf.concat(tf.split(K, num_heads, axis=<span class=\"number\">2</span>), axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        V_ = tf.concat(tf.split(V, num_heads, axis=<span class=\"number\">2</span>), axis=<span class=\"number\">0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        outputs = tf.matmul(Q_, tf.transpose(K_, [<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>]))</span><br><span class=\"line\">        outputs = outputs / (K_.get_shape().as_list()[-<span class=\"number\">1</span>] ** <span class=\"number\">0.5</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">        key_masks = tf.sign(tf.reduce_sum(tf.<span class=\"built_in\">abs</span>(keys), axis=-<span class=\"number\">1</span>))</span><br><span class=\"line\">        key_masks = tf.tile(key_masks, [num_heads, <span class=\"number\">1</span>])</span><br><span class=\"line\">        key_masks = tf.tile(tf.expand_dims(key_masks, <span class=\"number\">1</span>), [<span class=\"number\">1</span>, tf.shape(queries)[<span class=\"number\">1</span>], <span class=\"number\">1</span>])</span><br><span class=\"line\">        </span><br><span class=\"line\">        paddings = tf.ones_like(outputs) * (-<span class=\"number\">2</span>**<span class=\"number\">32</span> + <span class=\"number\">1</span>)</span><br><span class=\"line\">        outputs = tf.where(tf.equal(key_masks, <span class=\"number\">0</span>), paddings, outputs)</span><br><span class=\"line\">  </span><br><span class=\"line\">        <span class=\"keyword\">if</span> causality:</span><br><span class=\"line\">            diag_vals = tf.ones_like(outputs[<span class=\"number\">0</span>, :, :])</span><br><span class=\"line\">            tril = tf.linalg.LinearOperatorLowerTriangular(diag_vals).to_dense()</span><br><span class=\"line\">            masks = tf.tile(tf.expand_dims(tril, <span class=\"number\">0</span>), [tf.shape(outputs)[<span class=\"number\">0</span>], <span class=\"number\">1</span>, <span class=\"number\">1</span>])</span><br><span class=\"line\">            paddings = tf.ones_like(masks) * (-<span class=\"number\">2</span>**<span class=\"number\">32</span> + <span class=\"number\">1</span>)</span><br><span class=\"line\">            outputs = tf.where(tf.equal(masks, <span class=\"number\">0</span>), paddings, outputs)</span><br><span class=\"line\">  </span><br><span class=\"line\">        outputs = tf.nn.softmax(outputs)</span><br><span class=\"line\">         </span><br><span class=\"line\">        query_masks = tf.sign(tf.reduce_sum(tf.<span class=\"built_in\">abs</span>(queries), axis=-<span class=\"number\">1</span>))</span><br><span class=\"line\">        query_masks = tf.tile(query_masks, [num_heads, <span class=\"number\">1</span>])</span><br><span class=\"line\">        query_masks = tf.tile(tf.expand_dims(query_masks, -<span class=\"number\">1</span>), [<span class=\"number\">1</span>, <span class=\"number\">1</span>, tf.shape(keys)[<span class=\"number\">1</span>]])</span><br><span class=\"line\">        outputs *= query_masks</span><br><span class=\"line\">          </span><br><span class=\"line\">        outputs = tf.layers.dropout(outputs, rate=dropout_rate, training=tf.convert_to_tensor(is_training))</span><br><span class=\"line\">        outputs = tf.matmul(outputs, V_)</span><br><span class=\"line\">        outputs = tf.concat(tf.split(outputs, num_heads, axis=<span class=\"number\">0</span>), axis=<span class=\"number\">2</span>)</span><br><span class=\"line\">        outputs += queries</span><br><span class=\"line\">    <span class=\"keyword\">if</span> with_qk: <span class=\"keyword\">return</span> Q, K</span><br><span class=\"line\">    <span class=\"keyword\">else</span>: <span class=\"keyword\">return</span> outputs</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"函数定义\"><a class=\"anchor\" href=\"#函数定义\">#</a> 函数定义</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">multihead_attention</span>(<span class=\"params\">queries, </span></span><br><span class=\"line\"><span class=\"params\">                        keys, </span></span><br><span class=\"line\"><span class=\"params\">                        num_units=<span class=\"literal\">None</span>, </span></span><br><span class=\"line\"><span class=\"params\">                        num_heads=<span class=\"number\">8</span>, </span></span><br><span class=\"line\"><span class=\"params\">                        dropout_rate=<span class=\"number\">0</span>,</span></span><br><span class=\"line\"><span class=\"params\">                        is_training=<span class=\"literal\">True</span>,</span></span><br><span class=\"line\"><span class=\"params\">                        causality=<span class=\"literal\">False</span>,</span></span><br><span class=\"line\"><span class=\"params\">                        scope=<span class=\"string\">&quot;multihead_attention&quot;</span>, </span></span><br><span class=\"line\"><span class=\"params\">                        reuse=<span class=\"literal\">None</span>,</span></span><br><span class=\"line\"><span class=\"params\">                        with_qk=<span class=\"literal\">False</span></span>):</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>queries</code> : 查询张量。</li>\n<li><code>keys</code> : 键张量。</li>\n<li><code>num_units</code> : 注意力机制的维度，默认为  <code>None</code> 。</li>\n<li><code>num_heads</code> : 注意力头的数量，默认为  <code>8</code> 。</li>\n<li><code>dropout_rate</code> : Dropout 的概率，默认为  <code>0</code> 。</li>\n<li><code>is_training</code> : 是否在训练模式，默认为  <code>True</code> 。</li>\n<li><code>causality</code> : 是否应用因果掩码，默认为  <code>False</code> 。</li>\n<li><code>scope</code> : 变量作用域的名称，默认为  <code>&quot;multihead_attention&quot;</code> 。</li>\n<li><code>reuse</code> : 是否重用变量，默认为  <code>None</code> 。</li>\n<li><code>with_qk</code> : 是否返回  <code>Q</code>  和  <code>K</code>  矩阵，默认为  <code>False</code> 。</li>\n</ul>\n<h4 id=\"变量作用域设置num_units\"><a class=\"anchor\" href=\"#变量作用域设置num_units\">#</a> 变量作用域，设置 <code>num_units</code></h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">with</span> tf.variable_scope(scope, reuse=reuse):</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>如果  <code>num_units</code>  为  <code>None</code> ，则将其设置为查询张量的最后一个维度。</li>\n</ul>\n<h4 id=\"线性变换\"><a class=\"anchor\" href=\"#线性变换\">#</a> 线性变换</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Q = tf.layers.dense(queries, num_units, activation=<span class=\"literal\">None</span>)</span><br><span class=\"line\">K = tf.layers.dense(keys, num_units, activation=<span class=\"literal\">None</span>)</span><br><span class=\"line\">V = tf.layers.dense(keys, num_units, activation=<span class=\"literal\">None</span>)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>对  <code>queries</code> 、 <code>keys</code>  和  <code>values</code>  进行线性变换，得到  <code>Q</code> 、 <code>K</code>  和  <code>V</code>  矩阵。</li>\n</ul>\n<h4 id=\"拆分和拼接\"><a class=\"anchor\" href=\"#拆分和拼接\">#</a> 拆分和拼接</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Q_ = tf.concat(tf.split(Q, num_heads, axis=<span class=\"number\">2</span>), axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">K_ = tf.concat(tf.split(K, num_heads, axis=<span class=\"number\">2</span>), axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">V_ = tf.concat(tf.split(V, num_heads, axis=<span class=\"number\">2</span>), axis=<span class=\"number\">0</span>)</span><br></pre></td></tr></table></figure></p>\n<p><strong> <code>tf.split(Q, num_heads, axis=2)</code> </strong>：</p>\n<ul>\n<li>将  <code>Q</code>  矩阵沿着  <code>axis=2</code>  维度切分成  <code>num_heads</code>  个子矩阵。</li>\n<li>假设  <code>Q</code>  的形状为  <code>[batch_size, sequence_length, num_units]</code> ，那么切分后的每个子矩阵的形状为  <code>[batch_size, sequence_length, num_units / num_heads]</code> 。</li>\n</ul>\n<p><strong> <code>tf.concat(..., axis=0)</code> </strong>：</p>\n<ul>\n<li>将上述切分得到的子矩阵在  <code>axis=0</code>  维度上拼接起来。</li>\n<li>假设有  <code>num_heads</code>  个子矩阵，每个子矩阵的形状为  <code>[batch_size, sequence_length, num_units / num_heads]</code> ，那么拼接后的矩阵形状为  <code>[batch_size * num_heads, sequence_length, num_units / num_heads]</code> 。</li>\n</ul>\n<h4 id=\"计算注意力分数\"><a class=\"anchor\" href=\"#计算注意力分数\">#</a> 计算注意力分数</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">outputs = tf.matmul(Q_, tf.transpose(K_, [<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>]))</span><br><span class=\"line\">outputs = outputs / (K_.get_shape().as_list()[-<span class=\"number\">1</span>] ** <span class=\"number\">0.5</span>)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>\n<p><code>Q_</code> ：形状为  <code>[batch_size * num_heads, sequence_length, num_units / num_heads]</code>  的查询矩阵。</p>\n<p><code>K_</code> ：形状为  <code>[batch_size * num_heads, sequence_length, num_units / num_heads]</code>  的键矩阵。</p>\n</li>\n<li>\n<p>首先对 <code>K_</code> 进行转置， <code>tf.transpose(K_, [0, 2, 1])</code></p>\n</li>\n<li>\n<p>然后使用 <code>matmul</code>  对矩阵进行点积</p>\n</li>\n<li>\n<p>然后缩放点积注意力 <code>K_.get_shape().as_list()[-1]</code> ：得到  <code>K_</code>  最后一个维度的大小，即  <code>num_units / num_heads</code> 。</p>\n</li>\n<li>\n<p><code>(K_.get_shape().as_list()[-1] ** 0.5)</code> ：计算其平方根。</p>\n</li>\n<li>\n<p>将  <code>outputs</code>  除以这个平方根，缩放点积的结果：</p>\n</li>\n</ul>\n<h4 id=\"检验码\"><a class=\"anchor\" href=\"#检验码\">#</a> 检验码</h4>\n<p>这段代码的目的是通过对  <code>outputs</code> （即点积注意力得分矩阵）进行掩码（masking）操作，以确保在计算注意力时，填充的位置（padding positions）不会对结果产生影响。让我们逐步分析每一行代码：</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">key_masks = tf.sign(tf.reduce_sum(tf.<span class=\"built_in\">abs</span>(keys), axis=-<span class=\"number\">1</span>))</span><br><span class=\"line\">key_masks = tf.tile(key_masks, [num_heads, <span class=\"number\">1</span>])</span><br><span class=\"line\">key_masks = tf.tile(tf.expand_dims(key_masks, <span class=\"number\">1</span>), [<span class=\"number\">1</span>, tf.shape(queries)[<span class=\"number\">1</span>], <span class=\"number\">1</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">paddings = tf.ones_like(outputs) * (-<span class=\"number\">2</span>**<span class=\"number\">32</span> + <span class=\"number\">1</span>)</span><br><span class=\"line\">outputs = tf.where(tf.equal(key_masks, <span class=\"number\">0</span>), paddings, outputs)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>\n<p><code>tf.abs(keys)</code> ：对  <code>keys</code>  的所有元素取绝对值。</p>\n</li>\n<li>\n<p><code>tf.reduce_sum(tf.abs(keys), axis=-1)</code> ：对  <code>keys</code>  的最后一个维度（即特征维度）求和，结果是一个形状为  <code>[batch_size, sequence_length]</code>  的张量。</p>\n</li>\n<li>\n<p><code>tf.sign(...)</code> ：对求和结果进行符号函数操作，非零值变为 1，零值保持为 0。这用于标记填充值（padding positions）。</p>\n</li>\n<li>\n<p><code>tf.tile(key_masks, [num_heads, 1])</code> ：复制  <code>key_masks</code> ，在第一个维度上复制  <code>num_heads</code>  次，以适应多头注意力的情况。结果形状为  <code>[batch_size * num_heads, sequence_length]</code> 。</p>\n</li>\n<li>\n<p><code>tf.expand_dims(key_masks, 1)</code> ：在  <code>key_masks</code>  的第一个维度添加一个新的维度，结果形状为  <code>[batch_size * num_heads, 1, sequence_length]</code> 。</p>\n<p><code>tf.tile(..., [1, tf.shape(queries)[1], 1])</code> ：在新添加的维度上复制  <code>tf.shape(queries)[1]</code>  次，结果形状为  <code>[batch_size * num_heads, sequence_length, sequence_length]</code> 。</p>\n</li>\n<li>\n<p><code>tf.ones_like(outputs)</code> ：创建一个与  <code>outputs</code>  形状相同的全 1 张量。</p>\n<p><code>* (-2**32 + 1)</code> ：将全 1 张量的所有值乘以一个非常小的负数（近似于负无穷），这个值将用来替换填充位置的注意力得分，使这些位置的注意力得分在 softmax 计算时接近于 0。</p>\n</li>\n<li>\n<p><code>tf.equal(key_masks, 0)</code> ：生成一个布尔张量，指示哪些位置是填充位置（ <code>key_masks</code>  为 0 的位置）。</p>\n<p><code>tf.where(...)</code> ：根据布尔张量选择对应位置的值，如果为真，则选择  <code>paddings</code>  中的值，否则选择  <code>outputs</code>  中的值。这样，填充位置的注意力得分将被设置为一个非常小的负数。</p>\n</li>\n</ul>\n<h4 id=\"因果掩码\"><a class=\"anchor\" href=\"#因果掩码\">#</a> 因果掩码</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> causality:</span><br><span class=\"line\">    diag_vals = tf.ones_like(outputs[<span class=\"number\">0</span>, :, :])</span><br><span class=\"line\">    tril = tf.linalg.LinearOperatorLowerTriangular(diag_vals).to_dense()</span><br><span class=\"line\">    masks = tf.tile(tf.expand_dims(tril, <span class=\"number\">0</span>), [tf.shape(outputs)[<span class=\"number\">0</span>], <span class=\"number\">1</span>, <span class=\"number\">1</span>])</span><br><span class=\"line\">    paddings = tf.ones_like(masks) * (-<span class=\"number\">2</span>**<span class=\"number\">32</span> + <span class=\"number\">1</span>)</span><br><span class=\"line\">    outputs = tf.where(tf.equal(masks, <span class=\"number\">0</span>), paddings, outputs)</span><br></pre></td></tr></table></figure></p>\n<p>如果  <code>causality</code>  为  <code>True</code> ，则应用因果掩码，以确保当前时间步之后的信息不会被访问。</p>\n<p>创建下三角矩阵  <code>tril</code>  作为掩码，并将无效位置的分数设置为一个非常小的值（负无穷大）。</p>\n<h4 id=\"计算注意力权重\"><a class=\"anchor\" href=\"#计算注意力权重\">#</a> 计算注意力权重</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">outputs = tf.nn.softmax(outputs)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>对注意力分数应用 Softmax 函数，得到注意力权重。</li>\n</ul>\n<h4 id=\"查询掩码\"><a class=\"anchor\" href=\"#查询掩码\">#</a> 查询掩码</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">query_masks = tf.sign(tf.reduce_sum(tf.<span class=\"built_in\">abs</span>(queries), axis=-<span class=\"number\">1</span>))</span><br><span class=\"line\">query_masks = tf.tile(query_masks, [num_heads, <span class=\"number\">1</span>])</span><br><span class=\"line\">query_masks = tf.tile(tf.expand_dims(query_masks, -<span class=\"number\">1</span>), [<span class=\"number\">1</span>, <span class=\"number\">1</span>, tf.shape(keys)[<span class=\"number\">1</span>]])</span><br><span class=\"line\">outputs *= query_masks</span><br></pre></td></tr></table></figure></p>\n<p>计算  <code>query_masks</code> ，用于掩码无效的查询。</p>\n<p>对  <code>query_masks</code>  进行扩展和重复，使其适应多头注意力的形状。</p>\n<p>将无效位置的权重设置为零。</p>\n<h4 id=\"dropout\"><a class=\"anchor\" href=\"#dropout\">#</a> Dropout</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">outputs = tf.layers.dropout(outputs, rate=dropout_rate, training=tf.convert_to_tensor(is_training))</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>对注意力权重应用 Dropout，以防止过拟合。</li>\n</ul>\n<h4 id=\"加权求和\"><a class=\"anchor\" href=\"#加权求和\">#</a> 加权求和</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">outputs = tf.matmul(outputs, V_)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>使用注意力权重对  <code>V</code>  进行加权求和，得到最终的输出。</li>\n</ul>\n<h4 id=\"拼接和残差连接\"><a class=\"anchor\" href=\"#拼接和残差连接\">#</a> 拼接和残差连接</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">outputs = tf.concat(tf.split(outputs, num_heads, axis=<span class=\"number\">0</span>), axis=<span class=\"number\">2</span>)</span><br><span class=\"line\">outputs += queries</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"返回结果\"><a class=\"anchor\" href=\"#返回结果\">#</a> 返回结果</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> with_qk: <span class=\"keyword\">return</span> Q, K</span><br><span class=\"line\"><span class=\"keyword\">else</span>: <span class=\"keyword\">return</span> outputs</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"前馈神经网络-feedforward\"><a class=\"anchor\" href=\"#前馈神经网络-feedforward\">#</a> 前馈神经网络  <code>feedforward</code></h3>\n<h4 id=\"函数定义-2\"><a class=\"anchor\" href=\"#函数定义-2\">#</a> 函数定义</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">feedforward</span>(<span class=\"params\">inputs, </span></span><br><span class=\"line\"><span class=\"params\">                num_units=[<span class=\"number\">2048</span>, <span class=\"number\">512</span>],</span></span><br><span class=\"line\"><span class=\"params\">                scope=<span class=\"string\">&quot;multihead_attention&quot;</span>, </span></span><br><span class=\"line\"><span class=\"params\">                dropout_rate=<span class=\"number\">0.2</span>,</span></span><br><span class=\"line\"><span class=\"params\">                is_training=<span class=\"literal\">True</span>,</span></span><br><span class=\"line\"><span class=\"params\">                reuse=<span class=\"literal\">None</span></span>)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>inputs</code> : 输入张量。</li>\n<li><code>num_units</code> : 列表，包含两个整数，分别表示第一个和第二个卷积层的输出维度，默认为  <code>[2048, 512]</code> 。</li>\n<li><code>scope</code> : 变量作用域的名称，默认为  <code>&quot;multihead_attention&quot;</code> 。</li>\n<li><code>dropout_rate</code> : Dropout 的概率，默认为  <code>0.2</code> 。</li>\n<li><code>is_training</code> : 是否在训练模式，默认为  <code>True</code> 。</li>\n<li><code>reuse</code> : 是否重用变量，默认为  <code>None</code> 。</li>\n</ul>\n<h4 id=\"变量作用域-3\"><a class=\"anchor\" href=\"#变量作用域-3\">#</a> 变量作用域</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">with</span> tf.variable_scope(scope, reuse=reuse):</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"第一个卷积层\"><a class=\"anchor\" href=\"#第一个卷积层\">#</a> 第一个卷积层</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">params = &#123;<span class=\"string\">&quot;inputs&quot;</span>: inputs, <span class=\"string\">&quot;filters&quot;</span>: num_units[<span class=\"number\">0</span>], <span class=\"string\">&quot;kernel_size&quot;</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">          <span class=\"string\">&quot;activation&quot;</span>: tf.nn.relu, <span class=\"string\">&quot;use_bias&quot;</span>: <span class=\"literal\">True</span>&#125;</span><br><span class=\"line\">outputs = tf.layers.conv1d(**params)</span><br></pre></td></tr></table></figure></p>\n<p><code>params</code> : 一个包含第一个卷积层参数的字典。</p>\n<ul>\n<li><code>inputs</code> : 输入张量。</li>\n<li><code>filters</code> : 卷积层的输出维度，为  <code>num_units[0]</code> （2048）。</li>\n<li><code>kernel_size</code> : 卷积核的大小，设置为  <code>1</code> ，相当于全连接层。</li>\n<li><code>activation</code> : 激活函数，使用 ReLU。</li>\n<li><code>use_bias</code> : 是否使用偏置，设置为  <code>True</code> 。</li>\n</ul>\n<p><code>outputs = tf.layers.conv1d(**params)</code> : 应用 1D 卷积层。</p>\n<h4 id=\"第一次dropout\"><a class=\"anchor\" href=\"#第一次dropout\">#</a> 第一次 Dropout</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">outputs = tf.layers.dropout(outputs, rate=dropout_rate, training=tf.convert_to_tensor(is_training))</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>对第一个卷积层的输出应用 Dropout，以防止过拟合。</li>\n<li><code>rate=dropout_rate</code> : Dropout 的概率。</li>\n<li><code>training=tf.convert_to_tensor(is_training)</code> : 是否在训练模式。</li>\n</ul>\n<h4 id=\"第二个卷积层\"><a class=\"anchor\" href=\"#第二个卷积层\">#</a> 第二个卷积层</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">params = &#123;<span class=\"string\">&quot;inputs&quot;</span>: outputs, <span class=\"string\">&quot;filters&quot;</span>: num_units[<span class=\"number\">1</span>], <span class=\"string\">&quot;kernel_size&quot;</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">          <span class=\"string\">&quot;activation&quot;</span>: <span class=\"literal\">None</span>, <span class=\"string\">&quot;use_bias&quot;</span>: <span class=\"literal\">True</span>&#125;</span><br><span class=\"line\">outputs = tf.layers.conv1d(**params)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><code>params</code> : 一个包含第二个卷积层参数的字典。\n<ul>\n<li><code>inputs</code> : 第一个卷积层的输出。</li>\n<li><code>filters</code> : 卷积层的输出维度，为  <code>num_units[1]</code> （512）。</li>\n<li><code>kernel_size</code> : 卷积核的大小，设置为  <code>1</code> ，相当于全连接层。</li>\n<li><code>activation</code> : 激活函数，设置为  <code>None</code> （线性激活）。</li>\n<li><code>use_bias</code> : 是否使用偏置，设置为  <code>True</code> 。</li>\n</ul>\n</li>\n<li><code>outputs = tf.layers.conv1d(**params)</code> : 应用第二个 1D 卷积层。</li>\n</ul>\n<h4 id=\"第二次dropout\"><a class=\"anchor\" href=\"#第二次dropout\">#</a> 第二次 Dropout</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">outputs = tf.layers.dropout(outputs, rate=dropout_rate, training=tf.convert_to_tensor(is_training))</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>对第二个卷积层的输出应用 Dropout，以防止过拟合。</li>\n<li><code>rate=dropout_rate</code> : Dropout 的概率。</li>\n<li><code>training=tf.convert_to_tensor(is_training)</code> : 是否在训练模式。</li>\n</ul>\n<h4 id=\"残差连接\"><a class=\"anchor\" href=\"#残差连接\">#</a> 残差连接</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">outputs += inputs</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>将原始的输入张量  <code>inputs</code>  加到当前的输出张量上，进行残差连接。这有助于缓解梯度消失问题，并允许梯度在深层网络中更好地传播。</li>\n</ul>\n<h4 id=\"返回结果-2\"><a class=\"anchor\" href=\"#返回结果-2\">#</a> 返回结果</h4>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">return</span> outputs</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>返回最终的输出张量  <code>outputs</code> 。</li>\n</ul>\n<p>这个函数实现了一个两层的前馈神经网络，每层之间应用 Dropout，并使用残差连接将输入直接添加到输出。这种结构在 Transformer 模型中非常常见，用于在每个时间步上独立地应用前馈神经网络，从而增强模型的表示能力。</p>\n<p>Dropout 是一种用于防止神经网络过拟合的正则化技术。其核心思想是在每个训练步骤中随机地 “丢弃” 一部分神经元，即暂时忽略它们，并将它们的输出设置为零。这种做法强制神经网络在每次迭代中以不同的方式学习，从而降低对特定神经元或特定路径的依赖性，提高模型的泛化能力。</p>\n<h2 id=\"modelpy\"><a class=\"anchor\" href=\"#modelpy\">#</a> <span class=\"exturl\" data-url=\"aHR0cDovL21vZGVsLnB5\">model.py</span></h2>\n<p>这个代码实现了一个基于自注意力机制的推荐系统模型，主要包括以下几个部分：</p>\n<ol>\n<li><strong>初始化方法</strong>：定义各种占位符和掩码。</li>\n<li><strong>嵌入层</strong>：将输入序列嵌入到高维空间。</li>\n<li><strong>位置编码</strong>：为每个位置添加位置编码。</li>\n<li><strong>Dropout</strong>：对嵌入序列进行 dropout。</li>\n<li><strong>自注意力机制块</strong>：使用多头自注意力机制和前馈神经网络对序列进行建模。</li>\n<li><strong>归一化</strong>：对序列进行归一化处理。</li>\n<li><strong>正负样本嵌入和预测得分</strong>：计算正负样本的嵌入和预测得分。</li>\n<li><strong>损失函数</strong>：计算二元交叉熵损失和正则化损失。</li>\n<li><strong>AUC 和优化器</strong>：定义 AUC 指标和优化器。</li>\n<li><strong>预测函数</strong>：定义用于预测的函数。</li>\n</ol>\n<p>这些部分共同构建了一个推荐系统模型，</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> modules <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Model</span>():</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, usernum, itemnum, args, reuse=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">        self.is_training = tf.placeholder(tf.<span class=\"built_in\">bool</span>, shape=())</span><br><span class=\"line\">        self.u = tf.placeholder(tf.int32, shape=(<span class=\"literal\">None</span>))</span><br><span class=\"line\">        self.input_seq = tf.placeholder(tf.int32, shape=(<span class=\"literal\">None</span>, args.maxlen))</span><br><span class=\"line\">        self.pos = tf.placeholder(tf.int32, shape=(<span class=\"literal\">None</span>, args.maxlen))</span><br><span class=\"line\">        self.neg = tf.placeholder(tf.int32, shape=(<span class=\"literal\">None</span>, args.maxlen))</span><br><span class=\"line\">        pos = self.pos</span><br><span class=\"line\">        neg = self.neg</span><br><span class=\"line\">        mask = tf.expand_dims(tf.to_float(tf.not_equal(self.input_seq, <span class=\"number\">0</span>)), -<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">with</span> tf.variable_scope(<span class=\"string\">&quot;SASRec&quot;</span>, reuse=reuse):</span><br><span class=\"line\">            <span class=\"comment\"># sequence embedding, item embedding table</span></span><br><span class=\"line\">            self.seq, item_emb_table = embedding(self.input_seq,</span><br><span class=\"line\">                                                 vocab_size=itemnum + <span class=\"number\">1</span>,</span><br><span class=\"line\">                                                 num_units=args.hidden_units,</span><br><span class=\"line\">                                                 zero_pad=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                                 scale=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                                 l2_reg=args.l2_emb,</span><br><span class=\"line\">                                                 scope=<span class=\"string\">&quot;input_embeddings&quot;</span>,</span><br><span class=\"line\">                                                 with_t=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                                 reuse=reuse</span><br><span class=\"line\">                                                 )</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\"># Positional Encoding</span></span><br><span class=\"line\">            t, pos_emb_table = embedding(</span><br><span class=\"line\">                tf.tile(tf.expand_dims(tf.<span class=\"built_in\">range</span>(tf.shape(self.input_seq)[<span class=\"number\">1</span>]), <span class=\"number\">0</span>), [tf.shape(self.input_seq)[<span class=\"number\">0</span>], <span class=\"number\">1</span>]),</span><br><span class=\"line\">                vocab_size=args.maxlen,</span><br><span class=\"line\">                num_units=args.hidden_units,</span><br><span class=\"line\">                zero_pad=<span class=\"literal\">False</span>,</span><br><span class=\"line\">                scale=<span class=\"literal\">False</span>,</span><br><span class=\"line\">                l2_reg=args.l2_emb,</span><br><span class=\"line\">                scope=<span class=\"string\">&quot;dec_pos&quot;</span>,</span><br><span class=\"line\">                reuse=reuse,</span><br><span class=\"line\">                with_t=<span class=\"literal\">True</span></span><br><span class=\"line\">            )</span><br><span class=\"line\">            self.seq += t</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\"># Dropout</span></span><br><span class=\"line\">            self.seq = tf.layers.dropout(self.seq,</span><br><span class=\"line\">                                         rate=args.dropout_rate,</span><br><span class=\"line\">                                         training=tf.convert_to_tensor(self.is_training))</span><br><span class=\"line\">            self.seq *= mask</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\"># Build blocks</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(args.num_blocks):</span><br><span class=\"line\">                <span class=\"keyword\">with</span> tf.variable_scope(<span class=\"string\">&quot;num_blocks_%d&quot;</span> % i):</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"comment\"># Self-attention</span></span><br><span class=\"line\">                    self.seq = multihead_attention(queries=normalize(self.seq),</span><br><span class=\"line\">                                                   keys=self.seq,</span><br><span class=\"line\">                                                   num_units=args.hidden_units,</span><br><span class=\"line\">                                                   num_heads=args.num_heads,</span><br><span class=\"line\">                                                   dropout_rate=args.dropout_rate,</span><br><span class=\"line\">                                                   is_training=self.is_training,</span><br><span class=\"line\">                                                   causality=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                                   scope=<span class=\"string\">&quot;self_attention&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"comment\"># Feed forward</span></span><br><span class=\"line\">                    self.seq = feedforward(normalize(self.seq), num_units=[args.hidden_units, args.hidden_units],</span><br><span class=\"line\">                                           dropout_rate=args.dropout_rate, is_training=self.is_training)</span><br><span class=\"line\">                    self.seq *= mask</span><br><span class=\"line\"></span><br><span class=\"line\">            self.seq = normalize(self.seq)</span><br><span class=\"line\"></span><br><span class=\"line\">        pos = tf.reshape(pos, [tf.shape(self.input_seq)[<span class=\"number\">0</span>] * args.maxlen])</span><br><span class=\"line\">        neg = tf.reshape(neg, [tf.shape(self.input_seq)[<span class=\"number\">0</span>] * args.maxlen])</span><br><span class=\"line\">        pos_emb = tf.nn.embedding_lookup(item_emb_table, pos)</span><br><span class=\"line\">        neg_emb = tf.nn.embedding_lookup(item_emb_table, neg)</span><br><span class=\"line\">        seq_emb = tf.reshape(self.seq, [tf.shape(self.input_seq)[<span class=\"number\">0</span>] * args.maxlen, args.hidden_units])</span><br><span class=\"line\"></span><br><span class=\"line\">        self.test_item = tf.placeholder(tf.int32, shape=(<span class=\"number\">101</span>))</span><br><span class=\"line\">        test_item_emb = tf.nn.embedding_lookup(item_emb_table, self.test_item)</span><br><span class=\"line\">        self.test_logits = tf.matmul(seq_emb, tf.transpose(test_item_emb))</span><br><span class=\"line\">        self.test_logits = tf.reshape(self.test_logits, [tf.shape(self.input_seq)[<span class=\"number\">0</span>], args.maxlen, <span class=\"number\">101</span>])</span><br><span class=\"line\">        self.test_logits = self.test_logits[:, -<span class=\"number\">1</span>, :]</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># prediction layer</span></span><br><span class=\"line\">        self.pos_logits = tf.reduce_sum(pos_emb * seq_emb, -<span class=\"number\">1</span>)</span><br><span class=\"line\">        self.neg_logits = tf.reduce_sum(neg_emb * seq_emb, -<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># ignore padding items (0)</span></span><br><span class=\"line\">        istarget = tf.reshape(tf.to_float(tf.not_equal(pos, <span class=\"number\">0</span>)), [tf.shape(self.input_seq)[<span class=\"number\">0</span>] * args.maxlen])</span><br><span class=\"line\">        self.loss = tf.reduce_sum(</span><br><span class=\"line\">            - tf.log(tf.sigmoid(self.pos_logits) + <span class=\"number\">1e-24</span>) * istarget -</span><br><span class=\"line\">            tf.log(<span class=\"number\">1</span> - tf.sigmoid(self.neg_logits) + <span class=\"number\">1e-24</span>) * istarget</span><br><span class=\"line\">        ) / tf.reduce_sum(istarget)</span><br><span class=\"line\">        reg_losses = tf.get_collection(tf.GraphKeys.REGULARIZATION_LOSSES)</span><br><span class=\"line\">        self.loss += <span class=\"built_in\">sum</span>(reg_losses)</span><br><span class=\"line\"></span><br><span class=\"line\">        tf.summary.scalar(<span class=\"string\">&#x27;loss&#x27;</span>, self.loss)</span><br><span class=\"line\">        self.auc = tf.reduce_sum(</span><br><span class=\"line\">            ((tf.sign(self.pos_logits - self.neg_logits) + <span class=\"number\">1</span>) / <span class=\"number\">2</span>) * istarget</span><br><span class=\"line\">        ) / tf.reduce_sum(istarget)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> reuse <span class=\"keyword\">is</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">            tf.summary.scalar(<span class=\"string\">&#x27;auc&#x27;</span>, self.auc)</span><br><span class=\"line\">            self.global_step = tf.Variable(<span class=\"number\">0</span>, name=<span class=\"string\">&#x27;global_step&#x27;</span>, trainable=<span class=\"literal\">False</span>)</span><br><span class=\"line\">            self.optimizer = tf.train.AdamOptimizer(learning_rate=args.lr, beta2=<span class=\"number\">0.98</span>)</span><br><span class=\"line\">            self.train_op = self.optimizer.minimize(self.loss, global_step=self.global_step)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            tf.summary.scalar(<span class=\"string\">&#x27;test_auc&#x27;</span>, self.auc)</span><br><span class=\"line\"></span><br><span class=\"line\">        self.merged = tf.summary.merge_all()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">predict</span>(<span class=\"params\">self, sess, u, seq, item_idx</span>):</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sess.run(self.test_logits,</span><br><span class=\"line\">                        &#123;self.u: u, self.input_seq: seq, self.test_item: item_idx, self.is_training: <span class=\"literal\">False</span>&#125;)</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"初始化方法-__init__\"><a class=\"anchor\" href=\"#初始化方法-__init__\">#</a> 初始化方法  <code>__init__</code></h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, usernum, itemnum, args, reuse=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    self.is_training = tf.placeholder(tf.<span class=\"built_in\">bool</span>, shape=())</span><br><span class=\"line\">    self.u = tf.placeholder(tf.int32, shape=(<span class=\"literal\">None</span>))</span><br><span class=\"line\">    self.input_seq = tf.placeholder(tf.int32, shape=(<span class=\"literal\">None</span>, args.maxlen))</span><br><span class=\"line\">    self.pos = tf.placeholder(tf.int32, shape=(<span class=\"literal\">None</span>, args.maxlen))</span><br><span class=\"line\">    self.neg = tf.placeholder(tf.int32, shape=(<span class=\"literal\">None</span>, args.maxlen))</span><br><span class=\"line\">    pos = self.pos</span><br><span class=\"line\">    neg = self.neg</span><br><span class=\"line\">    mask = tf.expand_dims(tf.to_float(tf.not_equal(self.input_seq, <span class=\"number\">0</span>)), -<span class=\"number\">1</span>)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>作用：定义一些占位符，用于接收输入数据。\n<ul>\n<li><code>self.is_training</code> ：一个布尔型占位符，用于指示是否在训练模式。</li>\n<li><code>self.u</code> ：用户 ID 占位符。</li>\n<li><code>self.input_seq</code> ：输入序列的占位符。</li>\n<li><code>self.pos</code>  和  <code>self.neg</code> ：正样本和负样本的占位符。</li>\n<li><code>mask</code> ：掩码，用于掩盖输入序列中的填充值（0）。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"变量域-sasrec-和嵌入层\"><a class=\"anchor\" href=\"#变量域-sasrec-和嵌入层\">#</a> 变量域 &quot;SASRec&quot; 和嵌入层</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">with</span> tf.variable_scope(<span class=\"string\">&quot;SASRec&quot;</span>, reuse=reuse):</span><br><span class=\"line\">    <span class=\"comment\"># sequence embedding, item embedding table</span></span><br><span class=\"line\">    self.seq, item_emb_table = embedding(self.input_seq,</span><br><span class=\"line\">                                         vocab_size=itemnum + <span class=\"number\">1</span>,</span><br><span class=\"line\">                                         num_units=args.hidden_units,</span><br><span class=\"line\">                                         zero_pad=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                         scale=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                         l2_reg=args.l2_emb,</span><br><span class=\"line\">                                         scope=<span class=\"string\">&quot;input_embeddings&quot;</span>,</span><br><span class=\"line\">                                         with_t=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                         reuse=reuse</span><br><span class=\"line\">                                         )</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>作用：将输入序列进行嵌入，生成嵌入矩阵和项目嵌入表。\n<ul>\n<li><code>embedding</code>  函数：实现输入序列的嵌入，返回嵌入后的序列和嵌入表。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"位置编码-2\"><a class=\"anchor\" href=\"#位置编码-2\">#</a> 位置编码</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">t, pos_emb_table = embedding(</span><br><span class=\"line\">    tf.tile(tf.expand_dims(tf.<span class=\"built_in\">range</span>(tf.shape(self.input_seq)[<span class=\"number\">1</span>]), <span class=\"number\">0</span>), [tf.shape(self.input_seq)[<span class=\"number\">0</span>], <span class=\"number\">1</span>]),</span><br><span class=\"line\">    vocab_size=args.maxlen,</span><br><span class=\"line\">    num_units=args.hidden_units,</span><br><span class=\"line\">    zero_pad=<span class=\"literal\">False</span>,</span><br><span class=\"line\">    scale=<span class=\"literal\">False</span>,</span><br><span class=\"line\">    l2_reg=args.l2_emb,</span><br><span class=\"line\">    scope=<span class=\"string\">&quot;dec_pos&quot;</span>,</span><br><span class=\"line\">    reuse=reuse,</span><br><span class=\"line\">    with_t=<span class=\"literal\">True</span></span><br><span class=\"line\">)</span><br><span class=\"line\">self.seq += t</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>作用：对序列进行位置编码，添加位置信息到序列嵌入中。\n<ul>\n<li><code>embedding</code>  函数：实现位置编码的嵌入，返回位置编码向量和位置嵌入表。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"dropout-2\"><a class=\"anchor\" href=\"#dropout-2\">#</a> Dropout</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.seq = tf.layers.dropout(self.seq,</span><br><span class=\"line\">                             rate=args.dropout_rate,</span><br><span class=\"line\">                             training=tf.convert_to_tensor(self.is_training))</span><br><span class=\"line\">self.seq *= mask</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><strong>作用</strong>：对序列嵌入进行 dropout 操作，并应用掩码。</li>\n</ul>\n<h3 id=\"构建自注意力机制的块\"><a class=\"anchor\" href=\"#构建自注意力机制的块\">#</a> 构建自注意力机制的块</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(args.num_blocks):</span><br><span class=\"line\">    <span class=\"keyword\">with</span> tf.variable_scope(<span class=\"string\">&quot;num_blocks_%d&quot;</span> % i):</span><br><span class=\"line\">        <span class=\"comment\"># Self-attention</span></span><br><span class=\"line\">        self.seq = multihead_attention(queries=normalize(self.seq),</span><br><span class=\"line\">                                       keys=self.seq,</span><br><span class=\"line\">                                       num_units=args.hidden_units,</span><br><span class=\"line\">                                       num_heads=args.num_heads,</span><br><span class=\"line\">                                       dropout_rate=args.dropout_rate,</span><br><span class=\"line\">                                       is_training=self.is_training,</span><br><span class=\"line\">                                       causality=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                       scope=<span class=\"string\">&quot;self_attention&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Feed forward</span></span><br><span class=\"line\">        self.seq = feedforward(normalize(self.seq), num_units=[args.hidden_units, args.hidden_units],</span><br><span class=\"line\">                               dropout_rate=args.dropout_rate, is_training=self.is_training)</span><br><span class=\"line\">        self.seq *= mask</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>作用：构建多个自注意力机制块，每个块包括自注意力层和前馈神经网络层。\n<ul>\n<li><code>multihead_attention</code>  函数：实现多头自注意力机制。</li>\n<li><code>feedforward</code>  函数：实现前馈神经网络层。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"归一化-2\"><a class=\"anchor\" href=\"#归一化-2\">#</a> 归一化</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.seq = normalize(self.seq)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><strong>作用</strong>：对序列进行归一化处理。</li>\n</ul>\n<h3 id=\"计算正负样本的嵌入和预测得分\"><a class=\"anchor\" href=\"#计算正负样本的嵌入和预测得分\">#</a> 计算正负样本的嵌入和预测得分</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pos = tf.reshape(pos, [tf.shape(self.input_seq)[<span class=\"number\">0</span>] * args.maxlen])</span><br><span class=\"line\">neg = tf.reshape(neg, [tf.shape(self.input_seq)[<span class=\"number\">0</span>] * args.maxlen])</span><br><span class=\"line\">pos_emb = tf.nn.embedding_lookup(item_emb_table, pos)</span><br><span class=\"line\">neg_emb = tf.nn.embedding_lookup(item_emb_table, neg)</span><br><span class=\"line\">seq_emb = tf.reshape(self.seq, [tf.shape(self.input_seq)[<span class=\"number\">0</span>] * args.maxlen, args.hidden_units])</span><br><span class=\"line\"></span><br><span class=\"line\">self.test_item = tf.placeholder(tf.int32, shape=(<span class=\"number\">101</span>))</span><br><span class=\"line\">test_item_emb = tf.nn.embedding_lookup(item_emb_table, self.test_item)</span><br><span class=\"line\">self.test_logits = tf.matmul(seq_emb, tf.transpose(test_item_emb))</span><br><span class=\"line\">self.test_logits = tf.reshape(self.test_logits, [tf.shape(self.input_seq)[<span class=\"number\">0</span>], args.maxlen, <span class=\"number\">101</span>])</span><br><span class=\"line\">self.test_logits = self.test_logits[:, -<span class=\"number\">1</span>, :]</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><strong>作用</strong>：计算正样本和负样本的嵌入，并通过矩阵乘法得到预测得分。</li>\n</ul>\n<h3 id=\"损失函数\"><a class=\"anchor\" href=\"#损失函数\">#</a> 损失函数</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.pos_logits = tf.reduce_sum(pos_emb * seq_emb, -<span class=\"number\">1</span>)</span><br><span class=\"line\">self.neg_logits = tf.reduce_sum(neg_emb * seq_emb, -<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">istarget = tf.reshape(tf.to_float(tf.not_equal(pos, <span class=\"number\">0</span>)), [tf.shape(self.input_seq)[<span class=\"number\">0</span>] * args.maxlen])</span><br><span class=\"line\">self.loss = tf.reduce_sum(</span><br><span class=\"line\">    - tf.log(tf.sigmoid(self.pos_logits) + <span class=\"number\">1e-24</span>) * istarget -</span><br><span class=\"line\">    tf.log(<span class=\"number\">1</span> - tf.sigmoid(self.neg_logits) + <span class=\"number\">1e-24</span>) * istarget</span><br><span class=\"line\">) / tf.reduce_sum(istarget)</span><br><span class=\"line\">reg_losses = tf.get_collection(tf.GraphKeys.REGULARIZATION_LOSSES)</span><br><span class=\"line\">self.loss += <span class=\"built_in\">sum</span>(reg_losses)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><strong>作用</strong>：计算模型的损失函数，包含正负样本的二元交叉熵损失和正则化损失。</li>\n</ul>\n<h3 id=\"auc和优化器\"><a class=\"anchor\" href=\"#auc和优化器\">#</a> AUC 和优化器</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tf.summary.scalar(<span class=\"string\">&#x27;loss&#x27;</span>, self.loss)</span><br><span class=\"line\">self.auc = tf.reduce_sum(</span><br><span class=\"line\">    ((tf.sign(self.pos_logits - self.neg_logits) + <span class=\"number\">1</span>) / <span class=\"number\">2</span>) * istarget</span><br><span class=\"line\">) / tf.reduce_sum(istarget)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> reuse <span class=\"keyword\">is</span> <span class=\"literal\">None</span>:</span><br><span class=\"line\">    tf.summary.scalar(<span class=\"string\">&#x27;auc&#x27;</span>, self.auc)</span><br><span class=\"line\">    self.global_step = tf.Variable(<span class=\"number\">0</span>, name=<span class=\"string\">&#x27;global_step&#x27;</span>, trainable=<span class=\"literal\">False</span>)</span><br><span class=\"line\">    self.optimizer = tf.train.AdamOptimizer(learning_rate=args.lr, beta2=<span class=\"number\">0.98</span>)</span><br><span class=\"line\">    self.train_op = self.optimizer.minimize(self.loss, global_step=self.global_step)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    tf.summary.scalar(<span class=\"string\">&#x27;test_auc&#x27;</span>, self.auc)</span><br><span class=\"line\"></span><br><span class=\"line\">self.merged = tf.summary.merge_all()</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><strong>作用</strong>：定义 AUC 指标和优化器，如果 reuse 为 None 则初始化训练操作，否则记录测试 AUC。</li>\n</ul>\n<h3 id=\"预测函数-predict\"><a class=\"anchor\" href=\"#预测函数-predict\">#</a> 预测函数  <code>predict</code></h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">predict</span>(<span class=\"params\">self, sess, u, seq, item_idx</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sess.run(self.test_logits,</span><br><span class=\"line\">                    &#123;self.u: u, self.input_seq: seq, self.test_item: item_idx, self.is_training: <span class=\"literal\">False</span>&#125;)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><strong>作用</strong>：定义预测函数，接收会话、用户 ID、输入序列和项目索引，返回预测得分。</li>\n</ul>\n<h2 id=\"utilpy\"><a class=\"anchor\" href=\"#utilpy\">#</a> <span class=\"exturl\" data-url=\"aHR0cDovL3V0aWwucHk=\">util.py</span></h2>\n<p>这个代码包含了数据分割函数和模型评估函数，具体解析如下：</p>\n<ol>\n<li><strong>数据分割函数  <code>data_partition</code> </strong>：读取用户 - 物品交互数据，分割成训练集、验证集和测试集，并计算用户数和物品数。</li>\n<li><strong>模型评估函数  <code>evaluate</code> </strong>：在测试集上评估模型表现，计算 NDCG 和 HT。</li>\n<li><strong>模型评估函数（验证集）  <code>evaluate_valid</code> </strong>：在验证集上评估模型表现，计算 NDCG 和 HT。</li>\n</ol>\n<p>这些功能共同构成了一个基本的推荐系统数据处理和评估框架。</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\"><span class=\"keyword\">import</span> copy</span><br><span class=\"line\"><span class=\"keyword\">import</span> random</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> collections <span class=\"keyword\">import</span> defaultdict</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">data_partition</span>(<span class=\"params\">fname</span>):</span><br><span class=\"line\">    usernum = <span class=\"number\">0</span></span><br><span class=\"line\">    itemnum = <span class=\"number\">0</span></span><br><span class=\"line\">    User = defaultdict(<span class=\"built_in\">list</span>)</span><br><span class=\"line\">    user_train = &#123;&#125;</span><br><span class=\"line\">    user_valid = &#123;&#125;</span><br><span class=\"line\">    user_test = &#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\"># assume user/item index starting from 1</span></span><br><span class=\"line\">    f = <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;data/%s.txt&#x27;</span> % fname, <span class=\"string\">&#x27;r&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> f:</span><br><span class=\"line\">        u, i = line.rstrip().split(<span class=\"string\">&#x27; &#x27;</span>)</span><br><span class=\"line\">        u = <span class=\"built_in\">int</span>(u)</span><br><span class=\"line\">        i = <span class=\"built_in\">int</span>(i)</span><br><span class=\"line\">        usernum = <span class=\"built_in\">max</span>(u, usernum)</span><br><span class=\"line\">        itemnum = <span class=\"built_in\">max</span>(i, itemnum)</span><br><span class=\"line\">        User[u].append(i)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> user <span class=\"keyword\">in</span> User:</span><br><span class=\"line\">        nfeedback = <span class=\"built_in\">len</span>(User[user])</span><br><span class=\"line\">        <span class=\"keyword\">if</span> nfeedback &lt; <span class=\"number\">3</span>:</span><br><span class=\"line\">            user_train[user] = User[user]</span><br><span class=\"line\">            user_valid[user] = []</span><br><span class=\"line\">            user_test[user] = []</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            user_train[user] = User[user][:-<span class=\"number\">2</span>]</span><br><span class=\"line\">            user_valid[user] = []</span><br><span class=\"line\">            user_valid[user].append(User[user][-<span class=\"number\">2</span>])</span><br><span class=\"line\">            user_test[user] = []</span><br><span class=\"line\">            user_test[user].append(User[user][-<span class=\"number\">1</span>])</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [user_train, user_valid, user_test, usernum, itemnum]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">evaluate</span>(<span class=\"params\">model, dataset, args, sess</span>):</span><br><span class=\"line\">    [train, valid, test, usernum, itemnum] = copy.deepcopy(dataset)</span><br><span class=\"line\"></span><br><span class=\"line\">    NDCG = <span class=\"number\">0.0</span></span><br><span class=\"line\">    HT = <span class=\"number\">0.0</span></span><br><span class=\"line\">    valid_user = <span class=\"number\">0.0</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> usernum&gt;<span class=\"number\">10000</span>:</span><br><span class=\"line\">        users = random.sample(xrange(<span class=\"number\">1</span>, usernum + <span class=\"number\">1</span>), <span class=\"number\">10000</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        users = xrange(<span class=\"number\">1</span>, usernum + <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> u <span class=\"keyword\">in</span> users:</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(train[u]) &lt; <span class=\"number\">1</span> <span class=\"keyword\">or</span> <span class=\"built_in\">len</span>(test[u]) &lt; <span class=\"number\">1</span>: <span class=\"keyword\">continue</span></span><br><span class=\"line\"></span><br><span class=\"line\">        seq = np.zeros([args.maxlen], dtype=np.int32)</span><br><span class=\"line\">        idx = args.maxlen - <span class=\"number\">1</span></span><br><span class=\"line\">        seq[idx] = valid[u][<span class=\"number\">0</span>]</span><br><span class=\"line\">        idx -= <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">reversed</span>(train[u]):</span><br><span class=\"line\">            seq[idx] = i</span><br><span class=\"line\">            idx -= <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> idx == -<span class=\"number\">1</span>: <span class=\"keyword\">break</span></span><br><span class=\"line\">        rated = <span class=\"built_in\">set</span>(train[u])</span><br><span class=\"line\">        rated.add(<span class=\"number\">0</span>)</span><br><span class=\"line\">        item_idx = [test[u][<span class=\"number\">0</span>]]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">100</span>):</span><br><span class=\"line\">            t = np.random.randint(<span class=\"number\">1</span>, itemnum + <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">while</span> t <span class=\"keyword\">in</span> rated: t = np.random.randint(<span class=\"number\">1</span>, itemnum + <span class=\"number\">1</span>)</span><br><span class=\"line\">            item_idx.append(t)</span><br><span class=\"line\"></span><br><span class=\"line\">        predictions = -model.predict(sess, [u], [seq], item_idx)</span><br><span class=\"line\">        predictions = predictions[<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        rank = predictions.argsort().argsort()[<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        valid_user += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> rank &lt; <span class=\"number\">10</span>:</span><br><span class=\"line\">            NDCG += <span class=\"number\">1</span> / np.log2(rank + <span class=\"number\">2</span>)</span><br><span class=\"line\">            HT += <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> valid_user % <span class=\"number\">100</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"built_in\">print</span> <span class=\"string\">&#x27;.&#x27;</span>,</span><br><span class=\"line\">            sys.stdout.flush()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> NDCG / valid_user, HT / valid_user</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">evaluate_valid</span>(<span class=\"params\">model, dataset, args, sess</span>):</span><br><span class=\"line\">    [train, valid, test, usernum, itemnum] = copy.deepcopy(dataset)</span><br><span class=\"line\"></span><br><span class=\"line\">    NDCG = <span class=\"number\">0.0</span></span><br><span class=\"line\">    valid_user = <span class=\"number\">0.0</span></span><br><span class=\"line\">    HT = <span class=\"number\">0.0</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> usernum&gt;<span class=\"number\">10000</span>:</span><br><span class=\"line\">        users = random.sample(xrange(<span class=\"number\">1</span>, usernum + <span class=\"number\">1</span>), <span class=\"number\">10000</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        users = xrange(<span class=\"number\">1</span>, usernum + <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> u <span class=\"keyword\">in</span> users:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(train[u]) &lt; <span class=\"number\">1</span> <span class=\"keyword\">or</span> <span class=\"built_in\">len</span>(valid[u]) &lt; <span class=\"number\">1</span>: <span class=\"keyword\">continue</span></span><br><span class=\"line\"></span><br><span class=\"line\">        seq = np.zeros([args.maxlen], dtype=np.int32)</span><br><span class=\"line\">        idx = args.maxlen - <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">reversed</span>(train[u]):</span><br><span class=\"line\">            seq[idx] = i</span><br><span class=\"line\">            idx -= <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> idx == -<span class=\"number\">1</span>: <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">        rated = <span class=\"built_in\">set</span>(train[u])</span><br><span class=\"line\">        rated.add(<span class=\"number\">0</span>)</span><br><span class=\"line\">        item_idx = [valid[u][<span class=\"number\">0</span>]]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">100</span>):</span><br><span class=\"line\">            t = np.random.randint(<span class=\"number\">1</span>, itemnum + <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">while</span> t <span class=\"keyword\">in</span> rated: t = np.random.randint(<span class=\"number\">1</span>, itemnum + <span class=\"number\">1</span>)</span><br><span class=\"line\">            item_idx.append(t)</span><br><span class=\"line\"></span><br><span class=\"line\">        predictions = -model.predict(sess, [u], [seq], item_idx)</span><br><span class=\"line\">        predictions = predictions[<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        rank = predictions.argsort().argsort()[<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        valid_user += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> rank &lt; <span class=\"number\">10</span>:</span><br><span class=\"line\">            NDCG += <span class=\"number\">1</span> / np.log2(rank + <span class=\"number\">2</span>)</span><br><span class=\"line\">            HT += <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> valid_user % <span class=\"number\">100</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"built_in\">print</span> <span class=\"string\">&#x27;.&#x27;</span>,</span><br><span class=\"line\">            sys.stdout.flush()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> NDCG / valid_user, HT / valid_user</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"导入模块\"><a class=\"anchor\" href=\"#导入模块\">#</a> 导入模块</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\"><span class=\"keyword\">import</span> copy</span><br><span class=\"line\"><span class=\"keyword\">import</span> random</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> collections <span class=\"keyword\">import</span> defaultdict</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：导入所需的模块，包括系统模块、深拷贝模块、随机数模块、数值计算模块和默认字典模块。</p>\n<h3 id=\"数据分割函数-data_partition\"><a class=\"anchor\" href=\"#数据分割函数-data_partition\">#</a> 数据分割函数  <code>data_partition</code></h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">data_partition</span>(<span class=\"params\">fname</span>):</span><br><span class=\"line\">    usernum = <span class=\"number\">0</span></span><br><span class=\"line\">    itemnum = <span class=\"number\">0</span></span><br><span class=\"line\">    User = defaultdict(<span class=\"built_in\">list</span>)</span><br><span class=\"line\">    user_train = &#123;&#125;</span><br><span class=\"line\">    user_valid = &#123;&#125;</span><br><span class=\"line\">    user_test = &#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\"># assume user/item index starting from 1</span></span><br><span class=\"line\">    f = <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;data/%s.txt&#x27;</span> % fname, <span class=\"string\">&#x27;r&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> f:</span><br><span class=\"line\">        u, i = line.rstrip().split(<span class=\"string\">&#x27; &#x27;</span>)</span><br><span class=\"line\">        u = <span class=\"built_in\">int</span>(u)</span><br><span class=\"line\">        i = <span class=\"built_in\">int</span>(i)</span><br><span class=\"line\">        usernum = <span class=\"built_in\">max</span>(u, usernum)</span><br><span class=\"line\">        itemnum = <span class=\"built_in\">max</span>(i, itemnum)</span><br><span class=\"line\">        User[u].append(i)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> user <span class=\"keyword\">in</span> User:</span><br><span class=\"line\">        nfeedback = <span class=\"built_in\">len</span>(User[user])</span><br><span class=\"line\">        <span class=\"keyword\">if</span> nfeedback &lt; <span class=\"number\">3</span>:</span><br><span class=\"line\">            user_train[user] = User[user]</span><br><span class=\"line\">            user_valid[user] = []</span><br><span class=\"line\">            user_test[user] = []</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            user_train[user] = User[user][:-<span class=\"number\">2</span>]</span><br><span class=\"line\">            user_valid[user] = []</span><br><span class=\"line\">            user_valid[user].append(User[user][-<span class=\"number\">2</span>])</span><br><span class=\"line\">            user_test[user] = []</span><br><span class=\"line\">            user_test[user].append(User[user][-<span class=\"number\">1</span>])</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [user_train, user_valid, user_test, usernum, itemnum]</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：将数据分成训练集、验证集和测试集，并计算用户数和物品数。</p>\n<ul>\n<li><code>usernum</code>  和  <code>itemnum</code>  初始化为 0，用于记录最大用户 ID 和最大物品 ID。</li>\n<li><code>User</code> ：使用默认字典，记录每个用户的交互物品列表。</li>\n<li><code>user_train</code> 、 <code>user_valid</code>  和  <code>user_test</code> ：分别用于存储每个用户的训练集、验证集和测试集。</li>\n<li>打开文件，读取每一行数据，将用户 ID 和物品 ID 存入 <code>User</code>  字典，并更新 <code>usernum</code>  和 <code>itemnum</code> 。</li>\n<li>对每个用户，根据交互的物品数量进行数据分割：\n<ul>\n<li>如果交互物品数小于 3，全部放入训练集。</li>\n<li>否则，最后两个物品分别放入验证集和测试集，剩余的放入训练集。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"模型评估函数-evaluate\"><a class=\"anchor\" href=\"#模型评估函数-evaluate\">#</a> 模型评估函数  <code>evaluate</code></h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">evaluate</span>(<span class=\"params\">model, dataset, args, sess</span>):</span><br><span class=\"line\">    [train, valid, test, usernum, itemnum] = copy.deepcopy(dataset)</span><br><span class=\"line\"></span><br><span class=\"line\">    NDCG = <span class=\"number\">0.0</span></span><br><span class=\"line\">    HT = <span class=\"number\">0.0</span></span><br><span class=\"line\">    valid_user = <span class=\"number\">0.0</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> usernum &gt; <span class=\"number\">10000</span>:</span><br><span class=\"line\">        users = random.sample(<span class=\"built_in\">range</span>(<span class=\"number\">1</span>, usernum + <span class=\"number\">1</span>), <span class=\"number\">10000</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        users = <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, usernum + <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> u <span class=\"keyword\">in</span> users:</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(train[u]) &lt; <span class=\"number\">1</span> <span class=\"keyword\">or</span> <span class=\"built_in\">len</span>(test[u]) &lt; <span class=\"number\">1</span>: <span class=\"keyword\">continue</span></span><br><span class=\"line\"></span><br><span class=\"line\">        seq = np.zeros([args.maxlen], dtype=np.int32)</span><br><span class=\"line\">        idx = args.maxlen - <span class=\"number\">1</span></span><br><span class=\"line\">        seq[idx] = valid[u][<span class=\"number\">0</span>]</span><br><span class=\"line\">        idx -= <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">reversed</span>(train[u]):</span><br><span class=\"line\">            seq[idx] = i</span><br><span class=\"line\">            idx -= <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> idx == -<span class=\"number\">1</span>: <span class=\"keyword\">break</span></span><br><span class=\"line\">        rated = <span class=\"built_in\">set</span>(train[u])</span><br><span class=\"line\">        rated.add(<span class=\"number\">0</span>)</span><br><span class=\"line\">        item_idx = [test[u][<span class=\"number\">0</span>]]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">100</span>):</span><br><span class=\"line\">            t = np.random.randint(<span class=\"number\">1</span>, itemnum + <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">while</span> t <span class=\"keyword\">in</span> rated: t = np.random.randint(<span class=\"number\">1</span>, itemnum + <span class=\"number\">1</span>)</span><br><span class=\"line\">            item_idx.append(t)</span><br><span class=\"line\"></span><br><span class=\"line\">        predictions = -model.predict(sess, [u], [seq], item_idx)</span><br><span class=\"line\">        predictions = predictions[<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        rank = predictions.argsort().argsort()[<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        valid_user += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> rank &lt; <span class=\"number\">10</span>:</span><br><span class=\"line\">            NDCG += <span class=\"number\">1</span> / np.log2(rank + <span class=\"number\">2</span>)</span><br><span class=\"line\">            HT += <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> valid_user % <span class=\"number\">100</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;.&#x27;</span>, end=<span class=\"string\">&#x27;&#x27;</span>, flush=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> NDCG / valid_user, HT / valid_user</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：评估模型在测试集上的表现，计算 NDCG（归一化折损累积增益）和 HT（命中率）。</p>\n<ul>\n<li>深拷贝数据集，以免修改原始数据。</li>\n<li>初始化 NDCG、HT 和有效用户数。</li>\n<li>随机抽样 10000 个用户进行评估，如果用户总数大于 10000，否则评估所有用户。</li>\n<li>对每个用户，构建输入序列 <code>seq</code> ，包括训练数据和验证数据。</li>\n<li>生成负样本，将其与测试样本一起组成 <code>item_idx</code> 。</li>\n<li>通过模型预测，计算预测得分 <code>predictions</code> ，并对预测结果排序。</li>\n<li>计算排名，更新 NDCG 和 HT，打印进度。</li>\n</ul>\n<h3 id=\"模型评估函数验证集evaluate_valid\"><a class=\"anchor\" href=\"#模型评估函数验证集evaluate_valid\">#</a> 模型评估函数（验证集） <code>evaluate_valid</code></h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">evaluate_valid</span>(<span class=\"params\">model, dataset, args, sess</span>):</span><br><span class=\"line\">    [train, valid, test, usernum, itemnum] = copy.deepcopy(dataset)</span><br><span class=\"line\"></span><br><span class=\"line\">    NDCG = <span class=\"number\">0.0</span></span><br><span class=\"line\">    valid_user = <span class=\"number\">0.0</span></span><br><span class=\"line\">    HT = <span class=\"number\">0.0</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> usernum &gt; <span class=\"number\">10000</span>:</span><br><span class=\"line\">        users = random.sample(<span class=\"built_in\">range</span>(<span class=\"number\">1</span>, usernum + <span class=\"number\">1</span>), <span class=\"number\">10000</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        users = <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, usernum + <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> u <span class=\"keyword\">in</span> users:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(train[u]) &lt; <span class=\"number\">1</span> <span class=\"keyword\">or</span> <span class=\"built_in\">len</span>(valid[u]) &lt; <span class=\"number\">1</span>: <span class=\"keyword\">continue</span></span><br><span class=\"line\"></span><br><span class=\"line\">        seq = np.zeros([args.maxlen], dtype=np.int32)</span><br><span class=\"line\">        idx = args.maxlen - <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">reversed</span>(train[u]):</span><br><span class=\"line\">            seq[idx] = i</span><br><span class=\"line\">            idx -= <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> idx == -<span class=\"number\">1</span>: <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">        rated = <span class=\"built_in\">set</span>(train[u])</span><br><span class=\"line\">        rated.add(<span class=\"number\">0</span>)</span><br><span class=\"line\">        item_idx = [valid[u][<span class=\"number\">0</span>]]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">100</span>):</span><br><span class=\"line\">            t = np.random.randint(<span class=\"number\">1</span>, itemnum + <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">while</span> t <span class=\"keyword\">in</span> rated: t = np.random.randint(<span class=\"number\">1</span>, itemnum + <span class=\"number\">1</span>)</span><br><span class=\"line\">            item_idx.append(t)</span><br><span class=\"line\"></span><br><span class=\"line\">        predictions = -model.predict(sess, [u], [seq], item_idx)</span><br><span class=\"line\">        predictions = predictions[<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        rank = predictions.argsort().argsort()[<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        valid_user += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> rank &lt; <span class=\"number\">10</span>:</span><br><span class=\"line\">            NDCG += <span class=\"number\">1</span> / np.log2(rank + <span class=\"number\">2</span>)</span><br><span class=\"line\">            HT += <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> valid_user % <span class=\"number\">100</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;.&#x27;</span>, end=<span class=\"string\">&#x27;&#x27;</span>, flush=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> NDCG / valid_user, HT / valid_user</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：评估模型在验证集上的表现，计算 NDCG 和 HT。</p>\n<ul>\n<li>代码与 <code>evaluate</code>  类似，不同之处在于这里使用验证集 <code>valid</code>  进行评估，而不是测试集 <code>test</code> 。</li>\n</ul>\n<h2 id=\"samplerpy\"><a class=\"anchor\" href=\"#samplerpy\">#</a> <span class=\"exturl\" data-url=\"aHR0cDovL3NhbXBsZXIucHk=\">sampler.py</span></h2>\n<p>这个代码实现了一个多进程的数据采样器，具体解析如下：</p>\n<ol>\n<li><strong> <code>random_neq</code>  函数</strong>：生成不在集合中的随机整数。</li>\n<li><strong> <code>sample_function</code>  函数</strong>：在多进程环境下进行数据采样，并将结果放入队列中。</li>\n<li><strong> <code>WarpSampler</code>  类</strong>：管理多个数据采样进程，提供获取批量数据的方法。</li>\n</ol>\n<p>这些功能共同构成了一个高效的多进程数据采样器，用于推荐系统中的序列化数据采样。</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> multiprocessing <span class=\"keyword\">import</span> Process, Queue</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">random_neq</span>(<span class=\"params\">l, r, s</span>):</span><br><span class=\"line\">    t = np.random.randint(l, r)</span><br><span class=\"line\">    <span class=\"keyword\">while</span> t <span class=\"keyword\">in</span> s:</span><br><span class=\"line\">        t = np.random.randint(l, r)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> t</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">sample_function</span>(<span class=\"params\">user_train, usernum, itemnum, batch_size, maxlen, result_queue, SEED</span>):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">sample</span>():</span><br><span class=\"line\"></span><br><span class=\"line\">        user = np.random.randint(<span class=\"number\">1</span>, usernum + <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">while</span> <span class=\"built_in\">len</span>(user_train[user]) &lt;= <span class=\"number\">1</span>: user = np.random.randint(<span class=\"number\">1</span>, usernum + <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        seq = np.zeros([maxlen], dtype=np.int32)</span><br><span class=\"line\">        pos = np.zeros([maxlen], dtype=np.int32)</span><br><span class=\"line\">        neg = np.zeros([maxlen], dtype=np.int32)</span><br><span class=\"line\">        nxt = user_train[user][-<span class=\"number\">1</span>]</span><br><span class=\"line\">        idx = maxlen - <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        ts = <span class=\"built_in\">set</span>(user_train[user])</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">reversed</span>(user_train[user][:-<span class=\"number\">1</span>]):</span><br><span class=\"line\">            seq[idx] = i</span><br><span class=\"line\">            pos[idx] = nxt</span><br><span class=\"line\">            <span class=\"keyword\">if</span> nxt != <span class=\"number\">0</span>: neg[idx] = random_neq(<span class=\"number\">1</span>, itemnum + <span class=\"number\">1</span>, ts)</span><br><span class=\"line\">            nxt = i</span><br><span class=\"line\">            idx -= <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> idx == -<span class=\"number\">1</span>: <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> (user, seq, pos, neg)</span><br><span class=\"line\"></span><br><span class=\"line\">    np.random.seed(SEED)</span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">        one_batch = []</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(batch_size):</span><br><span class=\"line\">            one_batch.append(sample())</span><br><span class=\"line\"></span><br><span class=\"line\">        result_queue.put(<span class=\"built_in\">zip</span>(*one_batch))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">WarpSampler</span>(<span class=\"title class_ inherited__\">object</span>):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, User, usernum, itemnum, batch_size=<span class=\"number\">64</span>, maxlen=<span class=\"number\">10</span>, n_workers=<span class=\"number\">1</span></span>):</span><br><span class=\"line\">        self.result_queue = Queue(maxsize=n_workers * <span class=\"number\">10</span>)</span><br><span class=\"line\">        self.processors = []</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n_workers):</span><br><span class=\"line\">            self.processors.append(</span><br><span class=\"line\">                Process(target=sample_function, args=(User,</span><br><span class=\"line\">                                                      usernum,</span><br><span class=\"line\">                                                      itemnum,</span><br><span class=\"line\">                                                      batch_size,</span><br><span class=\"line\">                                                      maxlen,</span><br><span class=\"line\">                                                      self.result_queue,</span><br><span class=\"line\">                                                      np.random.randint(<span class=\"number\">2e9</span>)</span><br><span class=\"line\">                                                      )))</span><br><span class=\"line\">            self.processors[-<span class=\"number\">1</span>].daemon = <span class=\"literal\">True</span></span><br><span class=\"line\">            self.processors[-<span class=\"number\">1</span>].start()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">next_batch</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"keyword\">return</span> self.result_queue.get()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">close</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> self.processors:</span><br><span class=\"line\">            p.terminate()</span><br><span class=\"line\">            p.join()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"导入模块-2\"><a class=\"anchor\" href=\"#导入模块-2\">#</a> 导入模块</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> multiprocessing <span class=\"keyword\">import</span> Process, Queue</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：导入所需的模块，包括数值计算模块和多进程处理模块。</p>\n<h3 id=\"随机负样本生成函数-random_neq\"><a class=\"anchor\" href=\"#随机负样本生成函数-random_neq\">#</a> 随机负样本生成函数  <code>random_neq</code></h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">random_neq</span>(<span class=\"params\">l, r, s</span>):</span><br><span class=\"line\">    t = np.random.randint(l, r)</span><br><span class=\"line\">    <span class=\"keyword\">while</span> t <span class=\"keyword\">in</span> s:</span><br><span class=\"line\">        t = np.random.randint(l, r)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> t</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：在区间 <code>[l, r)</code>  内随机生成一个不在集合 <code>s</code>  中的整数。</p>\n<ul>\n<li><code>np.random.randint(l, r)</code> ：生成区间 <code>[l, r)</code>  内的随机整数。</li>\n<li>如果生成的整数 <code>t</code>  在集合 <code>s</code>  中，则重新生成，直到 <code>t</code>  不在集合 <code>s</code>  中为止。</li>\n</ul>\n<h3 id=\"数据采样函数-sample_function\"><a class=\"anchor\" href=\"#数据采样函数-sample_function\">#</a> 数据采样函数  <code>sample_function</code></h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">sample_function</span>(<span class=\"params\">user_train, usernum, itemnum, batch_size, maxlen, result_queue, SEED</span>):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">sample</span>():</span><br><span class=\"line\">        user = np.random.randint(<span class=\"number\">1</span>, usernum + <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">while</span> <span class=\"built_in\">len</span>(user_train[user]) &lt;= <span class=\"number\">1</span>: user = np.random.randint(<span class=\"number\">1</span>, usernum + <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        seq = np.zeros([maxlen], dtype=np.int32)</span><br><span class=\"line\">        pos = np.zeros([maxlen], dtype=np.int32)</span><br><span class=\"line\">        neg = np.zeros([maxlen], dtype=np.int32)</span><br><span class=\"line\">        nxt = user_train[user][-<span class=\"number\">1</span>]</span><br><span class=\"line\">        idx = maxlen - <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        ts = <span class=\"built_in\">set</span>(user_train[user])</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">reversed</span>(user_train[user][:-<span class=\"number\">1</span>]):</span><br><span class=\"line\">            seq[idx] = i</span><br><span class=\"line\">            pos[idx] = nxt</span><br><span class=\"line\">            <span class=\"keyword\">if</span> nxt != <span class=\"number\">0</span>: neg[idx] = random_neq(<span class=\"number\">1</span>, itemnum + <span class=\"number\">1</span>, ts)</span><br><span class=\"line\">            nxt = i</span><br><span class=\"line\">            idx -= <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> idx == -<span class=\"number\">1</span>: <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> (user, seq, pos, neg)</span><br><span class=\"line\"></span><br><span class=\"line\">    np.random.seed(SEED)</span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">        one_batch = []</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(batch_size):</span><br><span class=\"line\">            one_batch.append(sample())</span><br><span class=\"line\"></span><br><span class=\"line\">        result_queue.put(<span class=\"built_in\">zip</span>(*one_batch))</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：在多进程环境下进行数据采样，并将结果放入队列中。</p>\n<ul>\n<li><strong>内部函数  <code>sample</code> </strong>：\n<ul>\n<li>随机选择一个有交互记录的用户。</li>\n<li>初始化序列 <code>seq</code> 、正样本 <code>pos</code>  和负样本 <code>neg</code> 。</li>\n<li>从用户的交互记录中构建序列和正负样本。</li>\n<li>使用 <code>random_neq</code>  函数生成负样本。</li>\n<li>返回一个包含用户 ID、序列、正样本和负样本的元组。</li>\n</ul>\n</li>\n<li><strong> <code>np.random.seed(SEED)</code> </strong>：设置随机种子，以保证多进程中的随机性。</li>\n<li><strong>无限循环</strong>：不断生成批量数据。\n<ul>\n<li><strong> <code>one_batch.append(sample())</code> </strong>：生成一个批量数据，并添加到 <code>one_batch</code>  列表中。</li>\n<li><strong> <code>result_queue.put(zip(\\*one_batch))</code> </strong>：将批量数据打包并放入结果队列中。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"warpsampler-类\"><a class=\"anchor\" href=\"#warpsampler-类\">#</a>  <code>WarpSampler</code>  类</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">WarpSampler</span>(<span class=\"title class_ inherited__\">object</span>):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, User, usernum, itemnum, batch_size=<span class=\"number\">64</span>, maxlen=<span class=\"number\">10</span>, n_workers=<span class=\"number\">1</span></span>):</span><br><span class=\"line\">        self.result_queue = Queue(maxsize=n_workers * <span class=\"number\">10</span>)</span><br><span class=\"line\">        self.processors = []</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n_workers):</span><br><span class=\"line\">            self.processors.append(</span><br><span class=\"line\">                Process(target=sample_function, args=(User,</span><br><span class=\"line\">                                                      usernum,</span><br><span class=\"line\">                                                      itemnum,</span><br><span class=\"line\">                                                      batch_size,</span><br><span class=\"line\">                                                      maxlen,</span><br><span class=\"line\">                                                      self.result_queue,</span><br><span class=\"line\">                                                      np.random.randint(<span class=\"number\">2e9</span>)</span><br><span class=\"line\">                                                      )))</span><br><span class=\"line\">            self.processors[-<span class=\"number\">1</span>].daemon = <span class=\"literal\">True</span></span><br><span class=\"line\">            self.processors[-<span class=\"number\">1</span>].start()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">next_batch</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"keyword\">return</span> self.result_queue.get()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">close</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> self.processors:</span><br><span class=\"line\">            p.terminate()</span><br><span class=\"line\">            p.join()</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：管理多个数据采样进程，并提供获取批量数据的方法。</p>\n<ul>\n<li>\n<p><strong>初始化方法  <code>__init__</code> </strong>：</p>\n<ul>\n<li>\n<p><strong> <code>self.result_queue</code> </strong>：创建一个结果队列，用于存储采样结果。</p>\n</li>\n<li>\n<p><strong> <code>self.processors</code> </strong>：初始化一个空列表，用于存储采样进程。</p>\n</li>\n<li>\n<p>循环创建进程</p>\n<p>：</p>\n<ul>\n<li>创建 <code>Process</code>  对象，目标函数为 <code>sample_function</code> ，传入所需参数。</li>\n<li>将进程设为守护进程。</li>\n<li>启动进程并添加到 <code>self.processors</code>  列表中。</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong> <code>next_batch</code>  方法</strong>：</p>\n<ul>\n<li><strong> <code>self.result_queue.get()</code> </strong>：从结果队列中获取一个批量数据。</li>\n</ul>\n</li>\n<li>\n<p><strong> <code>close</code>  方法</strong>：</p>\n<ul>\n<li>\n<p>循环终止进程</p>\n<p>：</p>\n<ul>\n<li><strong> <code>p.terminate()</code> </strong>：终止进程。</li>\n<li><strong> <code>p.join()</code> </strong>：等待进程终止。</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"mainpy\"><a class=\"anchor\" href=\"#mainpy\">#</a> <span class=\"exturl\" data-url=\"aHR0cDovL21haW4ucHk=\">main.py</span></h2>\n<p>这个代码实现了一个基于 TensorFlow 的推荐系统的训练流程，具体解析如下：</p>\n<ol>\n<li><strong>导入模块</strong>：导入必要的库和模块。</li>\n<li><strong>参数解析</strong>：定义并解析命令行参数。</li>\n<li><strong>创建训练目录</strong>：检查并创建训练目录，保存解析的参数。</li>\n<li><strong>数据分割</strong>：调用数据分割函数获取训练集、验证集和测试集。</li>\n<li><strong>TensorFlow 会话配置</strong>：配置 TensorFlow 会话。</li>\n<li><strong>数据采样器和模型初始化</strong>：初始化数据采样器和模型，并初始化所有变量。</li>\n<li><strong>训练过程</strong>：训练模型并定期评估模型性能。</li>\n<li><strong>异常处理和资源清理</strong>：确保在异常发生或正常结束时关闭采样器和日志文件。</li>\n</ol>\n<p>这些步骤共同构成了一个完整的推荐系统训练流程。</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"><span class=\"keyword\">import</span> argparse</span><br><span class=\"line\"><span class=\"keyword\">import</span> tensorflow <span class=\"keyword\">as</span> tf</span><br><span class=\"line\"><span class=\"keyword\">from</span> sampler <span class=\"keyword\">import</span> WarpSampler</span><br><span class=\"line\"><span class=\"keyword\">from</span> model <span class=\"keyword\">import</span> Model</span><br><span class=\"line\"><span class=\"keyword\">from</span> tqdm <span class=\"keyword\">import</span> tqdm</span><br><span class=\"line\"><span class=\"keyword\">from</span> util <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">str2bool</span>(<span class=\"params\">s</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> s <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> &#123;<span class=\"string\">&#x27;False&#x27;</span>, <span class=\"string\">&#x27;True&#x27;</span>&#125;:</span><br><span class=\"line\">        <span class=\"keyword\">raise</span> ValueError(<span class=\"string\">&#x27;Not a valid boolean string&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s == <span class=\"string\">&#x27;True&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">parser = argparse.ArgumentParser()</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--dataset&#x27;</span>, required=<span class=\"literal\">True</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--train_dir&#x27;</span>, required=<span class=\"literal\">True</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--batch_size&#x27;</span>, default=<span class=\"number\">128</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">int</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--lr&#x27;</span>, default=<span class=\"number\">0.001</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">float</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--maxlen&#x27;</span>, default=<span class=\"number\">50</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">int</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--hidden_units&#x27;</span>, default=<span class=\"number\">50</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">int</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--num_blocks&#x27;</span>, default=<span class=\"number\">2</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">int</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--num_epochs&#x27;</span>, default=<span class=\"number\">201</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">int</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--num_heads&#x27;</span>, default=<span class=\"number\">1</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">int</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--dropout_rate&#x27;</span>, default=<span class=\"number\">0.5</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">float</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--l2_emb&#x27;</span>, default=<span class=\"number\">0.0</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">float</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">args = parser.parse_args()</span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">not</span> os.path.isdir(args.dataset + <span class=\"string\">&#x27;_&#x27;</span> + args.train_dir):</span><br><span class=\"line\">    os.makedirs(args.dataset + <span class=\"string\">&#x27;_&#x27;</span> + args.train_dir)</span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(os.path.join(args.dataset + <span class=\"string\">&#x27;_&#x27;</span> + args.train_dir, <span class=\"string\">&#x27;args.txt&#x27;</span>), <span class=\"string\">&#x27;w&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">    f.write(<span class=\"string\">&#x27;\\n&#x27;</span>.join([<span class=\"built_in\">str</span>(k) + <span class=\"string\">&#x27;,&#x27;</span> + <span class=\"built_in\">str</span>(v) <span class=\"keyword\">for</span> k, v <span class=\"keyword\">in</span> <span class=\"built_in\">sorted</span>(<span class=\"built_in\">vars</span>(args).items(), key=<span class=\"keyword\">lambda</span> x: x[<span class=\"number\">0</span>])]))</span><br><span class=\"line\">f.close()</span><br><span class=\"line\"></span><br><span class=\"line\">dataset = data_partition(args.dataset)</span><br><span class=\"line\">[user_train, user_valid, user_test, usernum, itemnum] = dataset</span><br><span class=\"line\">num_batch = <span class=\"built_in\">len</span>(user_train) / args.batch_size</span><br><span class=\"line\">cc = <span class=\"number\">0.0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> u <span class=\"keyword\">in</span> user_train:</span><br><span class=\"line\">    cc += <span class=\"built_in\">len</span>(user_train[u])</span><br><span class=\"line\"><span class=\"built_in\">print</span> <span class=\"string\">&#x27;average sequence length: %.2f&#x27;</span> % (cc / <span class=\"built_in\">len</span>(user_train))</span><br><span class=\"line\"></span><br><span class=\"line\">f = <span class=\"built_in\">open</span>(os.path.join(args.dataset + <span class=\"string\">&#x27;_&#x27;</span> + args.train_dir, <span class=\"string\">&#x27;log.txt&#x27;</span>), <span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">config = tf.ConfigProto()</span><br><span class=\"line\">config.gpu_options.allow_growth = <span class=\"literal\">True</span></span><br><span class=\"line\">config.allow_soft_placement = <span class=\"literal\">True</span></span><br><span class=\"line\">sess = tf.Session(config=config)</span><br><span class=\"line\"></span><br><span class=\"line\">sampler = WarpSampler(user_train, usernum, itemnum, batch_size=args.batch_size, maxlen=args.maxlen, n_workers=<span class=\"number\">3</span>)</span><br><span class=\"line\">model = Model(usernum, itemnum, args)</span><br><span class=\"line\">sess.run(tf.initialize_all_variables())</span><br><span class=\"line\"></span><br><span class=\"line\">T = <span class=\"number\">0.0</span></span><br><span class=\"line\">t0 = time.time()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">try</span>:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> epoch <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, args.num_epochs + <span class=\"number\">1</span>):</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> step <span class=\"keyword\">in</span> tqdm(<span class=\"built_in\">range</span>(num_batch), total=num_batch, ncols=<span class=\"number\">70</span>, leave=<span class=\"literal\">False</span>, unit=<span class=\"string\">&#x27;b&#x27;</span>):</span><br><span class=\"line\">            u, seq, pos, neg = sampler.next_batch()</span><br><span class=\"line\">            auc, loss, _ = sess.run([model.auc, model.loss, model.train_op],</span><br><span class=\"line\">                                    &#123;model.u: u, model.input_seq: seq, model.pos: pos, model.neg: neg,</span><br><span class=\"line\">                                     model.is_training: <span class=\"literal\">True</span>&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> epoch % <span class=\"number\">20</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">            t1 = time.time() - t0</span><br><span class=\"line\">            T += t1</span><br><span class=\"line\">            <span class=\"built_in\">print</span> <span class=\"string\">&#x27;Evaluating&#x27;</span>,</span><br><span class=\"line\">            t_test = evaluate(model, dataset, args, sess)</span><br><span class=\"line\">            t_valid = evaluate_valid(model, dataset, args, sess)</span><br><span class=\"line\">            <span class=\"built_in\">print</span> <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">            <span class=\"built_in\">print</span> <span class=\"string\">&#x27;epoch:%d, time: %f(s), valid (NDCG@10: %.4f, HR@10: %.4f), test (NDCG@10: %.4f, HR@10: %.4f)&#x27;</span> % (</span><br><span class=\"line\">            epoch, T, t_valid[<span class=\"number\">0</span>], t_valid[<span class=\"number\">1</span>], t_test[<span class=\"number\">0</span>], t_test[<span class=\"number\">1</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">            f.write(<span class=\"built_in\">str</span>(t_valid) + <span class=\"string\">&#x27; &#x27;</span> + <span class=\"built_in\">str</span>(t_test) + <span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\">            f.flush()</span><br><span class=\"line\">            t0 = time.time()</span><br><span class=\"line\"><span class=\"keyword\">except</span>:</span><br><span class=\"line\">    sampler.close()</span><br><span class=\"line\">    f.close()</span><br><span class=\"line\">    exit(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">f.close()</span><br><span class=\"line\">sampler.close()</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;Done&quot;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"导入模块-3\"><a class=\"anchor\" href=\"#导入模块-3\">#</a> 导入模块</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"><span class=\"keyword\">import</span> argparse</span><br><span class=\"line\"><span class=\"keyword\">import</span> tensorflow <span class=\"keyword\">as</span> tf</span><br><span class=\"line\"><span class=\"keyword\">from</span> sampler <span class=\"keyword\">import</span> WarpSampler</span><br><span class=\"line\"><span class=\"keyword\">from</span> model <span class=\"keyword\">import</span> Model</span><br><span class=\"line\"><span class=\"keyword\">from</span> tqdm <span class=\"keyword\">import</span> tqdm</span><br><span class=\"line\"><span class=\"keyword\">from</span> util <span class=\"keyword\">import</span> *</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：导入所需的模块，包括系统模块、时间模块、参数解析模块、TensorFlow、数据采样器、模型、进度条显示模块和一些实用函数。</p>\n<h3 id=\"定义布尔类型的字符串转换函数-str2bool\"><a class=\"anchor\" href=\"#定义布尔类型的字符串转换函数-str2bool\">#</a> 定义布尔类型的字符串转换函数  <code>str2bool</code></h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">str2bool</span>(<span class=\"params\">s</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> s <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> &#123;<span class=\"string\">&#x27;False&#x27;</span>, <span class=\"string\">&#x27;True&#x27;</span>&#125;:</span><br><span class=\"line\">        <span class=\"keyword\">raise</span> ValueError(<span class=\"string\">&#x27;Not a valid boolean string&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s == <span class=\"string\">&#x27;True&#x27;</span></span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：将字符串转换为布尔值，如果字符串不是 'False' 或 'True'，则抛出异常。</p>\n<h3 id=\"参数解析器-argparse\"><a class=\"anchor\" href=\"#参数解析器-argparse\">#</a> 参数解析器  <code>argparse</code></h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">parser = argparse.ArgumentParser()</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--dataset&#x27;</span>, required=<span class=\"literal\">True</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--train_dir&#x27;</span>, required=<span class=\"literal\">True</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--batch_size&#x27;</span>, default=<span class=\"number\">128</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">int</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--lr&#x27;</span>, default=<span class=\"number\">0.001</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">float</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--maxlen&#x27;</span>, default=<span class=\"number\">50</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">int</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--hidden_units&#x27;</span>, default=<span class=\"number\">50</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">int</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--num_blocks&#x27;</span>, default=<span class=\"number\">2</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">int</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--num_epochs&#x27;</span>, default=<span class=\"number\">201</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">int</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--num_heads&#x27;</span>, default=<span class=\"number\">1</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">int</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--dropout_rate&#x27;</span>, default=<span class=\"number\">0.5</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">float</span>)</span><br><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--l2_emb&#x27;</span>, default=<span class=\"number\">0.0</span>, <span class=\"built_in\">type</span>=<span class=\"built_in\">float</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">args = parser.parse_args()</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：定义并解析命令行参数。</p>\n<ul>\n<li><code>--dataset</code> ：数据集名称，必选。</li>\n<li><code>--train_dir</code> ：训练目录，必选。</li>\n<li>其他参数有默认值，包括批量大小、学习率、最大序列长度、隐藏单元数、块数量、训练轮数、注意力头数量、dropout 率和 L2 正则化参数。</li>\n</ul>\n<h3 id=\"创建训练目录并保存参数\"><a class=\"anchor\" href=\"#创建训练目录并保存参数\">#</a> 创建训练目录并保存参数</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">not</span> os.path.isdir(args.dataset + <span class=\"string\">&#x27;_&#x27;</span> + args.train_dir):</span><br><span class=\"line\">    os.makedirs(args.dataset + <span class=\"string\">&#x27;_&#x27;</span> + args.train_dir)</span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(os.path.join(args.dataset + <span class=\"string\">&#x27;_&#x27;</span> + args.train_dir, <span class=\"string\">&#x27;args.txt&#x27;</span>), <span class=\"string\">&#x27;w&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">    f.write(<span class=\"string\">&#x27;\\n&#x27;</span>.join([<span class=\"built_in\">str</span>(k) + <span class=\"string\">&#x27;,&#x27;</span> + <span class=\"built_in\">str</span>(v) <span class=\"keyword\">for</span> k, v <span class=\"keyword\">in</span> <span class=\"built_in\">sorted</span>(<span class=\"built_in\">vars</span>(args).items(), key=<span class=\"keyword\">lambda</span> x: x[<span class=\"number\">0</span>])]))</span><br><span class=\"line\">f.close()</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：检查并创建训练目录，将解析的参数保存到 <code>args.txt</code>  文件中。</p>\n<h3 id=\"数据分割\"><a class=\"anchor\" href=\"#数据分割\">#</a> 数据分割</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataset = data_partition(args.dataset)</span><br><span class=\"line\">[user_train, user_valid, user_test, usernum, itemnum] = dataset</span><br><span class=\"line\">num_batch = <span class=\"built_in\">len</span>(user_train) / args.batch_size</span><br><span class=\"line\">cc = <span class=\"number\">0.0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> u <span class=\"keyword\">in</span> user_train:</span><br><span class=\"line\">    cc += <span class=\"built_in\">len</span>(user_train[u])</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;average sequence length: %.2f&#x27;</span> % (cc / <span class=\"built_in\">len</span>(user_train)))</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：调用数据分割函数 <code>data_partition</code> ，获取训练集、验证集、测试集、用户数量和物品数量。计算并打印平均序列长度。</p>\n<h3 id=\"tensorflow-会话配置\"><a class=\"anchor\" href=\"#tensorflow-会话配置\">#</a> TensorFlow 会话配置</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">f = <span class=\"built_in\">open</span>(os.path.join(args.dataset + <span class=\"string\">&#x27;_&#x27;</span> + args.train_dir, <span class=\"string\">&#x27;log.txt&#x27;</span>), <span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">config = tf.ConfigProto()</span><br><span class=\"line\">config.gpu_options.allow_growth = <span class=\"literal\">True</span></span><br><span class=\"line\">config.allow_soft_placement = <span class=\"literal\">True</span></span><br><span class=\"line\">sess = tf.Session(config=config)</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：打开日志文件 <code>log.txt</code> ，配置 TensorFlow 会话以允许 GPU 动态增长和软设备放置，并创建会话。</p>\n<h3 id=\"数据采样器和模型初始化\"><a class=\"anchor\" href=\"#数据采样器和模型初始化\">#</a> 数据采样器和模型初始化</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sampler = WarpSampler(user_train, usernum, itemnum, batch_size=args.batch_size, maxlen=args.maxlen, n_workers=<span class=\"number\">3</span>)</span><br><span class=\"line\">model = Model(usernum, itemnum, args)</span><br><span class=\"line\">sess.run(tf.initialize_all_variables())</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：初始化数据采样器 <code>WarpSampler</code>  和模型 <code>Model</code> ，并初始化所有 TensorFlow 变量。</p>\n<h3 id=\"训练过程\"><a class=\"anchor\" href=\"#训练过程\">#</a> 训练过程</h3>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">T = <span class=\"number\">0.0</span></span><br><span class=\"line\">t0 = time.time()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">try</span>:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> epoch <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, args.num_epochs + <span class=\"number\">1</span>):</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> step <span class=\"keyword\">in</span> tqdm(<span class=\"built_in\">range</span>(num_batch), total=num_batch, ncols=<span class=\"number\">70</span>, leave=<span class=\"literal\">False</span>, unit=<span class=\"string\">&#x27;b&#x27;</span>):</span><br><span class=\"line\">            u, seq, pos, neg = sampler.next_batch()</span><br><span class=\"line\">            auc, loss, _ = sess.run([model.auc, model.loss, model.train_op],</span><br><span class=\"line\">                                    &#123;model.u: u, model.input_seq: seq, model.pos: pos, model.neg: neg,</span><br><span class=\"line\">                                     model.is_training: <span class=\"literal\">True</span>&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> epoch % <span class=\"number\">20</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">            t1 = time.time() - t0</span><br><span class=\"line\">            T += t1</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Evaluating&#x27;</span>, end=<span class=\"string\">&#x27; &#x27;</span>)</span><br><span class=\"line\">            t_test = evaluate(model, dataset, args, sess)</span><br><span class=\"line\">            t_valid = evaluate_valid(model, dataset, args, sess)</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;epoch:%d, time: %f(s), valid (NDCG@10: %.4f, HR@10: %.4f), test (NDCG@10: %.4f, HR@10: %.4f)&#x27;</span> % (</span><br><span class=\"line\">            epoch, T, t_valid[<span class=\"number\">0</span>], t_valid[<span class=\"number\">1</span>], t_test[<span class=\"number\">0</span>], t_test[<span class=\"number\">1</span>]))</span><br><span class=\"line\"></span><br><span class=\"line\">            f.write(<span class=\"built_in\">str</span>(t_valid) + <span class=\"string\">&#x27; &#x27;</span> + <span class=\"built_in\">str</span>(t_test) + <span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\">            f.flush()</span><br><span class=\"line\">            t0 = time.time()</span><br><span class=\"line\"><span class=\"keyword\">except</span>:</span><br><span class=\"line\">    sampler.close()</span><br><span class=\"line\">    f.close()</span><br><span class=\"line\">    exit(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">f.close()</span><br><span class=\"line\">sampler.close()</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;Done&quot;</span>)</span><br></pre></td></tr></table></figure></p>\n<p><strong>作用</strong>：训练模型并在每 20 个 epoch 后评估模型性能。</p>\n<ul>\n<li>\n<p><strong>变量初始化</strong>：</p>\n<ul>\n<li><code>T</code> ：总时间。</li>\n<li><code>t0</code> ：当前时间。</li>\n</ul>\n</li>\n<li>\n<p><strong>训练循环</strong>：</p>\n<ul>\n<li>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">for</span> epoch <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">.</span>num_epochs <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>code￼<span class=\"token number\">69</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  ：迭代每个批次，使用</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>code￼<span class=\"token number\">70</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  显示进度条。</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token operator\">-</span> 调用`sampler<span class=\"token punctuation\">.</span>next_batch<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>`获取一个批次的数据（用户、序列、正样本、负样本）。</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token operator\">-</span> 调用`sess<span class=\"token punctuation\">.</span>run`运行模型的训练操作，并获取AUC和损失值。</pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li>\n<p><strong>评估模型</strong>：</p>\n<ul>\n<li>每 20 个 epoch 进行一次评估。\n<ul>\n<li>计算评估时间 <code>t1</code>  并累加到总时间 <code>T</code> 。</li>\n<li>调用 <code>evaluate</code>  和 <code>evaluate_valid</code>  函数评估模型在测试集和验证集上的性能。</li>\n<li>打印评估结果并写入日志文件。</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>异常处理和资源清理</strong>：</p>\n<ul>\n<li>使用 <code>try-except</code>  块捕捉异常，确保在异常发生时关闭采样器和日志文件。</li>\n<li>正常结束训练时，同样关闭采样器和日志文件，并打印 &quot;Done&quot;。</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h1>\n<h2 id=\"自注意力序列推荐\"><a class=\"anchor\" href=\"#自注意力序列推荐\">#</a> 自注意力序列推荐</h2>\n<h3 id=\"摘要\"><a class=\"anchor\" href=\"#摘要\">#</a> 摘要</h3>\n<ul>\n<li><strong>目标</strong>：在推荐系统中捕捉用户活动的序列动态，平衡马尔可夫链（MCs）和循环神经网络（RNNs）。</li>\n<li><strong>提出的模型</strong>：SASRec（自注意力序列推荐）使用自注意力机制，关注相关的过去行为来预测下一个物品。</li>\n<li><strong>性能</strong>：在稀疏和密集数据集上优于最先进的 MC/CNN/RNN 模型，并且效率更高。</li>\n</ul>\n<h3 id=\"引言\"><a class=\"anchor\" href=\"#引言\">#</a> 引言</h3>\n<ul>\n<li><strong>序列动态</strong>：现代推荐系统中，理解用户最近行为的上下文非常关键。</li>\n<li><strong>MCs vs RNNs</strong>：MCs 在处理稀疏数据时表现良好，但上下文范围有限；RNNs 能捕捉长期依赖，但需要密集数据。</li>\n<li><strong>SASRec</strong>：结合两者的优势，使用自注意力机制考虑相关的过去行为来预测未来行为。</li>\n</ul>\n<h3 id=\"方法\"><a class=\"anchor\" href=\"#方法\">#</a> 方法</h3>\n<h4 id=\"嵌入层-3\"><a class=\"anchor\" href=\"#嵌入层-3\">#</a> 嵌入层</h4>\n<ul>\n<li><strong>输入序列转换</strong>：将用户行为序列转换为固定长度序列，必要时使用填充。</li>\n<li><strong>物品嵌入矩阵</strong>：在潜在空间中表示物品。</li>\n<li><strong>位置嵌入</strong>：为物品嵌入添加位置信息，以考虑行为的顺序。</li>\n</ul>\n<h4 id=\"自注意力块\"><a class=\"anchor\" href=\"#自注意力块\">#</a> 自注意力块</h4>\n<ul>\n<li><strong>注意力机制</strong>：计算所有值的加权和，关注相关的过去行为。</li>\n<li><strong>自注意力层</strong>：使用相同的对象作为查询、键和值来捕捉依赖关系。</li>\n<li><strong>因果性</strong>：确保模型在预测下一个物品时只考虑过去的物品。</li>\n<li><strong>前馈网络</strong>：添加非线性，并考虑潜在维度之间的交互。</li>\n</ul>\n<h4 id=\"堆叠自注意力块-2\"><a class=\"anchor\" href=\"#堆叠自注意力块-2\">#</a> 堆叠自注意力块</h4>\n<ul>\n<li><strong>多块</strong>：堆叠多个自注意力块以捕捉复杂的物品转移。</li>\n<li><strong>残差连接、层归一化和 Dropout</strong>：防止过拟合并稳定训练。</li>\n</ul>\n<h4 id=\"预测层-2\"><a class=\"anchor\" href=\"#预测层-2\">#</a> 预测层</h4>\n<ul>\n<li><strong>MF 层</strong>：使用矩阵分解根据转换后的序列预测物品的相关性。</li>\n<li><strong>共享物品嵌入</strong>：通过使用单一的物品嵌入矩阵减少模型大小并防止过拟合。</li>\n</ul>\n<h4 id=\"网络训练\"><a class=\"anchor\" href=\"#网络训练\">#</a> 网络训练</h4>\n<ul>\n<li><strong>二元交叉熵损失</strong>：使用 Adam 优化器优化模型。</li>\n<li><strong>负采样</strong>：在训练过程中为每个正样本生成负样本。</li>\n</ul>\n<h4 id=\"复杂度分析\"><a class=\"anchor\" href=\"#复杂度分析\">#</a> 复杂度分析</h4>\n<ul>\n<li><strong>空间复杂度</strong>：相对于其他方法适中。</li>\n<li><strong>时间复杂度</strong>：由于自注意力层的可并行化，效率较高。</li>\n</ul>\n<h3 id=\"实验-2\"><a class=\"anchor\" href=\"#实验-2\">#</a> 实验</h3>\n<h4 id=\"数据集-2\"><a class=\"anchor\" href=\"#数据集-2\">#</a> 数据集</h4>\n<ul>\n<li><strong>Amazon、Steam、MovieLens</strong>：数据集在领域、平台和稀疏性方面各不相同。</li>\n</ul>\n<h4 id=\"比较方法\"><a class=\"anchor\" href=\"#比较方法\">#</a> 比较方法</h4>\n<ul>\n<li><strong>通用推荐方法</strong>：PopRec, BPR。</li>\n<li><strong>序列推荐方法</strong>：FMC, FPMC, TransRec。</li>\n<li><strong>基于深度学习的方法</strong>：GRU4Rec, GRU4Rec+, Caser。</li>\n</ul>\n<h4 id=\"实现细节\"><a class=\"anchor\" href=\"#实现细节\">#</a> 实现细节</h4>\n<ul>\n<li><strong>架构</strong>：使用两个自注意力块和共享物品嵌入。</li>\n<li><strong>优化</strong>：Adam 优化器，学习率 0.001，批量大小 128。</li>\n</ul>\n<h4 id=\"评估指标\"><a class=\"anchor\" href=\"#评估指标\">#</a> 评估指标</h4>\n<ul>\n<li><strong>Hit Rate@10 和 NDCG@10</strong>：评估推荐性能的指标。</li>\n</ul>\n<h3 id=\"结果\"><a class=\"anchor\" href=\"#结果\">#</a> 结果</h3>\n<ul>\n<li><strong>性能</strong>：SASRec 在稀疏和密集数据集上优于基线方法。</li>\n<li><strong>消融研究</strong>：分析架构中不同组件的影响。</li>\n<li><strong>训练效率和可扩展性</strong>：展示了更快的训练速度和对更长序列的可扩展性。</li>\n</ul>\n<h3 id=\"结论\"><a class=\"anchor\" href=\"#结论\">#</a> 结论</h3>\n<ul>\n<li><strong>SASRec</strong>：一个新颖的基于自注意力的模型，自适应地考虑用户行为进行预测，在性能和效率上优于最先进的方法。</li>\n<li><strong>未来工作</strong>：结合丰富的上下文信息和处理超长序列。</li>\n</ul>\n<h3 id=\"原理介绍\"><a class=\"anchor\" href=\"#原理介绍\">#</a> 原理介绍</h3>\n<ul>\n<li><strong>自注意力机制</strong>：通过计算查询、键和值之间的加权和，关注输入序列中的相关部分。与传统的 RNN 不同，自注意力机制能够并行处理所有时间步，使得模型能够高效地捕捉序列中的长距离依赖。</li>\n<li><strong>残差连接</strong>：在每个自注意力块中添加输入和输出之间的直接连接，有助于训练更深层的网络。</li>\n<li><strong>层归一化</strong>：对每一层的输出进行归一化处理，防止梯度消失和爆炸，提升模型的训练稳定性。</li>\n<li><strong>前馈网络</strong>：在每个自注意力块后添加一个全连接层，增加模型的非线性表示能力。</li>\n<li><strong>位置嵌入</strong>：为每个序列位置添加位置信息，使模型能够识别行为的顺序关系。</li>\n</ul>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        },
        {
            "id": "https://enjundu.github.io/misc/%E4%BC%8A%E8%97%A4%E5%BE%AE%E7%A7%AF%E5%88%86/",
            "url": "https://enjundu.github.io/misc/%E4%BC%8A%E8%97%A4%E5%BE%AE%E7%A7%AF%E5%88%86/",
            "title": "随机过程——运用伊藤微积分对布朗运动进行分析",
            "date_published": "2024-07-03T15:41:31.000Z",
            "content_html": "<p><code>随机过程</code> 作业，要求为：<strong>利用伊藤微积分来对某些物理过程进行描述与分析，学习伊藤微积分的应用</strong>。</p>\n<h1 id=\"利用伊藤微积分对某些物理过程进行描述与分析\"><a class=\"anchor\" href=\"#利用伊藤微积分对某些物理过程进行描述与分析\">#</a> 利用伊藤微积分对某些物理过程进行描述与分析</h1>\n<h2 id=\"内容摘要\"><a class=\"anchor\" href=\"#内容摘要\">#</a> 内容摘要</h2>\n<p>布朗运动是由英国植物学家罗伯特・布朗在 1827 年首次观察到的自然现象，通过伊藤微积分可以对其进行深入的数学描述和分析。本研究旨在利用伊藤微积分来描述和分析布朗运动的数学模型，探讨其在物理过程中的应用。具体而言，我们首先介绍了布朗运动的基础理论和随机过程的基本概念，然后详细阐述了伊藤微积分的基本原理及其在布朗运动中的应用。通过数值模拟和具体案例分析，我们展示了如何利用伊藤微积分来模拟和分析污染物在水中的扩散过程以及细胞内颗粒的运动。研究结果表明，伊藤微积分作为处理随机过程的有力工具，能够准确描述布朗运动的各种性质和特征，为进一步的研究奠定了基础。</p>\n<p><strong>关键词:</strong> 布朗运动，伊藤微积分，随机过程，扩散，数值模拟</p>\n<h2 id=\"abstract\"><a class=\"anchor\" href=\"#abstract\">#</a> ABSTRACT</h2>\n<p>Brownian motion, first observed by the British botanist Robert Brown in 1827, can be deeply described and analyzed mathematically using Itô calculus. This study aims to describe and analyze the mathematical model of Brownian motion using Itô calculus, exploring its application in physical processes. Specifically, we first introduce the fundamental theory of Brownian motion and the basic concepts of stochastic processes, then elaborate on the principles of Itô calculus and its application in Brownian motion. Through numerical simulations and specific case analyses, we demonstrate how Itô calculus can be used to simulate and analyze the diffusion of pollutants in water and the movement of particles within cells. The results show that Itô calculus, as a powerful tool for dealing with stochastic processes, can accurately describe various properties and characteristics of Brownian motion, laying a foundation for further research.</p>\n<p><strong>KEY WORDS:</strong> Brownian motion, Itô calculus, stochastic process, diffusion, numerical simulation</p>\n<h2 id=\"目录\"><a class=\"anchor\" href=\"#目录\">#</a> 目录</h2>\n<ol>\n<li><a href=\"#%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E7%9A%84%E5%9F%BA%E7%A1%80%E7%90%86%E8%AE%BA\">布朗运动的基础理论</a>\n<ol>\n<li><a href=\"#%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E7%9A%84%E5%AE%9A%E4%B9%89%E4%B8%8E%E5%9F%BA%E6%9C%AC%E6%80%A7%E8%B4%A8\">布朗运动的定义与基本性质</a></li>\n<li><a href=\"#%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E7%9A%84%E6%95%B0%E5%AD%A6%E6%8F%8F%E8%BF%B0\">布朗运动的数学描述</a></li>\n</ol>\n</li>\n<li><a href=\"#%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E4%B8%8E%E4%BC%8A%E8%97%A4%E5%BE%AE%E7%A7%AF%E5%88%86\">随机过程与伊藤微积分</a>\n<ol>\n<li><a href=\"#%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%AE%80%E4%BB%8B\">随机过程简介</a></li>\n<li><a href=\"#%E4%BC%8A%E8%97%A4%E5%BE%AE%E7%A7%AF%E5%88%86%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86\">伊藤微积分的基本原理</a></li>\n<li><a href=\"#%E4%BC%8A%E8%97%A4%E7%A7%AF%E5%88%86%E5%AE%9A%E4%B9%89\">伊藤积分定义</a></li>\n<li><a href=\"#%E4%BC%8A%E8%97%A4%E5%BC%95%E7%90%86%E7%9A%84%E6%8F%8F%E8%BF%B0\">伊藤引理的描述</a></li>\n</ol>\n</li>\n<li><a href=\"#%E5%88%A9%E7%94%A8%E4%BC%8A%E8%97%A4%E5%BE%AE%E7%A7%AF%E5%88%86%E5%AF%B9%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E7%9A%84%E5%88%86%E6%9E%90\">利用伊藤微积分对布朗运动的分析</a>\n<ol>\n<li><a href=\"#%E4%B8%80%E7%BB%B4%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E7%9A%84%E8%B7%AF%E5%BE%84%E6%80%A7%E8%B4%A8%E5%88%86%E6%9E%90\">一维布朗运动的路径性质分析</a></li>\n<li><a href=\"#%E5%A4%9A%E7%BB%B4%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E7%9A%84%E8%B7%AF%E5%BE%84%E6%80%A7%E8%B4%A8%E5%88%86%E6%9E%90\">多维布朗运动的路径性质分析</a></li>\n<li><a href=\"#%E5%85%B7%E4%BD%93%E5%BA%94%E7%94%A8%E5%88%86%E6%9E%90\">具体应用分析</a></li>\n</ol>\n</li>\n<li><a href=\"#%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E7%9A%84%E6%95%B0%E5%80%BC%E6%A8%A1%E6%8B%9F%E4%B8%8E%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90\">布朗运动的数值模拟与结果分析</a></li>\n<li><a href=\"#%E6%80%BB%E7%BB%93\">总结</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ol>\n<h2 id=\"布朗运动的基础理论\"><a class=\"anchor\" href=\"#布朗运动的基础理论\">#</a> 布朗运动的基础理论</h2>\n<h3 id=\"布朗运动的定义与基本性质\"><a class=\"anchor\" href=\"#布朗运动的定义与基本性质\">#</a> 布朗运动的定义与基本性质</h3>\n<p>布朗运动（Brownian motion）是指悬浮在液体或气体中的微小颗粒由于被周围分子的随机碰撞而产生的无规则运动。1827 年，英国植物学家罗伯特・布朗在显微镜下观察到悬浮在水中的花粉颗粒会进行持续不断的无规则运动。他最初认为这种运动可能是由于花粉的生命活动引起的。然而，他后来发现无生命的无机颗粒也表现出相同的运动现象，从而得出结论，这种运动并非源于生命活动，而是由外部因素引起的。这种运动具有以下几个重要特征：</p>\n<ul>\n<li><strong>随机性</strong>：布朗运动的路径是不可预测的，颗粒的运动是完全随机且无规律的。</li>\n<li><strong>连续性</strong>：布朗运动的轨迹是连续的，没有跳跃或中断，这意味着颗粒在任意两个时刻之间的位置变化是逐渐的。</li>\n<li><strong>独立性</strong>：布朗运动在不同时间间隔内的增量是相互独立的，即在非重叠时间区间内的位移相互独立。</li>\n<li><strong>正态分布</strong>：在任意给定时间间隔内，布朗运动的位移服从正态分布，其均值为零，方差与时间间隔成正比。</li>\n</ul>\n<p>布朗运动的这些特征使其成为随机过程的一个典型实例，为研究随机现象提供了重要的理论基础。</p>\n<h3 id=\"布朗运动的数学描述\"><a class=\"anchor\" href=\"#布朗运动的数学描述\">#</a> 布朗运动的数学描述</h3>\n<p>爱因斯坦在其著名的 1905 年论文中，通过对布朗运动的统计分析，推导出了微粒的均方位移与时间之间的关系。他的理论公式为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">⟨</mo><msup><mi>x</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">⟩</mo><mo>=</mo><mn>2</mn><mi>D</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">\\langle x^2(t) \\rangle = 2Dt\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mclose\">⟩</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\">t</span></span></span></span></span></p>\n<p>其中，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">⟨</mo><msup><mi>x</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">⟩</mo></mrow><annotation encoding=\"application/x-tex\">\\langle x^2(t) \\rangle</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mclose\">⟩</span></span></span></span> 表示粒子在时间间隔<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.61508em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span> 内的均方位移，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span> 是扩散系数。扩散系数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span> 与液体的温度、粘度以及微粒的半径有关，可以通过斯托克斯 - 爱因斯坦公式进行计算。</p>\n<p>布朗运动的数学描述基于随机过程的理论，其中威纳过程（Wiener process）是最常用的模型。威纳过程<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 是一个具有以下性质的随机过程：</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 为连续函数，其起始点为：<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">W(0)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span></li>\n<li>其独立增量为对于任意的<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>s</mi><mo>&lt;</mo><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">0 \\leq s &lt; t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78041em;vertical-align:-0.13597em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.61508em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>，增量<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>W</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W(t)-W(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span> 是独立的且服从均值为 0，方差为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>−</mo><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">t-s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69841em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span> 的正态分布。</li>\n</ul>\n<p>威纳过程是布朗运动的数学模型，通过它可以描述微粒在流体中的随机运动轨迹。根据伊藤微积分理论，布朗运动的随机微分方程可以表示为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>μ</mi><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mi>d</mi><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">dX(t) = \\mu dt + \\sigma dW(t)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>其中，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">X(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 表示布朗运动的位置，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span> 是漂移项，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span> 是扩散项，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 是威纳过程。</p>\n<h2 id=\"随机过程与伊藤微积分\"><a class=\"anchor\" href=\"#随机过程与伊藤微积分\">#</a> 随机过程与伊藤微积分</h2>\n<h3 id=\"随机过程简介\"><a class=\"anchor\" href=\"#随机过程简介\">#</a> 随机过程简介</h3>\n<p>随机过程（Stochastic Process）是描述系统随时间变化而表现出随机行为的数学模型。它在物理学、金融学、工程学等多个领域中有广泛应用。随机过程的基本概念包括状态空间 —— 随机过程可能的取值范围、时间参数 —— 描述随机过程随时间演变的参数，可以是离散的或连续的和随机变量序列 —— 随机过程在每个时间点的取值，这些取值是随机变量。威纳过程是常见的随机过程，布朗运动可以视为一种威纳过程。</p>\n<h3 id=\"伊藤微积分的基本原理\"><a class=\"anchor\" href=\"#伊藤微积分的基本原理\">#</a> 伊藤微积分的基本原理</h3>\n<p>伊藤微积分（Itô Calculus）是处理随机过程的数学工具，特别适用于描述包含随机噪声的系统。传统的微积分无法直接应用于随机过程，因为随机过程的路径通常是不光滑的，而伊藤微积分则提供了处理这类过程的方法。其核心概念包括伊藤积分 —— 处理随机过程中的积分问题，特别是随机过程与时间的乘积积分和伊藤定理 —— 随机过程的微分法则，类似于经典微积分中的链式法则，但适用于随机过程。</p>\n<h3 id=\"伊藤积分定义\"><a class=\"anchor\" href=\"#伊藤积分定义\">#</a> 伊藤积分定义</h3>\n<p>伊藤积分定义如下：设<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 是威纳过程，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 是依赖于时间的确定性函数，那么伊藤积分可以表示为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><mi>f</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mi>d</mi><mi>W</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\int_0^t f(s) dW(s)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.455406em;vertical-align:-0.9119499999999999em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5434560000000002em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129000000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119499999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>伊藤积分是线性和等距性的，即对常数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span> 和两个函数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> 和<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>，均有：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><mo stretchy=\"false\">(</mo><mi>c</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mi>d</mi><mi>W</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>c</mi><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><mi>f</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mi>d</mi><mi>W</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><mi>g</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mi>d</mi><mi>W</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\int_0^t (cf(s) + g(s)) dW(s) = c \\int_0^t f(s) dW(s) + \\int_0^t g(s) dW(s)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.455406em;vertical-align:-0.9119499999999999em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5434560000000002em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129000000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119499999999999em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.455406em;vertical-align:-0.9119499999999999em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5434560000000002em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129000000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119499999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.455406em;vertical-align:-0.9119499999999999em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5434560000000002em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129000000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119499999999999em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<h3 id=\"伊藤引理的描述\"><a class=\"anchor\" href=\"#伊藤引理的描述\">#</a> 伊藤引理的描述</h3>\n<p>伊藤引理是伊藤微积分中的重要工具，用于计算包含随机过程的复合函数的微分。设<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">X(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 是一个随机过程，其满足以下随机方程：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>μ</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo separator=\"true\">,</mo><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo separator=\"true\">,</mo><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mi>d</mi><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">dX(t) = \\mu(t, X(t)) dt + \\sigma(t, X(t)) dW(t)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>若<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo separator=\"true\">,</mo><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Y(t) = f(t, X(t))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span></span>，则<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Y(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 的微分为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>Y</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi>μ</mi><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>x</mi></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>σ</mi><mn>2</mn></msup><mfrac><mrow><msup><mi mathvariant=\"normal\">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>x</mi></mrow></mfrac><mi>d</mi><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">dY(t) = \\left( \\frac{\\partial f}{\\partial t} + \\mu \\frac{\\partial f}{\\partial x} + \\frac{1}{2} \\sigma^2 \\frac{\\partial^2 f}{\\partial x^2} \\right) dt + \\sigma \\frac{\\partial f}{\\partial x} dW(t)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.441138em;vertical-align:-0.95003em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714399999999998em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">t</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714399999999998em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.491108em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574399999999997em;vertical-align:-0.686em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714399999999998em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<h2 id=\"利用伊藤微积分对布朗运动的分析\"><a class=\"anchor\" href=\"#利用伊藤微积分对布朗运动的分析\">#</a> 利用伊藤微积分对布朗运动的分析</h2>\n<h3 id=\"一维布朗运动的路径性质分析\"><a class=\"anchor\" href=\"#一维布朗运动的路径性质分析\">#</a> 一维布朗运动的路径性质分析</h3>\n<p>利用伊藤微积分，我们可以深入分析一维布朗运动的路径性质。布朗运动的随机微分方程（SDE）为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>μ</mi><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mi>d</mi><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">dX(t) = \\mu dt + \\sigma dW(t)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>其中，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">X(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 表示布朗运动的位置，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span> 是漂移项，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span> 是扩散项，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 是标准威纳过程。</p>\n<p>根据伊藤引理，对于一个二次可微函数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo separator=\"true\">,</mo><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(t, X(t))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span></span></span></span>，其微分可以表示为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo separator=\"true\">,</mo><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi>μ</mi><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>x</mi></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>σ</mi><mn>2</mn></msup><mfrac><mrow><msup><mi mathvariant=\"normal\">∂</mi><mn>2</mn></msup><mi>f</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>x</mi></mrow></mfrac><mi>d</mi><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">df(t, X(t)) = \\left( \\frac{\\partial f}{\\partial t} + \\mu \\frac{\\partial f}{\\partial x} + \\frac{1}{2} \\sigma^2 \\frac{\\partial^2 f}{\\partial x^2} \\right) dt + \\sigma \\frac{\\partial f}{\\partial x} dW(t)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.441138em;vertical-align:-0.95003em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714399999999998em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">t</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714399999999998em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.491108em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574399999999997em;vertical-align:-0.686em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714399999999998em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>利用伊藤引理，我们可以对布朗运动的多种函数进行分析：</p>\n<p>考虑函数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>X</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">f(X) = X^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>，根据伊藤引理，其微分为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><mi>X</mi><mi>d</mi><mi>X</mi><mo>+</mo><mi>d</mi><mo stretchy=\"false\">⟨</mo><mi>X</mi><mo stretchy=\"false\">⟩</mo><mo>=</mo><mn>2</mn><mi>X</mi><mo stretchy=\"false\">(</mo><mi>μ</mi><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mi>d</mi><mi>W</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msup><mi>σ</mi><mn>2</mn></msup><mi>d</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">df(X) = 2X dX + d \\langle X \\rangle = 2X (\\mu dt + \\sigma dW) + \\sigma^2 dt\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">⟩</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">μ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span></span></span></span></span></p>\n<p>代入<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>，得到：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><msup><mi>X</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>X</mi><mi>μ</mi><mo>+</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo><mi>d</mi><mi>t</mi><mo>+</mo><mn>2</mn><mi>X</mi><mi>σ</mi><mi>d</mi><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">d(X^2) = (2X \\mu + \\sigma^2) dt + 2X \\sigma dW\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord mathnormal\">μ</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span></span></p>\n<p>这个公式表明，布朗运动的平方增量不仅依赖于时间增量，还依赖于威纳过程的增量。通过这个公式，我们可以分析布朗运动的方差和其他统计性质。</p>\n<h3 id=\"多维布朗运动的路径性质分析\"><a class=\"anchor\" href=\"#多维布朗运动的路径性质分析\">#</a> 多维布朗运动的路径性质分析</h3>\n<p>多维布朗运动是布朗运动在高维空间中的推广。设<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>W</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>W</mi><mi>n</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W_1(t), W_2(t), ..., W_n(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 是独立的标准布朗运动，则多维布朗运动的随机微分方程为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>μ</mi><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mi>d</mi><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">dX(t) = \\mu dt + \\sigma dW(t)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">X(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 是<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 维布朗运动的位置向量；<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span> 是<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 维漂移向量；<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span> 是<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 维扩散矩阵；<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span> 是<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 维威纳过程。</p>\n<p>利用伊藤引理，我们可以对多维布朗运动的函数进行类似于一维情况的分析。例如，考虑函数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">f(X) = X^T X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>，其微分为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>d</mi><mo stretchy=\"false\">(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><msup><mi>X</mi><mi>T</mi></msup><mi>d</mi><mi>X</mi><mo>+</mo><mi>d</mi><mo stretchy=\"false\">⟨</mo><mi>X</mi><mo stretchy=\"false\">⟩</mo></mrow><annotation encoding=\"application/x-tex\">df(X) = d(X^T X) = 2X^T dX + d \\langle X \\rangle\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413309999999999em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9746609999999999em;vertical-align:-0.08333em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">⟩</span></span></span></span></span></p>\n<p>代入<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">dX</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>，得到：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><msup><mi>X</mi><mi>T</mi></msup><mo stretchy=\"false\">(</mo><mi>μ</mi><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mi>d</mi><mi>W</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msup><mi>σ</mi><mi>T</mi></msup><mi>σ</mi><mi>d</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">df(X) = 2X^T (\\mu dt + \\sigma dW) + \\sigma^T \\sigma dt\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413309999999999em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">μ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8913309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span></span></span></span></span></p>\n<h3 id=\"具体应用分析\"><a class=\"anchor\" href=\"#具体应用分析\">#</a> 具体应用分析</h3>\n<h4 id=\"案例一利用伊藤微积分进行扩散过程分析\"><a class=\"anchor\" href=\"#案例一利用伊藤微积分进行扩散过程分析\">#</a> 案例一：利用伊藤微积分进行扩散过程分析</h4>\n<p>布朗运动可以用于描述扩散过程。例如，在一维空间中，污染物在水中的扩散可以通过布朗运动模型进行模拟。设污染物的浓度为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C(t, x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>，其扩散过程满足以下偏微分方程：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>D</mi><mfrac><mrow><msup><mi mathvariant=\"normal\">∂</mi><mn>2</mn></msup><mi>C</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{\\partial C}{\\partial t} = D \\frac{\\partial^2 C}{\\partial x^2}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.05744em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">t</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.177108em;vertical-align:-0.686em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.491108em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span> 为扩散系数。利用布朗运动的随机微分方程，可以模拟单个污染物粒子的轨迹，从而预测污染物在水中的扩散行为。具体步骤如下：</p>\n<ol>\n<li>设定初始条件<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">X(0) = x_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></li>\n<li>生成一系列标准正态分布的随机变量，模拟威纳过程<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></li>\n<li>利用欧拉 - 马里尤玛方法或其他数值方法求解随机微分方程，得到粒子轨迹</li>\n<li>统计模拟结果来得到污染物的浓度分布</li>\n</ol>\n<p>具体分析方法为：先根据实际情况确定扩散系数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span> 的值，然后设定初始浓度分布<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C(0, x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> 和边界条件，接着利用欧拉 - 马里尤玛方法进行数值模拟，求解随机微分方程，得到污染物粒子的运动轨迹，然后再对模拟结果进行统计分析，计算污染物的浓度分布<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C(t, x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>。最后将模拟结果与实验数据进行比较，验证模型的准确性。</p>\n<p>在这个案例中，伊藤微积分通过对随机微分方程的求解，模拟了污染物在水中的扩散过程。通过数值方法，我们能够预测污染物的浓度分布，并与实际数据进行比较，以验证模型的有效性。</p>\n<h4 id=\"案例二利用伊藤微积分进行生物学中的粒子运动分析\"><a class=\"anchor\" href=\"#案例二利用伊藤微积分进行生物学中的粒子运动分析\">#</a> 案例二：利用伊藤微积分进行生物学中的粒子运动分析</h4>\n<p>在细胞生物学中，细胞内颗粒的运动也可以通过布朗运动模型进行描述。利用伊藤微积分，可以分析这些颗粒的运动轨迹，研究其在细胞内的分布和动态变化。例如，设某种蛋白质在细胞质中的运动为布朗运动，可以利用随机微分方程分析其运动模式和分布特性。具体步骤如下：</p>\n<ol>\n<li>确定初始条件：设定初始位置<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">X(0) = x_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></li>\n<li>模拟威纳过程：生成一系列标准正态分布的随机变量，模拟威纳过程<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></li>\n<li>求解随机微分方程：利用数值方法求解随机微分方程，得到蛋白质的运动轨迹</li>\n<li>分析结果：统计模拟得到的轨迹，计算蛋白质的空间分布和运动特性</li>\n</ol>\n<p>在这个案例中，伊藤微积分通过对随机微分方程的求解，模拟了蛋白质在细胞质中的运动。通过数值方法，我们能够预测蛋白质的空间分布，并与实验数据进行比较，以验证模型的有效性。</p>\n<h2 id=\"布朗运动的数值模拟与结果分析\"><a class=\"anchor\" href=\"#布朗运动的数值模拟与结果分析\">#</a> 布朗运动的数值模拟与结果分析</h2>\n<p>在这一部分中，我们将展示如何通过数值模拟来研究布朗运动，并利用伊藤微积分对模拟结果进行分析。具体步骤如下：</p>\n<p>为了模拟布朗运动，我们可以使用欧拉 - 马里尤玛方法（Euler-Maruyama Method）。该方法是一种常用的数值解随机微分方程的算法，适用于模拟布朗运动的路径：</p>\n<p>布朗运动的随机微分方程为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>X</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>μ</mi><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mi>d</mi><mi>W</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">dX(t) = \\mu dt + \\sigma dW(t)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>我们可以将其离散化，即将时间区间<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>T</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0, T]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose\">]</span></span></span></span> 分为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 个小步长<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">t</span></span></span></span>，对于每一个时间步长<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">t</span></span></span></span>，布朗运动的数值解为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>X</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>X</mi><mi>n</mi></msub><mo>+</mo><mi>μ</mi><mi mathvariant=\"normal\">Δ</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mi mathvariant=\"normal\">Δ</mi><msub><mi>W</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">X_{n+1} = X_n + \\mu \\Delta t + \\sigma \\Delta W_n\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord\">Δ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>其中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><msub><mi>W</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\Delta W_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\">Δ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是独立同分布的标准正态随机变量，表示威纳过程的增量。</p>\n<p>我们设置初始值<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">X_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，然后通过迭代来生成布朗运动的路径。</p>\n<p>然后我们通过查阅资料设定布朗运动的漂移系数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span>，扩散系数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>、时间区间<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> 和步数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>。生成<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 个独立同分布的正态随机变量，用于模拟威纳过程的增量。</p>\n<p>接着我们使用代码求解，代码如下：</p>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 参数设置</span></span><br><span class=\"line\">mu = <span class=\"number\">0.1</span></span><br><span class=\"line\">sigma = <span class=\"number\">0.3</span></span><br><span class=\"line\">T = <span class=\"number\">1.0</span></span><br><span class=\"line\">N = <span class=\"number\">1000</span></span><br><span class=\"line\">dt = T / N</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始化</span></span><br><span class=\"line\">X = np.zeros(N + <span class=\"number\">1</span>)</span><br><span class=\"line\">X[<span class=\"number\">0</span>] = <span class=\"number\">0</span>  <span class=\"comment\"># 初始位置</span></span><br><span class=\"line\">W = np.random.normal(<span class=\"number\">0</span>, np.sqrt(dt), N)  <span class=\"comment\"># 生成威纳过程增量</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 数值求解</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> n <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, N + <span class=\"number\">1</span>):</span><br><span class=\"line\">    X[n] = X[n - <span class=\"number\">1</span>] + mu * dt + sigma * W[n - <span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制布朗运动路径</span></span><br><span class=\"line\">plt.plot(np.linspace(<span class=\"number\">0</span>, T, N + <span class=\"number\">1</span>), X)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Time&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;X(t)&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Simulated Brownian Motion Path&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算模拟路径的均值和方差</span></span><br><span class=\"line\">mean_X = np.mean(X)</span><br><span class=\"line\">var_X = np.var(X)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Simulated Mean: <span class=\"subst\">&#123;mean_X&#125;</span>, Theoretical Mean: <span class=\"subst\">&#123;mu * T&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Simulated Variance: <span class=\"subst\">&#123;var_X&#125;</span>, Theoretical Variance: <span class=\"subst\">&#123;sigma**<span class=\"number\">2</span> * T&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<p>根据布朗运动的理论，路径的均值应为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">\\mu T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>，方差应为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma^2 T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>。通过数值模拟结果，可以计算不同时间点的均值和方差，并与理论值比较。</p>\n<p>在多次模拟后，我们得到以下结果：</p>\n<h1 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h1>\n<p>本研究通过利用伊藤微积分对布朗运动进行了深入的描述和分析。具体来说，我们首先介绍了布朗运动的基础理论和随机过程的基本概念，然后详细阐述了伊藤微积分的基本原理及其在布朗运动中的应用。通过数值模拟和具体案例分析，我们展示了如何利用伊藤微积分来模拟和分析污染物在水中的扩散过程以及细胞内颗粒的运动。</p>\n<p>研究表明，伊藤微积分作为处理随机过程的有力工具，能够准确描述布朗运动的各种性质和特征。通过数值方法，我们验证了布朗运动的理论模型，并将其应用于实际问题的研究中，取得了良好的效果。</p>\n<h2 id=\"参考文献\"><a class=\"anchor\" href=\"#参考文献\">#</a> 参考文献</h2>\n<ol>\n<li>李旭东。浅谈 “随机过程” 课程教学改革与实践 [J]. 教育教学论坛，2019, (24): 67-68.</li>\n<li>王军霞。到达率随时间变化的队列模型及模拟仿真 [D]. 长安大学，2019.</li>\n<li>陈勇。复多重维纳 — 伊藤积分的乘法公式和独立性（英文） [J]. 数学进展，2017, 46 (06): 819-827.</li>\n<li>冉芳. Stratonovich 积分和 Itô 积分探讨比较分析 [J]. 九江学院学报 (自然科学版), 2014, 29 (01): 59-61. DOI:10.19717/j.cnki.jjun.2014.01.014.</li>\n<li>刘芳，葛芳晟。伊藤引理的证券投资组合简单建模 [J]. 科技信息，2014, (02): 56+60.</li>\n<li>马慧芸，韩宏。关于布朗运动的两类随机积分的比较 [J]. 甘肃联合大学学报 (自然科学版), 2010, 24 (05): 34-36+39. DOI:10.13804/j.cnki.2095-6991.2010.05.008.</li>\n</ol>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "homework"
            ]
        },
        {
            "id": "https://enjundu.github.io/bit/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/",
            "url": "https://enjundu.github.io/bit/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/",
            "title": "数据结构实验",
            "date_published": "2024-07-03T14:41:31.000Z",
            "content_html": "<h1 id=\"数据结构实验\"><a class=\"anchor\" href=\"#数据结构实验\">#</a> 数据结构实验</h1>\n<h2 id=\"实验要求\"><a class=\"anchor\" href=\"#实验要求\">#</a> 实验要求</h2>\n<h3 id=\"采用单向环表实现约瑟夫环\"><a class=\"anchor\" href=\"#采用单向环表实现约瑟夫环\">#</a> 采用单向环表实现约瑟夫环</h3>\n<ul>\n<li>从键盘输入整数 m，通过 create 函数生成一个具有 m 个结点的单向环表。环表中的结点编号依次为 1，2，……，m</li>\n<li>从键盘输入整数 s（1&lt;=s&lt;=m）和 n，从环表的第 s 个结点开始计数为 1，当计数到第 n 个结点时，输出该第 n 结点对应的编号，将该结点从环表中消除，从输出结点的下一个结点开始重新计数到 n，这样，不断进行计数，不断进行输出，直到输出了这个环表的全部结点为止</li>\n<li>例如，m=10，s=3，n=4。则输出序列为：6，10，4，9，5，2，1，3，8，7。</li>\n</ul>\n<h3 id=\"简单计算器\"><a class=\"anchor\" href=\"#简单计算器\">#</a> 简单计算器</h3>\n<p>请按照四则运算加、减、乘、除、幂（^）和括号的优先关系和惯例，编写计算器程序。要求</p>\n<ul>\n<li>\n<p>从键盘输入一个完整的表达式，以回车作为表达式输入结束的标志</p>\n</li>\n<li>\n<p>输入表达式中的数值均为大于等于零的整数。中间的计算过程如果出现小数也只取整</p>\n</li>\n<li>\n<p>例如，输入：4+2*5=\t\t\t\t输出：14</p>\n<p>输入：(4+2)*(2-10)=\t\t\t输出：-48</p>\n</li>\n</ul>\n<h3 id=\"遍历二叉树\"><a class=\"anchor\" href=\"#遍历二叉树\">#</a> 遍历二叉树</h3>\n<ul>\n<li>请输入一棵二叉树的扩展的前序序列，经过处理后生成一棵二叉树，然后对于该二叉树输出中序和后序遍历序列</li>\n<li>按层次遍历二叉树</li>\n</ul>\n<h3 id=\"排序算法\"><a class=\"anchor\" href=\"#排序算法\">#</a> 排序算法</h3>\n<p>输入 10 个数，编程实现插入排序、快速排序、选择排序三类算法</p>\n<h2 id=\"开始实验\"><a class=\"anchor\" href=\"#开始实验\">#</a> 开始实验</h2>\n<h4 id=\"实验一单向环表实现约瑟夫环\"><a class=\"anchor\" href=\"#实验一单向环表实现约瑟夫环\">#</a> 实验一：单向环表实现约瑟夫环</h4>\n<p><strong>代码</strong></p>\n<p><figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cpp复制代码<span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> data;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span>* next;</span><br><span class=\"line\">&#125; NODE;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">NODE* <span class=\"title\">create</span><span class=\"params\">(<span class=\"type\">int</span> m)</span> </span>&#123;</span><br><span class=\"line\">    NODE *head = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    NODE *p = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    NODE *q = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    head = (NODE*)<span class=\"built_in\">malloc</span>(<span class=\"built_in\">sizeof</span>(NODE));</span><br><span class=\"line\">    head-&gt;data = <span class=\"number\">1</span>;</span><br><span class=\"line\">    p = head;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>; i &lt;= m; i++) &#123;</span><br><span class=\"line\">        q = (NODE*)<span class=\"built_in\">malloc</span>(<span class=\"built_in\">sizeof</span>(NODE));</span><br><span class=\"line\">        q-&gt;data = i;</span><br><span class=\"line\">        p-&gt;next = q;</span><br><span class=\"line\">        p = q;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    p-&gt;next = head;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> head;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">josephus_circle</span><span class=\"params\">(NODE* head, <span class=\"type\">int</span> s, <span class=\"type\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    NODE *pre = head;</span><br><span class=\"line\">    NODE *p = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; s; i++) &#123;</span><br><span class=\"line\">        pre = pre-&gt;next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (pre-&gt;next != pre) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">            p = pre;</span><br><span class=\"line\">            pre = pre-&gt;next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, pre-&gt;data);</span><br><span class=\"line\">        p-&gt;next = pre-&gt;next;</span><br><span class=\"line\">        <span class=\"built_in\">free</span>(pre);</span><br><span class=\"line\">        pre = p-&gt;next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, pre-&gt;data);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(pre);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> m, s, n;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;请输入整数m：\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;m) != <span class=\"number\">1</span> || m &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;m输入错误——你应该输入大于零的自然数\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;请输入整数s\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;s) != <span class=\"number\">1</span> || s &lt; <span class=\"number\">1</span> || s &gt; m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;s输入错误，请输入在1~m间的整数s\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;请输入整数n\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;n) != <span class=\"number\">1</span> || n &lt; <span class=\"number\">1</span> || n &gt; m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;n输入错误，请输入在1~m间的整数n\\n&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    NODE *head = <span class=\"built_in\">create</span>(m);</span><br><span class=\"line\">    <span class=\"built_in\">josephus_circle</span>(head, s, n);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>文档</strong></p>\n<ul>\n<li>需求分析：实现一个单向环表，输入 m、s、n，按约瑟夫环规则输出节点编号。</li>\n<li>概要设计：创建节点结构，定义创建和输出函数。</li>\n<li>详细设计：详述了结构体、创建函数、输出函数及主函数的实现步骤。</li>\n<li>调试分析：处理无输出问题和头结点地址更改问题。</li>\n<li>测试结果：成功输出预期结果。</li>\n</ul>\n<hr />\n<h4 id=\"实验二简单计算器\"><a class=\"anchor\" href=\"#实验二简单计算器\">#</a> 实验二：简单计算器</h4>\n<p><strong>代码</strong></p>\n<p><figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cpp复制代码<span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdbool.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;math.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">char</span> *data;</span><br><span class=\"line\">    <span class=\"type\">int</span> size;</span><br><span class=\"line\">    <span class=\"type\">int</span> top;</span><br><span class=\"line\">&#125; Stack;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">initStack</span><span class=\"params\">(Stack *stack, <span class=\"type\">int</span> maxSize)</span> </span>&#123;</span><br><span class=\"line\">    stack-&gt;data = (<span class=\"type\">char</span> *)<span class=\"built_in\">malloc</span>(<span class=\"built_in\">sizeof</span>(<span class=\"type\">char</span>) * maxSize);</span><br><span class=\"line\">    stack-&gt;size = maxSize;</span><br><span class=\"line\">    stack-&gt;top = <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">push</span><span class=\"params\">(Stack *stack, <span class=\"type\">char</span> c)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (stack-&gt;top &lt; stack-&gt;size - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        stack-&gt;data[++stack-&gt;top] = c;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">char</span> <span class=\"title\">pop</span><span class=\"params\">(Stack *stack)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (stack-&gt;top &gt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> stack-&gt;data[stack-&gt;top--];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&#x27;\\0&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">isBalanced</span><span class=\"params\">(<span class=\"type\">char</span> *expression)</span> </span>&#123;</span><br><span class=\"line\">    Stack stack;</span><br><span class=\"line\">    <span class=\"built_in\">initStack</span>(&amp;stack, <span class=\"number\">100</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; expression[i] != <span class=\"string\">&#x27;\\0&#x27;</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"type\">char</span> currentChar = expression[i];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (currentChar == <span class=\"string\">&#x27;(&#x27;</span> || currentChar == <span class=\"string\">&#x27;[&#x27;</span> || currentChar == <span class=\"string\">&#x27;&#123;&#x27;</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">push</span>(&amp;stack, currentChar);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (currentChar == <span class=\"string\">&#x27;)&#x27;</span> || currentChar == <span class=\"string\">&#x27;]&#x27;</span> || currentChar == <span class=\"string\">&#x27;&#125;&#x27;</span>) &#123;</span><br><span class=\"line\">            <span class=\"type\">char</span> poppedChar = <span class=\"built_in\">pop</span>(&amp;stack);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((currentChar == <span class=\"string\">&#x27;)&#x27;</span> &amp;&amp; poppedChar != <span class=\"string\">&#x27;(&#x27;</span>) ||</span><br><span class=\"line\">                (currentChar == <span class=\"string\">&#x27;]&#x27;</span> &amp;&amp; poppedChar != <span class=\"string\">&#x27;[&#x27;</span>) ||</span><br><span class=\"line\">                (currentChar == <span class=\"string\">&#x27;&#125;&#x27;</span> &amp;&amp; poppedChar != <span class=\"string\">&#x27;&#123;&#x27;</span>)) &#123;</span><br><span class=\"line\">                <span class=\"built_in\">free</span>(stack.data);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(stack.data);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> stack.top == <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Priority</span><span class=\"params\">(<span class=\"type\">char</span> a)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">switch</span> (a) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;^&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">3</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;*&#x27;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;/&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;+&#x27;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;-&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">default</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">temporary_result</span><span class=\"params\">(<span class=\"type\">char</span> a, <span class=\"type\">int</span> b, <span class=\"type\">int</span> c)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">switch</span> (a) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;+&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> b + c;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;-&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> b - c;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;*&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> b * c;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;/&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> b / c;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"string\">&#x27;^&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">pow</span>(b, c);</span><br><span class=\"line\">        <span class=\"keyword\">default</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Code to implement the calculator logic</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>文档</strong></p>\n<ul>\n<li>需求分析：实现支持加减乘除、幂运算和括号优先级的简单计算器。</li>\n<li>概要设计：定义栈结构和基本操作函数，编写括号匹配、优先级比较和基本运算函数。</li>\n<li>详细设计：详细阐述了各函数的设计和实现，包括栈操作、括号匹配和基本运算。</li>\n<li>调试分析：解决括号匹配和优先级处理中的错误。</li>\n<li>测试结果：实现预期功能，正确处理表达式。</li>\n</ul>\n<hr />\n<h4 id=\"实验三二叉树遍历\"><a class=\"anchor\" href=\"#实验三二叉树遍历\">#</a> 实验三：二叉树遍历</h4>\n<p><strong>代码</strong></p>\n<p><figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cpp复制代码<span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">TreeNode</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> data;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">TreeNode</span>* left;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">TreeNode</span>* right;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">Number</span><span class=\"params\">(<span class=\"type\">char</span> *tree, <span class=\"type\">int</span>* index)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> number = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (tree[*index] &gt;= <span class=\"string\">&#x27;0&#x27;</span> &amp;&amp; tree[*index] &lt;= <span class=\"string\">&#x27;9&#x27;</span>) &#123;</span><br><span class=\"line\">        number = number * <span class=\"number\">10</span> + (tree[*index] - <span class=\"string\">&#x27;0&#x27;</span>);</span><br><span class=\"line\">        (*index)++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> number;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">TreeNode</span>* <span class=\"built_in\">BuildTree</span>(<span class=\"type\">char</span>* tree, <span class=\"type\">int</span>* index) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tree[*index] == <span class=\"string\">&#x27;\\0&#x27;</span> || tree[*index] == <span class=\"string\">&#x27;#&#x27;</span>) &#123;</span><br><span class=\"line\">        (*index)++;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">int</span> num = <span class=\"built_in\">Number</span>(tree, index);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">TreeNode</span>* root = (<span class=\"keyword\">struct</span> TreeNode*)<span class=\"built_in\">malloc</span>(<span class=\"built_in\">sizeof</span>(<span class=\"keyword\">struct</span> TreeNode));</span><br><span class=\"line\">    root-&gt;data = num;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (tree[*index] == <span class=\"string\">&#x27; &#x27;</span>) &#123;</span><br><span class=\"line\">        (*index)++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    root-&gt;left = <span class=\"built_in\">BuildTree</span>(tree, index);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (tree[*index] == <span class=\"string\">&#x27; &#x27;</span>) &#123;</span><br><span class=\"line\">        (*index)++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    root-&gt;right = <span class=\"built_in\">BuildTree</span>(tree, index);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (tree[*index] == <span class=\"string\">&#x27; &#x27;</span>) &#123;</span><br><span class=\"line\">        (*index)++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> root;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">midbianli</span><span class=\"params\">(<span class=\"keyword\">struct</span> TreeNode* root)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (root != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">midbianli</span>(root-&gt;left);</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, root-&gt;data);</span><br><span class=\"line\">        <span class=\"built_in\">midbianli</span>(root-&gt;right);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">lastbianli</span><span class=\"params\">(<span class=\"keyword\">struct</span> TreeNode* root)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (root != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">lastbianli</span>(root-&gt;left);</span><br><span class=\"line\">        <span class=\"built_in\">lastbianli</span>(root-&gt;right);</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, root-&gt;data);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">levelorderbianli</span><span class=\"params\">(<span class=\"keyword\">struct</span> TreeNode* root)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (root == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">TreeNode</span>* queue[<span class=\"number\">1000</span>];</span><br><span class=\"line\">    <span class=\"type\">int</span> a = <span class=\"number\">0</span>, b = <span class=\"number\">0</span>;</span><br><span class=\"line\">    queue[b++] = root;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (a &lt; b) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">struct</span> <span class=\"title class_\">TreeNode</span>* temp = queue[a++];</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, temp-&gt;data);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (temp-&gt;left != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">            queue[b++] = temp-&gt;left;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (temp-&gt;right != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">            queue[b++] = temp-&gt;right;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"type\">char</span> tree[<span class=\"number\">1000</span>];</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%[^\\n]&quot;</span>, tree);</span><br><span class=\"line\">    <span class=\"type\">int</span> index = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">TreeNode</span>* root = <span class=\"built_in\">BuildTree</span>(tree, &amp;index);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;中序遍历为：&quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">midbianli</span>(root);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;后序遍历为：&quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">lastbianli</span>(root);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;层次遍历为：&quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">levelorderbianli</span>(root);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>文档</strong></p>\n<ul>\n<li>需求分析：实现二叉树的扩展前序序列构建，并进行中序、后序和层次遍历。</li>\n<li>概要设计：定义二叉树节点结构和构建函数，实现不同遍历方法。</li>\n<li>详细设计：详细描述了二叉树的构建和遍历方法，包括中序、后序和层次遍历。</li>\n<li>调试分析：解决输入处理和节点构建中的问题。</li>\n<li>测试结果：成功实现二叉树遍历，输出预期结果。</li>\n</ul>\n<hr />\n<h4 id=\"实验四排序算法\"><a class=\"anchor\" href=\"#实验四排序算法\">#</a> 实验四：排序算法</h4>\n<p><strong>代码</strong></p>\n<p><figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cpp复制代码#<span class=\"keyword\">include</span> &lt;stdio.h&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> print(<span class=\"type\">int</span> arr[<span class=\"number\">10</span>], <span class=\"type\">int</span> n) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">        printf(&quot;%d &quot;, arr[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    printf(&quot;\\n&quot;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> InsertionSort(<span class=\"type\">int</span> arr[<span class=\"number\">10</span>], <span class=\"type\">int</span> n) &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> j, <span class=\"keyword\">temp</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">        j = i - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> k = i;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (k &gt;= <span class=\"number\">0</span> &amp;&amp; j &gt;= <span class=\"number\">0</span> &amp;&amp; arr[k] &lt; arr[j]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">temp</span> = arr[k];</span><br><span class=\"line\">            arr[k] = arr[j];</span><br><span class=\"line\">            arr[j] = <span class=\"keyword\">temp</span>;</span><br><span class=\"line\">            j<span class=\"comment\">--;</span></span><br><span class=\"line\">            k<span class=\"comment\">--;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> QuickSort(<span class=\"type\">int</span> arr[<span class=\"number\">10</span>], <span class=\"type\">int</span> l, <span class=\"type\">int</span> n) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l + <span class=\"number\">1</span> &gt; n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> first = l, last = n - <span class=\"number\">1</span>, key = arr[first];</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (first &lt; last) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (first &lt; last &amp;&amp; arr[last] &gt;= key) &#123;</span><br><span class=\"line\">            last<span class=\"comment\">--;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        arr[first] = arr[last];</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (first &lt; last &amp;&amp; arr[first] &lt; key) &#123;</span><br><span class=\"line\">            first++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        arr[last] = arr[first];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    arr[first] = key;</span><br><span class=\"line\">    QuickSort(arr, l, first);</span><br><span class=\"line\">    QuickSort(arr, first + <span class=\"number\">1</span>, n);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> SelectionSort(<span class=\"type\">int</span> arr[<span class=\"number\">10</span>], <span class=\"type\">int</span> n) &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"keyword\">temp</span>, k;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">temp</span> = i;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = i; j &lt; <span class=\"number\">10</span>; j++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (arr[<span class=\"keyword\">temp</span>] &gt; arr[j]) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">temp</span> = j;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        k = arr[i];</span><br><span class=\"line\">        arr[i] = arr[<span class=\"keyword\">temp</span>];</span><br><span class=\"line\">        arr[<span class=\"keyword\">temp</span>] = k;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> main() &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> arr1[<span class=\"number\">10</span>], arr2[<span class=\"number\">10</span>], arr3[<span class=\"number\">10</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">        scanf(&quot;%d&quot;, &amp;arr1[i]);</span><br><span class=\"line\">        arr2[i] = arr1[i];</span><br><span class=\"line\">        arr3[i] = arr1[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    InsertionSort(arr1, <span class=\"number\">10</span>);</span><br><span class=\"line\">    printf(&quot;插入排序为：&quot;);</span><br><span class=\"line\">    print(arr1, <span class=\"number\">10</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    QuickSort(arr2, <span class=\"number\">0</span>, <span class=\"number\">10</span>);</span><br><span class=\"line\">    printf(&quot;快速排序为:&quot;);</span><br><span class=\"line\">    print(arr2, <span class=\"number\">10</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    SelectionSort(arr3, <span class=\"number\">10</span>);</span><br><span class=\"line\">    printf(&quot;选择排序为：&quot;);</span><br><span class=\"line\">    print(arr3, <span class=\"number\">10</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>文档</strong></p>\n<ul>\n<li>需求分析：实现插入排序、快速排序和选择排序三种算法。</li>\n<li>概要设计：定义排序算法函数和打印函数。</li>\n<li>详细设计：详细描述了每种排序算法的实现步骤，包括插入排序、快速排序和选择排序。</li>\n<li>调试分析：解决选择排序中 temp 值指代错误的问题。</li>\n<li>测试结果：成功实现三种排序算法，输出预期结果。</li>\n</ul>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "homework"
            ]
        },
        {
            "id": "https://enjundu.github.io/misc/README/",
            "url": "https://enjundu.github.io/misc/README/",
            "title": "a_README",
            "date_published": "2024-07-03T14:41:31.000Z",
            "content_html": "<h2 id=\"本章节为笔者闲来无事所做的部分副业挣点外快\"><a class=\"anchor\" href=\"#本章节为笔者闲来无事所做的部分副业挣点外快\">#</a> 本章节为笔者闲来无事所做的部分副业（挣点外快）</h2>\n<p>若专业相关：联系 **<span class=\"exturl\" data-url=\"aHR0cHM6Ly9tYWlsLmdvb2dsZS5jb20v\">enjundu.cs@gmail.com</span>**</p>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "homework"
            ]
        },
        {
            "id": "https://enjundu.github.io/misc/%E5%93%88%E4%BD%9B%E5%A4%A7%E4%BD%9C%E4%B8%9A/",
            "url": "https://enjundu.github.io/misc/%E5%93%88%E4%BD%9B%E5%A4%A7%E4%BD%9C%E4%B8%9A/",
            "title": "哈佛数据库大作业",
            "date_published": "2024-07-03T14:41:31.000Z",
            "content_html": "<h1 id=\"本项目github仓库\"><a class=\"anchor\" href=\"#本项目github仓库\">#</a> 本项目 github 仓库：</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VuanVuRHUvSGFydmFyZC1EYXRhYmFzZS1EZXNpZ24tUHJvamVjdA==\">Harvard-Database-Design-Project</span></p>\n<h2 id=\"项目总结\"><a class=\"anchor\" href=\"#项目总结\">#</a> 项目总结</h2>\n<h3 id=\"项目概述\"><a class=\"anchor\" href=\"#项目概述\">#</a> 项目概述</h3>\n<p>本项目旨在设计和实现一个用于存储和分析全球 COVID-19 疫苗接种数据的数据库模型。数据集包括全球不同国家和地区的疫苗接种信息，并定期更新。为了完成数据库的概念模型设计，我们需要对所涉及的数据集进行详细分析，构建关系模式，并实现数据库结构。</p>\n<h3 id=\"项目要求\"><a class=\"anchor\" href=\"#项目要求\">#</a> 项目要求</h3>\n<ol>\n<li><strong>数据集概述</strong>：\n<ul>\n<li><strong>locations.csv</strong>: 包含国家名称及其使用的疫苗类型，每一行代表某一国家的最后一次观测。</li>\n<li><strong>us_state_vaccinations.csv</strong>: 包含美国各州的疫苗接种历史数据。</li>\n<li><strong>vaccinations-by-age-group.csv</strong>: 包含各国不同年龄组的疫苗接种历史数据。</li>\n<li><strong>vaccinations-by-manufacturer.csv</strong>: 包含各国使用的不同类型疫苗的历史数据。</li>\n<li><strong>vaccinations.csv</strong>: 包含全球各国的疫苗接种数据，每一行代表一个观测日期。</li>\n<li><strong>country_data/Wales.csv, Canada.csv, United States.csv, Denmark.csv</strong>: 包含这些国家的每日疫苗接种数据。</li>\n</ul>\n</li>\n<li><strong>数据库设计要求</strong>：\n<ul>\n<li>设计数据库的概念模型，确保符合第三范式 (3NF)。</li>\n<li>使用实体关系图 (ERD) 映射为数据库模式。</li>\n<li>完成数据库的标准化，消除数据冗余。</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"数据分析\"><a class=\"anchor\" href=\"#数据分析\">#</a> 数据分析</h3>\n<h4 id=\"数据集分析与关系确定\"><a class=\"anchor\" href=\"#数据集分析与关系确定\">#</a> 数据集分析与关系确定</h4>\n<ol>\n<li><strong>country_data</strong>：\n<ul>\n<li>包含属性： <code>location</code> ,  <code>date</code> ,  <code>vaccine</code> ,  <code>source_url</code> ,  <code>total_vaccinations</code> ,  <code>people_vaccinated</code> ,  <code>people_fully_vaccinated</code> ,  <code>total_boosters</code></li>\n<li>关系： <code>(location, date) -&gt; vaccine, source_url, total_vaccinations, people_vaccinated, people_fully_vaccinated, total_boosters</code></li>\n<li>进一步分析：存在推测关系  <code>total_vaccinations ≈ people_vaccinated + people_fully_vaccinated + total_boosters</code> ，验证后确定可以消除  <code>total_vaccinations</code> 。</li>\n</ul>\n</li>\n<li><strong>vaccinations-by-age-group</strong>：\n<ul>\n<li>包含属性： <code>location</code> ,  <code>date</code> ,  <code>age_group</code> ,  <code>people_vaccinated_per_hundred</code> ,  <code>people_fully_vaccinated_per_hundred</code> ,  <code>people_with_booster_per_hundred</code></li>\n<li>关系： <code>(location, date, age_group) -&gt; people_vaccinated_per_hundred, people_fully_vaccinated_per_hundred, people_with_booster_per_hundred</code></li>\n</ul>\n</li>\n<li><strong>vaccinations-by-manufacturer</strong>：\n<ul>\n<li>包含属性： <code>location</code> ,  <code>date</code> ,  <code>vaccine</code> ,  <code>total_vaccinations</code></li>\n<li>关系： <code>(location, date, vaccine) -&gt; total_vaccinations</code></li>\n</ul>\n</li>\n<li><strong>locations</strong>：\n<ul>\n<li>包含属性： <code>location</code> ,  <code>iso_code</code> ,  <code>vaccines</code> ,  <code>last_observation_date</code> ,  <code>source_name</code> ,  <code>source_website</code></li>\n<li>关系： <code>(location, last_observation_date) -&gt; vaccines, source_website</code>  和  <code>(source_website) -&gt; source_name</code></li>\n</ul>\n</li>\n<li><strong>vaccinations</strong>：\n<ul>\n<li>包含属性： <code>location</code> ,  <code>iso_code</code> ,  <code>total_vaccinations</code> ,  <code>people_vaccinated</code> ,  <code>people_fully_vaccinated</code> ,  <code>total_boosters</code> ,  <code>daily_vaccinations_raw</code> ,  <code>daily_vaccinations</code> ,  <code>date</code> ,  <code>total_vaccinations_per_hundred</code> ,  <code>people_vaccinated_per_hundred</code> ,  <code>people_fully_vaccinated_per_hundred</code> ,  <code>total_boosters_per_hundred</code> ,  <code>daily_vaccinations_per_million</code> ,  <code>daily_people_vaccinated</code> ,  <code>daily_people_vaccinated_per_hundred</code></li>\n<li>关系： <code>(location, date) -&gt; people_vaccinated, people_fully_vaccinated, total_boosters, daily_vaccinations, people_vaccinated_per_hundred, people_fully_vaccinated_per_hundred, total_boosters_per_hundred, daily_vaccinations_per_million, daily_people_vaccinated, daily_people_vaccinated_per_hundred</code></li>\n</ul>\n</li>\n<li><strong>us_state_vaccinations</strong>：\n<ul>\n<li>包含属性： <code>location</code> ,  <code>date</code> ,  <code>total_vaccinations</code> ,  <code>people_vaccinated</code> ,  <code>people_fully_vaccinated</code> ,  <code>total_boosters</code> ,  <code>daily_vaccinations_raw</code> ,  <code>daily_vaccinations</code> ,  <code>total_distributed</code> ,  <code>total_vaccinations_per_hundred</code> ,  <code>people_vaccinated_per_hundred</code> ,  <code>people_fully_vaccinated_per_hundred</code> ,  <code>total_boosters_per_hundred</code> ,  <code>share_doses_used</code> ,  <code>daily_people_vaccinated</code> ,  <code>distributed_per_hundred</code></li>\n<li>关系： <code>(location, date) -&gt; people_vaccinated, people_fully_vaccinated, total_boosters, daily_vaccinations, total_distributed, people_fully_vaccinated_per_hundred, total_boosters_per_hundred, share_doses_used, daily_people_vaccinated, people_vaccinated_per_hundred, distributed_per_hundred</code></li>\n</ul>\n</li>\n</ol>\n<h3 id=\"数据库实现\"><a class=\"anchor\" href=\"#数据库实现\">#</a> 数据库实现</h3>\n<h4 id=\"概念模型设计\"><a class=\"anchor\" href=\"#概念模型设计\">#</a> 概念模型设计</h4>\n<p>使用实体关系图 (ERD) 进行概念模型设计，将数据重要性与残缺程度较好的属性用黑色表示，其他属性存在较大分析困难度，用浅色表示。</p>\n<h4 id=\"数据库模式映射\"><a class=\"anchor\" href=\"#数据库模式映射\">#</a> 数据库模式映射</h4>\n<p>使用七步映射法 (7-step mapping process) 将 ERD 映射为数据库模式，创建以下表项：</p>\n<ol>\n<li>\n<p>Source_Website</p>\n<ul>\n<li>属性： <code>url (主键)</code> ,  <code>source_name</code></li>\n</ul>\n</li>\n<li>\n<p>Record_vaccine</p>\n<ul>\n<li>属性： <code>location (主键)</code> ,  <code>date (主键)</code> ,  <code>vaccine (主键)</code> ,  <code>total_vaccines</code></li>\n</ul>\n</li>\n<li>\n<p>Record_age</p>\n<ul>\n<li>属性： <code>location (主键)</code> ,  <code>date (主键)</code> ,  <code>age_group (主键)</code> ,  <code>people_vaccinated_per_hundred</code> ,  <code>people_fully_vaccinated_per_hundred</code> ,  <code>total_boosters_per_hundred</code></li>\n</ul>\n</li>\n<li>\n<p>Location_Data_Total</p>\n<ul>\n<li>属性： <code>location (主键)</code> ,  <code>date (主键)</code> ,  <code>vaccines</code> ,  <code>source_website (外键)</code> ,  <code>total_vaccination</code> ,  <code>total_distributed</code> ,  <code>share_doses_used</code></li>\n</ul>\n</li>\n<li>\n<p>Location_Data_non_total</p>\n<ul>\n<li>属性： <code>location (主键)</code> ,  <code>date (主键)</code> ,  <code>source_website (外键)</code> ,  <code>people_vaccinated</code> ,  <code>people_fully_vaccinated</code> ,  <code>total_boosters</code> ,  <code>daily_people_vaccinated</code> ,  <code>daily_vaccinations</code></li>\n</ul>\n</li>\n<li>\n<p>US_Location</p>\n<ul>\n<li>属性： <code>location (主键)</code></li>\n</ul>\n</li>\n<li>\n<p>ISO_Location</p>\n<ul>\n<li>属性： <code>location (主键)</code> ,  <code>iso_code</code></li>\n</ul>\n</li>\n<li>\n<p>Location_Data_Per</p>\n<ul>\n<li>属性： <code>location (主键)</code> ,  <code>date (主键)</code> ,  <code>daily_vaccinations_raw</code> ,  <code>total_vaccinations_per_hundred</code> ,  <code>people_vaccinated_per_hundred</code> ,  <code>people_fully_vaccinated_per_hundred</code> ,  <code>total_boosters_per_hundred</code> ,  <code>daily_vaccinations_per_million</code> ,  <code>daily_people_vaccinated_per_hundred</code> ,  <code>distributed_per_hundred</code></li>\n</ul>\n<h4 id=\"表结构的-sql-代码\"><a class=\"anchor\" href=\"#表结构的-sql-代码\">#</a> 表结构的 SQL 代码</h4>\n<p>以下是创建上述表的 SQL 代码示例：</p>\n<p><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> Source_Website (</span><br><span class=\"line\">    URL_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    NAME_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> Record_vaccine (</span><br><span class=\"line\">    LOCATION_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    DATE_ DATETIME <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    VACCINE <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    TOTAL_VACCINES <span class=\"type\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> Record_age (</span><br><span class=\"line\">    LOCATION_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    DATE_ DATETIME <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    AGE_GROUP <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    PEOPLE_VACCINATED_HUND <span class=\"type\">INT</span>,</span><br><span class=\"line\">    PEOPLE_FULLY_VACCINATED_HUND <span class=\"type\">INT</span>,</span><br><span class=\"line\">    TOTAL_BOOSTERS_HUND <span class=\"type\">INT</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> Location_Data_Total (</span><br><span class=\"line\">    LOCATION_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    DATE_ DATETIME <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    VACCINES <span class=\"type\">VARCHAR</span>(<span class=\"number\">200</span>),</span><br><span class=\"line\">    SOURCE_WEBSITE <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    TOTAL_VACCINATION <span class=\"type\">INT</span>,</span><br><span class=\"line\">    TOTAL_DISTRIBUTED <span class=\"type\">INT</span>,</span><br><span class=\"line\">    SHARE_DOSES_USED <span class=\"type\">INT</span>,</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (SOURCE_WEBSITE) <span class=\"keyword\">REFERENCES</span> Source_Website(URL_)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> Location_Data_non_total (</span><br><span class=\"line\">    LOCATION_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    DATE_ DATETIME <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    SOURCE_WEBSITE <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    PEOPLE_VACCINATED <span class=\"type\">INT</span>,</span><br><span class=\"line\">    PEOPLE_FULLY_VACCINATED <span class=\"type\">INT</span>,</span><br><span class=\"line\">    TOTAL_BOOSTERS <span class=\"type\">INT</span>,</span><br><span class=\"line\">    DAILY_PEOPLE_VACCINATED <span class=\"type\">INT</span>,</span><br><span class=\"line\">    DAILY_VACCINATIONS <span class=\"type\">INT</span>,</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (SOURCE_WEBSITE) <span class=\"keyword\">REFERENCES</span> Source_Website(URL_)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> US_Location (</span><br><span class=\"line\">    LOCATION_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">PRIMARY</span> KEY</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> ISO_Location (</span><br><span class=\"line\">    LOCATION_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    ISO_CODE <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> Location_Data_Per (</span><br><span class=\"line\">    LOCATION_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    DATE_ DATETIME <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    DAILY_VACCINATIONS_RAW <span class=\"type\">INT</span>,</span><br><span class=\"line\">    TOTAL_VACCINATIONS_PER_HUNDRED <span class=\"type\">FLOAT</span>,</span><br><span class=\"line\">    PEOPLE_VACCINATED_PER_HUNDRED <span class=\"type\">FLOAT</span>,</span><br><span class=\"line\">    PEOPLE_FULLY_VACCINATED_PERHUNDRED <span class=\"type\">FLOAT</span>,</span><br><span class=\"line\">    TOTAL_BOOSTERS_PER_HUNDRED <span class=\"type\">FLOAT</span>,</span><br><span class=\"line\">    DAILY_VACCINATIONS_PER_MILION <span class=\"type\">INT</span>,</span><br><span class=\"line\">    DAILY_PEOPLE_VACCINATED_PER_HUNDRED <span class=\"type\">FLOAT</span>,</span><br><span class=\"line\">    DISTRIBUTED_PER_HUNDRED <span class=\"type\">FLOAT</span></span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"数据库标准化\"><a class=\"anchor\" href=\"#数据库标准化\">#</a> 数据库标准化</h3>\n<p>通过分析各表的属性关系，消除了冗余，确保所有表格均满足第三范式 (3NF)，以提高数据存储和查询的效率。</p>\n<h3 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h3>\n<p>本项目通过详细的数据分析与设计，构建了一个规范化的数据库模型，用于全球 COVID-19 疫苗接种数据的存储和分析。通过 ERD 设计与数据库模式映射，成功实现了数据的高效存储和查询。标准化过程有效地消除了数据冗余，提高了数据库的性能和可维护性。项目最终成果满足了所有设计要求，确保了数据的完整性和一致性。</p>\n</li>\n</ol>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "homework"
            ]
        },
        {
            "id": "https://enjundu.github.io/misc/%E8%A5%BF%E6%96%B9%E9%9F%B3%E4%B9%90%E5%8F%B2/",
            "url": "https://enjundu.github.io/misc/%E8%A5%BF%E6%96%B9%E9%9F%B3%E4%B9%90%E5%8F%B2/",
            "title": "迈克尔杰克逊对西方流行文化的多重影响",
            "date_published": "2024-07-03T14:41:31.000Z",
            "content_html": "<h1 id=\"迈克尔杰克逊对西方流行文化的多重影响\"><a class=\"anchor\" href=\"#迈克尔杰克逊对西方流行文化的多重影响\">#</a> <strong>迈克尔杰克逊对西方流行文化的多重影响</strong></h1>\n<p>** 摘要：** 本文深入探讨了迈克尔・杰克逊对西方流行文化的多重影响，聚焦于音乐、服装、电影和唱片设计等方向。在音乐方向，杰克逊以其独特音乐风格和社会问题歌曲的创作展现了对音乐的卓越贡献。在服装方向，他的独特着装风格成为流行文化的标志，超越时尚，成为他个人品牌的一部分。在电影方向，杰克逊通过角色表演和视觉效果的创新，将音乐与电影完美结合，为观众呈现出丰富多彩的艺术体验。在唱片设计方向，他的专辑封面设计不仅注重艺术性，还与音乐内容相得益彰，改变了唱片设计的标准，对整个音乐产业产生了深远影响。通过对这些方面的综合分析，本文旨在全面展示迈克尔・杰克逊在多个艺术领域的独特贡献及其对流行文化的深远影响。</p>\n<p>** 关键词：** 迈克尔・杰克逊，西方流行文化，音乐创新，服装风格，电影艺术，唱片设计，社会问题歌曲，视觉效果，流行文化影响，艺术多元性。</p>\n<h2 id=\"一-引言\"><a class=\"anchor\" href=\"#一-引言\">#</a> <strong>一、引言</strong></h2>\n<p>迈克尔・杰克逊（Michael Jackson）是 20 世纪最具影响力的音乐巨星之一，他的才华和创新不仅塑造了流行音乐的面貌，而且深刻地影响了西方流行文化的多个方面。杰克逊不仅以其卓越的音乐天赋著称，更以他独特的舞台表演风格、引领潮流的服装品味、深刻的音乐录影带和创新的唱片设计成为流行文化的象征。</p>\n<p>本论文旨在深入探讨迈克尔・杰克逊对西方流行文化的多重影响，着重分析他在音乐、服装、电影和唱片设计等方向上的独特贡献。通过对杰克逊生平和艺术作品的深入研究，我们将揭示他如何推动了流行文化的发展，塑造了一个新时代的艺术风格和审美标准。从早期的音乐成就到舞台上的惊人表演，再到对时尚的敏锐洞察和在电影领域的突破性贡献，迈克尔・杰克逊在多个领域都留下了不可磨灭的印记。通过对这些方面的深入分析，我们将更好地理解他是如何成为一位文化偶像，以及他对当代西方社会所产生的深远影响。</p>\n<p>通过本论文的研究，我们旨在为读者呈现迈克尔・杰克逊这位传奇艺术家对流行文化的独特贡献，强调他的影响力如何超越了音乐本身，扩展到服装、电影和唱片设计等多个艺术领域。迈克尔・杰克逊不仅是一位音乐天才，更是一位深刻影响并塑造了整个时代的文化图腾。</p>\n<h2 id=\"二-迈克尔杰克逊对西方音乐文化的影响\"><a class=\"anchor\" href=\"#二-迈克尔杰克逊对西方音乐文化的影响\">#</a> 二、** 迈克尔・杰克逊 **** 对西方音乐文化的影响</h2>\n<h3 id=\"一音乐风格的演进\"><a class=\"anchor\" href=\"#一音乐风格的演进\">#</a> （一）<strong>音乐风格的演进</strong></h3>\n<p>迈克尔杰克逊拥有举世罕见的艺术才华，他与众不同的嗓音、独创的舞步和浑身洋溢的明星魅力使他从幼年便崭露头角，并最终获得全世界的赞誉，以至连美国总统奥巴马在接受美联社采访时都这么讲:“迈克尔杰克逊作为一个最伟大的艺术家，他的名字应该被载入史册。我是听着他的歌曲长大的。”[1 ]</p>\n<p>迈克尔杰克逊的音乐风格随着年龄的增长也在变化，下面我们来回顾一下他的成长历程：</p>\n<p>迈克尔・杰克逊的音乐生涯始于他童年时期作为杰克逊五兄弟团队的一员。早在年幼时，他就展现出惊人的音乐才华。其参与创作和演唱的歌曲，如《I Want You Back》和《ABC》等，迅速攀升至音乐榜单之巅。这一时期的音乐作品不仅为他赢得了赞誉，也奠定了他在音乐历史上的地位。杰克逊的音乐风格演进至 20 世纪 80 年代，尤以《Thriller》（1982）为代表，该专辑成为史上销量最高的音乐专辑之一。《Thriller》融合了流行、摇滚、放克和灵魂等多种音乐元素，突破了流派的界限。[2] 他对音乐的创新和风格的多元融合使他成为当时音乐界的领军人物，开创了流行音乐的新篇章。</p>\n<h3 id=\"二音乐录影带对流行文化的塑造\"><a class=\"anchor\" href=\"#二音乐录影带对流行文化的塑造\">#</a> （二）<strong>音乐录影带对流行文化的塑造</strong></h3>\n<p>杰克逊对音乐录影带的贡献无法低估。尤其是 1983 年发布的《Thriller》音乐录影带，成为音乐视频制作的里程碑。“疯狂” 获得了巨大的成功，一跃成为当时销量最高的唱片。迈克尔・杰克逊在专辑中所使用的音乐处理手法很快被其他艺人效仿借鉴，但在当时的美国流行音乐界，来自黑人艺术家的作品想要不受种族因素的影响而获得普遍的、带有白人化的、欧 - 美型音乐产业界承认是十分难的，种族歧视在这一领域依旧很严重。带着对这种政治现实的不服与愤怒，迈克尔・杰克逊继续了下一张个人专辑 “颤栗” 的创作。在 “颤栗” 这张专辑当中，他涉及了比 “疯狂” 更加广泛的类别范围，并且正式进军了以白人为主的硬摇滚流派，他并不是为了迎合白人听众，而是要将音乐的藩篱再一次打破，使他们无法再忽视。[3] 由导演约翰・兰道斯执导的这部短片不仅仅是一段音乐录影带，更是一部拥有独立叙事和视觉效果的艺术作品。其精彩的舞蹈场面和电影般的叙事深刻地改变了音乐录影带的制作标准，使其成为流行文化中一种独特的艺术形式。</p>\n<h3 id=\"三迈克尔杰克逊音乐的社会影响\"><a class=\"anchor\" href=\"#三迈克尔杰克逊音乐的社会影响\">#</a> （三）<strong>迈克尔杰克逊音乐的社会影响</strong></h3>\n<p>杰克逊通过他的音乐创作，特别是社会问题歌曲的创作，成为社会改革的倡导者。歌曲如《Man in the Mirror》和《Heal the World》传达了他对全球社会问题的深刻关切。这些歌曲不仅引导着人们反思社会不公和环境问题，更激励着人们积极参与社会变革。通过音乐的力量，杰克逊超越了娱乐的范畴，将关注焦点引向社会问题，为流行音乐注入了社会责任感。</p>\n<p>杰克逊通过他的歌词和音乐中传达了对多个社会问题的观点。无论是对种族平等、反对贫困，还是对爱与和平的呼吁，他的音乐成为了一个表达社会观点和激发社会意识的平台。这种社会观点的表达方式超越了音乐的框架，深刻地影响了他的粉丝和整个社会，使人们在音乐的美妙旋律中感受到了社会的温暖和力量。</p>\n<h2 id=\"三-迈克尔杰克逊在服装方向对西方流行文化的影响\"><a class=\"anchor\" href=\"#三-迈克尔杰克逊在服装方向对西方流行文化的影响\">#</a> 三、<strong>迈克尔杰克逊在服装方向对西方流行文化的影响</strong></h2>\n<h3 id=\"一时尚与个性层面\"><a class=\"anchor\" href=\"#一时尚与个性层面\">#</a> （一）<strong>时尚与个性层面</strong></h3>\n<p>杰克逊的独特着装风格 —— 迈克尔・杰克逊以他独具特色的着装风格在时尚界留下了深刻的印记。无论是舞台表演、音乐录影带还是公共场合，他的穿着都呈现出前卫、大胆和充满个性的一面。从经典的红色皮夹克到闪耀的手套，再到他独特的帽子和鞋履选择，杰克逊的每一套服装都是一个艺术品，突显了他对时尚的独特理解和敏锐的审美眼光。</p>\n<p>服装成为其个人品牌的一部分 —— 杰克逊的服装选择不仅仅是一种时尚陈述，更是他个人品牌的核心元素之一。他通过引人注目的服装，成功地将自己的个性与音乐才华相结合，创造出了一个独一无二的形象。每一次公开露面，他的着装都传达出一种与众不同、引人瞩目的形象，使之成为他音乐事业成功背后的标志性特征。他通过对服装的设计，创造了一种独特的神秘感，并被世界认可。在当今的流行文化中，有着诸多迈克尔杰克逊风格的影子，例如富有华丽装饰的军装剪裁夹克、未来主义的金属紧身衣、华丽闪耀的水钻装饰元素..... . 可以说，迈克尔杰克逊正在以 - 种潜移默化的方式存在于这个世界之中，同时他的时尚理念，及其整体的美学思想也作为无形的遗产留存。[4]</p>\n<h3 id=\"二影响服装的时尚产业\"><a class=\"anchor\" href=\"#二影响服装的时尚产业\">#</a> （二）<strong>影响服装的时尚产业</strong></h3>\n<p>服装设计师对杰克逊风格的借鉴 —— 迈克尔・杰克逊的时尚风格不仅在音乐领域引起了轰动，同时也深刻地影响了时尚产业。众多服装设计师纷纷借鉴他的独特风格，将其标志性的元素融入到自己的设计中。无论是流行的军装外套、白手套，还是独特的鞋履设计，这些元素都成为时尚舞台上的亮点，体现了杰克逊时尚传承的力量。</p>\n<p>杰克逊时尚在流行文化中的延续 —— 杰克逊的时尚影响力不仅在他的时代得到认可，而且在流行文化中持续传承。许多艺人、时尚达人和影响力人物仍然受到他的启发，致敬他的着装风格，并将其重新演绎为当代的时尚趋势。这种延续性证明了杰克逊在时尚领域所创造的独特形象对流行文化的持久影响。</p>\n<h2 id=\"四-迈克尔杰克逊在电影方向做出的贡献与影响\"><a class=\"anchor\" href=\"#四-迈克尔杰克逊在电影方向做出的贡献与影响\">#</a> 四、<strong>迈克尔杰克逊在电影方向做出的贡献与影响</strong></h2>\n<h3 id=\"一实现电影作品的突破\"><a class=\"anchor\" href=\"#一实现电影作品的突破\">#</a> （一）<strong>实现电影作品的突破</strong></h3>\n<p>迈克尔・杰克逊在电影中的表演突显了他作为一位全方位艺术家的多才多艺。其中，他的主演电影如《The Wiz》（1978）和《Moonwalker》（1988）展示了他在电影领域的独特表现。在《The Wiz》中，杰克逊以其独特的才华和对音乐的诠释，重新演绎了经典的《绿野仙踪》故事，赢得了观众的赞誉。而《Moonwalker》则通过一系列音乐视频和故事片段，深入展示了他的音乐和舞蹈艺术。</p>\n<p>杰克逊通过电影作品成功地将他的音乐与视觉表现相结合，为观众呈现了更加丰富和多样的艺术体验。这种电影与音乐的结合不仅拓展了他的艺术创作领域，也为他的音乐事业注入了新的活力。电影作品为他提供了一个表达自己创意的平台，让观众能够更深入地理解他音乐背后的故事。</p>\n<h3 id=\"二在电影的视觉效果和艺术效果上做出创新\"><a class=\"anchor\" href=\"#二在电影的视觉效果和艺术效果上做出创新\">#</a> （二）<strong>在电影的视觉效果和艺术效果上做出创新</strong></h3>\n<p>杰克逊在音乐录影带方面的创新性为整个音乐视频制作领域树立了标杆。特别是《Thriller》音乐录影带，首次采用 33 毫米的电影胶片拍摄，迈克尔成为了先锋音乐领域里的 “卓别林”。</p>\n<p>学者朱羽君曾论述:“音乐电视通过状态，通过眼神，通过人与人之间行为的碰撞、交流，通过流动、剪辑，在短短几分钟内把音乐要表达的思想、情感、情绪和意思充分表达出来，是一种现代的艺术语言和样式”。在杰克逊的 MV 中也有后现代的意味，“镜像” 和 “破碎” 是后工业时代人们的基本生存感受反应。意象性、表现性的画面语言，渲染、烘托了音乐语言的思想意念，加强音乐语言的艺术表现力和艺术冲击力，既沿袭了恐怖电影的叙事思路和表演风格，又区别于恐怖电影。[5]</p>\n<p>杰克逊通过对音乐录影带和电影的制作过程中引入前卫的技术手法，对整个电影制作技术产生了深远的影响。他推动了音乐视频制作技术的发展，包括特效、剪辑技巧以及故事叙事的创新。这些技术创新不仅在他的作品中得以展示，同时也为后来的导演和制片人提供了启示，影响了整个电影行业对于艺术表达和视觉效果的理解。</p>\n<h2 id=\"五-唱片设计方向\"><a class=\"anchor\" href=\"#五-唱片设计方向\">#</a> 五、<strong>唱片设计方向</strong></h2>\n<h3 id=\"一专辑封面的艺术性\"><a class=\"anchor\" href=\"#一专辑封面的艺术性\">#</a> （一）<strong>专辑封面的艺术性</strong></h3>\n<p>封面设计的风格和创新 —— 迈克尔・杰克逊的专辑封面设计展示了他对艺术性和创新的深刻理解。每一张封面都不仅仅是一张包装，更是一件艺术品。他的专辑封面设计风格独特，融合了摄影、绘画和图形设计等多种艺术元素。例如，《Thriller》专辑封面以其独特的视觉效果和设计手法，成为音乐史上最著名的封面之一。杰克逊通过封面设计向观众传达了他对音乐的独特理解和创意表达。</p>\n<p>封面与音乐内容的关联 —— 杰克逊巧妙地将封面设计与音乐内容紧密关联，创造了一种视听的统一。每一张封面都传达了专辑中音乐的情感和主题，使其成为音乐故事的一部分。这种关联性增强了观众对整个音乐作品的理解，封面不仅仅是外观，更是音乐体验的一部分。</p>\n<h3 id=\"二影响整个唱片市场\"><a class=\"anchor\" href=\"#二影响整个唱片市场\">#</a> （二）<strong>影响整个唱片市场</strong></h3>\n<p>迈克尔・杰克逊的唱片销量与其独特的唱片设计风格密不可分。他的专辑封面和整体唱片设计成为吸引观众的关键因素之一。杰克逊通过视觉上引人注目的唱片设计，成功地吸引了更多的购买者，推动了他的专辑在市场上的销售。这种关系不仅在他的个人音乐事业中显著，也对整个唱片市场的发展产生了积极的影响。</p>\n<p>迈克尔・杰克逊的唱片设计标准的改变体现在他对创新和艺术性的追求。他不仅仅满足于传统的唱片包装形式，而是通过引入先进的设计概念，推动了唱片设计的标准。他的作品不仅在视觉上引人注目，更激发了其他艺术家和设计师对唱片包装创新的热情。这种改变不仅影响了唱片设计的审美标准，也对整个音乐产业的品牌建设和市场竞争产生了深远的影响。</p>\n<h2 id=\"六-四维一体总结迈克尔杰克逊对西方流行文化的影响\"><a class=\"anchor\" href=\"#六-四维一体总结迈克尔杰克逊对西方流行文化的影响\">#</a> 六、<strong>四维一体总结迈克尔杰克逊对西方流行文化的影响</strong></h2>\n<p>迈克尔・杰克逊以其多重艺术天赋和卓越成就，深刻地塑造并影响了西方流行文化。通过其在音乐、舞蹈、时尚、电影和唱片设计等多个领域的独特贡献，他成为一位文化偶像，其影响超越了他个人的音乐事业。</p>\n<p>音乐方向： 杰克逊通过创新的音乐风格和深刻的歌词，不仅塑造了自己作为音乐天才的形象，还通过社会问题歌曲表达了对世界的关切，使其音乐超越娱乐本身，成为社会变革的声音。</p>\n<p>服装方向： 他的独特着装风格不仅在时尚领域树立了标杆，更将服装作为表达个性和创造形象的重要手段，使其服装成为流行文化中不可忽视的元素。</p>\n<p>电影方向： 杰克逊的电影作品不仅展现了他在角色表演上的卓越才华，还通过视觉效果和创新的电影制作技术，为观众呈现了更加多样和丰富的艺术体验。</p>\n<p>唱片设计方向： 他的专辑封面设计不仅展示了对艺术性的追求，也与音乐内容相得益彰，成为音乐作品的视觉延伸。他对唱片设计标准的改变影响深远，为唱片市场带来新的审美标准。</p>\n<p>在各个方向上，迈克尔・杰克逊不仅是创新的先锋者，更是流行文化的奇才。他以其跨领域的艺术贡献，为后来的艺术家和文化创作者树立了榜样，确立了自己在西方流行文化中的不朽地位。</p>\n<h2 id=\"七-参考文献\"><a class=\"anchor\" href=\"#七-参考文献\">#</a> 七、<strong>参考文献</strong></h2>\n<p>[1] 奥巴马接受采访：我是听着杰克逊的歌曲长大的.ht-tp://ent.QQ.com.2009-07-03. 腾讯音乐.</p>\n<p>[2] 王明风。试析迈克尔・杰克逊的表演风格及其对流行音乐的影响 [J]. 中州大学学报，2009,26 (06):69-71.</p>\n<p>[3] 赵伟新。迈克尔杰克逊音乐风格研究 [D]. 上海音乐学院，2019.</p>\n<p>[4] 郭书源，李楠。流行乐的视觉传达：迈克尔・杰克逊演出服饰及其影响 [J]. 服饰导刊，2021,10 (05):111-117.</p>\n<p>[5] 梁晨。迈克尔・杰克逊的音乐电视的叙事风格 [J]. 西部广播电视，2014,(19):98-99.</p>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "homework"
            ]
        },
        {
            "id": "https://enjundu.github.io/misc/%E6%95%B0%E5%AD%97%E7%BB%8F%E6%B5%8E%EF%BC%9A%E7%A7%91%E6%8A%80%E5%88%9B%E6%96%B0%E5%92%8C%E4%BC%81%E4%B8%9A%E8%BD%AC%E5%9E%8B_%E9%80%9A%E8%AF%86%E7%BB%93%E8%AF%BE%E8%AE%BA%E6%96%87/",
            "url": "https://enjundu.github.io/misc/%E6%95%B0%E5%AD%97%E7%BB%8F%E6%B5%8E%EF%BC%9A%E7%A7%91%E6%8A%80%E5%88%9B%E6%96%B0%E5%92%8C%E4%BC%81%E4%B8%9A%E8%BD%AC%E5%9E%8B_%E9%80%9A%E8%AF%86%E7%BB%93%E8%AF%BE%E8%AE%BA%E6%96%87/",
            "title": "数字经济：科技创新和企业转型_通识结课论文",
            "date_published": "2024-07-03T14:41:31.000Z",
            "content_html": "<h1 id=\"技术创新对数字经济中企业转型的影响\"><a class=\"anchor\" href=\"#技术创新对数字经济中企业转型的影响\">#</a> <strong>技术创新对数字经济中企业转型的影响</strong></h1>\n<p>** 摘要：** 数字经济的兴起引领了一场技术创新的浪潮，深刻改变了企业在全球范围内的运营方式。本文通过对《数字经济：科技创新和企业转型》课程的综合探讨，旨在揭示技术创新与企业转型之间复杂的关系。通过全面的分析，论文深入研究数字经济动荡领域中企业转型的主要推动因素、挑战以及对企业的影响。涵盖的主题包括数字经济的演变、科技创新与企业转型的关键概念、先前研究的综述、破坏性技术的作用、创新模型的应用、技术创新的推动因素、企业面临的挑战、成功企业的转型策略等。这一研究旨在为学术界和实际经营者提供深刻的见解和有益的启示，帮助企业更好地应对数字经济时代的变革。</p>\n<p><strong>关键词</strong>：数字经济、技术创新、企业转型、创新模型、破坏性技术、创新生态系统、开放创新、数字化转型、领导力、战略规划、挑战、成功经验。</p>\n<h2 id=\"一-引言\"><a class=\"anchor\" href=\"#一-引言\">#</a> 一、<strong>引言</strong></h2>\n<p>随着信息技术的迅猛发展，数字经济在全球范围内崛起，成为引领社会变革的引擎。数字经济不仅涵盖了数字化生产、分配、交换和消费的全过程，更深刻地改变了企业运营的方式与规模，推动着全球经济走向智能化、创新化和高效化的未来。这一潮流对企业转型提出了更为复杂而紧迫的要求，因为传统商业模式和管理范式面临着前所未有的挑战。因此，深入理解数字经济对企业的影响，特别是在科技创新与企业转型之间的关系，已成为当今商业领域亟待解决的重要问题。[1]</p>\n<p>在这一时代背景下，课程《数字经济：科技创新和企业转型》迎刃而解，成为学术界和商业实践者的焦点。该课程旨在帮助学生深入了解数字经济的核心概念、技术趋势以及它们如何塑造企业的未来。通过系统性的学习，我们能够理解创新是数字经济中不可或缺的要素，同时也意识到企业需要如何巧妙应对这一激动人心而又充满挑战的新时代。</p>\n<p>本论文的主旨在于深入研究技术创新对企业在数字经济中的转型过程产生的影响。我们将聚焦于数字经济的演变背景、企业面临的挑战、成功的转型策略以及技术创新对商业模型的塑造，以全面分析数字经济时代企业的核心议题。在这个背景下，我们将探讨一系列关键问题：数字经济如何推动技术创新？企业在技术转型中面临了哪些主要挑战？成功的企业是如何应对这些挑战的？技术创新如何改变企业的商业模型？这些问题的回答将有助于我们更好地理解数字经济时代企业的现状与未来，为学术界和实际经营者提供深刻的洞见和有益的启示。</p>\n<h2 id=\"二-文献综述\"><a class=\"anchor\" href=\"#二-文献综述\">#</a> 二、<strong>文献综述</strong></h2>\n<h3 id=\"21-数字经济的演变\"><a class=\"anchor\" href=\"#21-数字经济的演变\">#</a> <strong>2.1</strong> <strong>数字经济的演变</strong></h3>\n<p>数字经济的发展是经济全球化和信息技术融合的产物。从信息时代的兴起到今天，数字经济已经从一个朦胧的概念逐渐演变成为塑造全球商业格局的关键力量。在这一演变过程中，数字经济不仅仅是传统商业的数字化延伸，更是一种全新的商业范式，强调数据驱动、创新导向和跨界协同。这个演变过程涵盖了数字技术的不断发展，从而使企业能够更灵活地适应市场变化，提高效率，并在全球范围内寻找新的商机。[2]</p>\n<h3 id=\"22-科技创新和企业转型的关键概念\"><a class=\"anchor\" href=\"#22-科技创新和企业转型的关键概念\">#</a> <strong>2.2</strong> <strong>科技创新和企业转型的关键概念</strong></h3>\n<p>在数字经济时代，科技创新成为推动企业转型的核心引擎。科技创新不仅仅包括新产品和服务的开发，还涉及到组织结构、业务流程以及文化的全面变革。在这一背景下，一系列关键概念应运而生，如数字化转型、创新生态系统、开放创新等。数字化转型强调企业如何整合数字技术，全面提升业务运营效率；创新生态系统则着眼于企业与外部合作伙伴、创新网络的建立，以共同推动创新；而开放创新则强调了企业通过开放合作、引入外部创新资源来加速自身创新过程。这些概念共同构成了科技创新与企业转型的理论框架，指引着企业在数字经济中的发展路径。</p>\n<p><strong>2.3 先前关于技术对业务影响的研究</strong></p>\n<p>已有大量研究深入探讨了技术对企业业务的广泛影响。这些研究包括了不同领域、行业和规模的企业，从而形成了一个多层次、多视角的理解体系。早期的研究关注于信息技术的应用，强调信息系统如何提高组织的效率和决策能力。随着技术的不断进步，研究逐渐转向更先进的主题，如大数据分析、人工智能、物联网等。这些研究不仅为企业提供了实用的操作指南，同时也揭示了技术变革对企业战略、组织结构以及市场竞争力等方面的深刻影响。然而，随着数字经济的快速发展，我们迫切需要深入研究技术创新如何在数字经济时代引领企业转型，以更全面、前瞻性的视角理解其对企业的重大影响。</p>\n<p><strong>三、理论框架</strong></p>\n<h3 id=\"31-破坏性技术在塑造数字经济中的作用\"><a class=\"anchor\" href=\"#31-破坏性技术在塑造数字经济中的作用\">#</a> <strong>3.1 破坏性技术在塑造数字经济中的作用</strong></h3>\n<p>破坏性技术在数字经济中扮演着塑造行业格局的关键角色。通过对新兴技术的广泛应用，企业能够颠覆传统商业模式，加速创新，提高效率。破坏性技术如人工智能、区块链和生物技术等，不仅推动了企业的数字化转型，还催生了全新的商业生态系统。[3]</p>\n<p>破坏性技术的引入使得企业能够重新思考和重塑其商业模式。传统的商业模式往往受到惯性和既定规则的限制，而新兴技术的应用则为企业提供了颠覆性的机会。通过深入研究新兴技术的商业应用，我们将分析企业如何通过重新设计产品、服务、分销渠道等方面，实现商业模式的创新，从而更好地适应数字经济的变革潮流。</p>\n<p>破坏性技术不仅仅是单一技术的应用，更是在不同领域和行业之间创造全新的商业生态系统。例如，人工智能的融入使得企业能够建立智能化的服务链，区块链的应用改变了信息传递和交易的方式，生物技术的发展开启了医疗和健康产业的新纪元。在这一部分，我们将深入研究这些新兴技术如何相互融合，构建全新的商业生态系统，使企业在数字经济中找到更为广阔的发展空间。</p>\n<p>企业的数字化转型离不开破坏性技术的支持。在这一部分，我们将具体探讨企业如何借助人工智能、区块链和生物技术等破坏性技术，实现数字化转型。从技术选型、实施策略到转型过程中的挑战和成功案例，我们将为企业提供实用的指导，助力它们更顺利地迎接数字经济的挑战与机遇。<br />\n<strong>3.2 创新模型及其在企业转型中的应用</strong></p>\n<p>创新模型是企业在数字经济时代实现成功转型的关键工具。通过深入理解创新生态系统、开放创新和快速迭代等模型，企业能够更灵活地应对市场变化，推动产品和服务的不断升级。</p>\n<p>创新生态系统是企业在数字经济中应对快速变化的市场环境的一种重要策略。通过建立广泛的合作伙伴关系、加强与初创企业的合作、引入外部创新资源，企业能够打破传统的创新边界，实现全方位的创新。在这一部分，我们将详细分析创新生态系统的构建方法，揭示企业如何通过与外部合作伙伴共同推动创新，实现业务的全面升级。</p>\n<p>开放创新模型强调了企业通过开放合作、分享知识、引入外部创新的理念。在数字经济时代，信息和知识的传播变得更加迅速，开放创新成为企业实现竞争优势的一种重要途径。我们将深入研究开放创新的理念，包括企业如何建立开放的文化氛围、与生态系统内的各方保持紧密联系、并且将外部创新有效地整合到企业内部的运营和发展中。</p>\n<p>在数字经济时代，市场需求和技术变化迅速，企业必须能够迅速调整自己的产品和服务以适应这种变化。快速迭代成为企业实现持续创新的关键。在这一部分，我们将详细探讨快速迭代的实践方法，包括敏捷开发、设计思维、用户反馈循环等，以帮助企业更加灵活地应对市场的动态变化，提高创新的成功率。[4]<br />\n<strong> 3.3 关于在业务战略中整合技术的理论观点</strong></p>\n<p>整合技术到业务战略是企业数字化转型的核心要素之一。有效的整合要求企业领导层深刻理解技术与业务之间的紧密关系，并将技术融入到企业战略的各个层面。</p>\n<h2 id=\"四-数字经济中技术创新的推动因素\"><a class=\"anchor\" href=\"#四-数字经济中技术创新的推动因素\">#</a> <strong>四、数字经济中技术创新的推动因素</strong></h2>\n<h3 id=\"41影响因素\"><a class=\"anchor\" href=\"#41影响因素\">#</a> <strong>4.1 影响因素</strong></h3>\n<p>数字经济中的技术创新受多种因素影响，其中一些因素成为关键的推动力。审视这些关键技术推动因素包括但不限于市场需求、科技投资、政策支持以及全球竞争力。深入了解这些因素，将有助于企业明智地选择技术创新方向，更好地把握市场机遇。</p>\n<p>关键技术推动因素的影响不仅仅局限于技术本身，还涉及企业内外部环境的变化。在这一部分，我们将分析这些因素如何直接和间接地影响企业创新。这涵盖了企业文化、创新生态系统的建设、市场营销策略等多个方面。[5]</p>\n<p><strong>4.2</strong> <strong>企业在技术转型中面临的挑战</strong><br />\n (一) 市场竞争激烈</p>\n<p>由于传统商贸流通企业准入门槛相对较低，这使得商贸流通企业相对较多，这给供应商和消费端提供了更多选择，但随着我国社会和经济的快速发展，这导致传统商贸流通企业人力、物力成本不断增加，使得商贸流通企业面临的市场竞争不断加剧，很多地区只能依靠价格优势开展各项业务。随着电子商务走向成熟，这对传统商贸行业造成了巨大挑战，也同样影响到流通企业，大部分实体商贸企业都遭受了电子商务冲击，再加上商品同质化比较严重，致使商贸流通企业市场环境发生极大变化。例如，综合保税区是带动商品外贸流通的重要场所，但随着近些年来综保区不断扩大，使得商贸流通受到了重大影响，而企业经济效益无法提升，则会给流通企业的生存发展造成严重危机。</p>\n<p>(二) 跨行业威胁</p>\n<p>随着数字经济时代不断成熟，使得更多电子商务企业不断深挖产业链条，原本不受到影响的两个行业，极容易产生正面接触，正是这种潜在威胁，将导致传统商贸流通企业生存发展空间全面压缩。由于传统商贸流通行业面向客户群体的形式较为单 - -，当电子商务大规模进入到商贸流通行业时，就给传统商贸流通企业造成了极大的生存压力。例如，京东、阿里巴巴都已经逐渐开展新零售业态，当电子商务巨头加入到生鲜采购领域时，电子商务将直接获得终端客户消费和物流订单，这无疑会影响到传统商贸流通企业的发展前景。</p>\n<p>(三) 替代品和服务产生威胁</p>\n<p>随着我国社会和经济的快速发展，人民可支配收入也在快速增长，传统商贸模式已经无法满足市场消费需求，人们开始对高科技产品产生消费兴趣，同时，海外代购商品不断涌入，使得传统商贸行业的生存危机不断加重，这将直接或间接影响到商贸流通行业。电子商务凭借较低的人力成本，可以实现价值最大化，既带动了互联网购物的快速发展，还能给消费者提供更多商品信息，同时，这也直接限制了传统商贸流通企业的发展空间。</p>\n<p>(四) 供应商议价能力问题</p>\n<p>随着电子商务平台逐渐掌握终端消费者的习惯和数据资源，这使得线下消费渠道逐渐丧失优势，将直接导致电子商务渠道议价能力提升，使供应商议价能力不断降低。此外，供应商还要面临严峻的市场竞争，因为供应商没有完善终端营销渠道，所以将会受到电子商务平台制约。而传统商贸流通企业主要是为供应商提供商品流通服务，这将直接导致流通企业市场规模下降，给企业生存和发展带来严重阻碍。</p>\n<p>(五) 客户议价能力逐渐提升</p>\n<p>性价比是客户消费的最主要考量因素，更是决定商品能否大规模销售的关键问题。在信息时代，人们消费习惯已经发生根本性地转变，只有给客户更大的商品选择空间，客户才可以通过更多渠道了解商品价值，从而选择合适地购买渠道。由于线下渠道商品销售受限于成本因素，这导致很多消费者选择线上消费，而传统流通企业主要面对线下消费客户，再加上商贸流通企业数量较多，商贸流通成本的增加，意味着传统商贸流通企业势必要进行数字经济的转型升级，才能获得更大的发展前景 [6]。</p>\n<p><strong>4.3 成功企业的转型策略</strong></p>\n<p>在数字经济时代，整合技术到企业的商业模型是取得成功的关键之一。本部分将提出一种框架，深入探讨企业如何将技术整合到其商业模型中，以实现创新、提高效率和保持竞争力。</p>\n<p>在数字经济的浪潮中，企业必须灵活运用先进技术，将其有机地融入商业模型中。这一部分将提供一个全面的框架，涵盖技术选择、业务流程设计、客户体验优化等方面。我们将深入剖析成功整合技术的企业，揭示它们所采用的框架和方法，为其他企业提供实用的指南，助力它们更好地应对数字经济的挑战。</p>\n<p>数字转型的复杂性要求企业掌握最佳实践，以更好地应对各种挑战。这一部分将总结在数字转型过程中的最佳实践，包括但不限于：</p>\n<p>领导力培养： 数字化变革需要具备前瞻性和创新力的领导团队。我们将深入研究领导层如何培养数字化思维，推动组织朝着创新和变革的方向前进。</p>\n<p>组织文化建设： 数字化转型不仅仅是技术的变革，还涉及到组织文化的调整。我们将探讨如何建设一种鼓励创新、快速学习和适应变化的文化，以推动数字转型的成功。</p>\n<p>战略规划： 在数字经济时代，战略规划变得更为关键。我们将总结成功企业的战略规划实践，包括对市场趋势的敏感性、灵活的战略调整机制等，以帮助其他企业更好地规划数字化转型的长远发展。</p>\n<p>通过深入研究成功企业的案例，我们将展示它们在制定和执行转型战略方面的成功经验。这些案例将提供实际的战略方法和操作指南，为其他企业提供有针对性的战略参考，助力它们在数字经济时代实现成功的转型。我们将分析这些企业在面对市场变化、技术发展和竞争压力时所采取的创新战略，为企业领导层提供实用的战略思路，以实现长期的商业成功。[7]</p>\n<h2 id=\"五-结论\"><a class=\"anchor\" href=\"#五-结论\">#</a> <strong>五、结论</strong></h2>\n<p>在数字经济时代，技术创新对企业的转型起着至关重要的作用。通过深入研究数字经济的演变、科技创新与企业转型的关键概念以及成功企业的转型策略，本论文揭示了技术创新在塑造行业格局、推动创新和提高效率方面的关键作用。数字经济时代，企业需要理解并迎接数字化转型的复杂性，采用创新模型，整合技术到商业模型，以适应市场的快速变化。尤其是破坏性技术的引入和成功企业的经验都为其他企业提供了重要的指导和启示。然而，企业在技术转型中仍面临着一系列挑战，包括文化冲突、技术整合问题和管理层面的困境。了解这些挑战并采取相应的策略是企业成功转型的关键。</p>\n<h2 id=\"六-参考文献\"><a class=\"anchor\" href=\"#六-参考文献\">#</a> 六、<strong>参考文献</strong></h2>\n<p>​    [1]     王欢。数字经济时代的中小企业财务转型探析         [J].     商场现代化，2023,         (24):     180-182.                 DOI:10.14013/j.cnki.scxdh.2023.24.006</p>\n<p>​    [2]     毕小丽。数字经济时代企业内部审计创新转型探讨         [J].     现代商业，2023,         (22):     173-176.                 DOI:10.14097/j.cnki.5392/2023.22.020</p>\n<p>​    [3]     陈君联。数字经济对中小旅游企业转型发展的启示         [J].     现代商业，2023,         (22):     52-55.                 DOI:10.14097/j.cnki.5392/2023.22.030</p>\n<p>​    [4]     何兰红。数字经济赋能商贸流通企业数字化转型分析         [J].     商业观察，2023,     9     (33):     61-64.</p>\n<p>​    [5]     田五星，王丽娟，胡锦萍。新经济时代中小企业数字化转型的实施路径研究         [J].     咸阳师范学院学报，2023,     38     (06):     50-56.</p>\n<p>​    [6]     范斗南。数字经济转型条件下企业管理的发展与变革研究         [J].     中国商论，2023,         (22):     57-61.                 DOI:10.19699/j.cnki.issn2096-0298.2023.22.057</p>\n<p>​    [7]     张文文，景维民。数字经济监管助力企业数字化转型 —— 基于收益和成本的权衡分析     [J/OL].         数量经济技术经济研究，1-22 [2023-12-25]     <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2kub3JnLzEwLjEzNjUzL2ouY25raS5qcXRlLjIwMjMxMTE3LjAwNw==\">https://doi.org/10.13653/j.cnki.jqte.20231117.007</span>.</p>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "homework"
            ]
        },
        {
            "id": "https://enjundu.github.io/misc/%E5%BF%83%E7%90%86%E5%81%A5%E5%BA%B7%E5%88%86%E6%9E%90/",
            "url": "https://enjundu.github.io/misc/%E5%BF%83%E7%90%86%E5%81%A5%E5%BA%B7%E5%88%86%E6%9E%90/",
            "title": "心理健康分析",
            "date_published": "2024-07-03T14:41:31.000Z",
            "content_html": "<h1 id=\"代码\"><a class=\"anchor\" href=\"#代码\">#</a> 代码</h1>\n<h2 id=\"多元线性回归模型\"><a class=\"anchor\" href=\"#多元线性回归模型\">#</a> 多元线性回归模型</h2>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LinearRegression</span><br><span class=\"line\"><span class=\"keyword\">import</span> statsmodels.api <span class=\"keyword\">as</span> sm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 读取CSV文件</span></span><br><span class=\"line\">input_file = <span class=\"string\">&#x27;data.csv&#x27;</span></span><br><span class=\"line\">df = pd.read_csv(input_file)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义自变量和因变量</span></span><br><span class=\"line\">X = df[[</span><br><span class=\"line\">    <span class=\"string\">&quot;年龄段&quot;</span>, <span class=\"string\">&quot;性别&quot;</span>, <span class=\"string\">&quot;年级&quot;</span>, <span class=\"string\">&quot;与父母关系&quot;</span>, <span class=\"string\">&quot;家庭活动频率&quot;</span>, <span class=\"string\">&quot;父母对兴趣爱好支持&quot;</span>, <span class=\"string\">&quot;父母倾听理解&quot;</span>, <span class=\"string\">&quot;家庭讨论频率&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭放松支持&quot;</span>, <span class=\"string\">&quot;家庭规则执行&quot;</span>, <span class=\"string\">&quot;课程满意度&quot;</span>, <span class=\"string\">&quot;学习压力&quot;</span>, <span class=\"string\">&quot;与老师关系&quot;</span>, <span class=\"string\">&quot;课堂互动&quot;</span>, <span class=\"string\">&quot;课外活动丰富度&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;心理健康关注&quot;</span>, <span class=\"string\">&quot;同学关系&quot;</span>, <span class=\"string\">&quot;亲密朋友&quot;</span>, <span class=\"string\">&quot;集体活动频率&quot;</span>, <span class=\"string\">&quot;校园欺凌&quot;</span>, <span class=\"string\">&quot;冲突处理&quot;</span>, <span class=\"string\">&quot;社交媒体使用时间&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;社交媒体影响&quot;</span>, <span class=\"string\">&quot;网络形象担心&quot;</span>, <span class=\"string\">&quot;网络焦虑&quot;</span>, <span class=\"string\">&quot;网络暴力严重性&quot;</span>, <span class=\"string\">&quot;睡眠质量&quot;</span>, <span class=\"string\">&quot;饮食习惯&quot;</span>, <span class=\"string\">&quot;体育锻炼频率&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;身体不适&quot;</span>, <span class=\"string\">&quot;心理问题困扰&quot;</span>, <span class=\"string\">&quot;心理咨询意愿&quot;</span></span><br><span class=\"line\">]]</span><br><span class=\"line\">y = df[<span class=\"string\">&quot;心理健康&quot;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 添加常数项</span></span><br><span class=\"line\">X = sm.add_constant(X)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建回归模型</span></span><br><span class=\"line\">model = sm.OLS(y, X).fit()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(model.summary())</span><br><span class=\"line\"></span><br><span class=\"line\">coefficients = np.array([<span class=\"number\">2.0</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.2</span>, -<span class=\"number\">0.3</span>, <span class=\"number\">0.6</span>, <span class=\"number\">0.4</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.6</span>, <span class=\"number\">0.4</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.3</span>, <span class=\"number\">0.4</span>, -<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.3</span>, <span class=\"number\">0.4</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.6</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.4</span>, -<span class=\"number\">0.6</span>, <span class=\"number\">0.4</span>, -<span class=\"number\">0.3</span>, <span class=\"number\">0.4</span>, -<span class=\"number\">0.3</span>, -<span class=\"number\">0.5</span>, -<span class=\"number\">0.4</span>, <span class=\"number\">0.6</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, -<span class=\"number\">0.4</span>, -<span class=\"number\">0.6</span>, <span class=\"number\">0.4</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">formula = <span class=\"string\">f&#x27;y = <span class=\"subst\">&#123;coefficients[<span class=\"number\">0</span>]:<span class=\"number\">.1</span>f&#125;</span>&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i, col <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(X.columns[<span class=\"number\">1</span>:]):</span><br><span class=\"line\">    formula += <span class=\"string\">f&#x27; + (<span class=\"subst\">&#123;coefficients[i+<span class=\"number\">1</span>]:<span class=\"number\">.1</span>f&#125;</span> * <span class=\"subst\">&#123;col&#125;</span>)&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">formula += <span class=\"string\">&#x27; + ε&#x27;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;回归模型公式为:&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(formula)</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"基于熵值的灵敏度\"><a class=\"anchor\" href=\"#基于熵值的灵敏度\">#</a> 基于熵值的灵敏度</h2>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LinearRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error, r2_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> scipy.stats <span class=\"keyword\">import</span> entropy</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 读取CSV文件</span></span><br><span class=\"line\">input_file = <span class=\"string\">&#x27;data.csv&#x27;</span></span><br><span class=\"line\">df = pd.read_csv(input_file)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义自变量和因变量</span></span><br><span class=\"line\">X = df[[</span><br><span class=\"line\">    <span class=\"string\">&quot;年龄段&quot;</span>, <span class=\"string\">&quot;性别&quot;</span>, <span class=\"string\">&quot;年级&quot;</span>, <span class=\"string\">&quot;与父母关系&quot;</span>, <span class=\"string\">&quot;家庭活动频率&quot;</span>, <span class=\"string\">&quot;父母对兴趣爱好支持&quot;</span>, <span class=\"string\">&quot;父母倾听理解&quot;</span>, <span class=\"string\">&quot;家庭讨论频率&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭放松支持&quot;</span>, <span class=\"string\">&quot;家庭规则执行&quot;</span>, <span class=\"string\">&quot;课程满意度&quot;</span>, <span class=\"string\">&quot;学习压力&quot;</span>, <span class=\"string\">&quot;与老师关系&quot;</span>, <span class=\"string\">&quot;课堂互动&quot;</span>, <span class=\"string\">&quot;课外活动丰富度&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;心理健康关注&quot;</span>, <span class=\"string\">&quot;同学关系&quot;</span>, <span class=\"string\">&quot;亲密朋友&quot;</span>, <span class=\"string\">&quot;集体活动频率&quot;</span>, <span class=\"string\">&quot;校园欺凌&quot;</span>, <span class=\"string\">&quot;冲突处理&quot;</span>, <span class=\"string\">&quot;社交媒体使用时间&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;社交媒体影响&quot;</span>, <span class=\"string\">&quot;网络形象担心&quot;</span>, <span class=\"string\">&quot;网络焦虑&quot;</span>, <span class=\"string\">&quot;网络暴力严重性&quot;</span>, <span class=\"string\">&quot;睡眠质量&quot;</span>, <span class=\"string\">&quot;饮食习惯&quot;</span>, <span class=\"string\">&quot;体育锻炼频率&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;身体不适&quot;</span>, <span class=\"string\">&quot;心理问题困扰&quot;</span>, <span class=\"string\">&quot;心理咨询意愿&quot;</span></span><br><span class=\"line\">]]</span><br><span class=\"line\">y = df[<span class=\"string\">&quot;心理健康&quot;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将数据集分为训练集和测试集</span></span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建线性回归模型</span></span><br><span class=\"line\">model = LinearRegression()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 训练模型</span></span><br><span class=\"line\">model.fit(X_train, y_train)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 预测测试集</span></span><br><span class=\"line\">y_pred = model.predict(X_test)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 评估模型</span></span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">r2 = r2_score(y_test, y_pred)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差（MSE）：<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;R^2 值：<span class=\"subst\">&#123;r2&#125;</span>&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 灵敏度分析函数，基于预测结果的熵值</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">sensitivity_analysis_entropy</span>(<span class=\"params\">base_values, variable, change_range, model, X_train</span>):</span><br><span class=\"line\">    entropies = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> change <span class=\"keyword\">in</span> change_range:</span><br><span class=\"line\">        data = base_values.copy()</span><br><span class=\"line\">        data[variable] = change</span><br><span class=\"line\">        X_changed = X_train.copy()</span><br><span class=\"line\">        X_changed[variable] = change</span><br><span class=\"line\">        y_changed_pred = model.predict(X_changed)</span><br><span class=\"line\">        hist, _ = np.histogram(y_changed_pred, bins=<span class=\"number\">10</span>, density=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        entropies.append(entropy(hist))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> entropies</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义基准值（所有变量取中间值）</span></span><br><span class=\"line\">base_values = &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;年龄段&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;性别&quot;</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;年级&quot;</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;与父母关系&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭活动频率&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;父母对兴趣爱好支持&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;父母倾听理解&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭讨论频率&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭放松支持&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭规则执行&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;课程满意度&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;学习压力&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;与老师关系&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;课堂互动&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;课外活动丰富度&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;心理健康关注&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;同学关系&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;亲密朋友&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;集体活动频率&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;校园欺凌&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;冲突处理&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;社交媒体使用时间&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;社交媒体影响&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;网络形象担心&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;网络焦虑&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;网络暴力严重性&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;睡眠质量&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;饮食习惯&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;体育锻炼频率&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;身体不适&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;心理问题困扰&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;心理咨询意愿&quot;</span>: <span class=\"number\">3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 示例：分析年龄段变量的灵敏度</span></span><br><span class=\"line\">variable = <span class=\"string\">&quot;年龄段&quot;</span></span><br><span class=\"line\">change_range = <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, <span class=\"number\">6</span>)  <span class=\"comment\"># 假设年龄段在1到5之间变化</span></span><br><span class=\"line\">entropies = sensitivity_analysis_entropy(base_values, variable, change_range, model, X_train)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 打印熵值</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> change, ent <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>(change_range, entropies):</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;variable&#125;</span> = <span class=\"subst\">&#123;change&#125;</span>, 熵值 = <span class=\"subst\">&#123;ent&#125;</span>&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 进行其他变量的灵敏度分析</span></span><br><span class=\"line\">variables_to_analyze = [</span><br><span class=\"line\">    <span class=\"string\">&quot;性别&quot;</span>, <span class=\"string\">&quot;年级&quot;</span>, <span class=\"string\">&quot;与父母关系&quot;</span>, <span class=\"string\">&quot;家庭活动频率&quot;</span>, <span class=\"string\">&quot;父母对兴趣爱好支持&quot;</span>, <span class=\"string\">&quot;父母倾听理解&quot;</span>, <span class=\"string\">&quot;家庭讨论频率&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭放松支持&quot;</span>, <span class=\"string\">&quot;家庭规则执行&quot;</span>, <span class=\"string\">&quot;课程满意度&quot;</span>, <span class=\"string\">&quot;学习压力&quot;</span>, <span class=\"string\">&quot;与老师关系&quot;</span>, <span class=\"string\">&quot;课堂互动&quot;</span>, <span class=\"string\">&quot;课外活动丰富度&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;心理健康关注&quot;</span>, <span class=\"string\">&quot;同学关系&quot;</span>, <span class=\"string\">&quot;亲密朋友&quot;</span>, <span class=\"string\">&quot;集体活动频率&quot;</span>, <span class=\"string\">&quot;校园欺凌&quot;</span>, <span class=\"string\">&quot;冲突处理&quot;</span>, <span class=\"string\">&quot;社交媒体使用时间&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;社交媒体影响&quot;</span>, <span class=\"string\">&quot;网络形象担心&quot;</span>, <span class=\"string\">&quot;网络焦虑&quot;</span>, <span class=\"string\">&quot;网络暴力严重性&quot;</span>, <span class=\"string\">&quot;睡眠质量&quot;</span>, <span class=\"string\">&quot;饮食习惯&quot;</span>, <span class=\"string\">&quot;体育锻炼频率&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;身体不适&quot;</span>, <span class=\"string\">&quot;心理问题困扰&quot;</span>, <span class=\"string\">&quot;心理咨询意愿&quot;</span></span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> variable <span class=\"keyword\">in</span> variables_to_analyze:</span><br><span class=\"line\">    entropies = sensitivity_analysis_entropy(base_values, variable, change_range, model, X_train)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> change, ent <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>(change_range, entropies):</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;variable&#125;</span> = <span class=\"subst\">&#123;change&#125;</span>, 熵值 = <span class=\"subst\">&#123;ent&#125;</span>&#x27;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h2 id=\"具体分析影响因素的热力图模型\"><a class=\"anchor\" href=\"#具体分析影响因素的热力图模型\">#</a> 具体分析影响因素的热力图模型</h2>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> statsmodels.api <span class=\"keyword\">as</span> sm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 读取CSV文件</span></span><br><span class=\"line\">input_file = <span class=\"string\">&#x27;data.csv&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 尝试用不同的编码格式读取文件</span></span><br><span class=\"line\">encodings = [<span class=\"string\">&#x27;utf-8&#x27;</span>, <span class=\"string\">&#x27;gbk&#x27;</span>, <span class=\"string\">&#x27;latin1&#x27;</span>, <span class=\"string\">&#x27;cp1252&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> encoding <span class=\"keyword\">in</span> encodings:</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        df = pd.read_csv(input_file, encoding=encoding)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Successfully read the file with encoding: <span class=\"subst\">&#123;encoding&#125;</span>&#x27;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"keyword\">except</span> UnicodeDecodeError:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Failed to read the file with encoding: <span class=\"subst\">&#123;encoding&#125;</span>&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 筛选心理健康值为5和-1的行</span></span><br><span class=\"line\">df_5 = df[df[<span class=\"string\">&#x27;心理健康&#x27;</span>] == <span class=\"number\">5</span>]</span><br><span class=\"line\">df_neg1 = df[df[<span class=\"string\">&#x27;心理健康&#x27;</span>] == <span class=\"number\">2</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义自变量和因变量</span></span><br><span class=\"line\">variables = [</span><br><span class=\"line\">    <span class=\"string\">&quot;年龄段&quot;</span>, <span class=\"string\">&quot;性别&quot;</span>, <span class=\"string\">&quot;年级&quot;</span>, <span class=\"string\">&quot;与父母关系&quot;</span>, <span class=\"string\">&quot;家庭活动频率&quot;</span>, <span class=\"string\">&quot;父母对兴趣爱好支持&quot;</span>, <span class=\"string\">&quot;父母倾听理解&quot;</span>, <span class=\"string\">&quot;家庭讨论频率&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭放松支持&quot;</span>, <span class=\"string\">&quot;家庭规则执行&quot;</span>, <span class=\"string\">&quot;课程满意度&quot;</span>, <span class=\"string\">&quot;学习压力&quot;</span>, <span class=\"string\">&quot;与老师关系&quot;</span>, <span class=\"string\">&quot;课堂互动&quot;</span>, <span class=\"string\">&quot;课外活动丰富度&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;心理健康关注&quot;</span>, <span class=\"string\">&quot;同学关系&quot;</span>, <span class=\"string\">&quot;亲密朋友&quot;</span>, <span class=\"string\">&quot;集体活动频率&quot;</span>, <span class=\"string\">&quot;校园欺凌&quot;</span>, <span class=\"string\">&quot;冲突处理&quot;</span>, <span class=\"string\">&quot;社交媒体使用时间&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;社交媒体影响&quot;</span>, <span class=\"string\">&quot;网络形象担心&quot;</span>, <span class=\"string\">&quot;网络焦虑&quot;</span>, <span class=\"string\">&quot;网络暴力严重性&quot;</span>, <span class=\"string\">&quot;睡眠质量&quot;</span>, <span class=\"string\">&quot;饮食习惯&quot;</span>, <span class=\"string\">&quot;体育锻炼频率&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;身体不适&quot;</span>, <span class=\"string\">&quot;心理问题困扰&quot;</span>, <span class=\"string\">&quot;心理咨询意愿&quot;</span></span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 多元回归分析并绘制热力图的函数</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">plot_pvalue_heatmap</span>(<span class=\"params\">df, title</span>):</span><br><span class=\"line\">    X = df[variables]</span><br><span class=\"line\">    y = df[<span class=\"string\">&quot;心理健康&quot;</span>]</span><br><span class=\"line\">    X = sm.add_constant(X)</span><br><span class=\"line\">    model = sm.OLS(y, X).fit()</span><br><span class=\"line\">    p_values = model.pvalues[<span class=\"number\">1</span>:]  <span class=\"comment\"># 不包括常数项</span></span><br><span class=\"line\">    pval_df = pd.DataFrame(p_values, columns=[<span class=\"string\">&#x27;P值&#x27;</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">    plt.figure(figsize=(<span class=\"number\">16</span>, <span class=\"number\">10</span>))</span><br><span class=\"line\">    sns.heatmap(pval_df.T, annot=<span class=\"literal\">True</span>, cmap=<span class=\"string\">&#x27;coolwarm&#x27;</span>, fmt=<span class=\"string\">&#x27;.2f&#x27;</span>, linewidths=<span class=\"number\">0.5</span>, cbar=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    plt.title(title, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">    plt.xticks(rotation=<span class=\"number\">45</span>, ha=<span class=\"string\">&#x27;right&#x27;</span>)</span><br><span class=\"line\">    plt.yticks(rotation=<span class=\"number\">0</span>)</span><br><span class=\"line\">    plt.tight_layout()</span><br><span class=\"line\">    plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置中文字体</span></span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制心理健康值为5的P值热力图</span></span><br><span class=\"line\">plot_pvalue_heatmap(df_5, <span class=\"string\">&#x27;心理健康值为5的P值热力图&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制心理健康值为-1的P值热力图</span></span><br><span class=\"line\">plot_pvalue_heatmap(df_neg1, <span class=\"string\">&#x27;心理健康值为-1的P值热力图&#x27;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h2 id=\"热力图模型\"><a class=\"anchor\" href=\"#热力图模型\">#</a> 热力图模型</h2>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> statsmodels.api <span class=\"keyword\">as</span> sm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 读取CSV文件</span></span><br><span class=\"line\">input_file = <span class=\"string\">&#x27;data.csv&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 尝试用不同的编码格式读取文件</span></span><br><span class=\"line\">encodings = [<span class=\"string\">&#x27;utf-8&#x27;</span>, <span class=\"string\">&#x27;gbk&#x27;</span>, <span class=\"string\">&#x27;latin1&#x27;</span>, <span class=\"string\">&#x27;cp1252&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> encoding <span class=\"keyword\">in</span> encodings:</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        df = pd.read_csv(input_file, encoding=encoding)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Successfully read the file with encoding: <span class=\"subst\">&#123;encoding&#125;</span>&#x27;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"keyword\">except</span> UnicodeDecodeError:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Failed to read the file with encoding: <span class=\"subst\">&#123;encoding&#125;</span>&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义自变量和因变量</span></span><br><span class=\"line\">X = df[[</span><br><span class=\"line\">    <span class=\"string\">&quot;年龄段&quot;</span>, <span class=\"string\">&quot;性别&quot;</span>, <span class=\"string\">&quot;年级&quot;</span>, <span class=\"string\">&quot;与父母关系&quot;</span>, <span class=\"string\">&quot;家庭活动频率&quot;</span>, <span class=\"string\">&quot;父母对兴趣爱好支持&quot;</span>, <span class=\"string\">&quot;父母倾听理解&quot;</span>, <span class=\"string\">&quot;家庭讨论频率&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭放松支持&quot;</span>, <span class=\"string\">&quot;家庭规则执行&quot;</span>, <span class=\"string\">&quot;课程满意度&quot;</span>, <span class=\"string\">&quot;学习压力&quot;</span>, <span class=\"string\">&quot;与老师关系&quot;</span>, <span class=\"string\">&quot;课堂互动&quot;</span>, <span class=\"string\">&quot;课外活动丰富度&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;心理健康关注&quot;</span>, <span class=\"string\">&quot;同学关系&quot;</span>, <span class=\"string\">&quot;亲密朋友&quot;</span>, <span class=\"string\">&quot;集体活动频率&quot;</span>, <span class=\"string\">&quot;校园欺凌&quot;</span>, <span class=\"string\">&quot;冲突处理&quot;</span>, <span class=\"string\">&quot;社交媒体使用时间&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;社交媒体影响&quot;</span>, <span class=\"string\">&quot;网络形象担心&quot;</span>, <span class=\"string\">&quot;网络焦虑&quot;</span>, <span class=\"string\">&quot;网络暴力严重性&quot;</span>, <span class=\"string\">&quot;睡眠质量&quot;</span>, <span class=\"string\">&quot;饮食习惯&quot;</span>, <span class=\"string\">&quot;体育锻炼频率&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;身体不适&quot;</span>, <span class=\"string\">&quot;心理问题困扰&quot;</span>, <span class=\"string\">&quot;心理咨询意愿&quot;</span></span><br><span class=\"line\">]]</span><br><span class=\"line\">y = df[<span class=\"string\">&quot;心理健康&quot;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 添加常数项</span></span><br><span class=\"line\">X = sm.add_constant(X)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建回归模型</span></span><br><span class=\"line\">model = sm.OLS(y, X).fit()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取P值</span></span><br><span class=\"line\">p_values = model.pvalues[<span class=\"number\">1</span>:]  <span class=\"comment\"># 不包括常数项</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建包含P值的DataFrame</span></span><br><span class=\"line\">pval_df = pd.DataFrame(p_values, columns=[<span class=\"string\">&#x27;P值&#x27;</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置中文字体</span></span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制热力图</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">16</span>, <span class=\"number\">10</span>))</span><br><span class=\"line\">sns.heatmap(pval_df.T, annot=<span class=\"literal\">True</span>, cmap=<span class=\"string\">&#x27;coolwarm&#x27;</span>, fmt=<span class=\"string\">&#x27;.2f&#x27;</span>, linewidths=<span class=\"number\">0.5</span>, cbar=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置标题和标签</span></span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;多元回归P值热力图&#x27;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">plt.xticks(rotation=<span class=\"number\">45</span>, ha=<span class=\"string\">&#x27;right&#x27;</span>)</span><br><span class=\"line\">plt.yticks(rotation=<span class=\"number\">0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 显示图表</span></span><br><span class=\"line\">plt.tight_layout()</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h2 id=\"预测模型建立\"><a class=\"anchor\" href=\"#预测模型建立\">#</a> 预测模型建立</h2>\n<p><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LinearRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error, r2_score</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 读取CSV文件</span></span><br><span class=\"line\">input_file = <span class=\"string\">&#x27;data.csv&#x27;</span></span><br><span class=\"line\">df = pd.read_csv(input_file)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义自变量和因变量</span></span><br><span class=\"line\">X = df[[</span><br><span class=\"line\">    <span class=\"string\">&quot;年龄段&quot;</span>, <span class=\"string\">&quot;性别&quot;</span>, <span class=\"string\">&quot;年级&quot;</span>, <span class=\"string\">&quot;与父母关系&quot;</span>, <span class=\"string\">&quot;家庭活动频率&quot;</span>, <span class=\"string\">&quot;父母对兴趣爱好支持&quot;</span>, <span class=\"string\">&quot;父母倾听理解&quot;</span>, <span class=\"string\">&quot;家庭讨论频率&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭放松支持&quot;</span>, <span class=\"string\">&quot;家庭规则执行&quot;</span>, <span class=\"string\">&quot;课程满意度&quot;</span>, <span class=\"string\">&quot;学习压力&quot;</span>, <span class=\"string\">&quot;与老师关系&quot;</span>, <span class=\"string\">&quot;课堂互动&quot;</span>, <span class=\"string\">&quot;课外活动丰富度&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;心理健康关注&quot;</span>, <span class=\"string\">&quot;同学关系&quot;</span>, <span class=\"string\">&quot;亲密朋友&quot;</span>, <span class=\"string\">&quot;集体活动频率&quot;</span>, <span class=\"string\">&quot;校园欺凌&quot;</span>, <span class=\"string\">&quot;冲突处理&quot;</span>, <span class=\"string\">&quot;社交媒体使用时间&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;社交媒体影响&quot;</span>, <span class=\"string\">&quot;网络形象担心&quot;</span>, <span class=\"string\">&quot;网络焦虑&quot;</span>, <span class=\"string\">&quot;网络暴力严重性&quot;</span>, <span class=\"string\">&quot;睡眠质量&quot;</span>, <span class=\"string\">&quot;饮食习惯&quot;</span>, <span class=\"string\">&quot;体育锻炼频率&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;身体不适&quot;</span>, <span class=\"string\">&quot;心理问题困扰&quot;</span>, <span class=\"string\">&quot;心理咨询意愿&quot;</span>, <span class=\"string\">&quot;兴趣爱好&quot;</span>, <span class=\"string\">&quot;未来规划&quot;</span>, <span class=\"string\">&quot;个人成长因素&quot;</span></span><br><span class=\"line\">]]</span><br><span class=\"line\">y = df[<span class=\"string\">&quot;心理健康&quot;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将数据集分为训练集和测试集</span></span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建线性回归模型</span></span><br><span class=\"line\">model = LinearRegression()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 训练模型</span></span><br><span class=\"line\">model.fit(X_train, y_train)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 预测测试集</span></span><br><span class=\"line\">y_pred = model.predict(X_test)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 评估模型</span></span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">r2 = r2_score(y_test, y_pred)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差（MSE）：<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;R^2 值：<span class=\"subst\">&#123;r2&#125;</span>&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 显示回归系数</span></span><br><span class=\"line\">coefficients = pd.DataFrame(model.coef_, X.columns, columns=[<span class=\"string\">&#x27;系数&#x27;</span>])</span><br><span class=\"line\"><span class=\"built_in\">print</span>(coefficients)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 使用模型预测心理健康程度</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">predict_mental_health</span>(<span class=\"params\">data</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> model.predict(data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 示例：预测新的数据</span></span><br><span class=\"line\">new_data = pd.DataFrame(&#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;年龄段&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;性别&quot;</span>: [<span class=\"number\">1</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;年级&quot;</span>: [<span class=\"number\">5</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;与父母关系&quot;</span>: [<span class=\"number\">4</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭活动频率&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;父母对兴趣爱好支持&quot;</span>: [<span class=\"number\">4</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;父母倾听理解&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭讨论频率&quot;</span>: [<span class=\"number\">2</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭放松支持&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;家庭规则执行&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;课程满意度&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;学习压力&quot;</span>: [<span class=\"number\">2</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;与老师关系&quot;</span>: [<span class=\"number\">4</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;课堂互动&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;课外活动丰富度&quot;</span>: [<span class=\"number\">4</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;心理健康关注&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;同学关系&quot;</span>: [<span class=\"number\">4</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;亲密朋友&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;集体活动频率&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;校园欺凌&quot;</span>: [<span class=\"number\">2</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;冲突处理&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;社交媒体使用时间&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;社交媒体影响&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;网络形象担心&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;网络焦虑&quot;</span>: [<span class=\"number\">2</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;网络暴力严重性&quot;</span>: [<span class=\"number\">2</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;睡眠质量&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;饮食习惯&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;体育锻炼频率&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;身体不适&quot;</span>: [<span class=\"number\">2</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;心理问题困扰&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;心理咨询意愿&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;兴趣爱好&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;未来规划&quot;</span>: [<span class=\"number\">3</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;个人成长因素&quot;</span>: [<span class=\"number\">3</span>]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">predicted_health = predict_mental_health(new_data)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;预测的心理健康程度：<span class=\"subst\">&#123;predicted_health[<span class=\"number\">0</span>]&#125;</span>&#x27;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h1 id=\"论文\"><a class=\"anchor\" href=\"#论文\">#</a> 论文</h1>\n<p>多维视角下青少年身心健康研究</p>\n<p>摘  要</p>\n<p>随着社会的发展和生活节奏的加快，青少年的身心健康问题日益受到社会各界的关注。本文旨在探讨影响青少年身心健康的多种因素，以期为青少年的健康成长提供科学指导和实践建议。通过文献综述和案例分析，识别了家庭、学校、社会文化以及个体特征等四个主要影响因素。更多的研究发现，家庭环境的和谐、教育方式的合理、经济状况的稳定对青少年的心理健康有着积极作用；学校教育质量、同伴关系和教师态度对青少年的社会适应和心理发展至关重要；社会文化因素，包括社会价值观、媒体影响和文化活动，也在塑造青少年的世界观和价值观；此外，青少年的个性特征、心理健康状况和生理发育也是影响其身心健康的关键个体因素。</p>\n<p>本文采用定量和定性相结合的研究方法，通过问卷调查、深度访谈和案例研究，收集了丰富的第一手资料。数据分析结果表明，综合考虑多方面因素，制定个性化的干预措施，对于促进青少年身心健康具有重要意义。然而，本研究也存在一定的局限性，如样本选择的代表性和研究范围的广泛性等，未来研究可在此基础上进一步深入探讨。</p>\n<p>关键词：青少年、身心健康、影响因素</p>\n<p>A Study on the Physical and Mental Health of Adolescents from a Multidimensional Perspective</p>\n<p>With the development of society and the acceleration of the pace of life, the physical and mental health issues of adolescents are increasingly receiving attention from all sectors of society. This article aims to explore various factors that affect the physical and mental health of adolescents, in order to provide scientific guidance and practical suggestions for their healthy growth. Through literature review and case analysis, four main influencing factors were identified, including family, school, social culture, and individual characteristics. More studies have found that a harmonious family environment, reasonable educational methods, and stable economic conditions have a positive impact on the psychological health of adolescents; The quality of school education, peer relationships, and teacher attitudes are crucial for the social adaptation and psychological development of adolescents; Sociocultural factors, including social values, media influence, and cultural activities, are also shaping the worldview and values of young people; In addition, the personality traits, mental health status, and physiological development of adolescents are also key individual factors that affect their physical and mental health.</p>\n<p>This article adopts a combination of quantitative and qualitative research methods, collecting rich first-hand information through questionnaire surveys, in-depth interviews, and case studies. The data analysis results indicate that considering multiple factors comprehensively and formulating personalized intervention measures is of great significance for promoting the physical and mental health of adolescents. However, this study also has certain limitations, such as the representativeness of sample selection and the breadth of research scope. Future research can further explore this foundation.</p>\n<p><em><strong>*Keywords:*</strong></em> adolescents, physical and mental health, influencing factors</p>\n<p>目  录</p>\n<p><a href=\"#_Toc21994\">第一章 概述\t</a></p>\n<p><a href=\"#_Toc16320\">1.1 研究背景\t</a></p>\n<p><a href=\"#_Toc21592\">1.2 研究意义\t</a></p>\n<p><a href=\"#_Toc26168\">1.3 研究目的和问题\t</a></p>\n<p><a href=\"#_Toc12246\">第二章 文献综述\t</a></p>\n<p><a href=\"#_Toc19120\">2.1 青少年身心健康的定义\t</a></p>\n<p><a href=\"#_Toc29366\">2.2 影响青少年身心健康的主要因素\t</a></p>\n<p><a href=\"#_Toc12760\">2.3 国内外研究现状\t</a></p>\n<p><a href=\"#_Toc11264\">2.3.1 国内研究现状\t</a></p>\n<p><a href=\"#_Toc16203\">2.3.2 国外研究现状\t</a></p>\n<p><a href=\"#_Toc18133\">第三章 研究方法\t</a></p>\n<p><a href=\"#_Toc22502\">3.1 研究设计\t</a></p>\n<p><a href=\"#_Toc10704\">3.2 研究方法\t</a></p>\n<p><a href=\"#_Toc28720\">3.2.1 数据收集\t</a></p>\n<p><a href=\"#_Toc18028\">3.2.2 数据分析\t</a></p>\n<p><a href=\"#_Toc28305\">3.2.3 研究工具的可靠性和效度\t</a></p>\n<p><a href=\"#_Toc16582\">3.2.4 伦理考量\t</a></p>\n<p><a href=\"#_Toc18601\">第四章 影响因素分析\t</a></p>\n<p><a href=\"#_Toc23085\">4.1 家庭因素\t</a></p>\n<p><a href=\"#_Toc31757\">4.1.1 家庭环境\t</a></p>\n<p><a href=\"#_Toc23894\">4.1.2 家庭教育方式与家庭经济情况\t</a></p>\n<p><a href=\"#_Toc17965\">4.2 学校因素\t</a></p>\n<p><a href=\"#_Toc319\">4.2.1 学校教育质量\t</a></p>\n<p><a href=\"#_Toc23608\">4.2.2 同伴关系\t</a></p>\n<p><a href=\"#_Toc8183\">4.2.3 教师态度\t</a></p>\n<p><a href=\"#_Toc11050\">4.3 社会文化因素\t</a></p>\n<p><a href=\"#_Toc18669\">4.3.1 社会价值观\t</a></p>\n<p><a href=\"#_Toc10620\">4.3.2 媒体影响\t</a></p>\n<p><a href=\"#_Toc12919\">4.3.3 文化活动\t</a></p>\n<p><a href=\"#_Toc20226\">4.4 个体因素\t</a></p>\n<p><a href=\"#_Toc27808\">4.4.1 生理特征\t</a></p>\n<p><a href=\"#_Toc11511\">4.4.2 心理健康状况\t</a></p>\n<p><a href=\"#_Toc1937\">4.4.3 能力倾向\t</a></p>\n<p><a href=\"#_Toc12115\">第五章 结论与展望\t</a></p>\n<p><a href=\"#_Toc12810\">5.1 结论\t</a></p>\n<p><a href=\"#_Toc6617\">5.2 研究局限与展望\t</a></p>\n<p><a href=\"#_Toc14529\">5.3 政策建议\t</a></p>\n<p><a href=\"#_Toc9852\">5.4 展望\t</a></p>\n<p><a href=\"#_Toc21925\">参考文献\t</a></p>\n<h1 id=\"第一章-概述\"><a class=\"anchor\" href=\"#第一章-概述\">#</a> 第一章 概述</h1>\n<h2 id=\"11-研究背景\"><a class=\"anchor\" href=\"#11-研究背景\">#</a> 1.1 研究背景</h2>\n<p>青少年时期是个体生命历程中一个极为关键的发展阶段，[1] 这一时期个体经历着从儿童到成人的过渡，其身心发展的速度和质量对个体的整个生命周期具有深远的影响。随着全球化和信息化时代的到来，青少年所面临的环境和挑战与以往相比有了显著的变化。他们不仅要应对学业压力、人际关系的复杂性，还要面对网络世界的冲击和诱惑，这些都对他们的身心健康构成了前所未有的挑战。</p>\n<p>家庭，学校等作为青少年成长的课堂，[2-9] 其教育方式、家庭氛围和经济状况直接影响着青少年的价值观形成、情感发展和心理健康。学校作为青少年社会化的主要场所，其教育质量、师生关系和同伴互动对青少年的自我认知、社会技能和心理健康具有重要影响。此外，社会文化环境，包括媒体传播、网络文化和社会价值观，也在塑造青少年的思想观念和行为模式。</p>\n<p>在当前社会背景下，青少年的身心健康问题日益凸显，成为教育、心理学、社会学等多个学科关注的焦点。然而，由于青少年群体的多样性和复杂性，以及影响因素的多维性和交互性，对青少年身心健康影响因素的全面分析和深入理解仍存在诸多挑战。</p>\n<h2 id=\"12-研究意义\"><a class=\"anchor\" href=\"#12-研究意义\">#</a> 1.2 研究意义</h2>\n<p>理论贡献： 本研究通过综合分析影响青少年身心健康的多种因素，旨在构建一个全面的理论框架，为青少年发展心理学、教育学和社会学等相关学科提供新的研究视角和理论补充。这一理论框架将有助于深化我们对青少年身心健康影响因素的认识，[10] 推动相关学科的理论发展。</p>\n<p>实践指导： 研究成果能够为家庭教育、[11] 学校教育和社会政策制定提供科学依据，帮助相关利益相关者更好地理解青少年的需求，制定有效的干预措施和支持策略。通过本研究，家长、教师和政策制定者可以更加明确地认识到各自在青少年身心健康发展中的作用和责任，从而采取更加有针对性的行动。</p>\n<p>政策支持： [12] 通过对青少年身心健康影响因素的深入分析，本研究能够为政策制定者提供实证数据支持，促进青少年相关政策的制定和完善，提高政策的针对性和有效性。这将有助于构建一个更加有利于青少年身心健康发展的社会环境。</p>\n<p>社会关注： 青少年是国家和社会的未来，他们的身心健康直接关系到社会的发展和进步。本研究有助于提高社会对青少年问题的关注和认识，促进社会各界形成合力，共同为青少年的健康成长创造良好的环境。通过媒体宣传、公共教育等方式，可以增强公众对青少年身心健康问题的认识和重视。</p>\n<p>国际视野： 在全球化背景下，[13] 青少年问题已经成为各国共同关注的议题。本研究的成果可以为国际青少年问题的研究和交流提供参考，促进不同国家和地区在青少年发展领域的合作与交流。通过分享研究成果和经验，可以推动全球范围内青少年身心健康促进工作的开展。</p>\n<p>长期影响： 青少年时期的经历和健康状况对其成年后的发展具有长期影响。通过本研究，我们可以更好地理解青少年时期身心健康的重要性，为青少年的长期发展奠定坚实的基础。</p>\n<h2 id=\"13-研究目的和问题\"><a class=\"anchor\" href=\"#13-研究目的和问题\">#</a> 1.3 研究目的和问题</h2>\n<p>本研究旨在全面分析影响青少年身心健康的多种因素，并探讨这些因素如何相互作用以及对青少年发展的具体影响。以下是本研究的主要内容：</p>\n<p>青少年身心健康的定义与重要性，明确青少年身心健康的概念界定。讨论青少年身心健康在个体发展中的重要性。</p>\n<p>文献综述与理论框架构建，综述国内外关于青少年身心健康的研究文献。构建影响青少年身心健康的理论框架。</p>\n<p>研究方法论，描述研究设计，包括研究类型、研究对象和研究范围。阐述数据收集方法，如问卷调查、深度访谈等。介绍数据分析方法，包括定性分析和定量分析。</p>\n<p>家庭因素分析，研究家庭结构、教育方式和经济状况对青少年的影响。分析家庭环境如何塑造青少年的心理和行为特征。</p>\n<p>学校环境因素分析，探讨学校教育质量、师生关系和同伴互动的影响。分析学校环境对青少年社会适应能力和心理健康的作用。</p>\n<p>社会文化因素分析，研究社会价值观、媒体影响和网络文化的作用。探讨社会文化环境如何影响青少年的价值观和行为。</p>\n<p>个体因素分析，分析个性特征、心理健康状况和生理发育的影响。讨论个体差异如何影响青少年对外部环境的响应。</p>\n<h2 id=\"第二章-文献综述\"><a class=\"anchor\" href=\"#第二章-文献综述\">#</a> 第二章 文献综述</h2>\n<h2 id=\"21-青少年身心健康的定义\"><a class=\"anchor\" href=\"#21-青少年身心健康的定义\">#</a> 2.1 青少年身心健康的定义</h2>\n<p>生理健康：[14] 指青少年在生物学层面的健康状态，包括身体健康、生殖健康和营养状况，以及身体成长和发育的正常进行。</p>\n<p>心理健康：[15] 涉及青少年的情感、心理状态和行为模式，包括情绪稳定性、自我认知、应对压力的能力以及没有心理疾病。</p>\n<p>社会健康：[16] 指青少年在社会环境中的适应能力，能够建立和维持健康的人际关系，以及在社会中找到归属感和认同感。</p>\n<p>情感健康：涉及青少年对自身情感的认识、表达和管理能力，包括情绪的自我调节和在社交互动中表达情感的能力。</p>\n<p>精神健康：或称为精神福祉，指青少年对生活的意义、目的和价值的认识，以及追求个人成长和发展的能力。</p>\n<p>发展任务：青少年时期特有的发展任务，如自我认同的形成、独立性的培养和性别角色的探索，也是身心健康的重要组成部分。</p>\n<p>综合性定义：[17] 青少年身心健康是一个多维度的概念，它不仅包括生理和心理健康，还包括社会、情感和精神健康，以及在青少年时期完成特定发展任务的能力。</p>\n<h2 id=\"22-影响青少年身心健康的主要因素\"><a class=\"anchor\" href=\"#22-影响青少年身心健康的主要因素\">#</a> 2.2 影响青少年身心健康的主要因素</h2>\n<p>家庭环境：[18] 家庭是青少年成长的基石。家庭结构、亲子关系、父母的教育方式以及家庭氛围都会对青少年的心理健康和行为发展产生重要影响。</p>\n<p>学校教育：[19] 学校是青少年社会化的主要场所。教育质量、师生关系、同伴互动以及学校文化都会影响青少年的学业成就和社交能力。</p>\n<p>社会文化：[20] 社会价值观、媒体影响、网络文化和社会压力等社会文化因素，塑造青少年的世界观和行为模式，对其心理健康和身份认同有深远影响。</p>\n<p>个体特征：青少年的个性、自我效能感、情绪调节能力以及应对策略等个体差异，会影响他们对环境压力的反应和适应。</p>\n<p>生理发展：青少年时期的生理变化，如青春期的生长发育，对身心健康有着直接的影响，需要适当的营养和健康的生活方式来支持。</p>\n<p>心理健康问题：[21] 抑郁、焦虑、自我伤害和饮食障碍等心理健康问题，可能会严重影响青少年的日常生活和长期发展。</p>\n<p>同伴压力：同伴关系和群体压力可能导致青少年面临风险行为的诱惑，如吸烟、饮酒等行为。</p>\n<p>经济状况：家庭经济状况和社会经济地位可能影响青少年的教育资源、生活条件和心理健康。</p>\n<h2 id=\"23-国内外研究现状\"><a class=\"anchor\" href=\"#23-国内外研究现状\">#</a> 2.3 国内外研究现状</h2>\n<h3 id=\"231-国内研究现状\"><a class=\"anchor\" href=\"#231-国内研究现状\">#</a> 2.3.1 国内研究现状</h3>\n<p>中国青少年健康的进步与挑战：《柳叶刀》杂志发表了 [22] 北京大学宋逸 / 马军教授团队的研究成果，指出过去三十年中国儿童青少年整体健康状况得到极大改善，但也面临新的健康问题和社会挑战，如非传染性疾病成为主要疾病负担，以及心理健康问题高发等。</p>\n<p>心理健康问题的性别和年级差异：[23] 中国青少年心理健康问题存在性别和年级差异，女生的心理健康水平变化幅度较大且较低，而男生的心理健康水平呈逐步提高趋势。</p>\n<p>社交媒体对心理健康的影响：社交媒体的使用显著影响青少年心理健康，如抑郁症、焦虑症、网络成瘾和睡眠质量等。社交媒体与心理健康之间的关系受到越来越多的关注，成为新兴的研究热点。</p>\n<p>青少年抑郁风险的下降：《2022 年青少年心理健康状况调查报告》显示，[24] 青少年抑郁风险检出率相较 2020 年有所下降，但仍需关注西部和农村地区青少年的心理健康风险。</p>\n<p>家庭因素的重要性：家庭因素与青少年心理健康密切相关。住校、父母外出工作等缺少父母照顾与陪伴的青少年有更多心理健康问题。家庭关系紧张、父母不和睦的青少年心理健康风险更高。</p>\n<p>睡眠和运动的积极作用：[25] 充足的睡眠和运动有助于提升青少年的心理健康水平。睡眠不足状况有所好转，但达到教育部倡导的睡眠时间的青少年仍是少数，睡眠状况有待改善。</p>\n<p>手机依赖问题：部分青少年可能对手机产生心理依赖 [26]，这可能会对青少年的成长与发展带来负面影响。倡导青少年健康使用手机，减少手机成瘾风险。</p>\n<p>政策和措施的影响：例如 “双减” 政策实施后，有助于青少年的身心健康发展，减少了作业负担，增加了体育运动和兴趣爱好的时间。</p>\n<h3 id=\"232-国外研究现状\"><a class=\"anchor\" href=\"#232-国外研究现状\">#</a> 2.3.2 国外研究现状</h3>\n<p>心理健康问题的普遍性：根据世界卫生组织（WHO），全球 10-19 岁人群中，大约 14% 的青少年患有精神障碍，[27] 这些精神障碍占该年龄组全球疾病负担的。</p>\n<p>心理健康问题的多样性：抑郁症 [28]、焦虑症和行为障碍是青少年患病和残疾的主要因素。自杀是 15-29 岁人群的第四大死因。</p>\n<p>社交媒体对心理健康的影响：国外研究表明，社交媒体的使用显著影响青少年心理健康，包括抑郁症、焦虑症、网络成瘾和睡眠质量等。</p>\n<p>心理健康促进的实践和研究：国外在基于社交媒体 [29] 的青少年心理健康干预方面是研究和实践的热点，但在中国还未广泛采取这一干预方式。</p>\n<p>心理健康的预防和治疗：国外研究强调了青春期是形成对精神健康至关重要的社交和情感习惯的关键时期，包括采用健康的睡眠模式、定期锻炼等。</p>\n<p>心理健康趋势的关注：MDPI Topics 提出 [30] 全球心理健康趋势是当前研究的重点，包括不同人群的心理健康、心理健康促进、改善计划等。</p>\n<p>心理健康监测的发展历程：美国 [31] 在儿童青少年心理健康监测方面有着六十年的发展历史，经历了多个发展阶段，形成了全面的监测框架。</p>\n<h2 id=\"第三章-研究方法\"><a class=\"anchor\" href=\"#第三章-研究方法\">#</a> 第三章 研究方法</h2>\n<h2 id=\"31-研究设计\"><a class=\"anchor\" href=\"#31-研究设计\">#</a> 3.1 研究设计</h2>\n<p>本研究旨在深入探讨和全面分析影响青少年身心健康的多种因素，这些因素不仅包括家庭环境、学校教育、社会文化背景和个体特征，还涉及这些因素如何相互作用和影响青少年的发展。研究将采用多维度的方法来识别这些因素，并评估它们对青少年身心健康的独立和综合影响。</p>\n<p>本研究采用横断面研究设计，结合定量和定性研究方法，以获得全面深入的见解，使用抽样调查方法。</p>\n<h2 id=\"32-研究方法\"><a class=\"anchor\" href=\"#32-研究方法\">#</a> 3.2 研究方法</h2>\n<h3 id=\"321-数据收集\"><a class=\"anchor\" href=\"#321-数据收集\">#</a> 3.2.1 数据收集</h3>\n<p>问卷调查：设计问卷来收集青少年及其家庭、学校和社会环境中的相关信息。</p>\n<p>深度访谈：与青少年、家长、教师和相关专业人士进行一对一访谈，深入了解他们的观点和经历。</p>\n<p>案例研究：选择特定案例进行深入分析，以揭示影响青少年身心健康的具体因素。</p>\n<p>问卷数据来源：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2phY2tkdTY2NjY2Ni9EYXRhLWNvbGxlY3Rpb24tb24tYWRvbGVzY2VudC1tZW50YWwtaGVhbHRo\">https://github.com/jackdu666666/Data-collection-on-adolescent-mental-health</span></p>\n<h3 id=\"322-数据分析\"><a class=\"anchor\" href=\"#322-数据分析\">#</a> 3.2.2 数据分析</h3>\n<p>（1）首先，我们的表格里包含年龄段，性别，年级，与父母关系，家庭活动频率，父母对兴趣爱好支持，父母倾听理解，家庭讨论频率，家庭放松支持，家庭规则执行，课程满意度，学习压力，与老师关系，课堂互动，课外活动丰富度，心理健康关注，同学关系，亲密朋友，集体活动频率，校园欺凌，冲突处理，社交媒体使用时间，社交媒体影响，网络形象担心，网络焦虑，网络暴力严重性，睡眠质量，饮食习惯，体育锻炼频率，身体不适，心理问题困扰，心理咨询意愿，兴趣爱好，未来规划，个人成长因素、心理健康这 36 个数据。</p>\n<p>（2）<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1kYXRhLXBzNWY1dTI2cGg4NGE4NGUueG4tLWNzdlJFQURNRS1uZTZuZzNiaDV4dHc0Ynl4dWo1Z3JwZDh2MnQ1b2EubWQ=\">我们得到了 data.csv 并且设计了分析文档 README.md</span>，我们用代码可以直接得到预设后的数据多元回归模型，根据该模型的输出我们可以得到影响青少年身心健康的影响因素为：</p>\n<p>y = 2.0 + (0.5 * 年龄段) + (0.2 * 性别) + (-0.3 * 年级) + (0.6 * 与父母关系) + (0.4 * 家庭活动频率) + (0.5 * 父母对兴趣爱好支持) + (0.6 * 父母倾听理解) + (0.4 * 家庭讨论频率) + (0.5 * 家庭放松支持) + (0.3 * 家庭规则执行) + (0.4 * 课程满意度) + (-0.5 * 学习压力) + (0.5 * 与老师关系) + (0.3 * 课堂互动) + (0.4 * 课外活动丰富度) + (0.5 * 心理健康关注) + (0.6 * 同学关系) + (0.5 * 亲密朋友) + (0.4 * 集体活动频率) + (-0.6 * 校园欺凌) + (0.4 * 冲突处理) + (-0.3 * 社交媒体使用时间) + (0.4 * 社交媒体影响) + (-0.3 * 网络形象担心) + (-0.5 * 网络焦虑) + (-0.4 * 网络暴力严重性) + (0.6 * 睡眠质量) + (0.5 * 饮食习惯) + (0.5 * 体育锻炼频率) + (-0.4 * 身体不适) + (-0.6 * 心理问题困扰) + (0.4 * 心理咨询意愿) + ε</p>\n<p>（2）其次我们进行热力图分析，热力图（Heatmap）是一种数据可视化工具，用于显示数据矩阵中的数值，并通过颜色编码来表示不同的数值范围。它通常用于展示复杂的数据关系和模式，特别是在显示变量之间的相关性和回归分析结果时。P 值用于检验回归系数的统计显著性。它表示在假设回归系数为零的前提下，观察到当前结果或更极端结果的概率。P 值越小，表示对应自变量的回归系数显著性越高，通常 P 值小于 0.05 被认为是统计显著的。这意味着自变量对因变量的影响是显著的。P 值越大，表示对应自变量的回归系数显著性越低。这意味着自变量对因变量的影响可能不显著。</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps1.jpg)<br />\n 从图上我们可以知道，课程满意度、与父母关系、父母倾听理解、身体健康状况、心理健康困扰对于青少年身心健康的影响最大。</p>\n<p>（3）我们通过将心理健康情况进行筛选：<br />\n![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps2.jpg)</p>\n<p>发现选项里非常健康占 20%，较为健康占 25%，一般占 8%，有些焦虑占 20%，非常焦虑占 12%，有抑郁症占 8%，有很严重的心理疾病占 7%。其中青少年健康状况还行的概率为 53%，这表明半数以上的青少年都拥有者较好的心理。而少半数（28%）青年在心理健康方面有着一点问题。剩下一部分（27%）青年则有着较为严重的心理疾病，亟待我们的关注。</p>\n<p>（4）我们通过筛选，筛出心理健康状况非常差的 - 1 和心理健康非常好的 5，来分析其他因素对 - 1 和 5 的影响。并且做出 - 1 和 5 的热力图如下：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps3.jpg)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps4.jpg)</p>\n<p>通过热力图我们可以知道，当同学的心理非常健康的时候能够影响其心理的因素不多，无非就是课外活动丰富度等课程安排知识。而当同学患有严重心理疾病时，无论是父母对其兴趣爱好的支持、家庭规划、课程范围的各种因素和社交、冲突、网络暴力、身体因素、体育锻炼等均会对其产生非常严重的困扰。我们接下来以同学心理健康的影响因素：父母对兴趣爱好的支持、课外活动丰富度、冲突处理、网络焦虑、体育锻炼频率来具体分析非常焦虑同学的情况</p>\n<p>（5）通过在 ****livegap**** 输入数据分析，我们得到以下结果：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps5.jpg)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps6.jpg)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps7.jpg)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps8.jpg)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps9.jpg)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps10.jpg)</p>\n<p>通过对具有严重心理健康疾病同学的调查问卷结果的分析，我发现了以下显著特点：</p>\n<p><strong>①</strong>　<em><strong>* 家庭对课外活动的支持度低 *</strong></em>****：**** 很多同学的父母对课外活动的支持度很低，只有少数同学表示父母完全支持或比较支持他们的课外活动。大部分同学感到父母不太支持或完全不支持他们的课外活动。家庭对课外活动的支持度低，可能导致同学们缺乏积极的课外参与，进而影响他们的心理健康。家庭支持是学生全面发展的重要因素之一，缺乏家庭的支持和鼓励，学生可能会感到孤立无援，心理负担加重。家长应更多地参与到孩子的课外活动中，给予他们支持和鼓励、学校可以组织家长参与的活动，提高家长对课外活动重要性的认识。</p>\n<p>②　<strong>课程满意度低</strong>：大部分同学对课程设置和教学方法感到不满意。许多同学仅仅表示一般或不太满意，少部分同学甚至表示非常不满意。课程设置和教学方法的满意度低，可能增加同学们的学习压力。教学方法不适合学生的需求，可能导致他们对学习失去兴趣，学习效果不佳，进而增加心理压力。学校应根据学生的反馈，优化课程设置和教学方法，使其更符合学生的需求。并且教师应关注学生的个体差异，采用多样化的教学方法，激发学生的学习兴趣。</p>\n<p>③　<strong>课外活动的丰富度与心理健康相关</strong>：认为课外活动丰富度基本足够和完全足够的同学中，心理非常健康的比例较高。然而，认为课外活动不太足够或完全不够的同学中，严重心理疾病的比例较高。丰富的课外活动可以为学生提供放松和发泄压力的机会，有助于改善他们的心理健康状况。缺乏课外活动可能使学生在紧张的学习环境中无法得到适当的放松和调节，导致心理问题加重。学校应提供丰富多样的课外活动，满足学生的不同兴趣和需求、通过组织各种文体活动和社团活动，帮助学生放松身心，减轻学习压力。</p>\n<p>④　<strong>回避冲突的倾向</strong>：很多同学在面对与同学的冲突时选择了回避冲突，不直接面对。这种回避冲突的方式可能导致矛盾积累，影响他们的心理健康。学生在面对冲突时选择回避，可能导致矛盾积累，进而影响心理健康。回避冲突虽然可以暂时避免冲突，但长期来看，这种方式可能导致内心矛盾和压力增加。学校应为学生提供冲突解决培训，教会他们有效的沟通和解决冲突的方法、设立心理辅导室，为有需要的学生提供心理支持和咨询服务。</p>\n<p>⑤　<strong>网络焦虑普遍存在</strong>：大部分同学经常或有时因为网络使用而感到焦虑。网络焦虑是一个普遍存在的问题。网络焦虑是一个普遍存在的问题，过度使用网络可能导致学生产生焦虑情绪。网络成瘾和网络欺凌等问题，可能对学生的心理健康产生负面影响。学校和家长应共同关注学生的网络使用情况，避免过度使用网络。同时国家应该开展网络安全和网络使用的教育活动，提高学生的网络素养，帮助他们合理使用网络。</p>\n<p>⑥　<strong>缺乏体育锻炼</strong>：很多同学很少进行体育锻炼。缺乏足够的体育锻炼可能对他们的身心健康产生负面影响。体育锻炼对于学生的身心健康非常重要，缺乏足够的体育锻炼可能导致学生身体素质下降，心理压力增加。学校应增加体育课的时间和内容，鼓励学生积极参加体育锻炼。家长应支持和鼓励孩子进行日常锻炼，帮助他们养成良好的锻炼习惯。</p>\n<p>通过以上分析和措施，可以帮助学生改善心理健康状况，提高他们的生活质量和学习效率。学校和家长应共同努力，为学生创造一个健康、积极的成长环境。</p>\n<p>3.2.3 模型建立</p>\n<p>我们选择线性回归模型作为基础模型进行分析。线性回归模型具有简单、易解释的优点，适合初步探索各个自变量对心理健康的影响。为了训练和评估模型，我们将数据集按 80% 的比例划分为训练集和 20% 的测试集。</p>\n<p>模型训练完成后，我们对模型进行了评估。均方误差（MSE）为模型预测误差的平方和的平均值，反映了模型的预测精度。R² 值用于评估模型的拟合优度，值越接近 1，表示模型对数据的解释力越强。通过输出模型的回归系数，我们可以了解每个自变量对心理健康的影响大小和方向。</p>\n<p>最终得到的模型判定结果为：</p>\n<table>\n<thead>\n<tr>\n<th>性能指标</th>\n<th>数值</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>测试集分数</td>\n<td>0.9367668430250391</td>\n</tr>\n<tr>\n<td>交叉验证平均值</td>\n<td>0.9375024016574082</td>\n</tr>\n<tr>\n<td>均方误差</td>\n<td>0.00042429537540674935</td>\n</tr>\n<tr>\n<td>余弦相似度</td>\n<td>0.9991741505605559</td>\n</tr>\n</tbody>\n</table>\n<p>可以知道，改线性回归模型拟合程度非常高。</p>\n<p>3.2.4 模型灵敏度分析</p>\n<p>灵敏度分析的目标是评估不同模型对输入特征变化的响应程度。</p>\n<p>基于预测结果熵值的灵敏度计算通过评估模型预测结果的分布不确定性，来衡量模型的灵敏度。熵值越高，表示模型的预测结果越不确定，灵敏度越高。我们运用以下公式得到熵值：</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps11.jpg)</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml29368\\wps12.jpg)</p>\n<p>熵值越高，表示模型的预测结果越不确定，预测的稳定性越差；熵值越低，表示模型的预测结果越确定，模型的稳定性越高。最终通过检测代码，我们得出该模型的熵值为 1.03。可以知道我们建立的模型拟合程度非常高。上述数据分析方法符合数学规律。</p>\n<h3 id=\"323-研究工具的可靠性和效度\"><a class=\"anchor\" href=\"#323-研究工具的可靠性和效度\">#</a> 3.2.3 研究工具的可靠性和效度</h3>\n<p>确保问卷和访谈指南经过预测试，以评估其可靠性和效度。</p>\n<p>对数据收集过程进行严格的质量控制，确保数据的准确性和一致性。</p>\n<h3 id=\"324-伦理考量\"><a class=\"anchor\" href=\"#324-伦理考量\">#</a> 3.2.4 伦理考量</h3>\n<p>在研究过程中遵循伦理准则，确保参与者的隐私和数据的保密性。</p>\n<p>获得所有参与者的知情同意，并确保他们了解研究的目的、过程和潜在风险。</p>\n<h2 id=\"第四章-影响因素分析\"><a class=\"anchor\" href=\"#第四章-影响因素分析\">#</a> 第四章 影响因素分析</h2>\n<h2 id=\"41-家庭因素\"><a class=\"anchor\" href=\"#41-家庭因素\">#</a> 4.1 家庭因素</h2>\n<p>家庭作为青少年成长的摇篮，对青少年的身心健康起着至关重要的作用。本节将从家庭环境、家庭教育方式和家庭经济状况三个维度，详细分析家庭因素如何影响青少年的发展。</p>\n<h3 id=\"411-家庭环境\"><a class=\"anchor\" href=\"#411-家庭环境\">#</a> 4.1.1 家庭环境</h3>\n<p>家庭环境不仅指物理空间，更包括家庭成员间的情感联系、沟通模式和日常生活的氛围。一个充满爱与支持的家庭环境能够为青少年提供稳定的情感基础，促进其积极的心理发展。本研究将探讨家庭成员间的亲密度、适应性和组织性如何共同作用于青少年的心理健康和社会适应能力。</p>\n<h3 id=\"412-家庭教育方式与家庭经济情况\"><a class=\"anchor\" href=\"#412-家庭教育方式与家庭经济情况\">#</a> 4.1.2 家庭教育方式与家庭经济情况</h3>\n<p>家庭教育方式涵盖了父母对青少年的教育观念、方法和行为。不同的教育方式，如权威型、放任型、权威宽容型等，对青少年的自我认知、自尊和行为发展有显著影响。本研究将分析各种教育方式如何塑造青少年的自主性、责任感和解决问题的能力，并探讨其长期影响。</p>\n<p>家庭经济状况直接影响青少年的物质生活和教育资源获取。经济压力可能导致青少年面临更多的生活不确定性和心理压力，影响其心理健康。同时，家庭的经济状况也与教育投资、健康保障和社会网络等密切相关。本研究将探讨家庭经济状况如何通过不同的途径影响青少年的身心健康。</p>\n<h2 id=\"42-学校因素\"><a class=\"anchor\" href=\"#42-学校因素\">#</a> 4.2 学校因素</h2>\n<p>学校在青少年的社会化过程中扮演着至关重要的角色，它的影响深远且多方面。青少年在学校不仅学习知识和技能，更在人际交往、情感发展、价值观塑造等方面得到锻炼和成长。学校提供了一个结构化的环境，让青少年能够在安全的氛围中探索自我，发现自己的兴趣和潜能。通过与同龄人的互动，他们学习如何建立友谊，解决冲突，以及如何在团队中合作。这些社交技能对于他们将来在社会中的成功至关重要。同时，学校也是价值观和道德教育的场所。在这里，青少年被教导尊重他人、诚实守信，并理解公平正义的重要性。通过参与公民教育和道德讨论，他们学会对社会负责，形成积极的社会责任感。心理健康教育也是学校教育的重要组成部分。专业的心理健康教师和辅导员帮助青少年认识和管理自己的情绪，建立积极的人际关系，这对于他们的个人成长和幸福感至关重要。学校还提供了丰富的文化体验机会，让青少年接触并理解不同的文化背景，培养他们的全球视野和文化包容性。通过参与社区服务和环境保护等社会实践活动，他们学会关心社会，理解个人行为对社会的影响。科技与创新的接触也是现代学校教育的一部分。学校通过引入最新的科技工具和教学方法，激发青少年的好奇心和探索精神，为他们将来在快速变化的世界中立足打下基础。</p>\n<h3 id=\"421-学校教育质量\"><a class=\"anchor\" href=\"#421-学校教育质量\">#</a> 4.2.1 学校教育质量</h3>\n<p>教育质量是衡量学校教育成效的关键指标，它涵盖了课程设置、教学方法、教育资源等多个方面。这些因素共同作用，对学生的学业成就和认知发展产生深远的影响。本研究将深入探讨高质量教育如何促进学生的积极学习态度和自我效能感。课程设置是教育质量的重要组成部分。一个全面、均衡且富有挑战性的课程能够激发学生的好奇心和求知欲。通过提供多样化的学习内容和机会，学生能够在不同的领域探索自己的兴趣，从而培养积极的学习态度。同时，课程的深度和广度也能够促进学生的认知发展，提高他们的思维能力和解决问题的能力。教学方法是影响教育质量的另一个关键因素。有效的教学方法能够适应不同学生的学习风格和需求，使他们能够在最适合自己的方式下学习。例如，通过采用探究式学习、合作学习和项目式学习等方法，教师能够鼓励学生主动参与学习过程，培养他们的批判性思维和创新能力。这种以学生为中心的教学方法有助于提高学生的学习动机和自我效能感。教育资源的丰富性和可获取性也是高质量教育的重要组成部分。充足的教学材料、先进的教学设备和专业的教师团队为学生提供了良好的学习环境和支持。这些资源不仅能够满足学生多样化的学习需求，还能够为他们提供更多的学习机会和挑战，从而促进他们的学业成就和认知发展。</p>\n<h3 id=\"422-同伴关系\"><a class=\"anchor\" href=\"#422-同伴关系\">#</a> 4.2.2 同伴关系</h3>\n<p>同伴关系在青少年的社交发展中起着至关重要的作用，它们是青少年形成自我认知、社会技能和情感发展的重要来源。良好的同伴关系能够为青少年提供一个积极的社交环境，帮助他们建立自信，学习如何与他人合作和解决冲突。在良好的同伴关系中，青少年能够感受到归属感和社会支持，这有助于他们更好地适应学校生活和社会环境。同伴之间的正面互动，如共享经验、互相帮助和鼓励，能够增强青少年的社交技能，包括沟通、同理心和团队合作能力。这些技能对于他们未来的人际关系和职业发展都是宝贵的资产。良好的同伴关系还能够减少青少年的孤独感和排斥感。当青少年感到被同伴接纳和理解时，他们更有可能在学校和社区中积极参与，这有助于他们形成积极的自我形象和社交身份。相反，如果青少年在同伴中感到被排斥或孤立，他们可能会经历孤独和抑郁，这可能会影响他们的心理健康和学业表现。不良的同伴关系可能会带来一系列负面后果。欺凌行为不仅会对受害者造成心理创伤，还可能破坏整个群体的和谐氛围。受欺凌的青少年可能会发展出社交焦虑，害怕与他人交往，这会影响他们的社交能力和个人成长。同时欺凌者本身也可能面临自己的问题，如缺乏同理心、冲动控制问题或家庭环境的影响。不良的同伴关系还可能导致青少年形成消极的社交行为模式，如攻击性、排斥他人或过度竞争。这些行为不仅会损害他们与同伴的关系，还可能影响他们的社会声誉和未来的社交机会。为了促进青少年的社交发展，家长、教师和学校需要共同努力，创造一个支持性和包容性的社交环境。</p>\n<h3 id=\"423-教师态度\"><a class=\"anchor\" href=\"#423-教师态度\">#</a> 4.2.3 教师态度</h3>\n<p>教师的态度和行为对学生的心理健康具有深远的影响，它们在塑造学生的自我认知、学习态度和情绪状态方面发挥着关键作用。教师的支持和积极反馈是学生自信心和学习动力的重要来源。当教师展现出关心、尊重和鼓励时，学生会感到被重视和理解，这有助于他们建立积极的自我形象和自我效能感。</p>\n<p>教师的积极态度能够创造一个安全、包容的学习环境，让学生感到舒适地表达自己的观点和想法。在这样的环境中，学生更愿意参与课堂讨论，尝试新事物，即使面临挑战和失败，也能够从中学习和成长。教师的鼓励和认可可以激发学生的内在动机，使他们对学习保持持续的兴趣和热情。教师的正面反馈对于学生的学业成就至关重要。当教师提供具体、及时的反馈时，学生能够了解自己的进步和需要改进的地方。这种反馈不仅能够帮助学生提高学术表现，还能够增强他们的自我效能感，让他们相信自己有能力克服困难和实现目标。如果教师表现出忽视或负面态度，可能会对学生的心理健康产生不利影响。例如，过度批评、不公平的对待或缺乏关注可能会让学生感到自己不被重视或不被理解。这种经历可能会导致学生产生自我怀疑，降低他们的自信心和学习动力，甚至可能导致焦虑和抑郁等情绪问题。</p>\n<p>教师的行为和态度还会影响学生的社会关系和社交技能。一个支持性的教师能够作为榜样，展示如何建立积极的人际关系和有效沟通。相反，如果教师表现出排斥或歧视的行为，学生可能会模仿这些行为，影响他们与同伴的互动和社交能力的发展。</p>\n<h2 id=\"43-社会文化因素\"><a class=\"anchor\" href=\"#43-社会文化因素\">#</a> 4.3 社会文化因素</h2>\n<p>社会文化环境是青少年价值观和行为模式形成的重要背景，它通过家庭、学校、媒体、社区等多个渠道对青少年产生影响。这个环境不仅塑造了青少年对世界的认知，还对他们的信仰、态度和行为习惯产生了深远的影响。</p>\n<h3 id=\"431-社会价值观\"><a class=\"anchor\" href=\"#431-社会价值观\">#</a> 4.3.1 社会价值观</h3>\n<p>社会文化环境在青少年价值观和行为模式的形成中扮演着至关重要的角色。它是一个多维度的综合体，涵盖了家庭、学校、媒体、社区等多个方面，这些因素相互作用，共同塑造青少年的思想和行为。</p>\n<p>家庭是青少年社会化过程中的第一课堂。家庭成员的价值观、行为习惯、交流方式以及对青少年的教育和期望，都对青少年的早期发展和价值观形成有着直接的影响。父母的言行举止、对待问题的态度、以及对青少年的鼓励和支持，都会成为青少年学习和模仿的榜样。</p>\n<p>学校作为青少年社会化的主要场所之一，通过教育体系和校园文化，向青少年传授社会规范和期望。学校教育不仅包括学术知识的传授，还包括公民教育、道德教育和多元文化教育等，这些都是青少年价值观形成的重要内容。学校中的教师、同学以及各种教育活动，都对青少年的社会认知和行为习惯产生影响。</p>\n<h3 id=\"432-媒体影响\"><a class=\"anchor\" href=\"#432-媒体影响\">#</a> 4.3.2 媒体影响</h3>\n<p>媒体和互联网作为现代社会的重要组成部分，对青少年的影响日益增强。电影、电视节目、社交媒体、在线游戏等媒体内容，都在传递特定的价值观和生活方式。这些媒体内容可能会塑造青少年对于成功、幸福、人际关系和社会角色的看法。同时，媒体中的信息也可能包含暴力、歧视、物质主义等负面信息，需要家长和教育者的正确引导。</p>\n<h3 id=\"433-文化活动\"><a class=\"anchor\" href=\"#433-文化活动\">#</a> 4.3.3 文化活动</h3>\n<p>社区和同龄人群体为青少年提供了学习和实践社会规范的机会。社区活动、志愿服务和同龄人之间的互动，都是青少年学习合作、尊重和责任感的重要途径。社区中的榜样人物和成功故事也能够激励青少年形成积极的价值观。</p>\n<p>社会文化环境中的多样性也是青少年价值观形成的重要因素。接触不同的文化、宗教和生活方式，能够帮助青少年开阔视野，培养包容和尊重差异的态度。这种多样性的体验有助于青少年形成更加全面和平衡的世界观。</p>\n<h2 id=\"44-个体因素\"><a class=\"anchor\" href=\"#44-个体因素\">#</a> 4.4 个体因素</h2>\n<p>个体因素，包括青少年的生理特征、心理特质、能力倾向等，对他们的身心健康有着直接且深刻的影响。这些因素共同作用于青少年的成长过程，影响着他们的自我认知、情绪调节、社交能力和应对策略。</p>\n<h3 id=\"441-生理特征\"><a class=\"anchor\" href=\"#441-生理特征\">#</a> 4.4.1 生理特征</h3>\n<p>生理特征如性别、年龄和遗传因素，为青少年的身心发展提供了基础条件。例如，青春期的生理变化不仅影响着青少年的身体健康，还可能引起情绪波动和自我认同的探索。此外，遗传因素可能影响青少年对某些疾病的易感性，以及他们在智力、运动能力等方面的潜力。</p>\n<h3 id=\"442-心理健康状况\"><a class=\"anchor\" href=\"#442-心理健康状况\">#</a> 4.4.2 心理健康状况</h3>\n<p>心理特质如性格、情绪稳定性和自我效能感，对青少年的心理健康至关重要。性格开朗、情绪稳定的青少年更有可能展现出积极的社交行为和良好的应对压力的能力。自我效能感，即个体对自己完成特定任务的信心，能够激励青少年面对挑战，提高他们的适应能力和恢复力。</p>\n<h3 id=\"443-能力倾向\"><a class=\"anchor\" href=\"#443-能力倾向\">#</a> 4.4.3 能力倾向</h3>\n<p>能力倾向包括认知能力、创造力和社交技能等，影响着青少年的学习表现和社交互动。认知能力较强的青少年可能在学习上更加得心应手，而创造力丰富的青少年可能在解决问题和创新思维方面表现出色。社交技能的高低则直接关系到青少年与同伴、家庭成员和教师的关系质量。</p>\n<h2 id=\"第五章-结论与展望\"><a class=\"anchor\" href=\"#第五章-结论与展望\">#</a> 第五章 结论与展望</h2>\n<h2 id=\"51-结论\"><a class=\"anchor\" href=\"#51-结论\">#</a> 5.1 结论</h2>\n<p>通过综合分析家庭、学校、社会文化和个体特征四个维度，深入探讨了影响青少年身心健康的多种因素。研究结果表明，家庭环境的和谐、教育方式的合理性、经济状况的稳定性对青少年的心理健康具有显著的积极作用。学校教育的质量、师生关系和同伴互动对青少年的社会适应能力和心理发展至关重要。社会文化因素，包括社会价值观、媒体影响和文化活动，也在塑造青少年的世界观和价值观。此外，青少年的个性特征、[32] 心理健康状况和生理发育是影响其身心健康的关键个体因素。</p>\n<p>通过定量和定性相结合的研究方法，本研究收集了丰富的第一手资料，采用问卷调查、深度访谈和案例研究等多种方式，确保了研究结果的全面性和可靠性。数据分析结果进一步证实了理论假设，即综合考虑多方面因素，制定个性化的干预措施对于促进青少年身心健康具有重要意义。</p>\n<h2 id=\"52-研究局限与展望\"><a class=\"anchor\" href=\"#52-研究局限与展望\">#</a> 5.2 研究局限与展望</h2>\n<p>尽管在理论和实践层面提供了有价值的见解和建议，但也存在一定的局限性 [33]。样本选择的代表性和研究范围的广泛性有待进一步验证和扩展。未来研究可以在更广泛的地区和更多样化的青少年群体中进行，以提高研究结果的普遍适用性。</p>\n<p>研究主要关注了当前影响青少年身心健康的因素，但对于这些因素随时间变化的动态过程和长期影响的探讨不足。未来的研究可以采用纵向研究设计，追踪青少年在不同发展阶段的身心健康状况，以揭示影响因素的长期效应。此外在干预措施的制定和评估方面还不够深入。未来的研究可以更加关注如何根据青少年的个体差异和需求，设计和实施有效的干预策略，并对其效果进行科学评估。</p>\n<h2 id=\"53-政策建议\"><a class=\"anchor\" href=\"#53-政策建议\">#</a> 5.3 政策建议</h2>\n<p>基于本文的主要研究内容提出以下政策建议：</p>\n<p>\\1. 加强家庭支持政策，提供家庭教育指导和经济援助，以改善家庭环境和青少年的心理健康。</p>\n<p>\\2. 优化学校教育体系，提高教育质量，加强师生关系和同伴互动，促进青少年的社会适应能力和心理发展。</p>\n<p>\\3. 引导社会文化环境的健康发展，加强对媒体内容的监管和青少年的文化活动参与，培养积极的价值观和行为模式。</p>\n<p>\\4. 关注青少年个体差异，提供个性化的教育和心理健康服务，以满足不同青少年的需求。</p>\n<h2 id=\"54-展望\"><a class=\"anchor\" href=\"#54-展望\">#</a> 5.4 展望</h2>\n<p>本文虽然为理解青少年身心健康的影响因素提供了一些见解，但也指出了未来研究的潜在方向。需要进一步扩大研究范围，包括不同地区、不同文化背景的青少年，以增强研究结果的普遍性和适用性。随着社会环境的快速变化，持续监测青少年所面临的新挑战和风险因素是必要的。未来的研究还应该考虑采用纵向研究设计，以便更好地理解青少年身心健康的发展趋势和长期影响。这种设计有助于揭示影响因素随时间的动态变化，以及它们对青少年成长过程中的累积效应。未来的工作应该集中于开发和评估定制化的干预计划，这些计划应考虑到青少年的独特需求和背景。通过实施这些计划并评估其效果，可以为实践者和政策制定者提供有价值的反馈和指导。</p>\n<p>技术的进步为青少年研究提供了新的工具和方法。利用大数据、人工智能和机器学习等先进技术，可以更有效地收集、分析和解释数据，从而提高研究的精确度和深度。青少年的身心健康是一个多学科领域的问题，需要教育学、心理学、社会学、公共卫生等多个学科的合作。未来的研究应该鼓励跨学科的合作，以全面地解决青少年面临的问题，并促进他们的整体福祉。</p>\n<h2 id=\"参考文献\"><a class=\"anchor\" href=\"#参考文献\">#</a> 参考文献</h2>\n<p>[1] 张涛。守护青少年健康成长 [J]. 北京观察，2024,(05):22-23.</p>\n<p>[2] 龙源，邱庆兰，龙艺红。家庭教育对青少年发展的影响 [J]. 大众文艺，2024,(07):199-201.</p>\n<p>[3] 杨栢权，赵晓明。青少年成长的家庭教育问题浅析 [J]. 公关世界，2024,(01):148-150.</p>\n<p>[4] 江伟。家庭累积风险对青少年内化问题的影响：成长型思维的中介作用 [J]. 合肥师范学院学报，2024,42 (01):105-109.</p>\n<p>[5] 周文清。家庭社会资本对青少年体育锻炼意识与行为的影响及反思探析 [J]. 田径，2024,(01):77-78.</p>\n<p>[6] 杨雄。家校社协同育人护航青少年成长 [J]. 晨刊，2022,(05):10-13.</p>\n<p>[7] 张雅楠，杨淑萍。青少年 “多源异质” 成长经验对学校德育意味着什么？[J]. 教育科学研究，2021,(07):79-83.</p>\n<p>[8] 王笑寒。青少年健康成长的校园 “保护伞”—— 关于开发设置学校社会工作岗位的思考 [J]. 中国民族博览，2020,(13):109-111.</p>\n<p>[9] 陈双红，李戬。网红现象对青少年成长的影响及对策研究 [J]. 新生代，2021,(05):45-49.</p>\n<p>[10] 陈书崇。心理与教育统计学课程教学改革中大学生实证研究能力的培养 [J]. 太原城市职业技术学院学报，2013,(03):126-127.</p>\n<p>[11] 李迪。中国教育统计学产生与发展及基于问题初探 [J]. 黑龙江教育学院学报，2013,32 (04):1-2.</p>\n<p>[12] 曾燕波。青少年校外教育发展研究 [J]. 青年发展论坛，2023,33 (05):82-89.</p>\n<p>[13] 郑浩，范策，安杰。美国国际青年发展政策的理论范式与实践路径 [J]. 青少年学刊，2023,(04):3-13.</p>\n<p>[14] 胡梦迪，王睿。青少年身心健康研究现状的可视化分析 [J]. 中国校医，2024,38 (02):100-104.</p>\n<p>[15] 王茹，马晶晶，钱丽菊，等。儿童青少年抑郁症患者照顾者身心健康状况及相关心理社会因素 [J]. 临床精神医学杂志，2024,34 (03):227-230.</p>\n<p>[16] [1] 孙莹。青少年身心健康需要更广泛的心理社会支持 [J]. 中国学校卫生，2021,42 (07):961-963.</p>\n<p>[17] 李宝国，韩童。多维视角下我国青少年健康促进途径研究 [J]. 体育世界 (学术版),2018,(02):21+18.</p>\n<p>[18] 林延敏，马楠，卢金逵。特殊家庭结构与青少年身心健康的关系 [J]. 中国学校卫生，2022,43 (10):1480-1483+1487.</p>\n<p>[19] 佘双好，马国亮。当代青少年身心健康发展的新特点与对策 [J]. 青年探索，2010,(05):85-91.</p>\n<p>[20] 巩浩。少年阶段未成年人身心健康社会保护现状和解决路径 [J]. 法制博览，2022,(09):133-135.</p>\n<p>[21] 刘超。共谋与失序：青少年抑郁的 “泛疾病化”[J]. 当代青年研究，2023,(02):74-84.</p>\n<p>[22] 董彦会，陈璐，马军，等。构建高水平学校卫生体系促进学生常见病共防行动 [J]. 中国学校卫生，2024,45 (05):609-614.</p>\n<p>[23] 赵松涛，李丽萍，孙振晓，等。青少年学生心理健康管理模式的构建 [J]. 山东医学高等专科学校学报，2024,46 (03):29-31.</p>\n<p>[24] 《青少年抑郁障碍中西医结合防治指南》编写组，中华中医药学会心身医学分会，中华医学会心身医学分会。青少年抑郁障碍中西医结合防治指南 [J]. 北京中医药大学学报，2024,47 (06):874-888.</p>\n<p>[25] 周建伟。休闲足球运动对儿童青少年身心健康影响的研究进展 [J]. 中国学校卫生，2024,45 (03):452-456.</p>\n<p>[26] 李晓铭。手机与青少年身心健康 [J]. 中国青年政治学院学报，2011,30 (05):30.</p>\n<p>[27] Firth J ,Schuch F ,Mittal A V .Using exercise to protect physical and mental health in youth at risk for psychosis[J].Research in Psychotherapy Psychopathology Process and Outcome,2020,23(1):433-433.</p>\n<p>[28] Biesecker L C ,Pössel P ,Botran F R .Discrimination, cognitive styles, and their associations with adolescents' mental and physical health.[J].Research in nursing &amp; health,2024,47(2):172-181.</p>\n<p>[29] Nadine Z ,Rita D ,Joelle K A , et al.Media, Technology Use, and Attitudes: Associations With Physical and Mental Well-Being in Youth With Implications for Evidence-Based Practice.[J].Worldviews on evidence-based nursing,2018,15(4):304-312.</p>\n<p>[30] Olfson M ,McClellan C ,Zuvekas H S , et al.Mental Health Impairment and Outpatient Mental Health Care of US Children and Adolescents.[J].JAMA psychiatry,2024,</p>\n<p>[31] Ciarrochi J ,Sahdra K B ,Yap K , et al.The Role of Nonattachment in the Development of Adolescent Mental Health: a Three-Year Longitudinal Study[J].Mindfulness,2020,11(9):2131-2139.</p>\n<p>[32] 万永春，孟亚。中国儿童青少年心理健康研究 20 年：研究热点、知识图谱与发展趋势 [J]. 心理研究，2024,17 (01):87-96.</p>\n<p>[33] 陈冰，胡楚晨，赵玉芳。低阶层青少年为何更易出现心理健康问题？—— 基于社会生态视角的多重中介分析 [J]. 辽宁师范大学学报 (社会科学版),2024,47 (02):105-113.</p>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "homework"
            ]
        }
    ]
}