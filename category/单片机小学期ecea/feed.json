{
    "version": "https://jsonfeed.org/version/1",
    "title": "Hexo • All posts by \"单片机小学期ecea\" category",
    "description": "",
    "home_page_url": "https://enjundu.github.io",
    "items": [
        {
            "id": "https://enjundu.github.io/ECEA/3%E4%B8%B2%E5%8F%A3%E6%89%93%E5%8D%B0/",
            "url": "https://enjundu.github.io/ECEA/3%E4%B8%B2%E5%8F%A3%E6%89%93%E5%8D%B0/",
            "title": "Connect serial port to print text",
            "date_published": "2024-07-03T10:43:21.000Z",
            "content_html": "<h1 id=\"connect-serial-port-to-print-text\"><a class=\"anchor\" href=\"#connect-serial-port-to-print-text\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VuanVuRHUvRUNFQS1wcmFjdGljZS1CSVQtY29tcHV0ZXItcHJvZ3JhbW1pbmc=\">Connect serial port to print text</span></h1>\n<h2 id=\"实验要求\"><a class=\"anchor\" href=\"#实验要求\">#</a> 实验要求</h2>\n<ul>\n<li>串口打印文本</li>\n<li>用直接配置串口的方式，向 PC 传输一句话</li>\n<li>在 FLASH 中存储一句话，并用 DMA 配置串口向 PC 传输</li>\n</ul>\n<h2 id=\"代码user\"><a class=\"anchor\" href=\"#代码user\">#</a> 代码 User\\</h2>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;bsp_usart.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// define the starting address of the Flash&#x27;s storing room</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> FLASH_STRING_ADDRESS 0x08008000</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Define the string which will be stored in FLASH</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">char</span> flashString[] = <span class=\"string\">&quot;And you are beautiful too!(sending from FLASH!)\\r\\n&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">main</span><span class=\"params\">(<span class=\"type\">void</span>)</span> &#123;</span><br><span class=\"line\">    USART_Config();<span class=\"comment\">//initialization</span></span><br><span class=\"line\">\t\tUsart_SendString(USART1,<span class=\"string\">&quot;dgg is so handsome,isn&#x27;t he?&quot;</span>);</span><br><span class=\"line\"> <span class=\"comment\">// Store the string in FLASH</span></span><br><span class=\"line\">    FLASH_Unlock();<span class=\"comment\">//unlock the FLASH</span></span><br><span class=\"line\">    FLASH_ClearFlag(FLASH_FLAG_EOP | FLASH_FLAG_PGERR | FLASH_FLAG_WRPRTERR);</span><br><span class=\"line\">    <span class=\"type\">uint32_t</span> flashAddress = FLASH_STRING_ADDRESS;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">char</span> *sourceAddress = flashString;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (*sourceAddress) &#123;</span><br><span class=\"line\">        FLASH_ProgramWord(flashAddress, *sourceAddress);</span><br><span class=\"line\">        flashAddress += <span class=\"number\">4</span>; <span class=\"comment\">// Increment by 4 bytes for each word</span></span><br><span class=\"line\">        sourceAddress++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    FLASH_Lock();<span class=\"comment\">//Lock the FLASH</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Transmit the stored string using DMA</span></span><br><span class=\"line\">    Usart_SendStringDMA(USART1, flashString);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"userusart\"><a class=\"anchor\" href=\"#userusart\">#</a> User\\usart</h2>\n<h3 id=\"bsp_usartc\"><a class=\"anchor\" href=\"#bsp_usartc\">#</a> bsp_usart.c</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;bsp_usart.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">USART_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA|RCC_APB2Periph_USART1,ENABLE);</span><br><span class=\"line\">  GPIO_InitTypeDef GPIO_InitStructure;</span><br><span class=\"line\">\t</span><br><span class=\"line\">  <span class=\"comment\">//USART1 Tx(PA.09) </span></span><br><span class=\"line\">  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9; </span><br><span class=\"line\">\tGPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;</span><br><span class=\"line\">  GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class=\"line\">  GPIO_Init(GPIOA, &amp;GPIO_InitStructure);</span><br><span class=\"line\">  <span class=\"comment\">//USART1 Rx(PA.10) </span></span><br><span class=\"line\">  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_10; </span><br><span class=\"line\">\tGPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING; </span><br><span class=\"line\">  GPIO_Init(GPIOA, &amp;GPIO_InitStructure);</span><br><span class=\"line\">\t</span><br><span class=\"line\">  USART_InitTypeDef USART_InitStructure;</span><br><span class=\"line\">  <span class=\"comment\">//USART1</span></span><br><span class=\"line\">  USART_InitStructure.USART_BaudRate = <span class=\"number\">9600</span>; </span><br><span class=\"line\">  USART_InitStructure.USART_WordLength = USART_WordLength_8b; </span><br><span class=\"line\">  USART_InitStructure.USART_StopBits = USART_StopBits_2; </span><br><span class=\"line\">  USART_InitStructure.USART_Parity = USART_Parity_No; </span><br><span class=\"line\">  USART_InitStructure.USART_Mode = USART_Mode_Tx | USART_Mode_Rx;</span><br><span class=\"line\">  USART_InitStructure.USART_HardwareFlowControl = USART_HardwareFlowControl_None; </span><br><span class=\"line\">  USART_Init(USART1, &amp;USART_InitStructure);</span><br><span class=\"line\">\t</span><br><span class=\"line\">  USART_Cmd(USART1, ENABLE);  </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Usart_SendByte</span><span class=\"params\">(USART_TypeDef * pUSARTx, <span class=\"type\">uint8_t</span> ch)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  USART_SendData(pUSARTx, ch);  </span><br><span class=\"line\">  <span class=\"keyword\">while</span>(USART_GetFlagStatus(pUSARTx, USART_FLAG_TXE) == RESET);  </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Usart_SendString</span><span class=\"params\">(USART_TypeDef * pUSARTx, <span class=\"type\">char</span> *str)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"type\">unsigned</span> <span class=\"type\">int</span> k=<span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">do</span> </span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    Usart_SendByte(pUSARTx, *(str + k));</span><br><span class=\"line\">    k++;</span><br><span class=\"line\">  &#125;<span class=\"keyword\">while</span>(*(str + k) != <span class=\"string\">&#x27;\\0&#x27;</span>); </span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">while</span>(USART_GetFlagStatus(pUSARTx, USART_FLAG_TC) == RESET) </span><br><span class=\"line\">  &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Usart_SendStringDMA</span><span class=\"params\">(USART_TypeDef *pUSARTx, <span class=\"type\">const</span> <span class=\"type\">char</span> *str)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    DMA_InitTypeDef DMA_InitStructure;</span><br><span class=\"line\">    <span class=\"comment\">// Configure DMA</span></span><br><span class=\"line\">    RCC_AHBPeriphClockCmd(RCC_AHBPeriph_DMA1, ENABLE);</span><br><span class=\"line\"></span><br><span class=\"line\">    DMA_DeInit(DMA1_Channel4); <span class=\"comment\">// USART1 TX channel</span></span><br><span class=\"line\"></span><br><span class=\"line\">    DMA_InitStructure.DMA_PeripheralBaseAddr = (<span class=\"type\">uint32_t</span>)&amp;pUSARTx-&gt;DR;</span><br><span class=\"line\">    DMA_InitStructure.DMA_MemoryBaseAddr = (<span class=\"type\">uint32_t</span>)str;</span><br><span class=\"line\">    DMA_InitStructure.DMA_DIR = DMA_DIR_PeripheralDST; <span class=\"comment\">// Transfer from FLASH to PC</span></span><br><span class=\"line\">    DMA_InitStructure.DMA_BufferSize = <span class=\"built_in\">strlen</span>(str);<span class=\"comment\">//Define using bytes of a string</span></span><br><span class=\"line\">    DMA_InitStructure.DMA_PeripheralInc = DMA_PeripheralInc_Disable;</span><br><span class=\"line\">    DMA_InitStructure.DMA_MemoryInc = DMA_MemoryInc_Enable;\t</span><br><span class=\"line\">    DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_Byte;</span><br><span class=\"line\">    DMA_InitStructure.DMA_MemoryDataSize = DMA_MemoryDataSize_Byte;<span class=\"comment\">//Data will be transmitted in bytes from the source address to the destination address</span></span><br><span class=\"line\">    DMA_InitStructure.DMA_Mode = DMA_Mode_Normal;</span><br><span class=\"line\">    DMA_InitStructure.DMA_Priority = DMA_Priority_High;</span><br><span class=\"line\">    DMA_InitStructure.DMA_M2M = DMA_M2M_Disable; <span class=\"comment\">// Memory to memory disabled</span></span><br><span class=\"line\">    DMA_Init(DMA1_Channel4, &amp;DMA_InitStructure);</span><br><span class=\"line\"></span><br><span class=\"line\">    USART_DMACmd(pUSARTx, USART_DMAReq_Tx, ENABLE);    <span class=\"comment\">// Open USART DMA TX</span></span><br><span class=\"line\"></span><br><span class=\"line\">    DMA_Cmd(DMA1_Channel4, ENABLE);    <span class=\"comment\">// Enable DMA channel</span></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"bsp_usarth\"><a class=\"anchor\" href=\"#bsp_usarth\">#</a> bsp_usart.h</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifndef</span> BSP_USART_H</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> BSP_USART_H</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">USART_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Usart_SendByte</span><span class=\"params\">(USART_TypeDef * pUSARTx, <span class=\"type\">uint8_t</span> ch)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Usart_SendString</span><span class=\"params\">(USART_TypeDef * pUSARTx, <span class=\"type\">char</span> *str)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Usart_SendStringDMA</span><span class=\"params\">(USART_TypeDef *pUSARTx, <span class=\"type\">const</span> <span class=\"type\">char</span> *str)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span> <span class=\"comment\">// BSP_USART_H</span></span></span><br></pre></td></tr></table></figure></p>\n<h1 id=\"tool\"><a class=\"anchor\" href=\"#tool\">#</a> tool:</h1>\n<p>SerialPortUtility.exe</p>\n",
            "tags": [
                "Hexo",
                "Front Matter"
            ]
        },
        {
            "id": "https://enjundu.github.io/ECEA/4%E4%BA%A7%E7%94%9F%E4%B8%83%E8%89%B2%E7%81%AF/",
            "url": "https://enjundu.github.io/ECEA/4%E4%BA%A7%E7%94%9F%E4%B8%83%E8%89%B2%E7%81%AF/",
            "title": "Generate colorful lights",
            "date_published": "2024-07-03T10:43:21.000Z",
            "content_html": "<h1 id=\"generate-colorful-lights\"><a class=\"anchor\" href=\"#generate-colorful-lights\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VuanVuRHUvRUNFQS1wcmFjdGljZS1CSVQtY29tcHV0ZXItcHJvZ3JhbW1pbmc=\">Generate colorful lights</span></h1>\n<h2 id=\"实验介绍\"><a class=\"anchor\" href=\"#实验介绍\">#</a> 实验介绍</h2>\n<ul>\n<li>产生七色灯</li>\n<li>以 TIM3 输出 PWM，控制全彩 LED 灯变换颜色</li>\n<li>以另一个 TIM 作为计数器，每 1s 产生 1 次中断</li>\n<li>以中断控制一个状态机，改变全彩灯的 CCR</li>\n<li>达到效果：赤 - 橙 - 黄 - 绿 - 青 - 蓝 - 紫，七种颜色循环切换，每 1s 切换一个颜色</li>\n</ul>\n<h2 id=\"user\"><a class=\"anchor\" href=\"#user\">#</a> USER</h2>\n<h3 id=\"mainc\"><a class=\"anchor\" href=\"#mainc\">#</a> main.c</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;LED_PWM.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">main</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//Ensure interrupt priority</span></span><br><span class=\"line\">\t\tNVIC_InitTypeDef NVIC_InitStructure;</span><br><span class=\"line\">\t\tNVIC_InitStructure.NVIC_IRQChannel = TIM4_IRQn;</span><br><span class=\"line\">\t\tNVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = <span class=\"number\">0</span>; </span><br><span class=\"line\">\t\tNVIC_InitStructure.NVIC_IRQChannelSubPriority = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\tNVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;</span><br><span class=\"line\">\t\tNVIC_Init(&amp;NVIC_InitStructure);</span><br><span class=\"line\">\t</span><br><span class=\"line\">    COLOR_TIMx_GPIO_Config();</span><br><span class=\"line\">    COLOR_PWM_Config();</span><br><span class=\"line\">    COLOR_TIMx4_Config();</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>) &#123;   </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"led_pwmc\"><a class=\"anchor\" href=\"#led_pwmc\">#</a> LED_PWM.c</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;LED_PWM.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_gpio.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_tim.h&quot;</span> </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">RCC_Configuration</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    RCC_APB2PeriphClockCmd(RCC_APB2Periph_AFIO, ENABLE);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">COLOR_TIMx_GPIO_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\tRCC_Configuration();</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\tRCC_APB2PeriphClockCmd(COLOR_TIM_GPIO_CLK, ENABLE);</span><br><span class=\"line\">\tGPIO_PinRemapConfig(GPIO_PartialRemap_TIM3, ENABLE);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tGPIO_InitTypeDef GPIO_InitStructure;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// red</span></span><br><span class=\"line\">    GPIO_InitStructure.GPIO_Pin = COLOR_RED_TIM_LED_PIN;</span><br><span class=\"line\">    GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;</span><br><span class=\"line\">    GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class=\"line\">    GPIO_Init(COLOR_RED_TIM_LED_PORT, &amp;GPIO_InitStructure);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// green</span></span><br><span class=\"line\">    GPIO_InitStructure.GPIO_Pin = COLOR_GREEN_TIM_LED_PIN;</span><br><span class=\"line\">    GPIO_Init(COLOR_GREEN_TIM_LED_PORT, &amp;GPIO_InitStructure);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// blue</span></span><br><span class=\"line\">    GPIO_InitStructure.GPIO_Pin = COLOR_BLUE_TIM_LED_PIN;</span><br><span class=\"line\">    GPIO_Init(COLOR_BLUE_TIM_LED_PORT, &amp;GPIO_InitStructure);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">COLOR_PWM_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tTIM_TimeBaseInitTypeDef TIM_TimeBaseStructure;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tRCC_APB1PeriphClockCmd(COLOR_TIM_CLK,ENABLE);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tTIM_TimeBaseStructure.TIM_Period = <span class=\"number\">255</span>;</span><br><span class=\"line\">\tTIM_TimeBaseStructure.TIM_Prescaler = <span class=\"number\">4000</span>;</span><br><span class=\"line\">\tTIM_TimeBaseStructure.TIM_ClockDivision=TIM_CKD_DIV1;</span><br><span class=\"line\">\tTIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;</span><br><span class=\"line\">\tTIM_TimeBaseInit(COLOR_TIMx,&amp;TIM_TimeBaseStructure);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tTIM_OCInitTypeDef TIM_OCInitStucture;</span><br><span class=\"line\">\tTIM_OCInitStucture.TIM_OCMode = TIM_OCMode_PWM1;</span><br><span class=\"line\">\tTIM_OCInitStucture.TIM_OutputState = TIM_OutputState_Enable;</span><br><span class=\"line\">\tTIM_OCInitStucture.TIM_Pulse = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tTIM_OCInitStucture.TIM_OCPolarity = TIM_OCPolarity_Low;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"comment\">//  OC2 red</span></span><br><span class=\"line\">    TIM_OC2Init(COLOR_TIMx, &amp;TIM_OCInitStucture);</span><br><span class=\"line\">    TIM_OC2PreloadConfig(COLOR_TIMx, TIM_OCPreload_Enable);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  OC3 green</span></span><br><span class=\"line\">    TIM_OC3Init(COLOR_TIMx, &amp;TIM_OCInitStucture);</span><br><span class=\"line\">    TIM_OC3PreloadConfig(COLOR_TIMx, TIM_OCPreload_Enable);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  OC4 blue</span></span><br><span class=\"line\">    TIM_OC4Init(COLOR_TIMx, &amp;TIM_OCInitStucture);</span><br><span class=\"line\">    TIM_OC4PreloadConfig(COLOR_TIMx, TIM_OCPreload_Enable);</span><br><span class=\"line\"></span><br><span class=\"line\">\t</span><br><span class=\"line\">\tTIM_ARRPreloadConfig(COLOR_TIMx,ENABLE);</span><br><span class=\"line\">\tTIM_Cmd(COLOR_TIMx,ENABLE);</span><br><span class=\"line\">\t</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">COLOR_TIMx4_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    TIM_TimeBaseInitTypeDef TIM_TimeBaseStructure;</span><br><span class=\"line\">    RCC_APB1PeriphClockCmd(COLOR_TIM4_CLK, ENABLE);</span><br><span class=\"line\"><span class=\"comment\">/*Clock Frequency: Assuming the system clock frequency is 72 MHz.</span></span><br><span class=\"line\"><span class=\"comment\">\tPrescaler Value: The prescaler is set to 10000 - 1.</span></span><br><span class=\"line\"><span class=\"comment\">\tPeriod Value: The period is set to 7200 - 1.</span></span><br><span class=\"line\"><span class=\"comment\">\tConsequently, the timer clock frequency after prescaling is 7.2 kHz (72 MHz / 10000).</span></span><br><span class=\"line\"><span class=\"comment\">\tThe timer starts counting from 0 and triggers an interrupt when it reaches a count of 7199 (7200 - 1). </span></span><br><span class=\"line\"><span class=\"comment\">\tThe time interval can be calculated as follows:</span></span><br><span class=\"line\"><span class=\"comment\">\tTime = Number of Periods / Timer Clock Frequency</span></span><br><span class=\"line\"><span class=\"comment\">\tTime = 7199 / 7200 ˜ 0.999722 seconds</span></span><br><span class=\"line\"><span class=\"comment\">\tTherefore, in practice, the timer will trigger an interrupt after approximately 0.999722 </span></span><br><span class=\"line\"><span class=\"comment\">\tseconds, which is close to 1 second.*/</span></span><br><span class=\"line\">    TIM_TimeBaseStructure.TIM_Period = <span class=\"number\">7200</span> - <span class=\"number\">1</span>;</span><br><span class=\"line\">    TIM_TimeBaseStructure.TIM_Prescaler =<span class=\"number\">10000</span> - <span class=\"number\">1</span>; </span><br><span class=\"line\">\t</span><br><span class=\"line\">    TIM_TimeBaseStructure.TIM_ClockDivision = TIM_CKD_DIV1;</span><br><span class=\"line\">    TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;</span><br><span class=\"line\">    TIM_TimeBaseInit(COLOR_TIMx4, &amp;TIM_TimeBaseStructure);</span><br><span class=\"line\"></span><br><span class=\"line\">    TIM_ITConfig(COLOR_TIMx4, TIM_IT_Update, ENABLE); <span class=\"comment\">// Enable update interrupt</span></span><br><span class=\"line\">    TIM_Cmd(COLOR_TIMx4, ENABLE);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Add these definitions at the beginning of your .c file</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">enum</span> &#123;</span></span><br><span class=\"line\">    COLOR_RED,</span><br><span class=\"line\">    COLOR_ORANGE,</span><br><span class=\"line\">    COLOR_YELLOW,</span><br><span class=\"line\">    COLOR_GREEN,</span><br><span class=\"line\">    COLOR_CYAN,</span><br><span class=\"line\">    COLOR_BLUE,</span><br><span class=\"line\">    COLOR_PURPLE</span><br><span class=\"line\">&#125; ColorState;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> currentColor=<span class=\"number\">-1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">TIM4_IRQHandler</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (TIM_GetITStatus(COLOR_TIMx4, TIM_IT_Update) != RESET)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        TIM_ClearITPendingBit(COLOR_TIMx4, TIM_IT_Update);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Update the current color state</span></span><br><span class=\"line\">        currentColor = (currentColor + <span class=\"number\">1</span>) % <span class=\"number\">7</span>; <span class=\"comment\">// Cycle through 0 to 6</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Update the PWM values based on the current color state</span></span><br><span class=\"line\"><span class=\"keyword\">switch</span> (currentColor) &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"keyword\">case</span> COLOR_RED:</span><br><span class=\"line\">        COLOR_TIMx-&gt;CCR2 = <span class=\"number\">255</span>;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR3 = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR4 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> COLOR_ORANGE:</span><br><span class=\"line\">        COLOR_TIMx-&gt;CCR2 = <span class=\"number\">255</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">/*In fact, when the value of CCR3 is set to 128, it represents the standard RGB orange color parameter. </span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\t\tHowever, after visual confirmation, setting it to 97 gives a color that more closely resembles orange. </span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\t\tTherefore, I chose to set it to 97.*/</span></span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR3 = <span class=\"number\">97</span>\t;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR4 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> COLOR_YELLOW:</span><br><span class=\"line\">        COLOR_TIMx-&gt;CCR2 = <span class=\"number\">255</span>;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR3 = <span class=\"number\">255</span>;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR4 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> COLOR_GREEN:</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR2 = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR3 = <span class=\"number\">255</span>;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR4 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> COLOR_CYAN:</span><br><span class=\"line\">        COLOR_TIMx-&gt;CCR2 = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR3 = <span class=\"number\">255</span>;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR4 = <span class=\"number\">255</span>;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> COLOR_BLUE:</span><br><span class=\"line\">        COLOR_TIMx-&gt;CCR2 = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR3 = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR4 = <span class=\"number\">255</span>;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> COLOR_PURPLE:</span><br><span class=\"line\">        COLOR_TIMx-&gt;CCR2 = <span class=\"number\">128</span>;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR3 = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\tCOLOR_TIMx-&gt;CCR4 = <span class=\"number\">255</span>;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"led_pwmh\"><a class=\"anchor\" href=\"#led_pwmh\">#</a> LED_PWM.h</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifndef</span> LED_PWM_H</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED_PWM_H</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_TIM_GPIO_CLK   RCC_APB2Periph_GPIOB</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_RED_TIM_LED_PIN      GPIO_Pin_5  </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_GREEN_TIM_LED_PIN    GPIO_Pin_0  </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_BLUE_TIM_LED_PIN     GPIO_Pin_1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_RED_TIM_LED_PORT     GPIOB</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_GREEN_TIM_LED_PORT   GPIOB</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_BLUE_TIM_LED_PORT    GPIOB</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_TIM_CLK             RCC_APB1Periph_TIM3</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_TIMx                TIM3</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_TIM4_CLK             RCC_APB1Periph_TIM4</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_TIMx4                TIM4</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">COLOR_TIMx_GPIO_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">COLOR_PWM_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">COLOR_TIMx4_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">TIM1_IRQHandler</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "Hexo",
                "Front Matter"
            ]
        },
        {
            "id": "https://enjundu.github.io/ECEA/5%E4%BA%A7%E7%94%9F%E5%A4%9A%E5%BD%A9%E5%91%BC%E5%90%B8%E7%81%AF/",
            "url": "https://enjundu.github.io/ECEA/5%E4%BA%A7%E7%94%9F%E5%A4%9A%E5%BD%A9%E5%91%BC%E5%90%B8%E7%81%AF/",
            "title": "Breathing lamp",
            "date_published": "2024-07-03T09:43:21.000Z",
            "content_html": "<h1 id=\"breathing-lamp\"><a class=\"anchor\" href=\"#breathing-lamp\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VuanVuRHUvRUNFQS1wcmFjdGljZS1CSVQtY29tcHV0ZXItcHJvZ3JhbW1pbmc=\">Breathing lamp</span></h1>\n<h2 id=\"实验介绍\"><a class=\"anchor\" href=\"#实验介绍\">#</a> 实验介绍</h2>\n<ul>\n<li><strong>产生多彩呼吸灯</strong></li>\n<li>产生 4 彩（红、绿、蓝、白）呼吸灯，呼吸周期为 1.x 秒（x 为学号尾数）</li>\n<li>CCR 更新周期不高于 0.2s<img data-src=\"https://s2.loli.net/2024/07/03/FxpCUfVZuQskcb9.png\" alt=\"image.png\" /></li>\n</ul>\n<h2 id=\"user\"><a class=\"anchor\" href=\"#user\">#</a> USER</h2>\n<h3 id=\"breath_ledc\"><a class=\"anchor\" href=\"#breath_ledc\">#</a> breath_led.c</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;breath_led.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_gpio.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_tim.h&quot;</span> </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">COLOR_TIMx_GPIO_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tRCC_APB2PeriphClockCmd (RCC_APB2Periph_AFIO,ENABLE);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tRCC_APB2PeriphClockCmd(COLOR_TIM_GPIO_CLK, ENABLE);</span><br><span class=\"line\">\tGPIO_PinRemapConfig(GPIO_PartialRemap_TIM3, ENABLE);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tGPIO_InitTypeDef GPIO_InitStructure;</span><br><span class=\"line\">\t<span class=\"comment\">//red</span></span><br><span class=\"line\">\tGPIO_InitStructure.GPIO_Pin = COLOR_RED_TIM_LED_PIN;</span><br><span class=\"line\">\tGPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;</span><br><span class=\"line\">\tGPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;</span><br><span class=\"line\">\tGPIO_Init(COLOR_RED_TIM_LED_PORT,&amp;GPIO_InitStructure);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//green</span></span><br><span class=\"line\">\tGPIO_InitStructure.GPIO_Pin = COLOR_GREEN_TIM_LED_PIN;</span><br><span class=\"line\">\tGPIO_Init(COLOR_GREEN_TIM_LED_PORT,&amp;GPIO_InitStructure);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//blue</span></span><br><span class=\"line\">\tGPIO_InitStructure.GPIO_Pin = COLOR_BLUE_TIM_LED_PIN;</span><br><span class=\"line\">\tGPIO_Init(COLOR_BLUE_TIM_LED_PORT,&amp;GPIO_InitStructure);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">COLOR_TIMx_Mode_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tTIM_TimeBaseInitTypeDef TIM_TimeBaseStructure;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tRCC_APB1PeriphClockCmd(COLOR_TIM_CLK,ENABLE);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tTIM_TimeBaseStructure.TIM_Period = <span class=\"number\">255</span>;</span><br><span class=\"line\">\tTIM_TimeBaseStructure.TIM_Prescaler = <span class=\"number\">7</span>;</span><br><span class=\"line\">\tTIM_TimeBaseStructure.TIM_ClockDivision=TIM_CKD_DIV1;</span><br><span class=\"line\">\tTIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;</span><br><span class=\"line\">\tTIM_TimeBaseInit(COLOR_TIM,&amp;TIM_TimeBaseStructure);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tTIM_ARRPreloadConfig(COLOR_TIM,ENABLE);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tTIM_Cmd(COLOR_TIM,ENABLE);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tTIM_OCInitTypeDef\t\tTIM_OCInitStructure;</span><br><span class=\"line\">\tTIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM1;</span><br><span class=\"line\">\tTIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable;</span><br><span class=\"line\">\tTIM_OCInitStructure.TIM_Pulse = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tTIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_Low;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"comment\">//  OC2 red</span></span><br><span class=\"line\">    TIM_OC2Init(COLOR_TIM, &amp;TIM_OCInitStructure);</span><br><span class=\"line\">    TIM_OC2PreloadConfig(COLOR_TIM, TIM_OCPreload_Enable);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  OC3 green</span></span><br><span class=\"line\">    TIM_OC3Init(COLOR_TIM, &amp;TIM_OCInitStructure);</span><br><span class=\"line\">    TIM_OC3PreloadConfig(COLOR_TIM, TIM_OCPreload_Enable);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  OC4 blue</span></span><br><span class=\"line\">    TIM_OC4Init(COLOR_TIM, &amp;TIM_OCInitStructure);</span><br><span class=\"line\">    TIM_OC4PreloadConfig(COLOR_TIM, TIM_OCPreload_Enable);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">BASIC_TIM_Init</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tTIM_TimeBaseInitTypeDef TIM_TimeBaseStructure;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tRCC_APB1PeriphClockCmd(BASIC_TIM_CLK,ENABLE);</span><br><span class=\"line\">\t</span><br><span class=\"line\"><span class=\"comment\">//Since the last digit of my student ID is 5, the breathing LED blink period should be 1.5 seconds. The calculation is as follows:</span></span><br><span class=\"line\">\t</span><br><span class=\"line\"><span class=\"comment\">/*Target duration = 1.5 seconds = 1500 milliseconds</span></span><br><span class=\"line\"><span class=\"comment\">Timer clock frequency = 72 MHz = 72,000,000 Hz</span></span><br><span class=\"line\"><span class=\"comment\">Counting frequency per second = 10 times</span></span><br><span class=\"line\"><span class=\"comment\">Counting times = 10 times/second * 1.5 seconds = 15 times</span></span><br><span class=\"line\"><span class=\"comment\">Prescaler = (Timer clock frequency * Target duration) / Counting times - 1</span></span><br><span class=\"line\"><span class=\"comment\">Period = Counting times - 1</span></span><br><span class=\"line\"><span class=\"comment\">According to the calculations above, the prescaler is approximately 4800000, and the period is 14.*/</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\tTIM_TimeBaseStructure.TIM_Prescaler = <span class=\"number\">4800000</span>;</span><br><span class=\"line\">\tTIM_TimeBaseStructure.TIM_Period = <span class=\"number\">14</span>;</span><br><span class=\"line\">\tTIM_TimeBaseInit(BASIC_TIM,&amp;TIM_TimeBaseStructure);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tTIM_ARRPreloadConfig(BASIC_TIM,ENABLE);</span><br><span class=\"line\">\tTIM_Cmd(BASIC_TIM,ENABLE);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tTIM_ClearFlag(BASIC_TIM,TIM_FLAG_Update);</span><br><span class=\"line\">\tTIM_ITConfig(BASIC_TIM,TIM_IT_Update,ENABLE);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">BASIC_TIM_NVIC_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tNVIC_InitTypeDef NVIC_InitStructure;</span><br><span class=\"line\">\tNVIC_PriorityGroupConfig(NVIC_PriorityGroup_0);</span><br><span class=\"line\">\tNVIC_InitStructure.NVIC_IRQChannel = TIM6_IRQn;</span><br><span class=\"line\">\tNVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tNVIC_InitStructure.NVIC_IRQChannelSubPriority = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tNVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;</span><br><span class=\"line\">\tNVIC_Init(&amp;NVIC_InitStructure);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ColorState enumeration to represent different colors</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">enum</span> &#123;</span></span><br><span class=\"line\">    COLOR_RED,</span><br><span class=\"line\">    COLOR_GREEN,</span><br><span class=\"line\">    COLOR_BLUE,</span><br><span class=\"line\">    COLOR_WHITE</span><br><span class=\"line\">&#125; ColorState;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">uint16_t</span> breathCounter = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">uint8_t</span> breathDirection = <span class=\"number\">1</span>; </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> currentColor=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\t\t\t</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">TIM6_IRQHandler</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (TIM_GetITStatus(BASIC_TIM, TIM_IT_Update) != RESET)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        TIM_ClearITPendingBit(BASIC_TIM, TIM_IT_Update);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// Update the PWM duty cycle (CCR values) based on the currentColor</span></span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (currentColor) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> COLOR_RED:</span><br><span class=\"line\">                TIM_SetCompare2(COLOR_TIM, breathCounter); <span class=\"comment\">// Red</span></span><br><span class=\"line\">                TIM_SetCompare3(COLOR_TIM, <span class=\"number\">0</span>);</span><br><span class=\"line\">                TIM_SetCompare4(COLOR_TIM, <span class=\"number\">0</span>);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> COLOR_GREEN:</span><br><span class=\"line\">                TIM_SetCompare2(COLOR_TIM, <span class=\"number\">0</span>);</span><br><span class=\"line\">                TIM_SetCompare3(COLOR_TIM, breathCounter); <span class=\"comment\">// Green</span></span><br><span class=\"line\">                TIM_SetCompare4(COLOR_TIM, <span class=\"number\">0</span>);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> COLOR_BLUE:</span><br><span class=\"line\">                TIM_SetCompare2(COLOR_TIM, <span class=\"number\">0</span>);</span><br><span class=\"line\">                TIM_SetCompare3(COLOR_TIM, <span class=\"number\">0</span>);</span><br><span class=\"line\">                TIM_SetCompare4(COLOR_TIM, breathCounter); <span class=\"comment\">// Blue</span></span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> COLOR_WHITE:</span><br><span class=\"line\">                TIM_SetCompare2(COLOR_TIM, breathCounter); <span class=\"comment\">// Red</span></span><br><span class=\"line\">                TIM_SetCompare3(COLOR_TIM, breathCounter); <span class=\"comment\">// Green</span></span><br><span class=\"line\">                TIM_SetCompare4(COLOR_TIM, breathCounter); <span class=\"comment\">// Blue</span></span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Update the breathCounter and direction</span></span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//Implementing a specific function to achieve a breathing effect for the LED.</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (breathDirection) &#123;</span><br><span class=\"line\">            breathCounter++;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (breathCounter &gt;= <span class=\"number\">255</span>) &#123;</span><br><span class=\"line\">                breathCounter = <span class=\"number\">255</span>;</span><br><span class=\"line\">                breathDirection = <span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            breathCounter--;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (breathCounter == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                breathCounter = <span class=\"number\">0</span>;</span><br><span class=\"line\">                breathDirection = <span class=\"number\">1</span>;</span><br><span class=\"line\">                currentColor = (currentColor + <span class=\"number\">1</span>) % <span class=\"number\">4</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"breath_ledh\"><a class=\"anchor\" href=\"#breath_ledh\">#</a> breath_led.h</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifndef</span> BREATH_LED_H</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> BREATH_LED_H</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_TIM_GPIO_CLK   RCC_APB2Periph_GPIOB</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_RED_TIM_LED_PIN      GPIO_Pin_5  </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_GREEN_TIM_LED_PIN    GPIO_Pin_0  </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_BLUE_TIM_LED_PIN     GPIO_Pin_1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_RED_TIM_LED_PORT     GPIOB</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_GREEN_TIM_LED_PORT   GPIOB</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_BLUE_TIM_LED_PORT    GPIOB</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_TIM_CLK             RCC_APB1Periph_TIM3</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> COLOR_TIM                TIM3</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> BASIC_TIM                TIM6</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> BASIC_TIM_CLK            RCC_APB1Periph_TIM6</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"type\">void</span> <span class=\"title function_\">COLOR_TIMx_GPIO_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"type\">void</span> <span class=\"title function_\">COLOR_TIMx_Mode_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"type\">void</span> <span class=\"title function_\">BASIC_TIM_Init</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"type\">void</span> <span class=\"title function_\">BASIC_TIM_NVIC_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"mainc\"><a class=\"anchor\" href=\"#mainc\">#</a> main.c</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;breath_led.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_gpio.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_tim.h&quot;</span> </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">main</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t COLOR_TIMx_GPIO_Config();</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t COLOR_TIMx_Mode_Config();</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t BASIC_TIM_Init();</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t BASIC_TIM_NVIC_Config();</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t\tTIM_Cmd(BASIC_TIM, ENABLE);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">       </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"stm32f10x_confh\"><a class=\"anchor\" href=\"#stm32f10x_confh\">#</a> stm32f10x_conf.h</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  ******************************************************************************</span></span><br><span class=\"line\"><span class=\"comment\">  * @file    Project/STM32F10x_StdPeriph_Template/stm32f10x_conf.h </span></span><br><span class=\"line\"><span class=\"comment\">  * @author  MCD Application Team</span></span><br><span class=\"line\"><span class=\"comment\">  * @version V3.5.0</span></span><br><span class=\"line\"><span class=\"comment\">  * @date    08-April-2011</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief   Library configuration file.</span></span><br><span class=\"line\"><span class=\"comment\">  ******************************************************************************</span></span><br><span class=\"line\"><span class=\"comment\">  * @attention</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * THE PRESENT FIRMWARE WHICH IS FOR GUIDANCE ONLY AIMS AT PROVIDING CUSTOMERS</span></span><br><span class=\"line\"><span class=\"comment\">  * WITH CODING INFORMATION REGARDING THEIR PRODUCTS IN ORDER FOR THEM TO SAVE</span></span><br><span class=\"line\"><span class=\"comment\">  * TIME. AS A RESULT, STMICROELECTRONICS SHALL NOT BE HELD LIABLE FOR ANY</span></span><br><span class=\"line\"><span class=\"comment\">  * DIRECT, INDIRECT OR CONSEQUENTIAL DAMAGES WITH RESPECT TO ANY CLAIMS ARISING</span></span><br><span class=\"line\"><span class=\"comment\">  * FROM THE CONTENT OF SUCH FIRMWARE AND/OR THE USE MADE BY CUSTOMERS OF THE</span></span><br><span class=\"line\"><span class=\"comment\">  * CODING INFORMATION CONTAINED HEREIN IN CONNECTION WITH THEIR PRODUCTS.</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * &lt;h2&gt;&lt;center&gt;&amp;copy; COPYRIGHT 2011 STMicroelectronics&lt;/center&gt;&lt;/h2&gt;</span></span><br><span class=\"line\"><span class=\"comment\">  ******************************************************************************</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Define to prevent recursive inclusion -------------------------------------*/</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifndef</span> __STM32F10x_CONF_H</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> __STM32F10x_CONF_H</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Includes ------------------------------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"comment\">/* Uncomment/Comment the line below to enable/disable peripheral header file inclusion */</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_adc.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_bkp.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_can.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_cec.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_crc.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_dac.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_dbgmcu.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_dma.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_exti.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_flash.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_fsmc.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_gpio.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_i2c.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_iwdg.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_pwr.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_rcc.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_rtc.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_sdio.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_spi.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_tim.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_usart.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_wwdg.h&quot;</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;misc.h&quot;</span> <span class=\"comment\">/* High level functions for NVIC and SysTick (add-on to CMSIS functions) */</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Exported types ------------------------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"comment\">/* Exported constants --------------------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"comment\">/* Uncomment the line below to expanse the &quot;assert_param&quot; macro in the </span></span><br><span class=\"line\"><span class=\"comment\">   Standard Peripheral Library drivers code */</span></span><br><span class=\"line\"><span class=\"comment\">/* #define USE_FULL_ASSERT    1 */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Exported macro ------------------------------------------------------------*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//#define USE_FULL_ASSERT</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifdef</span>  USE_FULL_ASSERT</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  The assert_param macro is used for function&#x27;s parameters check.</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  expr: If expr is false, it calls assert_failed function which reports </span></span><br><span class=\"line\"><span class=\"comment\">  *         the name of the source file and the source line number of the call </span></span><br><span class=\"line\"><span class=\"comment\">  *         that failed. If expr is true, it returns no value.</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval None</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\">  <span class=\"meta\">#<span class=\"keyword\">define</span> assert_param(expr) ((expr) ? (void)0 : assert_failed((uint8_t *)__FILE__, __LINE__))</span></span><br><span class=\"line\"><span class=\"comment\">/* Exported functions ------------------------------------------------------- */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">assert_failed</span><span class=\"params\">(<span class=\"type\">uint8_t</span>* file, <span class=\"type\">uint32_t</span> line)</span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">else</span></span></span><br><span class=\"line\">  <span class=\"meta\">#<span class=\"keyword\">define</span> assert_param(expr) ((void)0)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span> <span class=\"comment\">/* USE_FULL_ASSERT */</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span> <span class=\"comment\">/* __STM32F10x_CONF_H */</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/******************* (C) COPYRIGHT 2011 STMicroelectronics *****END OF FILE****/</span></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"stm32f10x_itc\"><a class=\"anchor\" href=\"#stm32f10x_itc\">#</a> stm32f10x_it.c</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  ******************************************************************************</span></span><br><span class=\"line\"><span class=\"comment\">  * @file    Project/STM32F10x_StdPeriph_Template/stm32f10x_it.c </span></span><br><span class=\"line\"><span class=\"comment\">  * @author  MCD Application Team</span></span><br><span class=\"line\"><span class=\"comment\">  * @version V3.5.0</span></span><br><span class=\"line\"><span class=\"comment\">  * @date    08-April-2011</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief   Main Interrupt Service Routines.</span></span><br><span class=\"line\"><span class=\"comment\">  *          This file provides template for all exceptions handler and </span></span><br><span class=\"line\"><span class=\"comment\">  *          peripherals interrupt service routine.</span></span><br><span class=\"line\"><span class=\"comment\">  ******************************************************************************</span></span><br><span class=\"line\"><span class=\"comment\">  * @attention</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * THE PRESENT FIRMWARE WHICH IS FOR GUIDANCE ONLY AIMS AT PROVIDING CUSTOMERS</span></span><br><span class=\"line\"><span class=\"comment\">  * WITH CODING INFORMATION REGARDING THEIR PRODUCTS IN ORDER FOR THEM TO SAVE</span></span><br><span class=\"line\"><span class=\"comment\">  * TIME. AS A RESULT, STMICROELECTRONICS SHALL NOT BE HELD LIABLE FOR ANY</span></span><br><span class=\"line\"><span class=\"comment\">  * DIRECT, INDIRECT OR CONSEQUENTI</span></span><br><span class=\"line\"><span class=\"comment\">  </span></span><br><span class=\"line\"><span class=\"comment\">  AL DAMAGES WITH RESPECT TO ANY CLAIMS ARISING</span></span><br><span class=\"line\"><span class=\"comment\">  * FROM THE CONTENT OF SUCH FIRMWARE AND/OR THE USE MADE BY CUSTOMERS OF THE</span></span><br><span class=\"line\"><span class=\"comment\">  * CODING INFORMATION CONTAINED HEREIN IN CONNECTION WITH THEIR PRODUCTS.</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * &lt;h2&gt;&lt;center&gt;&amp;copy; COPYRIGHT 2011 STMicroelectronics&lt;/center&gt;&lt;/h2&gt;</span></span><br><span class=\"line\"><span class=\"comment\">  ******************************************************************************</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Includes ------------------------------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_it.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** @addtogroup STM32F10x_StdPeriph_Template</span></span><br><span class=\"line\"><span class=\"comment\">  * @&#123;</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Private typedef -----------------------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"comment\">/* Private define ------------------------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"comment\">/* Private macro -------------------------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"comment\">/* Private variables ---------------------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"comment\">/* Private function prototypes -----------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"comment\">/* Private functions ---------------------------------------------------------*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/******************************************************************************/</span></span><br><span class=\"line\"><span class=\"comment\">/*            Cortex-M3 Processor Exceptions Handlers                         */</span></span><br><span class=\"line\"><span class=\"comment\">/******************************************************************************/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  This function handles NMI exception.</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  None</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval None</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">NMI_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  This function handles Hard Fault exception.</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  None</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval None</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">HardFault_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">/* Go to infinite loop when Hard Fault exception occurs */</span></span><br><span class=\"line\">  <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  This function handles Memory Manage exception.</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  None</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval None</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">MemManage_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">/* Go to infinite loop when Memory Manage exception occurs */</span></span><br><span class=\"line\">  <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  This function handles Bus Fault exception.</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  None</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval None</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">BusFault_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">/* Go to infinite loop when Bus Fault exception occurs */</span></span><br><span class=\"line\">  <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  This function handles Usage Fault exception.</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  None</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval None</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">UsageFault_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">/* Go to infinite loop when Usage Fault exception occurs */</span></span><br><span class=\"line\">  <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  This function handles SVCall exception.</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  None</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval None</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">SVC_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  This function handles Debug Monitor exception.</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  None</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval None</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">DebugMon_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  This function handles PendSVC exception.</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  None</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval None</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">PendSV_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  This function handles SysTick Handler.</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  None</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval None</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">SysTick_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/******************************************************************************/</span></span><br><span class=\"line\"><span class=\"comment\">/*                 STM32F10x Peripherals Interrupt Handlers                   */</span></span><br><span class=\"line\"><span class=\"comment\">/*  Add here the Interrupt Handler for the used peripheral(s) (PPP), for the  */</span></span><br><span class=\"line\"><span class=\"comment\">/*  available peripheral interrupt handler&#x27;s name please refer to the startup */</span></span><br><span class=\"line\"><span class=\"comment\">/*  file (startup_stm32f10x_xx.s).                                            */</span></span><br><span class=\"line\"><span class=\"comment\">/******************************************************************************/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  This function handles PPP interrupt request.</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  None</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval None</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"comment\">/*void PPP_IRQHandler(void)</span></span><br><span class=\"line\"><span class=\"comment\">&#123;</span></span><br><span class=\"line\"><span class=\"comment\">&#125;*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @&#125;</span></span><br><span class=\"line\"><span class=\"comment\">  */</span> </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/******************* (C) COPYRIGHT 2011 STMicroelectronics *****END OF FILE****/</span></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"stm32f10x_ith\"><a class=\"anchor\" href=\"#stm32f10x_ith\">#</a> stm32f10x_it.h</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  ******************************************************************************</span></span><br><span class=\"line\"><span class=\"comment\">  * @file    Project/STM32F10x_StdPeriph_Template/stm32f10x_it.h </span></span><br><span class=\"line\"><span class=\"comment\">  * @author  MCD Application Team</span></span><br><span class=\"line\"><span class=\"comment\">  * @version V3.5.0</span></span><br><span class=\"line\"><span class=\"comment\">  * @date    08-April-2011</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief   This file contains the headers of the interrupt handlers.</span></span><br><span class=\"line\"><span class=\"comment\">  ******************************************************************************</span></span><br><span class=\"line\"><span class=\"comment\">  * @attention</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * THE PRESENT FIRMWARE WHICH IS FOR GUIDANCE ONLY AIMS AT PROVIDING CUSTOMERS</span></span><br><span class=\"line\"><span class=\"comment\">  * WITH CODING INFORMATION REGARDING THEIR PRODUCTS IN ORDER FOR THEM TO SAVE</span></span><br><span class=\"line\"><span class=\"comment\">  * TIME. AS A RESULT, STMICROELECTRONICS SHALL NOT BE HELD LIABLE FOR ANY</span></span><br><span class=\"line\"><span class=\"comment\">  * DIRECT, INDIRECT OR CONSEQUENTIAL DAMAGES WITH RESPECT TO ANY CLAIMS ARISING</span></span><br><span class=\"line\"><span class=\"comment\">  * FROM THE CONTENT OF SUCH FIRMWARE AND/OR THE USE MADE BY CUSTOMERS OF THE</span></span><br><span class=\"line\"><span class=\"comment\">  * CODING INFORMATION CONTAINED HEREIN IN CONNECTION WITH THEIR PRODUCTS.</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * &lt;h2&gt;&lt;center&gt;&amp;copy; COPYRIGHT 2011 STMicroelectronics&lt;/center&gt;&lt;/h2&gt;</span></span><br><span class=\"line\"><span class=\"comment\">  ******************************************************************************</span></span><br><span class=\"line\"><span class=\"comment\">  */</span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Define to prevent recursive inclusion -------------------------------------*/</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifndef</span> __STM32F10x_IT_H</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> __STM32F10x_IT_H</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifdef</span> __cplusplus</span></span><br><span class=\"line\"> <span class=\"keyword\">extern</span> <span class=\"string\">&quot;C&quot;</span> &#123;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span> </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Includes ------------------------------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Exported types ------------------------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"comment\">/* Exported constants --------------------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"comment\">/* Exported macro ------------------------------------------------------------*/</span></span><br><span class=\"line\"><span class=\"comment\">/* Exported functions ------------------------------------------------------- */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">NMI_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">HardFault_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">MemManage_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">BusFault_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">UsageFault_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">SVC_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">DebugMon_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">PendSV_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">SysTick_Handler</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifdef</span> __cplusplus</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span> <span class=\"comment\">/* __STM32F10x_IT_H */</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/******************* (C) COPYRIGHT 2011 STMicroelectronics *****END OF FILE****/</span></span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "Hexo",
                "Front Matter"
            ]
        },
        {
            "id": "https://enjundu.github.io/ECEA/1%E7%82%B9%E4%BA%AE%E7%81%AF/",
            "url": "https://enjundu.github.io/ECEA/1%E7%82%B9%E4%BA%AE%E7%81%AF/",
            "title": "LED lighting program",
            "date_published": "2024-07-03T09:43:21.000Z",
            "content_html": "<h1 id=\"led-lighting-program\"><a class=\"anchor\" href=\"#led-lighting-program\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VuanVuRHUvRUNFQS1wcmFjdGljZS1CSVQtY29tcHV0ZXItcHJvZ3JhbW1pbmc=\">LED lighting program</span></h1>\n<h2 id=\"设计要求\"><a class=\"anchor\" href=\"#设计要求\">#</a> 设计要求</h2>\n<ul>\n<li><strong>用按键控制 LED 发光类型</strong></li>\n<li>按 KEY1，控制 LED 灯在 “红光 - 绿光 - 蓝光 - 白光” 四种方式之间切换</li>\n<li>按 KEY2，控制 LED 灯熄灭</li>\n</ul>\n<h2 id=\"设计思路\"><a class=\"anchor\" href=\"#设计思路\">#</a> 设计思路</h2>\n<h2 id=\"hardwarebeep\"><a class=\"anchor\" href=\"#hardwarebeep\">#</a> \\Hardware\\beep</h2>\n<h3 id=\"beepc\"><a class=\"anchor\" href=\"#beepc\">#</a> beep.c</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;beep.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">BEEP_Init</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">//实例化配置GPIO模式和速度结构体</span></span><br><span class=\"line\">    GPIO_InitTypeDef GPIO_InitStruct;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//使能蜂鸣器时钟</span></span><br><span class=\"line\">    RCC_APB2PeriphClockCmd(BEEP_CLK, ENABLE );</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//配置端口输出并初始化</span></span><br><span class=\"line\">    GPIO_InitStruct.GPIO_Mode = GPIO_Mode_Out_PP;</span><br><span class=\"line\">    GPIO_InitStruct.GPIO_Pin = BEEP_PIN;</span><br><span class=\"line\">    GPIO_InitStruct.GPIO_Speed = GPIO_Speed_50MHz;      </span><br><span class=\"line\">    GPIO_Init( BEEP_PORT, &amp;GPIO_InitStruct);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//蜂鸣器初始化后不响</span></span><br><span class=\"line\">    BEEP(<span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"beeph\"><a class=\"anchor\" href=\"#beeph\">#</a> beep.h</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifndef</span> __BEEP_H</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> __BEEP_H</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//定义蜂鸣器端口、引脚和时钟，对应PA8</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> BEEP_PIN   GPIO_Pin_8</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> BEEP_PORT  GPIOA</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> BEEP_CLK   RCC_APB2Periph_GPIOA</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//BEEP（ON/OFF）控制蜂鸣器开关</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> ON  1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> OFF 0</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> BEEP(x) <span class=\"keyword\">if</span> (x) GPIO_SetBits(BEEP_PORT,BEEP_PIN);\\</span></span><br><span class=\"line\"><span class=\"meta\">                <span class=\"keyword\">else</span>  GPIO_ResetBits( BEEP_PORT,BEEP_PIN);</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//声明蜂鸣器初始化函数</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">BEEP_Init</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br></pre></td></tr></table></figure></p>\n<h2 id=\"project\"><a class=\"anchor\" href=\"#project\">#</a> \\Project</h2>\n<h3 id=\"delayc\"><a class=\"anchor\" href=\"#delayc\">#</a> Delay.c</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  ?????</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  xus ????,??:0~233015</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval ?</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Delay_us</span><span class=\"params\">(<span class=\"type\">uint32_t</span> xus)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tSysTick-&gt;LOAD = <span class=\"number\">72</span> * xus;\t\t\t\t<span class=\"comment\">//????????</span></span><br><span class=\"line\">\tSysTick-&gt;VAL = <span class=\"number\">0x00</span>;\t\t\t\t\t<span class=\"comment\">//???????</span></span><br><span class=\"line\">\tSysTick-&gt;CTRL = <span class=\"number\">0x00000005</span>;\t\t\t\t<span class=\"comment\">//??????HCLK,?????</span></span><br><span class=\"line\">\t<span class=\"keyword\">while</span>(!(SysTick-&gt;CTRL &amp; <span class=\"number\">0x00010000</span>));\t<span class=\"comment\">//?????0</span></span><br><span class=\"line\">\tSysTick-&gt;CTRL = <span class=\"number\">0x00000004</span>;\t\t\t\t<span class=\"comment\">//?????</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  ?????</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  xms ????,??:0~4294967295</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval ?</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Delay_ms</span><span class=\"params\">(<span class=\"type\">uint32_t</span> xms)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>(xms--)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tDelay_us(<span class=\"number\">1000</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * @brief  ????</span></span><br><span class=\"line\"><span class=\"comment\">  * @param  xs ????,??:0~4294967295</span></span><br><span class=\"line\"><span class=\"comment\">  * @retval ?</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Delay_s</span><span class=\"params\">(<span class=\"type\">uint32_t</span> xs)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>(xs--)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tDelay_ms(<span class=\"number\">1000</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure></p>\n<h3 id=\"dlayh\"><a class=\"anchor\" href=\"#dlayh\">#</a> Dlay.h</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifndef</span> __DELAY_H</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> __DELAY_H</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Delay_us</span><span class=\"params\">(<span class=\"type\">uint32_t</span> us)</span>;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Delay_ms</span><span class=\"params\">(<span class=\"type\">uint32_t</span> ms)</span>;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Delay_s</span><span class=\"params\">(<span class=\"type\">uint32_t</span> s)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"newstartc\"><a class=\"anchor\" href=\"#newstartc\">#</a> newstart.c</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">sbit FM = PA8;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">main</span><span class=\"params\">()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\tFM=<span class=\"number\">1</span>;<span class=\"comment\">//1.08us</span></span><br><span class=\"line\">\tFM=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"mainc\"><a class=\"anchor\" href=\"#mainc\">#</a> main.c</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x_gpio.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;bsp_led.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">uint8_t</span> <span class=\"title function_\">Key_Scan</span><span class=\"params\">(GPIO_TypeDef* GPIOx, <span class=\"type\">uint16_t</span> GPIO_Pin)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (GPIO_ReadInputDataBit(GPIOx, GPIO_Pin) == KEY_ON)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (GPIO_ReadInputDataBit(GPIOx, GPIO_Pin) == KEY_ON)<span class=\"comment\">//scan whether KEY_ON has been pushed</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> KEY_ON;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> KEY_OFF;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Delay</span><span class=\"params\">(__IO u32 nCount)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">LED_Color</span><span class=\"params\">(<span class=\"type\">uint8_t</span> color)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">switch</span> (color) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">0</span>:</span><br><span class=\"line\">            LED_RED;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">            LED_GREEN;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">            LED_BLUE;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">            LED_WHITE;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">main</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    LED_GPIO_Config();</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"type\">uint8_t</span> color = <span class=\"number\">-1</span>;    <span class=\"comment\">// 0: Red, 1: Green, 2: Blue, 3: White</span></span><br><span class=\"line\">    <span class=\"type\">uint8_t</span> prev_color = <span class=\"number\">-1</span>;   <span class=\"comment\">// Store the previous color for KEY2 functionality</span></span><br><span class=\"line\"></span><br><span class=\"line\">ff: <span class=\"keyword\">while</span> (<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (Key_Scan(KEY1_GPIO_PORT, KEY1_GPIO_PIN) == KEY_ON) &#123;</span><br><span class=\"line\">\t\t\t\t</span><br><span class=\"line\">\t\t\t\t\t<span class=\"comment\">//Detect KEY_ Is ON turned on to prevent KEY_ When ON is turned on, the light changes. Wait until the KEY1 key is pressed and bounces before changing the color</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">while</span> (Key_Scan(KEY1_GPIO_PORT, KEY1_GPIO_PIN) == KEY_ON) &#123;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">\t\t\t\t</span><br><span class=\"line\">            prev_color = color;</span><br><span class=\"line\"></span><br><span class=\"line\">            color = (color + <span class=\"number\">1</span>) % <span class=\"number\">4</span>;<span class=\"comment\">// use mod to simplize this project </span></span><br><span class=\"line\"></span><br><span class=\"line\">            LED_Color(color);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (Key_Scan(KEY2_GPIO_PORT, KEY2_GPIO_PIN) == KEY_ON) &#123;</span><br><span class=\"line\">\t\t\t\t\t <span class=\"keyword\">while</span> (Key_Scan(KEY2_GPIO_PORT, KEY2_GPIO_PIN) == KEY_ON) &#123;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            LED_RGBOFF;<span class=\"comment\">//Turn off all lights</span></span><br><span class=\"line\">\t\t\t\t\t\t</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">goto</span> ff;<span class=\"comment\">//Enter the ff function and rerun</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"bsp_ledc\"><a class=\"anchor\" href=\"#bsp_ledc\">#</a> bsp_led.c</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;bsp_led.h&quot;</span>   </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">LED_GPIO_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;\t\t</span><br><span class=\"line\">\t\t<span class=\"comment\">/*¶¨ÒåÒ»¸öGPIO_InitTypeDefÀàÐÍµÄ½á¹¹Ìå*/</span></span><br><span class=\"line\">\t\tGPIO_InitTypeDef GPIO_InitStructure;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">/*¿ªÆôLED and KEYÏà¹ØµÄGPIOÍâÉèÊ±ÖÓ*/</span></span><br><span class=\"line\">\t\tRCC_APB2PeriphClockCmd( LED1_GPIO_CLK | LED2_GPIO_CLK | LED3_GPIO_CLK, ENABLE);</span><br><span class=\"line\">    RCC_APB2PeriphClockCmd(KEY1_GPIO_CLK | KEY2_GPIO_CLK | LED_GPIO_CLK, ENABLE);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t\t<span class=\"comment\">/*Ñ¡ÔñÒª¿ØÖÆµÄGPIOÒý½Å*/</span></span><br><span class=\"line\">\t\tGPIO_InitStructure.GPIO_Pin = LED1_GPIO_PIN;\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">/*ÉèÖÃÒý½ÅÄ£Ê½ÎªÍ¨ÓÃÍÆÍìÊä³ö*/</span></span><br><span class=\"line\">\t\tGPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;   </span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">/*ÉèÖÃÒý½ÅËÙÂÊÎª50MHz */</span>   </span><br><span class=\"line\">\t\tGPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">/*µ÷ÓÃ¿âº¯Êý£¬³õÊ¼»¯GPIO*/</span></span><br><span class=\"line\">\t\tGPIO_Init(LED1_GPIO_PORT, &amp;GPIO_InitStructure);\t</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"comment\">//Green</span></span><br><span class=\"line\">\t\tGPIO_InitStructure.GPIO_Pin = LED2_GPIO_PIN;</span><br><span class=\"line\">\t\tGPIO_Init(LED2_GPIO_PORT, &amp;GPIO_InitStructure);</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"comment\">//Blue</span></span><br><span class=\"line\">\t\tGPIO_InitStructure.GPIO_Pin = LED3_GPIO_PIN;</span><br><span class=\"line\">\t\tGPIO_Init(LED3_GPIO_PORT, &amp;GPIO_InitStructure);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">/* ¹Ø±ÕËùÓÐledµÆ\t*/</span></span><br><span class=\"line\">\t\tGPIO_SetBits(LED1_GPIO_PORT, LED1_GPIO_PIN);</span><br><span class=\"line\">\t\tGPIO_SetBits(LED2_GPIO_PORT, LED2_GPIO_PIN);\t </span><br><span class=\"line\">\t\tGPIO_SetBits(LED3_GPIO_PORT, LED3_GPIO_PIN);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"bsp_ledh\"><a class=\"anchor\" href=\"#bsp_ledh\">#</a> bsp_led.h</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifndef</span> __LED_H</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\t__LED_H</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// define key1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> KEY1_GPIO_CLK RCC_APB2Periph_GPIOA</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> KEY1_GPIO_PORT GPIOA</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> KEY1_GPIO_PIN GPIO_Pin_0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// define key2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> KEY2_GPIO_CLK RCC_APB2Periph_GPIOC</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> KEY2_GPIO_PORT GPIOC</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> KEY2_GPIO_PIN GPIO_Pin_13</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED_GPIO_CLK RCC_APB2Periph_GPIOB</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED_GPIO_PORT GPIOB</span></span><br><span class=\"line\"><span class=\"comment\">// R-ºìÉ«</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1_GPIO_PORT    \tGPIOB\t\t\t              <span class=\"comment\">/* GPIO¶Ë¿Ú */</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1_GPIO_CLK \t    RCC_APB2Periph_GPIOB\t\t<span class=\"comment\">/* GPIO¶Ë¿ÚÊ±ÖÓ */</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1_GPIO_PIN\t\tGPIO_Pin_5\t\t\t        <span class=\"comment\">/* Á¬½Óµ½SCLÊ±ÖÓÏßµÄGPIO */</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// G-ÂÌÉ«</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED2_GPIO_PORT    \tGPIOB\t\t\t              <span class=\"comment\">/* GPIO¶Ë¿Ú */</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED2_GPIO_CLK \t    RCC_APB2Periph_GPIOB\t\t<span class=\"comment\">/* GPIO¶Ë¿ÚÊ±ÖÓ */</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED2_GPIO_PIN\t\tGPIO_Pin_0\t\t\t        <span class=\"comment\">/* Á¬½Óµ½SCLÊ±ÖÓÏßµÄGPIO */</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// B-À¶É«</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED3_GPIO_PORT    \tGPIOB\t\t\t              <span class=\"comment\">/* GPIO¶Ë¿Ú */</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED3_GPIO_CLK \t    RCC_APB2Periph_GPIOB\t\t<span class=\"comment\">/* GPIO¶Ë¿ÚÊ±ÖÓ */</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED3_GPIO_PIN\t\tGPIO_Pin_1\t\t\t        <span class=\"comment\">/* Á¬½Óµ½SCLÊ±ÖÓÏßµÄGPIO */</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** the macro definition to trigger the led on or off </span></span><br><span class=\"line\"><span class=\"comment\">  * 1 - off</span></span><br><span class=\"line\"><span class=\"comment\">  *0 - on</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> ON 0</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> OFF 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> KEY_ON 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> KEY_OFF 0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Ê¹ÓÃ±ê×¼µÄ¹Ì¼þ¿â¿ØÖÆIO*/</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1(a)\t<span class=\"keyword\">if</span> (a)\t\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tGPIO_SetBits(LED1_GPIO_PORT,LED1_GPIO_PIN);\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\t<span class=\"keyword\">else</span>\t\t\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tGPIO_ResetBits(LED1_GPIO_PORT,LED1_GPIO_PIN)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED2(a)\t<span class=\"keyword\">if</span> (a)\t\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tGPIO_SetBits(LED2_GPIO_PORT,LED2_GPIO_PIN);\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\t<span class=\"keyword\">else</span>\t\t\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tGPIO_ResetBits(LED2_GPIO_PORT,LED2_GPIO_PIN)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED3(a)\t<span class=\"keyword\">if</span> (a)\t\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tGPIO_SetBits(LED3_GPIO_PORT,LED3_GPIO_PIN);\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\t<span class=\"keyword\">else</span>\t\t\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tGPIO_ResetBits(LED3_GPIO_PORT,LED3_GPIO_PIN)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Ö±½Ó²Ù×÷¼Ä´æÆ÷µÄ·½·¨¿ØÖÆIO */</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tdigitalHi(p,i)\t\t &#123;p-&gt;BSRR=i;&#125;\t <span class=\"comment\">//Êä³öÎª¸ßµçÆ½\t\t</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> digitalLo(p,i)\t\t &#123;p-&gt;BRR=i;&#125;\t <span class=\"comment\">//Êä³öµÍµçÆ½</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> digitalToggle(p,i) &#123;p-&gt;ODR ^=i;&#125; <span class=\"comment\">//Êä³ö·´×ª×´Ì¬</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* ¶¨Òå¿ØÖÆIOµÄºê */</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1_OFF\t\t   digitalHi(LED1_GPIO_PORT,LED1_GPIO_PIN)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1_ON\t\t\t   digitalLo(LED1_GPIO_PORT,LED1_GPIO_PIN)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED2_OFF\t\t   digitalHi(LED2_GPIO_PORT,LED2_GPIO_PIN)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED2_ON\t\t\t   digitalLo(LED2_GPIO_PORT,LED2_GPIO_PIN)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED3_OFF\t\t   digitalHi(LED3_GPIO_PORT,LED3_GPIO_PIN)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED3_ON\t\t\t   digitalLo(LED3_GPIO_PORT,LED3_GPIO_PIN)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//ºì</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED_RED  \\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED1_ON;\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED2_OFF\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED3_OFF</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//ÂÌ</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED_GREEN\t\t\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED1_OFF;\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED2_ON\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED3_OFF</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//À¶</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED_BLUE\t\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED1_OFF;\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED2_OFF\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED3_ON</span></span><br><span class=\"line\">\t\t</span><br><span class=\"line\"><span class=\"comment\">//°×(ºì+ÂÌ+À¶)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED_WHITE\t\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED1_ON;\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED2_ON\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED3_ON</span></span><br><span class=\"line\">\t\t\t\t\t</span><br><span class=\"line\"><span class=\"comment\">//ºÚ(È«²¿¹Ø±Õ)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED_RGBOFF\t\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED1_OFF;\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED2_OFF\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tLED3_OFF</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">LED_GPIO_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span> </span></span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "Hexo",
                "Front Matter"
            ]
        },
        {
            "id": "https://enjundu.github.io/ECEA/2%E8%9C%82%E9%B8%A3%E5%99%A8%E6%8A%A5%E6%97%B6/",
            "url": "https://enjundu.github.io/ECEA/2%E8%9C%82%E9%B8%A3%E5%99%A8%E6%8A%A5%E6%97%B6/",
            "title": "The buzzer reports the time based on the student ID",
            "date_published": "2024-07-03T09:43:21.000Z",
            "content_html": "<h1 id=\"the-buzzer-reports-the-time-based-on-the-student-id\"><a class=\"anchor\" href=\"#the-buzzer-reports-the-time-based-on-the-student-id\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VuanVuRHUvRUNFQS1wcmFjdGljZS1CSVQtY29tcHV0ZXItcHJvZ3JhbW1pbmc=\">The buzzer reports the time based on the student ID</span></h1>\n<h2 id=\"实验介绍\"><a class=\"anchor\" href=\"#实验介绍\">#</a> 实验介绍</h2>\n<p><strong>蜂鸣报时</strong></p>\n<ul>\n<li>写一个函数，使用 SysTick 方法，计时 0.25s</li>\n<li>使蜂鸣器产生 n 次短鸣 + 1 长鸣，n=mod (学号末位，5)+1</li>\n<li>短鸣的时间为 0.25s，长鸣时间为 1s，每次鸣响之间间隔 1s</li>\n<li>蜂鸣响起的同时，红色 LED 灯同时亮起</li>\n</ul>\n<h2 id=\"实验代码\"><a class=\"anchor\" href=\"#实验代码\">#</a> 实验代码</h2>\n<h3 id=\"mainc\"><a class=\"anchor\" href=\"#mainc\">#</a> main.c</h3>\n<p>如果要改代码的话更改 12 行的 while 函数即可</p>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;bsp_led.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;beep.h&quot;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;bsp_systick.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">main</span><span class=\"params\">()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t\tLED_GPIO_Config();\t</span><br><span class=\"line\">    BEEP_Init();</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t<span class=\"type\">int</span> i=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(i&lt;<span class=\"number\">1</span>)\t<span class=\"comment\">/*My student number is 112022xxx5,which means  n=mod(5,5)+1=1*/</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        BEEP(<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\tLED1_ON;<span class=\"comment\">//light the red light</span></span><br><span class=\"line\">    SysTick_Delay_ms(<span class=\"number\">250</span>);</span><br><span class=\"line\">        BEEP(<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t\t\tLED1_OFF;<span class=\"comment\">// turn off the red light</span></span><br><span class=\"line\">\t\t\tSysTick_Delay_ms(<span class=\"number\">1000</span>);\t\t\t</span><br><span class=\"line\">\t\t\t\ti++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t\t\tBEEP(<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\tLED1_ON;</span><br><span class=\"line\">\t\t\tSysTick_Delay_ms(<span class=\"number\">1000</span>);</span><br><span class=\"line\">\t\t\tBEEP(<span class=\"number\">0</span>); </span><br><span class=\"line\">\t\t\tLED1_OFF;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"ledbsp_ledc\"><a class=\"anchor\" href=\"#ledbsp_ledc\">#</a> led/bsp_led.c</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;bsp_led.h&quot;</span>   </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">LED_GPIO_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\">&#123;\t</span><br><span class=\"line\">\t\tGPIO_InitTypeDef GPIO_InitStructure;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tRCC_APB2PeriphClockCmd\t(LED1_GPIO_CLK,ENABLE);</span><br><span class=\"line\">\t\t<span class=\"comment\">/*Select the GPIO pin to be controlled*/</span>\t\t</span><br><span class=\"line\">\t\tGPIO_InitStructure.GPIO_Pin = LED1_GPIO_PIN;\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">/*Set pin mode to push pull output?/</span></span><br><span class=\"line\"><span class=\"comment\">\t\tGPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;   </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">\t\t/*Set pin speed to 50MHz */</span>   </span><br><span class=\"line\">\t\tGPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; </span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">/*Calling library functions to initialize GPIO*/</span></span><br><span class=\"line\">\t\tGPIO_Init(LED1_GPIO_PORT, &amp;GPIO_InitStructure);\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">/*Turn off LED1 light*/</span></span><br><span class=\"line\">\t\tGPIO_SetBits(LED1_GPIO_PORT, LED1_GPIO_PIN);</span><br><span class=\"line\">\t</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"ledbsp_ledh\"><a class=\"anchor\" href=\"#ledbsp_ledh\">#</a> led/bsp_led.h</h3>\n<p><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifndef</span> __LED_H</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\t__LED_H</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stm32f10x.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// R-红色</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1_GPIO_PORT    \tGPIOB\t\t\t              <span class=\"comment\">/* GPIO端口 */</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1_GPIO_CLK \t    RCC_APB2Periph_GPIOB\t\t<span class=\"comment\">/* GPIO端口时钟 */</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1_GPIO_PIN\t\tGPIO_Pin_5\t\t\t        <span class=\"comment\">/* 连接到SCL时钟线的GPIO */</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> ON  0</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> OFF 1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1(a)\t<span class=\"keyword\">if</span> (a)\t\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tGPIO_SetBits(LED1_GPIO_PORT,LED1_GPIO_PIN);\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\t<span class=\"keyword\">else</span>\t\t\\</span></span><br><span class=\"line\"><span class=\"meta\">\t\t\t\t\tGPIO_ResetBits(LED1_GPIO_PORT,LED1_GPIO_PIN)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span>\tdigitalHi(p,i)\t\t &#123;p-&gt;BSRR=i;&#125;\t <span class=\"comment\">//输出为高电平\t\t</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> digitalLo(p,i)\t\t &#123;p-&gt;BRR=i;&#125;\t <span class=\"comment\">//输出低电平</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> digitalToggle(p,i) &#123;p-&gt;ODR ^=i;&#125; <span class=\"comment\">//输出反转状态</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1_TOGGLE\t\t digitalToggle(LED1_GPIO_PORT,LED1_GPIO_PIN)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1_OFF\t\t   digitalHi(LED1_GPIO_PORT,LED1_GPIO_PIN)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LED1_ON\t\t\t   digitalLo(LED1_GPIO_PORT,LED1_GPIO_PIN)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">LED_GPIO_Config</span><span class=\"params\">(<span class=\"type\">void</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span> </span></span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "Hexo",
                "Front Matter"
            ]
        }
    ]
}