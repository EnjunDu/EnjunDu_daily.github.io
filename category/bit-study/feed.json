{
    "version": "https://jsonfeed.org/version/1",
    "title": "Hexo • All posts by \"bit-study\" category",
    "description": "",
    "home_page_url": "https://enjundu.github.io",
    "items": [
        {
            "id": "https://enjundu.github.io/bit/%E4%BA%9A%E5%A4%AA%E6%95%B0%E6%A8%A1%E2%80%94%E2%80%94%E6%96%B0%E8%83%BD%E6%BA%90%E6%B1%BD%E8%BD%A6/",
            "url": "https://enjundu.github.io/bit/%E4%BA%9A%E5%A4%AA%E6%95%B0%E6%A8%A1%E2%80%94%E2%80%94%E6%96%B0%E8%83%BD%E6%BA%90%E6%B1%BD%E8%BD%A6/",
            "title": "亚太数模——新能源汽车",
            "date_published": "2024-07-04T14:49:23.000Z",
            "content_html": "<h2 id=\"abstract\"><a class=\"markdownIt-Anchor\" href=\"#abstract\">#</a> ABSTRACT</h2>\n<p>This study presents a comprehensive analysis of new energy electric vehicles (NEEVs) in China, employing a range of statistical methods and advanced algorithms. Using tools such as MATLAB, SPSS, and Excel, the research systematically addresses several critical questions regarding the development, impact, and future trajectory of NEEVs.</p>\n<ol>\n<li><strong>Development of NEEVs in China</strong>: The study investigates the rapid growth of NEEVs in China, highlighting the influence of technological advancements and supportive government policies. An upward trend in vehicle ownership and market size is revealed, attributed to factors such as government subsidies, carbon emissions, and advancements in battery technology.</li>\n<li><strong>Predictive Modeling</strong>: Predictive models, including multiple regression, ARIMA time series, and random forest algorithms, are employed to forecast the development of NEEVs over the next decade. The models indicate robust growth in sales and market penetration, driven by reduced costs and technological improvements.</li>\n<li><strong>Market Dynamics</strong>: The research delves into the specific factors affecting the NEEV market in China, identifying key contributors such as patent applications, subsidies, and battery capacities. Regression analysis shows a positive relationship between these factors and the growth of NEEV ownership and market size.</li>\n<li><strong>Impact on Traditional Energy Vehicles</strong>: The study assesses the impact of NEEVs on the global traditional energy vehicle industry, indicating a market transition favoring electric vehicles. This shift is driven by technological advancements, economic considerations, and environmental benefits associated with electric vehicles.</li>\n<li><strong>Government and International Policies</strong>: The analysis extends to the effects of international policies on the development of NEEVs in China. Policies from countries like Germany, Japan, and the United States are examined, revealing their influence on China’s NEEV market dynamics.</li>\n<li><strong>Ecological Benefits</strong>: The study evaluates the ecological benefits of NEEVs, particularly in urban areas. It highlights significant reductions in carbon emissions when conventional vehicles are replaced with electric ones, underscoring the environmental advantages of NEEV adoption.</li>\n</ol>\n<p>In conclusion, the paper provides a detailed evaluation of the NEEV market in China, offering valuable insights into its development, market dynamics, and future prospects. The findings underscore the importance of NEEVs in fostering environmental sustainability and economic growth.</p>\n<p><strong>Keywords</strong>: New Energy Electric Vehicles, Statistical Analysis, ARIMA, GA-BP Neural Network, Random Forest, Market Trends, Environmental Sustainability.</p>\n<p><em><strong>*Content*</strong></em></p>\n<p><em><strong>*ABSTRACT*</strong></em>\t<em><strong>*1*</strong></em></p>\n<p><em><strong>*Content*</strong></em>\t2</p>\n<p><em><strong>*1.*</strong></em>\t<em><strong>*Introduction*</strong></em>\t3</p>\n<p>1.2 Problem background\t3</p>\n<p>1.3 Restatement of the Problem\t3</p>\n<p>1.4 Our work\t4</p>\n<p><em><strong>*2.*</strong></em>\t<em><strong>*Assumptions and Justifications.*</strong></em>\t6</p>\n<p><em><strong>*3.*</strong></em>\t****Notation****s\t6</p>\n<p><em><strong>*4.*</strong></em>\t<em><strong>*Data Desceiption*</strong></em>\t7</p>\n<p>4.1Data Collection\t7</p>\n<p>4.2 Data Cleaning\t7</p>\n<p><em><strong>*5.Models and solutions*</strong></em>\t8</p>\n<p>5.1 Analyzing the main factors affecting the development of new energy electric vehicles in China\t8</p>\n<p>5.2 Predicting the future development of new energy electric vehicles in China in the next 10 years.\t12</p>\n<p>5.3 Collect data and establish a mathematical model to analyze the impact of new energy electric vehicles on the global traditional energy vehicle industry.\t19</p>\n<p>5.4 Some countries have formulated a series of policies targeted to resist the development of new energy electric vehicles in China. Establish a mathematical model to analyze the effects of these policies on the development of new energy electric vehicles in China.\t23</p>\n<p>5.6 Based on the conclusion of question 5, write an open letter to the citizens to publicize the benefits of new energy electric vehicles and the contributions of the electric vehicle industry in various countries around the world.\t25</p>\n<p><em><strong>*Appendi*</strong></em><em><strong>*x*</strong></em>\t27</p>\n<p>\\1. <strong>Introduction</strong></p>\n<p><strong>1.1</strong> <em><strong>*Problem background*</strong></em></p>\n<p>New energy vehicles refer to vehicles with advanced technical principles, new</p>\n<p>technologies and new structures, which use unconventional vehicle fuel as their power source (unconventional automotive fuels refer to fuels other than gasoline and diesel) and integrate advanced technologies in vehicle power control and drive. New energy vehicles include four major types: hybrid electric vehicles, pure electric vehicles, fuel cell electric vehicles, and other new energy vehicles. As a type of new energy vehicle, new energy electric vehicles have achieved rapid development in recent years due to their properties of low pollution, low energy consumption, and ability to regulate peak electricity consumption. New energy electric vehicles, including electric buses and family electric cars with less than 7 seats, have been popular with consumers and governments around the world.</p>\n<p>Since 2011, the Chinese government has actively promoted the development of new energy electric vehicles and formulated a series of preferential policies. The new energy electric vehicle industry has achieved tremendous development, gradually becoming another Chinese symbol after the “China High Speed Railway”.</p>\n<p><strong>1.2</strong> <em><strong>*Restatement of the Problem*</strong></em></p>\n<p><em><strong>*problem*</strong></em> <em><strong>*1*</strong></em></p>\n<p>Analyze the main factors that affect the development of new energy electric vehicles in China, establish a mathematical model, and describe the impact of these factors on the development of new energy electric vehicles in China.</p>\n<p><em><strong>*problem*</strong></em> <em><strong>*2*</strong></em></p>\n<p>Collect industry development data on China’s new energy electric vehicles, establish a mathematical model to describe and predict the development of China’s new energy electric vehicles in the next 10 years.</p>\n<p><em><strong>*problem*</strong></em> <em><strong>*3*</strong></em></p>\n<p>Collect data and establish a mathematical model to analyze the impact of new energy electric vehicles on the global traditional energy vehicle industry.</p>\n<p><em><strong>*problem*</strong></em> <em><strong>*4*</strong></em></p>\n<p>Some countries have formulated a series of policies targeted to resist the development of new energy electric vehicles in China. Establish a mathematical model to analyze the effects of these policies on the development of new energy electric vehicles in China.2</p>\n<p><em><strong>*problem*</strong></em> <em><strong>*5*</strong></em></p>\n<p>Analyze the impact of the electrification of new energy electric vehicles (including electric buses) in cities on the ecological environment. Assuming that there is an urban population of 1 million, provide the calculation results of the model.</p>\n<p><em><strong>*problem*</strong></em> <em><strong>*6*</strong></em></p>\n<p>Based on the conclusion of question 5, write an open letter to the citizens to publicize the benefits of new energy electric vehicles and the contributions of the electric vehicle industry in various countries around the world.</p>\n<p><strong>1.3</strong> <em><strong>*Our work*</strong></em></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/UbNpk4d2zYBxO1s.png\" alt=\"image.png\"></p>\n<p><strong>1.1.1</strong> <em><strong>*problem 1*</strong></em></p>\n<p>In analyzing China’s new energy electric vehicles, we identified key factors like vehicle ownership and market size as dependent variables and included patent applications, subsidies, carbon emissions, battery capacities, vehicle price, and market penetration as independent variables. Our regression analysis showed an upward trend in vehicle ownership, suggesting a positive development in the sector. We addressed variable collinearity and established a robust model, highlighting the significant relationship between vehicle ownership, yearly changes, patent applications, and subsidy amounts.</p>\n<p><strong>1.1.2</strong> <em><strong>*Problem 2*</strong></em></p>\n<p>Our study predicts a bright future for China’s new energy vehicles, with sales trends showing considerable growth since 2013. Using a multiple linear regression model based on 19 independent variables, we forecasted the sector’s growth for the next decade. The model exhibited an excellent fit, accurately mirroring the actual sales trends and projecting a continued rise in new energy vehicle sales.</p>\n<p><strong>1.1.3</strong> <em><strong>*Problem 3*</strong></em></p>\n<p>Our research involved extensive data preparation and exploratory analysis to understand the impact of electric vehicles on the traditional energy vehicle industry. By employing time series, scatter plots, and correlation matrices, we established a VAR model to analyze the dynamic relationship between electric and traditional vehicle sales. The results indicated a significant influence of electric vehicle growth on the traditional vehicle market, informing policy implications and future industry trends.</p>\n<p><strong>1.1.4</strong> <em><strong>*Problem 4*</strong></em></p>\n<p>This section assessed how international policies like Germany and Japan’s opposition, the US Inflation Reduction Act, and the EU’s investigation into Chinese electric vehicles affected China’s market. Our analysis, based on export data and policy impacts in 2022 and 2023, revealed that these policies have somewhat hindered the growth of China’s new energy vehicle exports.</p>\n<p><strong>1.1.5</strong> <em><strong>*Problem 5*</strong></em></p>\n<p>Our study evaluated the ecological benefits of electrifying vehicles in urban areas. By comparing carbon emissions from traditional and electric vehicles, we concluded that a complete switch to electric vehicles could drastically reduce carbon emissions in a city of one million people, emphasizing the environmental advantages of electric vehicle adoption.</p>\n<p><strong>1.1.6</strong> <em><strong>*Problem 6*</strong></em></p>\n<p>In an open letter to citizens, we highlighted the significant role of new energy electric vehicles in achieving a sustainable future. The letter underlined the environmental and technological benefits of electric vehicles, noting advancements in battery technology and smart systems. We encouraged public recognition of these benefits and the positive future outlook for the electric vehicle industry.</p>\n<p>\\1. <strong>Assumptions and Justifications</strong>**.**</p>\n<p><strong>A****ssumption 1:</strong> It is assumed that the data in each form is real and valid, and the sampling error is small. Only when the model is built on real data can reliable prediction results be obtained.</p>\n<p><strong>A****ssumption 2:</strong> It is assumed that the influence of other factors such as Consumer Acceptance is not considered. The model selects some factors that have a greater impact on vehicle ownership, vehicle market size and etc. as independent variables. Only by ignoring the influence of other factors can be reasonable prediction equation be obtained.</p>\n<p><strong>A****ssumption 3</strong>: It is assumed that the data obtained from the search has a certain degree of credibility and rationality. And the data is relatively complete.</p>\n<p>\\2. <strong>Notations</strong></p>\n<p><strong>Table</strong> <strong>1</strong> <strong>Symbol</strong> <strong>Description</strong></p>\n<table>\n<thead>\n<tr>\n<th><em><strong>*Symbol*</strong></em></th>\n<th><em><strong>*Explanation*</strong></em></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><em><strong>*β*</strong></em></td>\n<td>the coefficient of x</td>\n</tr>\n<tr>\n<td><em><strong>*X*</strong></em><em><strong>*Y*</strong></em></td>\n<td>self variantimplicit variant</td>\n</tr>\n</tbody>\n</table>\n<p>\\3. <strong>Data Desceiption</strong></p>\n<p><em><strong>*4.1Data Collection*</strong></em></p>\n<p>Due to the fact that the mathematical modeling problem in this study is related to the development of new energy vehicles, in order to collect datasets related to the development of new energy vehicles, we searched many databases. The data in these databases are all related to new energy vehicles, and due to the different types of data provided by different databases, we integrated the data on an annual basis into a table. Below are the sources of the data and the meanings of variables.</p>\n<p><em><strong>*Table 2 Dataset source*</strong></em></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/CnsZD9HIi3qmerM.png\" alt=\"image.png\"></p>\n<p><em><strong>*4.2 Data Cleaning*</strong></em></p>\n<p><em><strong>*4.2.1 Data missing value processing*</strong></em></p>\n<p>Due to the different departments and cycles of data recording, the amount of data in different data sets is not the same. In order to make the data sets of each variable available, the missing values in the data sets should be dealt with accordingly. In this paper, the regression interpolation method based on the serial trend is used to deal with the missing values of the data.</p>\n<p><em><strong>*4.2.2 Data Standardization processing*</strong></em></p>\n<p>Since each variable has different units and orders of magnitude, we standardize each data in order to facilitate the construction of our multiple regression model. In this paper, z-scores are used to process the data. It can be expressed by the following equation:</p>\n<p>*z=(x-μ)/*<em>σ</em>\t\t\t\t\t\t\t\t\t（1）</p>\n<p><em><strong>*4.2.3 Factor correlation analysis chart*</strong></em></p>\n<p>According to the following correlation coefficient heatmap, it can be seen that when New energy vehicle ownership (10000 vehicles) and New Energy Vehicle Market Size (RMB bill) are used as dependent variables, their values are related to Year, Number of patient applications for new energy vehicles (items), Amount of subsidiaries for new energy vehicles (RMB bill), Total carbon emissions (miles of tons) Lithium iron phosphate power battery installed capacity/GWh, installed capacity of term battery/GWh, and weighted average price of new energy vehicles ($10000) are all related. And the correlation coefficients are relatively large (greater than 0.8 and mostly 0.95-1)</p>\n<p>Therefore, the quantities we collected all have strong correlation, and they can all be used as independent variables to predict the sales or development of new energy vehicles.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/M3q9CDOzgfIFwJN.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture2 Correlation coefficient heat map*</strong></em></p>\n<p><strong>5.Models and solutions</strong></p>\n<p><em><strong>*5.1 Analyzing the main factors affecting the development of new energy electric vehicles in China*</strong></em></p>\n<p><em><strong>*（1）Data collection*</strong></em></p>\n<p>We organize the collected data and set Year as an irrelevant variable, but changes in Year will affect the subsequent changes, so we keep Year. then we set New energy vehicle ownership (10,000 vehicles) and New Energy Vehicle Market Size (RMB billion) as dependent variables because our group believes that changes in these two variables can reflect changes in the development of new energy electric vehicles in China. Then we set Number of patent applications for new energy vehicles (items), Amount of subsidies for new energy vehicles (RMB billion), Total carbon emissions ( millions of tons), Lithium iron phosphate power battery installed capacity/GWh, Installed capacity of ternary battery/GWh, Weighted average price of new energy vehicles ($10,000), New energy vehicle market penetration (%) are set as independent variables, considering that they are the main factors affecting the change of the dependent variable.</p>\n<p>Therefore, we design the statistical graph as shown below.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/f4hN28J9a1mEk6X.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture3 Statistical data on factors affecting the development of new energy vehicles*</strong></em></p>\n<p><strong>（2）</strong><em><strong>*New energy vehicle ownership (10,000 vehicles) multiple regression curve*</strong></em></p>\n<p>According to the change of New energy vehicle ownership (10,000 vehicles) and its first-order difference curve over the years, it can be seen that New energy vehicle ownership (10,000 vehicles) shows an upward trend, so the factors in the multivariate regression curve of New energy vehicle ownership (10,000 vehicles) should generally show an upward trend after weighting. Therefore, the factors in the multiple regression curve of New energy vehicle ownership (10,000 vehicles) should be in an upward trend after weighting in general. And we can also know that the curve of New energy vehicle ownership (10,000 vehicles) is accelerating in general.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/waLd5vgBN1xM4pt.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture4 Vehicle ownership and its first-order difference curve vary with year*</strong></em></p>\n<p>The analysis of the results of the F-test shows that the P-value of significance is 0.001 * * *, which is significant at the level and rejects the null hypothesis of a regression coefficient of 0. Therefore, the model basically meets the requirements.</p>\n<p>For the collinearity performance of variables, the VIF values of Year, Number of patent applications for new energy vehicles (items), Amount of subsidiaries for new energy vehicles (RMB bill), Total carbon emissions (miles of tons), Lithium iron phase power battery installed capacity/GWh, Installed capacity of term battery/GWh, Weighted average price of new energy vehicles ($10000) are greater than 10, There is a collinear relationship, so it is easy to remove the collinear independent variables or perform ridge regression or stepwise regression.</p>\n<p>The formula of the model is as follows: y=-0.046-0.507 * Year -0.155 * Number of patient applications for new energy vehicles (items)+1.81 * Amount of subsidiaries for new energy vehicles (RMB bill)+0.028 * Total carbon emissions (miles of tons) -0.556 * Lithium iron phase power battery installed capacity/GWh+1.402 * Installed capacity of term battery/GWh+44.817 * Weighted average price of new energy vehicles ($10000).</p>\n<p>This also confirms that the fit is very good.</p>\n<p><strong>Table3 Table of results of linear regression analysis</strong></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/eT6WKdN4sLfBkYz.png\" alt=\"image.png\"></p>\n<p New=\"\" energy=\"\" vehicle=\"\" ownership=\"\" (10000=\"\" vehicles)=\"\">The following figure shows the independent variables X: {Year, Number of patient applications for new energy vehicles (items), Amount of subsidiaries for new energy vehicles (RMB bill), Total carbon emissions (miles of tons), Lithium iron phase power battery installed capacity/GWh, Installed capacity of term battery/GWh, Weighted average price of new energy vehicles ($10000)}; The relationship between the dependent variable Y:</p>\n<p>We order:</p>\n<p>y=New energy vehicle ownership (10,000 vehicles)</p>\n<p><em>x</em>1=Year</p>\n<p><em>x</em>2=Number of patent applications for new energy vehicles (items)</p>\n<p><em>x</em>3=Amount of subsidies for new energy vehicles (RMB billion)</p>\n<p><em>x</em>4=Total carbon emissions (millions of tons)</p>\n<p><em>x</em>5=Lithium iron phosphate power battery installed capacity/GWh</p>\n<p><em>x</em>6=Installed capacity of ternary battery/GWh</p>\n<p><em>x</em>7=Weighted average price of new energy vehicles ($10,000)</p>\n<p>According to the statistics listed above,we could get this function：</p>\n<p>y=-0.046-0.507<em>x</em>1-0.155<em>x</em>2+1.81<em>x</em>3+0.028<em>x</em>4-0.556<em>x</em>5+1.402<em>x</em>6+44.817<em>x</em>7（2）</p>\n<p><strong>Table4 multivariate regression coefficient value</strong></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/Sa6Z4jpmUWsYM21.png\" alt=\"image.png\"></p>\n<p>The following graph shows the raw data plot, model fitted values, and model predicted values for this model.</p>\n<p>According to the graph, the fit is very good.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/oG1wCaSuvhMyKEj.png\" alt=\"image.png\"></p>\n<p><strong>Picture5 Comparison of model fit and true value</strong></p>\n<p>Based on the resultant fit we know that the predicted value of New energy vehicle ownership (10,000 vehicles) is very close to the true value and the fit is successful.</p>\n<p><strong>（3）</strong><em><strong>*New Energy Vehicle Market Size (RMB billion) multiple regression curve*</strong></em></p>\n<p><em><strong>*In the same way as above, we can obtain a set of equations：*</strong></em></p>\n<p>New Energy Vehicle Market Size (RMB billion)=-0.569-6.291（Year）-1.893*（Number of patent applications for new energy vehicles (items)）+28.455*（Amount of subsidies for new energy vehicles (RMB billion)）+0.344（Total carbon emissions (millions of tons)）-5.866*（Lithium iron phosphate power battery installed capacity/GWh）+16.201*（Installed capacity of ternary battery/GWh）+559.405*（Weighted average price of new energy vehicles ($10,000)）</p>\n<p><strong>（4）</strong><em><strong>*Analyzing and summarizing the first question*</strong></em></p>\n<p>In general, government subsidies, total carbon emissions, installed capacity of ternary batteries, and the weighted average price of new energy vehicles have a positive impact on the market size, while the number of patent applications and the installed capacity of lithium iron phosphate power batteries have a negative impact.</p>\n<p>However, from my perspective, an increase in the number of patent applications may signify the growing applicability of patents to new energy vehicles. Additionally, as the development of lithium iron phosphate power batteries matures, it is likely to have a positive impact on the market size. We recognize that during the initial stages of technological development, significant investments are required, and any short-term negative impacts may be inconsequential. Following our group research, a consensus has emerged that these factors will likely contribute positively to the new energy vehicle market in the future.</p>\n<p>Therefore, it is conceivable that a higher number of patent applications could reflect increased technological relevance to new energy vehicles, and the mature development of lithium iron phosphate power batteries may eventually contribute positively to the market size. As our group collectively believes, these factors are expected to benefit the new energy vehicle market substantially in the future.</p>\n<p><em><strong>*5.2 Predicting the future development of new energy electric vehicles in China in the next 10 years.*</strong></em></p>\n<p>(1)<em><strong>*Preliminary trend of increase/decrease based on sales graphs*</strong></em></p>\n<p>The sales of new energy vehicles year by year according to the year - sales plotted as the following curve, from which we can see that the sales of new energy vehicles and the year between the year does have a rising trend, and we can see that the sales of new energy vehicles in the initial emergence of the trend of low-frequency slow growth in about 2013, and in 2020 after the trend of high rate of growth, the analysis of the world’s new energy science and technology and the Chinese government’s new energy vehicle policy support and other factors, to be discussed in the follow-up.<img data-src=\"https://s2.loli.net/2024/07/04/nysUCTQd6HGLNzp.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture6 Year vs. graph Production and sales of new energy vehicles (10,000 units)*</strong></em></p>\n<p>After the sales of new energy vehicles are processed by the first-order difference, the obtained first-order difference-year graph shows an exponential growth trend, which generally shows a relatively smooth first and a rapid growth trend until the beginning of 2020. Overall it is still in the form of growth.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/aBuoMKwGljnqWkF.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture*</strong></em><em><strong>*7 first-order difference in value Production and sales of new energy vehicles*</strong></em></p>\n<p><strong>(2)</strong> <em><strong>*Modeling based on multiple regression linear curves*</strong></em></p>\n<p>(3) Combining examples and research, we can find that the change of annual sales of new energy vehicles is related to Year、New energy vehicle ownership (10,000 vehicles)、New Energy Vehicle Market Size (RMB billion)、New energy vehicle market penetration (%)、New Energy Vehicle YoY Growth Rate (%)、Number of new energy vehicle enterprises (number)、Number of patent applications for new energy vehicles (items)、Scale of new energy vehicle industry chain (home)、Number of charging piles for new energy vehicles (10,000)、Coverage of new energy vehicle charging infrastructure (%)、Amount of subsidies for new energy vehicles (RMB billion)、Market penetration of conventional fuel vehicles (%)、Total carbon emissions in the Yangtze River Delta region (million tons)、Production and sales of conventional vehicles (10,000 units)、Conventional Vehicles YoY Growth Rate (%)、Lithium iron phosphate power battery installed capacity/GWh、Installed capacity of ternary battery/GWh、Total carbon emissions (millions of tons)、Weighted average price of new energy vehicles ($10,000)and other variable factors are closely related.</p>\n<p>Therefore, we will model the relationship between Production and sales of new energy vehicles (10,000 units) and the other 19 independent variables based on the collected dataset.And the model’s conclusions are used to predict the development of new energy electric vehicles in China over the next decade.</p>\n<p>​\t⚫ Build multiple linear models</p>\n<p>We order:</p>\n<p><em>x</em>1=Year</p>\n<p><em>x</em>2=New energy vehicle ownership (10,000 vehicles)</p>\n<p><em>x</em>3=New Energy Vehicle Market Size (RMB billion)</p>\n<p><em>x</em>4=New energy vehicle market penetration (%)</p>\n<p><em>x</em>5=New Energy Vehicle YoY Growth Rate (%)</p>\n<p><em>x</em>6=Number of new energy vehicle enterprises (number)</p>\n<p><em>x</em>7=Number of patent applications for new energy vehicles (items)</p>\n<p><em>x</em>8=Scale of new energy vehicle industry chain (home)</p>\n<p><em>x</em>9=Number of charging piles for new energy vehicles (10,000)</p>\n<p><em>x</em>10=Coverage of new energy vehicle charging infrastructure (%)</p>\n<p><em>x</em>11=Amount of subsidies for new energy vehicles (RMB billion)</p>\n<p><em>x</em>12=Market penetration of conventional fuel vehicles (%)</p>\n<p><em>x</em>13=Total carbon emissions in the Yangtze River Delta region (million tons)</p>\n<p><em>x</em>14=Production and sales of conventional vehicles (10,000 units)</p>\n<p><em>x</em>15=Conventional Vehicles YoY Growth Rate (%)</p>\n<p><em>x</em>16=Lithium iron phosphate power battery installed capacity/GWh</p>\n<p><em>x</em>17=Installed capacity of ternary battery/GWh</p>\n<p><em>x</em>18=Total carbon emissions (millions of tons)</p>\n<p><em>x</em>19=Weighted average price of new energy vehicles ($10,000)</p>\n<p>y=β0+β1<em>x</em>1+β2<em>x</em>2+β3<em>x</em>3+β4<em>x</em>4+β5<em>x</em>5+β6<em>x</em>6+β7<em>x</em>7+β8<em>x</em>8+β9<em>x</em>9+β10<em>x</em>10+β11<em>x</em>11+β12<em>x</em>12+β13<em>x</em>13+β14<em>x</em>14+β15<em>x</em>15+β16<em>x</em>16+β17<em>x</em>17+β18<em>x</em>18+β19<em>x</em>19 \t\t\t\t\t\t\t\t\t\t\t\t<strong>(<strong><strong>3</strong></strong>)</strong></p>\n<p>Using the python code for the multiple regression algorithm (Appendix 1), we can get the value of this multiple regression equation as:</p>\n<p>y=-175.361921+0.786334<em>x</em>1+4.674333<em>x</em>2+0.133171<em>x</em>3+1.340155<em>x</em>4+0.203066<em>x</em>5+5.114536<em>x</em>6-1.460884<em>x</em>7+0.602279<em>x</em>8+2.367206<em>x</em>9-7.039104<em>x</em>10+7.524213<em>x</em>11-1.340155<em>x</em>12-0.623688<em>x</em>13+0.488335<em>x</em>14-6.786688<em>x</em>15-2.279974<em>x</em>16+5.143792<em>x</em>17-0.075757<em>x</em>18+0.393167<em>x</em>19\t\t\t\t\t\t\t\t\t\t\t\t\t\t  <strong>(<strong><strong>4</strong></strong>)</strong></p>\n<p>​</p>\n<p><strong>Table****5</strong> <strong>Model</strong> <strong>Summary</strong></p>\n<table>\n<thead>\n<tr>\n<th>Model</th>\n<th>R</th>\n<th>R square</th>\n<th>Adjust R square</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td></td>\n<td>0.930</td>\n<td>0.865</td>\n<td>0.980</td>\n</tr>\n</tbody>\n</table>\n<p>According to the multiple regression model it is shown that the model R is 0.930, the square of R is 0.865 and the adjusted R square value is 0.980, which indicates a very good fit.</p>\n<p>Hypothesis is raised in F-test: all coefficients are 0. From the ANOVA table (see appendix), it can be seen that the p value of the F test is &lt;0.001, and the null hypothesis is rejected at the significance level of 0.05, and the test is passed.</p>\n<p>We substituted formulas to calculate projected annual sales based on the values of the other nineteen formulas (the algorithm is attached in the Appendix), and then calculated a graph of year-annual sales - projected sales as follows.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/OjX4MycbRzuod8W.png\" alt=\"image.png\"></p>\n<p><em><strong>*picture8 imagery of year-annual sales - projected sales*</strong></em></p>\n<p>From the above figure, we can find that the number of expected annual sales and the actual number of annual sales is really too close, leading to the fact that we may wonder whether there is a second line drawn, so we do not put a different way of thinking, to make the number of expected annual sales - the actual number of annual sales of the x-y curve, we can clearly see that the slope of the image k = 1, and the intercept is only -0.0046, which is very small, so you can approximate that the predicted results are exactly the same as the actual results. The fit is valid.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/W7yidw4JYGRtPUK.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture9 Forecasted - Actuall Number of units sold*</strong></em></p>\n<p>From the graph I gave and the formula new energy vehicle production and sales (10,000 units) = -175.361921 + 0.786334 × year + 4.674333 × new energy vehicle ownership (10,000 units) + 0.133171 × new energy vehicle market size (100 million yuan) + 1.340155 × new energy vehicle market penetration rate (%) + 0.203066 × new energy vehicle vehicle chain growth rate (%) +5.114536×number of new energy vehicle enterprises (home) ±1.460884×number of new energy vehicle patent applications (item) +0.602279×size of new energy vehicle industry chain (home) +2.367206×number of new energy vehicle charging piles (10,000 pcs) ±7.039104×coverage of new energy vehicle charging infrastructure ( %) + 7.524213 × amount of subsidies for new energy vehicles (RMB 100 million) + -1.340155 × market penetration rate of traditional fuel vehicles (%) + -0.623688 × total carbon emissions in the Yangtze River Delta region (millions of tons) + 0.488335 × production and sales volume of traditional vehicles (10,000 vehicles) + -6.786688 × chain growth rate of traditional vehicles (%) + - 2.279974×Lithium iron phosphate power battery installed volume/GWh+5.143792×Ternary battery installed volume/GWh± can be known.</p>\n<p>\\1. New energy vehicle production and sales (10,000 units) and year, new energy vehicle ownership (10,000 units), new energy vehicle market size (RMB 100 million), new energy vehicle market penetration rate (%), new energy vehicle chain growth rate (%), number of new energy vehicle enterprises (home), new energy vehicle industry chain size (home) new energy vehicle industry chain size (home), number of new energy vehicle charging piles (10,000) The independent variables of new energy vehicle subsidy amount (RMB 100 million), installed capacity of ternary batteries/GWh, and weighted average price of new energy vehicles (RMB 10,000) are positively correlated.</p>\n<p>\\2. Negative correlation with total carbon emissions (million tons), chain growth rate of conventional vehicles (%), etc.</p>\n<p>From the following change curves of the respective variables, it can be seen that the total sales volume of new energy vehicles (10,000 units) will grow exponentially in the next ten years.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/BwtxHlyNRXcsh3g.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture10 The variation curve of each variable over the year（1）*</strong></em></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/2wXANi7ZkCgn4FW.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture11 Comparison of Market Penetration Rates of Conventional and New Energy Vehicles*</strong></em></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/5PZpFxaSj2vr8Xo.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture12 The variation curve of each variable over the year（2）*</strong></em></p>\n<p>In summary, I have the following views on the development of new energy vehicles in China in the next decade:</p>\n<p>\\1. In the next decade, the number of new energy vehicles (10000 units) will steadily increase, currently showing a cubic growth, and will continue to grow until reaching a certain order of magnitude and starting to grow steadily and slowly.</p>\n<p>\\2. The scale of the new energy vehicle market (in billions of RMB) will be greatly increased, gradually surpassing the sharp decline in the traditional vehicle market size with increasing derivatives</p>\n<p>\\3. The penetration rate (%) of the new energy vehicle market will gradually increase, ultimately reaching over 70%.</p>\n<p>\\4. The month on month growth rate (%) of new energy vehicles will first increase and then decrease. As the month on month growth is compared to the previous year’s growth, the growth rate will not be particularly high in the future, but overall it still shows a growth trend.</p>\n<p>\\5. The number of new energy vehicle enterprises will increase. As new energy vehicles are an emerging market, manufacturers such as Tesla will make a lot of money, which will attract more manufacturers to enter new energy. At present, the most representative manufacturers are Huawei’s Wenjie and Xiaomi Motors.</p>\n<p>The number of patent applications for new energy vehicles will gradually increase, and then gradually decrease. Due to the current peak period of new energy vehicle development, it is normal for patents to spring up one after another. As the new energy industry gradually matures in the future, the number of patents will decrease.</p>\n<p>\\7. The scale of the new energy vehicle industry chain will gradually increase, consistent with the conclusion in 5</p>\n<p>The number of new energy vehicle charging stations (10000) will be significantly increased to adapt to the increasing holdings of new energy vehicles and attract new customers.</p>\n<p>\\9. The coverage rate (%) of new energy vehicle charging infrastructure will be significantly increased, for the same reason.</p>\n<p>The most important thing is that the sales of new energy vehicles will also steadily increase. In short, the development of new energy electric vehicles in China in the next 10 years will be very promising, and the future is bound to be limitless!</p>\n<p><em><strong>*5.3*</strong></em> <em><strong>*Collect data and establish a mathematical model to analyze the impact of new energy electric vehicles on the global traditional energy vehicle industry.*</strong></em></p>\n<h3 id=\"data-preparation-and-preprocessing\"><a class=\"markdownIt-Anchor\" href=\"#data-preparation-and-preprocessing\">#</a> Data Preparation and Preprocessing:</h3>\n<p>Data Organization: Transform raw data into an analyzable format, ensuring correct data types for each variable (e.g., years as date format, sales volumes as numerical values).</p>\n<p>Missing Values: Inspect the dataset for any missing entries. If present, choose to impute (using methods like mean of neighboring values, median, or regression prediction based on other variables) or to exclude missing records.</p>\n<p>Outlier Analysis: Identify and scrutinize outliers to determine whether they result from input errors or natural fluctuations. Correct or exclude errors; retain natural fluctuations as they may represent real-world scenarios.</p>\n<p>Normalization/Standardization: Apply normalization or standardization techniques (such as Z-score standardization) to adjust the scale of data, eliminating the influence of different variable magnitudes.</p>\n<h3 id=\"exploratory-data-analysis-eda\"><a class=\"markdownIt-Anchor\" href=\"#exploratory-data-analysis-eda\">#</a> Exploratory Data Analysis (EDA):</h3>\n<p>Time Series Analysis: Plot time series for each variable to observe trends and patterns over time, identifying any evident trends or seasonality.</p>\n<p>Scatter Plot Analysis: Create scatter plots to explore relationships between variables, such as the relationship between electric vehicle sales and crude oil prices.</p>\n<p>Correlation Matrix Visualization: Construct a correlation matrix and visualize it to discern linear relationships between variables, aiding in variable selection for the VAR model.</p>\n<h3 id=\"correlation-analysis\"><a class=\"markdownIt-Anchor\" href=\"#correlation-analysis\">#</a> Correlation Analysis:</h3>\n<p>Pearson Correlation Coefficient: Compute the Pearson correlation coefficient between electric vehicle sales, traditional vehicle sales, and crude oil prices to quantitatively describe their linear relationships.</p>\n<p>Significance Testing: Perform tests to ascertain the statistical significance of the correlation coefficients, thus determining the reliability of the relationships between variables.</p>\n<h3 id=\"causality-testing\"><a class=\"markdownIt-Anchor\" href=\"#causality-testing\">#</a> Causality Testing:</h3>\n<p>Granger Causality Test: Conduct Granger causality tests to determine if one variable’s historical values can significantly predict future values of another, thereby establishing a Granger cause.</p>\n<p>Lag Selection: Choose the number of lags to use in Granger causality testing, typically selected based on information criteria such as AIC or BIC.</p>\n<h3 id=\"var-model-construction\"><a class=\"markdownIt-Anchor\" href=\"#var-model-construction\">#</a> VAR Model Construction:</h3>\n<p>Variable Selection: Based on EDA and correlation analysis outcomes, select appropriate variables for the VAR model.</p>\n<p>Model Estimation: Estimate the VAR model’s parameters using the ordinary least squares method.</p>\n<p>Lag Structure Determination: Determine the optimal lag order for the VAR model using information criteria.</p>\n<h3 id=\"model-estimation-and-testing\"><a class=\"markdownIt-Anchor\" href=\"#model-estimation-and-testing\">#</a> Model Estimation and Testing:</h3>\n<p>Model Diagnostics: Conduct diagnostic tests, including tests for autocorrelation of residuals, heteroscedasticity, and model stability.</p>\n<p>Predictive Accuracy: Assess the model’s predictive accuracy, often by reserving a portion of data as a test set.</p>\n<h3 id=\"model-interpretation-and-policy-analysis\"><a class=\"markdownIt-Anchor\" href=\"#model-interpretation-and-policy-analysis\">#</a> Model Interpretation and Policy Analysis:</h3>\n<p>Impact Interpretation: Interpret the results of the VAR model, discussing how the growth in electric vehicle sales dynamically influences the sales of traditional energy vehicles.</p>\n<p>Policy Impact Discussion: Explore how electric vehicle-related policies might affect the relationships between these variables and how policymakers can utilize these findings.</p>\n<p>External Factors Consideration: Discuss potential external factors that may impact the markets for electric vehicles and traditional energy vehicles, and how these factors might be incorporated into future research.</p>\n<h3 id=\"translated-conclusions\"><a class=\"markdownIt-Anchor\" href=\"#translated-conclusions\">#</a> Translated Conclusions:</h3>\n<p>The data indicates that the market share of electric vehicles grew from 0.4% in 2013 to 18.6% in 2022, a substantial increase that correlates with a decline in traditional energy vehicle sales. Specifically, as electric vehicle sales have risen, traditional vehicle sales have demonstrated a downward trend. This suggests a shift in consumer preferences and the impact of reduced costs and technological advancements in electric vehicles, attracting more buyers.</p>\n<p>The increase in the electric vehicle market share significantly correlates with a decrease in the average fuel consumption of traditional vehicles. This suggests that automobile manufacturers may be enhancing the fuel efficiency of traditional vehicles to compete with electric vehicles, or consumers may be increasingly opting for models with lower fuel consumption.</p>\n<p>While the growth in electric vehicle market share has not directly impacted crude oil prices (the correlation is not significant), it does not preclude the potential for long-term effects on the energy market. As electric vehicle costs continue to decrease and policies further support, the demand for traditional fuel vehicles might decline, potentially affecting future crude oil demand and prices.</p>\n<p>In conclusion, the emergence of electric vehicles is gradually impacting the global traditional energy vehicle industry. Specifically, with the continuing expansion of the electric vehicle market share, global sales of traditional vehicles have begun to be affected, as indicated by decreasing sales. Meanwhile, the traditional vehicle industry’s technological adaptation is reflected in improved fuel efficiency and reduced consumption. However, so far, the rise in the electric vehicle market has not had a significant impact on crude oil prices, which may be due to the crude oil market being influenced by a variety of factors, including global economic activity levels, international political situations, and the development of alternative energy markets.</p>\n<p><em><strong>*5.4 Some countries have formulated a series of policies targeted to resist the*</strong></em> <em><strong>*development of new energy electric vehicles in China. Establish a mathematical model to*</strong></em> <em><strong>*analyze the effects of these policies on the development of new energy electric vehicles in China.*</strong></em></p>\n<p><em><strong>*（1）Policy*</strong></em> <em><strong>*Collection*</strong></em></p>\n<p>​\tIn June 2022, Germany and Japan were strongly opposed to new energy sources.</p>\n<p>On 16 August 2022 the Inflation Reduction Act (IRA) was signed into law, under which only electric vehicles assembled in North America are eligible for tax credits.</p>\n<p>On 4 October 2023, the EU launched a countervailing investigation into China’s new battery electric vehicles.</p>\n<p><em><strong>*（2）*</strong></em><em><strong>*Data collection*</strong></em></p>\n<p>In order to analyse these policies on the development of new energy electric vehicles in China, we collected the export volume of new energy vehicles from 2011 to 2023, As shown in the figure below</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/6mILXTDCbUc7htY.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture13 New Energy Vehicle Export Volume scatterplot*</strong></em></p>\n<p>The anomaly is removed due to the impact of the New Crown Epidemic, which resulted in a decrease rather than an increase in exports of new energy electric vehicles in 2020</p>\n<p>As the above policies are concentrated in 2022 as well as 2023, we fitted a non-linear fit to the data as shown in the following figure, to specifically compare exports in 2022 and 2023.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/nudLeiwcsNBbSXJ.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture14 New Energy Vehicle Export Volume and Time curve*</strong></em></p>\n<p>Get the polynomial function:</p>\n<p>y=-0.0049x6-59.72x5+301061x4 \t\t\t\t\t\t\t\t\t <em><strong>*（5）*</strong></em></p>\n<p>Comparing the estimates of new energy vehicle exports corresponding to the fitted curves with the actual data using the fitted curves, it can be seen that these policies have indeed inhibited the development of new energy electric vehicles in China.</p>\n<p><em><strong>*5*</strong></em><em><strong>*.5 Analyze the impact of the electrification of new energy electric vehicles (including*</strong></em> <em><strong>*electric buses) in cities on the ecological environment. Assuming that there is an urban*</strong></em> <em><strong>*population of 1 million, provide the calculation results of the model.*</strong></em></p>\n<p><em><strong>*(*</strong></em><em><strong>*1) Data Collection*</strong></em></p>\n<p>The carbon emission factor for petrol is 2.951kg-CO2/kg, each liter of petrol weights approximately 750g, total combustion produces 2.194kg CO2, the average fuel consumption of a conventional car is 6.46L/ 100 kilometres, The resulting 100 km for conventional cars CO2 emissions: 14.17kg/km, average fuel consumption of conventional buses is 25L/100km, conventional buses 100km CO2 emissions: 54.85kg/km;</p>\n<p>grid carbon intensity is 0.65kg/kWh, and the average electric vehicle power consumption is 15kWh/100km, resulting in 100km CO2 emissions from electric vehicles: 9.75kg/100km, electric buses on average Electricity consumption is 56.6kWh/100km, CO2 emission of 100km from electric bus: 36.79kg/km.</p>\n<p><em><strong>*(*</strong></em><em><strong>*2)*</strong></em> <em><strong>*model assumption*</strong></em></p>\n<p>​\tThe population of the city is 1 million, assuming that there are on average 3 people in a household, and each household has a car, i.e., there are 333,000 cars in the city; there are 70,000 buses in the city. The average journey of a car in a day is 300km, which gives the difference in CO2 emissions between new energy electric cars and traditional cars as 48.4 tons/vehicle<em>per year, and the difference in CO2 emissions between new energy electric buses and traditional buses as 197.76 tons/vehicle</em>per year, and the difference in the total annual CO2emissions between new energy electric vehicles and traditional vehicles as 2,996 tons, and China’s average per capita carbon emissions as 6.8 tons. When all vehicles in the city are replaced with new energy vehicles, the city’s per capita carbon emissions can be reduced by 2.996 tons, a whopping 44%!</p>\n<p><em><strong>*5.*</strong></em><em><strong>*6*</strong></em> <em><strong>*Based on the conclusion of question 5, write an open letter to the citizens to publicize the benefits of new energy electric vehicles and the contributions of the electric vehicle industry in various countries around the world.*</strong></em></p>\n<p>Dear Citizens,</p>\n<p>In our journey towards a sustainable future, the emergence and expansion of new energy electric vehicles (EVs) stand as a testament to our collective commitment to environmental stewardship and technological innovation. These vehicles, characterized by their minimal environmental footprint, are pivotal in reducing urban pollution and enhancing air quality. Unlike their traditional counterparts, EVs convert energy with remarkable efficiency, offering a sustainable alternative that aligns with the global imperative to conserve resources.</p>\n<p>In addition to their environmental benefits, electric vehicles are driving technological advancements across multiple sectors, including battery technology, smart connectivity, and autonomous driving systems. This evolution is not just a leap in vehicular technology but a catalyst for broader socio-economic changes. Economically, EVs present a cost-effective solution for consumers, promising lower long-term operating and maintenance expenses.</p>\n<p>Globally, countries have been contributing significantly to this transformative movement. China, for instance, has solidified its position as a leader in the EV market, boasting record-breaking sales and a rapidly increasing market penetration. The Chinese government’s robust policies under its dual carbon goals have been instrumental in catalyzing this growth, demonstrating a commitment to high-quality industry development. Concurrently, the United States has embarked on an ambitious plan to integrate EVs into its national fabric. With strategic investments in infrastructure and manufacturing, driven by comprehensive legislative support like the Bipartisan Infrastructure Law and the Inflation Reduction Act, the U.S. is poised to significantly influence the global EV landscape.</p>\n<p>Similarly, the European Union’s initiatives have been pivotal in driving EV adoption. By implementing stringent CO2 emission standards, the EU has not only promoted environmentally friendly vehicles but also spurred innovation in green technologies. The collaborative efforts of European nations in policy formulation and infrastructure development further underline a shared vision for a green and sustainable future.</p>\n<p>As we embrace this era of electric vehicles, it is evident that our choices transcend beyond individual preferences to a collective responsibility towards a greener, more efficient, and sustainable world. The commitment and actions of countries like China, the United States, and the European Union reflect a global paradigm shift, one where the adoption of electric vehicles is a key component in our pursuit of environmental sustainability and economic resilience.</p>\n<p>In closing, the journey towards a sustainable future is not a solitary endeavor but a collaborative effort that requires the participation and support of each one of us. As we continue to witness and contribute to this transformation, let us remember that each step towards embracing electric vehicles is a step towards a cleaner and more sustainable world.</p>\n<p>Sincerely</p>\n<p>2023-11-25</p>\n<p><em><strong>*Appendix*</strong></em></p>\n<p>Data</p>\n<table>\n<thead>\n<tr>\n<th>Data</th>\n<th>Data sources</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Market share of new energy vehicles, etc.</td>\n<td>NDANEV：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5uZGFuZXYuY29tLw==\">http://www.ndanev.com/</span></td>\n</tr>\n<tr>\n<td>Market penetration of new energy vehicles and conventional vehicles</td>\n<td>National Bureau of Statistics, Ministry of Industry and Information Technology, New Energy Vehicle Association</td>\n</tr>\n<tr>\n<td>China’s total annual carbon emissions</td>\n<td><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudGhlcGFwZXIuY24vbmV3c0RldGFpbF9mb3J3YXJkXzE5ODk1MjQ3\">https://www.thepaper.cn/newsDetail_forward_19895247</span></td>\n</tr>\n<tr>\n<td>Number of new energy vehicle patents</td>\n<td>China Patent Publication Announcement Network</td>\n</tr>\n<tr>\n<td>Development of New Energy Vehicle Battery</td>\n<td>China ICT</td>\n</tr>\n<tr>\n<td>Infrastructure coverage and number of charging piles for new energy vehicles</td>\n<td>Data Center for Resource and Environmental Sciences, Chinese Academy of Sciences</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>新能源汽车销量（万 / 辆）</td>\n<td></td>\n<td></td>\n<td>年份</td>\n<td>市场占有率（%）</td>\n<td></td>\n<td></td>\n<td>年份</td>\n<td>电池平均能量密度（Wh/kg）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>-----------------------</td>\n<td>----</td>\n<td>----</td>\n<td>----</td>\n<td>---------------</td>\n<td>----</td>\n<td>----</td>\n<td>----</td>\n<td>-------------------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>50.7</td>\n<td></td>\n<td></td>\n<td>2016</td>\n<td>1.8</td>\n<td></td>\n<td></td>\n<td>2016</td>\n<td>75</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>77.7</td>\n<td></td>\n<td></td>\n<td>2017</td>\n<td>2.7</td>\n<td></td>\n<td></td>\n<td>2017</td>\n<td>95</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>126.8</td>\n<td></td>\n<td></td>\n<td>2018</td>\n<td>4.5</td>\n<td></td>\n<td></td>\n<td>2018</td>\n<td>105</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>120.6</td>\n<td></td>\n<td></td>\n<td>2019</td>\n<td>4.68</td>\n<td></td>\n<td></td>\n<td>2019</td>\n<td>140</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>140.9</td>\n<td></td>\n<td></td>\n<td>2020</td>\n<td>5.4</td>\n<td></td>\n<td></td>\n<td>2020</td>\n<td>153</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>352.9</td>\n<td></td>\n<td></td>\n<td>2021</td>\n<td>23.5</td>\n<td></td>\n<td></td>\n<td>2021</td>\n<td>215</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>689.9</td>\n<td></td>\n<td></td>\n<td>2022</td>\n<td>25.6</td>\n<td></td>\n<td></td>\n<td>2022</td>\n<td>280</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>945.9</td>\n<td></td>\n<td></td>\n<td>2023</td>\n<td>30.4</td>\n<td></td>\n<td></td>\n<td>2023</td>\n<td>300</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>电机效率（%）</td>\n<td></td>\n<td></td>\n<td>年份</td>\n<td>充电桩数量（万个）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>-------------</td>\n<td>----</td>\n<td>----</td>\n<td>----</td>\n<td>------------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>80-88</td>\n<td>84</td>\n<td></td>\n<td>2016</td>\n<td>16.6</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>85-90</td>\n<td>87.5</td>\n<td></td>\n<td>2017</td>\n<td>45</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>88-92</td>\n<td>90</td>\n<td></td>\n<td>2018</td>\n<td>77.7</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>90-95</td>\n<td>93</td>\n<td></td>\n<td>2019</td>\n<td>121.9</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>91-96</td>\n<td>93.5</td>\n<td></td>\n<td>2020</td>\n<td>168.1</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>92-97</td>\n<td>94.5</td>\n<td></td>\n<td>2021</td>\n<td>261.7</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>93-98</td>\n<td>95.5</td>\n<td></td>\n<td>2022</td>\n<td>521</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>94-98</td>\n<td>96</td>\n<td></td>\n<td>2023</td>\n<td>795.4</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>补贴估计值（万）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>----------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>5</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>7</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>6</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>4</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>3.5</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>3</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>2</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>1.5</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>产业协同率（%）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>---------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>35</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>40</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>45</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>50</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>55</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>60</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>65</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>70</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>中国新能源汽车产量（万辆）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>--------------------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>51.7</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>79.4</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>127.9</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>124.9</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>145.9</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>367.8</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>700.8</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>1000</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>新能源汽车产量增长率（%）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>-------------------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>53</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>53.3</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>79.5</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>0.11</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>7.5</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>145.6</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>96.9</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>40</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>中国燃油车产量（万辆）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>----------------------</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>2819</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>2942.5</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>2781</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>2456</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>2531.1</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>2458.8</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>1508.1</td>\n</tr>\n<tr>\n<td>2023</td>\n<td>1955.7</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>新能源汽车保有量（万辆）</td>\n<td>新能源汽车市场规模（亿元人民币）</td>\n<td>新能源汽车企业数量（家）</td>\n<td>新能源汽车专利申请数量（项）</td>\n<td>新能源汽车产业链规模（家）</td>\n<td>新能源汽车充电桩数量（万个）</td>\n<td>新能源汽车充电基础设施覆盖率（%）</td>\n<td>新能源汽车补贴金额（亿元人民币）</td>\n<td>传统燃油车市场渗透率（%）</td>\n<td>新能源汽车市场渗透率（%）</td>\n<td>长三角地区碳排放总量 (百万吨)</td>\n<td>新能源汽车产销量（万辆）</td>\n<td>新能源汽车环比增长率 (%)</td>\n<td>传统汽车产销量（万辆）</td>\n<td>传统汽车环比增长率 (%)</td>\n<td>磷酸铁锂动力电池装机量 / GWh</td>\n<td>三元电池装机量 / GWh</td>\n<td>碳排放总量 (百万吨)</td>\n<td>新能源汽车加权平均价格 (万元)</td>\n</tr>\n<tr>\n<td>----</td>\n<td>------------------------</td>\n<td>--------------------------------</td>\n<td>------------------------</td>\n<td>----------------------------</td>\n<td>--------------------------</td>\n<td>----------------------------</td>\n<td>---------------------------------</td>\n<td>--------------------------------</td>\n<td>-------------------------</td>\n<td>-------------------------</td>\n<td>----------------------------</td>\n<td>------------------------</td>\n<td>-----------------------</td>\n<td>----------------------</td>\n<td>---------------------</td>\n<td>--------------------------</td>\n<td>------------------</td>\n<td>------------------</td>\n<td>----------------------------</td>\n</tr>\n<tr>\n<td>2013</td>\n<td>0.2</td>\n<td>7.3</td>\n<td>30</td>\n<td>630</td>\n<td>230</td>\n<td>0.3</td>\n<td>0.5</td>\n<td>6.2</td>\n<td>99.9</td>\n<td>0.1</td>\n<td>1608.79</td>\n<td>1.79</td>\n<td>39.8</td>\n<td>2198.3</td>\n<td>15</td>\n<td>2</td>\n<td>15</td>\n<td>9839.7</td>\n<td>18</td>\n</tr>\n<tr>\n<td>2014</td>\n<td>1.2</td>\n<td>25.4</td>\n<td>50</td>\n<td>870</td>\n<td>280</td>\n<td>0.6</td>\n<td>1.7</td>\n<td>7.5</td>\n<td>99.6</td>\n<td>0.4</td>\n<td>1569.41</td>\n<td>7.48</td>\n<td>317.9</td>\n<td>2341.2</td>\n<td>6.5</td>\n<td>5</td>\n<td>20</td>\n<td>10029.8</td>\n<td>18.5</td>\n</tr>\n<tr>\n<td>2015</td>\n<td>3.3</td>\n<td>71.5</td>\n<td>70</td>\n<td>1020</td>\n<td>320</td>\n<td>1.2</td>\n<td>3.5</td>\n<td>9.8</td>\n<td>98.7</td>\n<td>1.3</td>\n<td>1578.45</td>\n<td>33.01</td>\n<td>341.4</td>\n<td>2406.5</td>\n<td>2.8</td>\n<td>6.1</td>\n<td>26.9</td>\n<td>9980.2</td>\n<td>19</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>7.3</td>\n<td>162.5</td>\n<td>90</td>\n<td>1170</td>\n<td>370</td>\n<td>3.5</td>\n<td>8.7</td>\n<td>13.2</td>\n<td>98.2</td>\n<td>1.8</td>\n<td>1496.37</td>\n<td>50.71</td>\n<td>53.6</td>\n<td>2801.5</td>\n<td>16.4</td>\n<td>21.8</td>\n<td>28.9</td>\n<td>9861</td>\n<td>19.5</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>16.7</td>\n<td>331.5</td>\n<td>120</td>\n<td>1360</td>\n<td>420</td>\n<td>8.2</td>\n<td>17.2</td>\n<td>19.6</td>\n<td>97.4</td>\n<td>2.6</td>\n<td>1602.22</td>\n<td>77.68</td>\n<td>53.3</td>\n<td>2871.5</td>\n<td>2.5</td>\n<td>39.9</td>\n<td>37.8</td>\n<td>10058.8</td>\n<td>20</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>31.7</td>\n<td>609.5</td>\n<td>150</td>\n<td>1470</td>\n<td>460</td>\n<td>15.6</td>\n<td>30.5</td>\n<td>28.4</td>\n<td>96.4</td>\n<td>3.6</td>\n<td>1602.72</td>\n<td>125.6</td>\n<td>61.7</td>\n<td>2791.7</td>\n<td>-2.8</td>\n<td>79.9</td>\n<td>45.7</td>\n<td>10291.8</td>\n<td>20.5</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>57.2</td>\n<td>956.7</td>\n<td>180</td>\n<td>1610</td>\n<td>500</td>\n<td>28.4</td>\n<td>52.3</td>\n<td>38.7</td>\n<td>95.3</td>\n<td>4.7</td>\n<td>1623.18</td>\n<td>120.6</td>\n<td>-4.0</td>\n<td>2535.4</td>\n<td>-9.2</td>\n<td>79.8</td>\n<td>49.8</td>\n<td>10492.5</td>\n<td>21</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>94.3</td>\n<td>1521.6</td>\n<td>220</td>\n<td>1750</td>\n<td>550</td>\n<td>44.7</td>\n<td>77.9</td>\n<td>46.3</td>\n<td>94.3</td>\n<td>5.7</td>\n<td>1649.15</td>\n<td>136.8</td>\n<td>13.4</td>\n<td>2023.1</td>\n<td>-20.2</td>\n<td>96.3</td>\n<td>61.6</td>\n<td>10713.5</td>\n<td>21.5</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>127.9</td>\n<td>2002.5</td>\n<td>250</td>\n<td>1900</td>\n<td>590</td>\n<td>59.1</td>\n<td>80.2</td>\n<td>53.9</td>\n<td>93.6</td>\n<td>6.4</td>\n<td>1675.53</td>\n<td>352.1</td>\n<td>157.6</td>\n<td>2334.1</td>\n<td>15.4</td>\n<td>183.8</td>\n<td>110.4</td>\n<td>10934.6</td>\n<td>22</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>164.5</td>\n<td>2483.4</td>\n<td>280</td>\n<td>2000</td>\n<td>630</td>\n<td>74.2</td>\n<td>87.6</td>\n<td>61.5</td>\n<td>92.7</td>\n<td>7.3</td>\n<td>1702.35</td>\n<td>688.7</td>\n<td>95.6</td>\n<td>1997.7</td>\n<td>-14.4</td>\n<td>184.5</td>\n<td>117.3</td>\n<td>11155.6</td>\n<td>22.5</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td>年份</td>\n<td>新能源汽车保有量（万辆）</td>\n<td>新能源汽车市场规模（亿元人民币）</td>\n<td>新能源汽车专利申请数量（项）</td>\n<td>新能源汽车补贴金额（亿元人民币）</td>\n<td>碳排放总量 (百万吨)</td>\n<td>磷酸铁锂动力电池装机量 / GWh</td>\n<td>三元电池装机量 / GWh</td>\n<td>新能源汽车加权平均价格 (万元)</td>\n<td>新能源汽车市场渗透率（%）</td>\n</tr>\n<tr>\n<td>----</td>\n<td>------------------------</td>\n<td>--------------------------------</td>\n<td>----------------------------</td>\n<td>--------------------------------</td>\n<td>------------------</td>\n<td>--------------------------</td>\n<td>------------------</td>\n<td>----------------------------</td>\n<td>-------------------------</td>\n</tr>\n<tr>\n<td>2013</td>\n<td>0.2</td>\n<td>7.3</td>\n<td>630</td>\n<td>6.2</td>\n<td>9839.7</td>\n<td>2</td>\n<td>15</td>\n<td>18</td>\n<td>0.1</td>\n</tr>\n<tr>\n<td>2014</td>\n<td>1.2</td>\n<td>25.4</td>\n<td>870</td>\n<td>7.5</td>\n<td>10029.8</td>\n<td>5</td>\n<td>20</td>\n<td>18.5</td>\n<td>0.4</td>\n</tr>\n<tr>\n<td>2015</td>\n<td>3.3</td>\n<td>71.5</td>\n<td>1020</td>\n<td>9.8</td>\n<td>9980.2</td>\n<td>6.1</td>\n<td>26.9</td>\n<td>19</td>\n<td>1.3</td>\n</tr>\n<tr>\n<td>2016</td>\n<td>7.3</td>\n<td>162.5</td>\n<td>1170</td>\n<td>13.2</td>\n<td>9861</td>\n<td>21.8</td>\n<td>28.9</td>\n<td>19.5</td>\n<td>1.8</td>\n</tr>\n<tr>\n<td>2017</td>\n<td>16.7</td>\n<td>331.5</td>\n<td>1360</td>\n<td>19.6</td>\n<td>10058.8</td>\n<td>39.9</td>\n<td>37.8</td>\n<td>20</td>\n<td>2.6</td>\n</tr>\n<tr>\n<td>2018</td>\n<td>31.7</td>\n<td>609.5</td>\n<td>1470</td>\n<td>28.4</td>\n<td>10291.8</td>\n<td>79.9</td>\n<td>45.7</td>\n<td>20.5</td>\n<td>3.6</td>\n</tr>\n<tr>\n<td>2019</td>\n<td>57.2</td>\n<td>956.7</td>\n<td>1610</td>\n<td>38.7</td>\n<td>10492.5</td>\n<td>79.8</td>\n<td>49.8</td>\n<td>21</td>\n<td>4.7</td>\n</tr>\n<tr>\n<td>2020</td>\n<td>94.3</td>\n<td>1521.6</td>\n<td>1750</td>\n<td>46.3</td>\n<td>10713.5</td>\n<td>96.3</td>\n<td>61.6</td>\n<td>21.5</td>\n<td>5.7</td>\n</tr>\n<tr>\n<td>2021</td>\n<td>127.9</td>\n<td>2002.5</td>\n<td>1900</td>\n<td>53.9</td>\n<td>10934.6</td>\n<td>183.8</td>\n<td>110.4</td>\n<td>22</td>\n<td>6.4</td>\n</tr>\n<tr>\n<td>2022</td>\n<td>164.5</td>\n<td>2483.4</td>\n<td>2000</td>\n<td>61.5</td>\n<td>11155.6</td>\n<td>184.5</td>\n<td>117.3</td>\n<td>22.5</td>\n<td>7.3</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LinearRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> r2_score, mean_squared_error</span><br><span class=\"line\"><span class=\"comment\"># 读取 Excel 文件</span></span><br><span class=\"line\">excel_path = <span class=\"string\">r&#x27;D:\\desktop\\2023亚太赛 c 数据\\第二问\\data\\第二问数据整合.xlsx&#x27;</span></span><br><span class=\"line\">df = pd.read_excel(excel_path)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 选择自变量和因变量</span></span><br><span class=\"line\">X = df[[<span class=\"string\">&#x27;年份&#x27;</span>, <span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>,<span class=\"string\">&#x27;新能源汽车市场规模（亿元人民币）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车市场渗透率（%）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车环比增长率(%)&#x27;</span>, <span class=\"string\">&#x27;新能源汽车企业数量（家）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车专利申请数量（项）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车产业链规模（家）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车充电桩数量（万个）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车充电基础设施覆盖率（%）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车补贴金额（亿元人民币）&#x27;</span>, <span class=\"string\">&#x27;传统燃油车市场渗透率（%）&#x27;</span>, <span class=\"string\">&#x27;长三角地区碳排放总量(百万吨)&#x27;</span>, <span class=\"string\">&#x27;传统汽车产销量（万辆）&#x27;</span>, <span class=\"string\">&#x27;传统汽车环比增长率(%)&#x27;</span>, <span class=\"string\">&#x27;磷酸铁锂动力电池装机量/GWh&#x27;</span>, <span class=\"string\">&#x27;三元电池装机量/GWh&#x27;</span>, <span class=\"string\">&#x27;碳排放总量(百万吨)&#x27;</span>, <span class=\"string\">&#x27;新能源汽车加权平均价格(万元)&#x27;</span>]]</span><br><span class=\"line\">Y = df[<span class=\"string\">&#x27;新能源汽车产销量（万辆）&#x27;</span>]</span><br><span class=\"line\"><span class=\"comment\"># 创建线性回归模型</span></span><br><span class=\"line\">model = LinearRegression()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 拟合模型</span></span><br><span class=\"line\">model.fit(X, Y)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取回归系数</span></span><br><span class=\"line\">coefficients = pd.DataFrame(&#123;<span class=\"string\">&#x27;Variable&#x27;</span>: [<span class=\"string\">&#x27;intercept&#x27;</span>] + <span class=\"built_in\">list</span>(X.columns), <span class=\"string\">&#x27;Coefficient&#x27;</span>: [model.intercept_] + <span class=\"built_in\">list</span>(model.coef_)&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输出回归系数</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(coefficients)</span><br><span class=\"line\"><span class=\"comment\"># 预测值</span></span><br><span class=\"line\">predictions = model.predict(X)</span><br><span class=\"line\"><span class=\"comment\"># 计算R²和标准估计误差</span></span><br><span class=\"line\">r2 = r2_score(Y, predictions)</span><br><span class=\"line\">mse = mean_squared_error(Y, predictions)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输出R²和标准估计误差</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;R²:&#x27;</span>, r2)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;标准估计误差:&#x27;</span>, mse)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> statsmodels.tsa.holtwinters <span class=\"keyword\">import</span> ExponentialSmoothing</span><br><span class=\"line\"><span class=\"keyword\">from</span> statsmodels.tsa.seasonal <span class=\"keyword\">import</span> seasonal_decompose</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]  <span class=\"comment\"># 设置中文字体为黑体</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 1. 数据导入和准备</span></span><br><span class=\"line\">df = pd.read_excel(<span class=\"string\">&quot;第二问数据整合.xlsx&quot;</span>, index_col=<span class=\"string\">&quot;年份&quot;</span>)</span><br><span class=\"line\">df.index = pd.to_datetime(df.index, <span class=\"built_in\">format</span>=<span class=\"string\">&#x27;%Y&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2. 可视化数据</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(df[<span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>], marker=<span class=\"string\">&#x27;o&#x27;</span>, label=<span class=\"string\">&#x27;新能源汽车保有量&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;新能源汽车保有量 Over Time&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Year&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.savefig(<span class=\"string\">&quot;可视化数据.png&quot;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3. 趋势分析</span></span><br><span class=\"line\">result = seasonal_decompose(df[<span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>], model=<span class=\"string\">&#x27;multiplicative&#x27;</span>, period=<span class=\"number\">1</span>)  <span class=\"comment\"># 选择合适的周期</span></span><br><span class=\"line\">result.plot()</span><br><span class=\"line\">plt.savefig(<span class=\"string\">&quot;趋势分析.png&quot;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4. 时间序列预测模型 - Holt-Winters Exponential Smoothing</span></span><br><span class=\"line\"><span class=\"comment\"># 将数据拆分为训练集和测试集</span></span><br><span class=\"line\">train_size = <span class=\"built_in\">int</span>(<span class=\"built_in\">len</span>(df) * <span class=\"number\">0.8</span>)</span><br><span class=\"line\">train, test = df[<span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>][:train_size], df[<span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>][train_size:]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建并拟合模型</span></span><br><span class=\"line\"><span class=\"comment\"># 使用Holt-Winters指数平滑模型</span></span><br><span class=\"line\">model = ExponentialSmoothing(train, seasonal=<span class=\"string\">&#x27;add&#x27;</span>, seasonal_periods=<span class=\"number\">2</span>)</span><br><span class=\"line\">result = model.fit()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 预测</span></span><br><span class=\"line\">forecast = result.forecast(steps=<span class=\"built_in\">len</span>(test))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 保存预测结果为 Excel 文件</span></span><br><span class=\"line\">result_df = pd.DataFrame(&#123;<span class=\"string\">&#x27;实际值&#x27;</span>: test, <span class=\"string\">&#x27;预测值&#x27;</span>: forecast&#125;)</span><br><span class=\"line\">result_df.to_excel(<span class=\"string\">&#x27;预测结果.xlsx&#x27;</span>, index=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 可视化预测结果</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">12</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(train.index, train, label=<span class=\"string\">&#x27;Train&#x27;</span>)</span><br><span class=\"line\">plt.plot(test.index, test, label=<span class=\"string\">&#x27;Test&#x27;</span>)</span><br><span class=\"line\">plt.plot(test.index, forecast, label=<span class=\"string\">&#x27;Predicted&#x27;</span>, linestyle=<span class=\"string\">&#x27;dashed&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;新能源汽车保有量预测&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Year&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.savefig(<span class=\"string\">&quot;新能源汽车保有量预测.png&quot;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> statsmodels.api <span class=\"keyword\">as</span> sm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 读取 Excel 文件</span></span><br><span class=\"line\">excel_path = <span class=\"string\">r&#x27;D:\\desktop\\2023亚太赛 c 数据\\第二问\\data\\第二问数据整合.xlsx&#x27;</span></span><br><span class=\"line\">df = pd.read_excel(excel_path)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 选择自变量和因变量</span></span><br><span class=\"line\">X = df[[<span class=\"string\">&#x27;年份&#x27;</span>, <span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>,<span class=\"string\">&#x27;新能源汽车市场规模（亿元人民币）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车市场渗透率（%）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车环比增长率(%)&#x27;</span>, <span class=\"string\">&#x27;新能源汽车企业数量（家）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车专利申请数量（项）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车产业链规模（家）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车充电桩数量（万个）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车充电基础设施覆盖率（%）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车补贴金额（亿元人民币）&#x27;</span>, <span class=\"string\">&#x27;传统燃油车市场渗透率（%）&#x27;</span>, <span class=\"string\">&#x27;长三角地区碳排放总量(百万吨)&#x27;</span>, <span class=\"string\">&#x27;传统汽车产销量（万辆）&#x27;</span>, <span class=\"string\">&#x27;传统汽车环比增长率(%)&#x27;</span>, <span class=\"string\">&#x27;磷酸铁锂动力电池装机量/GWh&#x27;</span>, <span class=\"string\">&#x27;三元电池装机量/GWh&#x27;</span>, <span class=\"string\">&#x27;碳排放总量(百万吨)&#x27;</span>, <span class=\"string\">&#x27;新能源汽车加权平均价格(万元)&#x27;</span>]]</span><br><span class=\"line\">Y = df[<span class=\"string\">&#x27;新能源汽车产销量（万辆）&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 添加截距项</span></span><br><span class=\"line\">X = sm.add_constant(X)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 拟合线性回归模型</span></span><br><span class=\"line\">model = sm.OLS(Y, X).fit()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 进行F检验</span></span><br><span class=\"line\">f_test = model.f_test(<span class=\"string\">&quot; &quot;</span>.join(X.columns[<span class=\"number\">1</span>:]))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(f_test)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> statsmodels.tsa.holtwinters <span class=\"keyword\">import</span> ExponentialSmoothing</span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]  <span class=\"comment\"># 设置中文字体为黑体</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 1. 数据导入和准备</span></span><br><span class=\"line\">df = pd.read_excel(<span class=\"string\">&quot;data/第二问数据整合.xlsx&quot;</span>, index_col=<span class=\"string\">&quot;年份&quot;</span>)</span><br><span class=\"line\">df.index = pd.to_datetime(df.index, <span class=\"built_in\">format</span>=<span class=\"string\">&#x27;%Y&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2. 需要预测的列名</span></span><br><span class=\"line\">columns_to_predict = [</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车市场渗透率（%）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车环比增长率(%)&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车企业数量（家）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车专利申请数量（项）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车产业链规模（家）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车充电桩数量（万个）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车充电基础设施覆盖率（%）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车补贴金额（亿元人民币）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;传统燃油车市场渗透率（%）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;长三角地区碳排放总量(百万吨)&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;传统汽车产销量（万辆）&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;传统汽车环比增长率(%)&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;磷酸铁锂动力电池装机量/GWh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;三元电池装机量/GWh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;碳排放总量(百万吨)&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;新能源汽车加权平均价格(万元)&#x27;</span></span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3. 循环预测并保存结果和图</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> column <span class=\"keyword\">in</span> columns_to_predict:</span><br><span class=\"line\">    <span class=\"comment\"># 创建并拟合模型</span></span><br><span class=\"line\">    model = ExponentialSmoothing(df[column], seasonal=<span class=\"string\">&#x27;add&#x27;</span>, seasonal_periods=<span class=\"number\">2</span>)</span><br><span class=\"line\">    result = model.fit()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 预测</span></span><br><span class=\"line\">    forecast = result.forecast(steps=<span class=\"number\">11</span>)  <span class=\"comment\"># 预测2023年到2033年的数据</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 输出预测结果</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;column&#125;</span> 预测结果:&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(forecast)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 可视化预测结果</span></span><br><span class=\"line\">    plt.figure(figsize=(<span class=\"number\">12</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">    plt.plot(df.index, df[column], label=<span class=\"string\">&#x27;历史数据&#x27;</span>)</span><br><span class=\"line\">    plt.plot(pd.date_range(start=<span class=\"string\">&#x27;2023-01-01&#x27;</span>, periods=<span class=\"number\">11</span>, freq=<span class=\"string\">&#x27;Y&#x27;</span>), forecast, label=<span class=\"string\">&#x27;预测&#x27;</span>, linestyle=<span class=\"string\">&#x27;dashed&#x27;</span>)</span><br><span class=\"line\">    plt.title(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;column&#125;</span>预测&#x27;</span>)</span><br><span class=\"line\">    plt.xlabel(<span class=\"string\">&#x27;年份&#x27;</span>)</span><br><span class=\"line\">    plt.ylabel(column)</span><br><span class=\"line\">    plt.legend()</span><br><span class=\"line\">    plt.savefig(<span class=\"string\">f&quot;<span class=\"subst\">&#123;column&#125;</span>_预测.png&quot;</span>)</span><br><span class=\"line\">    plt.close()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> statsmodels.api <span class=\"keyword\">as</span> sm</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"comment\"># 读取 Excel 文件</span></span><br><span class=\"line\">excel_path = <span class=\"string\">r&#x27;D:\\desktop\\2023亚太赛 c 数据\\第二问\\data\\第二问数据整合.xlsx&#x27;</span></span><br><span class=\"line\">df = pd.read_excel(excel_path)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 使用回归方程的系数</span></span><br><span class=\"line\">coefficients = [-<span class=\"number\">175.361921</span>, <span class=\"number\">0.786334</span>, <span class=\"number\">4.674333</span>, <span class=\"number\">0.133171</span>, <span class=\"number\">1.340155</span>, <span class=\"number\">0.203066</span>, <span class=\"number\">5.114536</span>, -<span class=\"number\">1.460884</span>, <span class=\"number\">0.602279</span>,</span><br><span class=\"line\">                <span class=\"number\">2.367206</span>, -<span class=\"number\">7.039104</span>, <span class=\"number\">7.524213</span>, -<span class=\"number\">1.340155</span>, -<span class=\"number\">0.623688</span>, <span class=\"number\">0.488335</span>, -<span class=\"number\">6.786688</span>, -<span class=\"number\">2.279974</span>, <span class=\"number\">5.143792</span>,</span><br><span class=\"line\">                -<span class=\"number\">0.075757</span>, <span class=\"number\">0.393167</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 选择自变量</span></span><br><span class=\"line\">features = df[[<span class=\"string\">&#x27;年份&#x27;</span>, <span class=\"string\">&#x27;新能源汽车保有量（万辆）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车市场规模（亿元人民币）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车市场渗透率（%）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车环比增长率(%)&#x27;</span>,</span><br><span class=\"line\">                <span class=\"string\">&#x27;新能源汽车企业数量（家）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车专利申请数量（项）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车产业链规模（家）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车充电桩数量（万个）&#x27;</span>,</span><br><span class=\"line\">                <span class=\"string\">&#x27;新能源汽车充电基础设施覆盖率（%）&#x27;</span>, <span class=\"string\">&#x27;新能源汽车补贴金额（亿元人民币）&#x27;</span>, <span class=\"string\">&#x27;传统燃油车市场渗透率（%）&#x27;</span>,</span><br><span class=\"line\">                <span class=\"string\">&#x27;长三角地区碳排放总量(百万吨)&#x27;</span>, <span class=\"string\">&#x27;传统汽车产销量（万辆）&#x27;</span>, <span class=\"string\">&#x27;传统汽车环比增长率(%)&#x27;</span>, <span class=\"string\">&#x27;磷酸铁锂动力电池装机量/GWh&#x27;</span>,</span><br><span class=\"line\">                <span class=\"string\">&#x27;三元电池装机量/GWh&#x27;</span>, <span class=\"string\">&#x27;碳排放总量(百万吨)&#x27;</span>, <span class=\"string\">&#x27;新能源汽车加权平均价格(万元)&#x27;</span>]]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 添加截距项</span></span><br><span class=\"line\">features = sm.add_constant(features)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算预测值</span></span><br><span class=\"line\">predicted_sales = np.dot(features.values, coefficients)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将预测值添加到数据框</span></span><br><span class=\"line\">df[<span class=\"string\">&#x27;预测新能源汽车产销量（万辆）&#x27;</span>] = predicted_sales</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输出结果</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(df[[<span class=\"string\">&#x27;年份&#x27;</span>, <span class=\"string\">&#x27;新能源汽车产销量（万辆）&#x27;</span>, <span class=\"string\">&#x27;预测新能源汽车产销量（万辆）&#x27;</span>]])</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        },
        {
            "id": "https://enjundu.github.io/bit/DATA_predose/",
            "url": "https://enjundu.github.io/bit/DATA_predose/",
            "title": "亚太数模——洪水",
            "date_published": "2024-07-04T14:49:23.000Z",
            "content_html": "<h2 id=\"before-problem-数据传入与预处理全局函数设置\"><a class=\"markdownIt-Anchor\" href=\"#before-problem-数据传入与预处理全局函数设置\">#</a> Before Problem – 数据传入与预处理，全局函数设置</h2>\n<h3 id=\"导入必要的库\"><a class=\"markdownIt-Anchor\" href=\"#导入必要的库\">#</a> 导入必要的库</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> statsmodels.api <span class=\"keyword\">as</span> sm</span><br><span class=\"line\"><span class=\"keyword\">import</span> statsmodels.formula.api <span class=\"keyword\">as</span> smf</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LinearRegression</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.preprocessing <span class=\"keyword\">import</span> StandardScaler</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> r2_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> DecisionTreeRegressor</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LogisticRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> preprocessing</span><br><span class=\"line\"><span class=\"keyword\">import</span> joblib</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> RandomForestRegressor</span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">u&#x27;simHei&#x27;</span>]   <span class=\"comment\"># 显示中文</span></span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span>      <span class=\"comment\"># 解决负号问题</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"数据读入\"><a class=\"markdownIt-Anchor\" href=\"#数据读入\">#</a> 数据读入</h3>\n<h4 id=\"从traincsv读入train数据\"><a class=\"markdownIt-Anchor\" href=\"#从traincsv读入train数据\">#</a> 从 train.csv 读入 train 数据</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br></pre></td></tr></table></figure>\n<h3 id=\"数据预处理\"><a class=\"markdownIt-Anchor\" href=\"#数据预处理\">#</a> 数据预处理</h3>\n<p>id 列对于数据分析没有用处，直接清洗掉这一列</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<p>经检验，原始数据中不存在缺失值与明显的离群点，因此在这里全部保留<br>\n将 ‘洪水概率’ 设置为目标变量，将原始数据划分为 X，y</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">y=train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">y=np.array(y)</span><br></pre></td></tr></table></figure>\n<h3 id=\"数据相关性简要分析\"><a class=\"markdownIt-Anchor\" href=\"#数据相关性简要分析\">#</a> 数据相关性简要分析</h3>\n<p>利用不同指标与洪水概率的相关系数来衡量这些指标与洪水概率的关系</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]=y</span><br><span class=\"line\">heat_corr = train_data.corr()[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">heat_corr_sorted=heat_corr.sort_values(ascending=<span class=\"literal\">False</span>)</span><br><span class=\"line\">heat_corr=heat_corr[:-<span class=\"number\">1</span>]</span><br></pre></td></tr></table></figure>\n<p>可视化相关系数图</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">heat_corr.plot(kind=<span class=\"string\">&#x27;bar&#x27;</span>, color=<span class=\"string\">&#x27;skyblue&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;不同因素对洪水概率的影响&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;影响因素&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;corr&#x27;</span>)</span><br><span class=\"line\">plt.grid(axis=<span class=\"string\">&#x27;y&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<h3 id=\"建立三个水平的指标集\"><a class=\"markdownIt-Anchor\" href=\"#建立三个水平的指标集\">#</a> 建立三个水平的指标集</h3>\n<pre><code>20： 全指标\n\n10：半指标\n\n5：核心指标\n\n划分依据: 相关系数大小\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">heat_corr_sorted=heat_corr_sorted[<span class=\"number\">1</span>:<span class=\"number\">11</span>]</span><br><span class=\"line\">ten_columns=heat_corr_sorted.index.<span class=\"built_in\">str</span>.split().<span class=\"built_in\">str</span>[<span class=\"number\">0</span>]</span><br><span class=\"line\">five_columns=heat_corr_sorted[:<span class=\"number\">5</span>].index.<span class=\"built_in\">str</span>.split().<span class=\"built_in\">str</span>[<span class=\"number\">0</span>]</span><br></pre></td></tr></table></figure>\n<h3 id=\"全局函数设置\"><a class=\"markdownIt-Anchor\" href=\"#全局函数设置\">#</a> 全局函数设置</h3>\n<p>建立余弦相似度的计算函数<br>\n cosine (a,b)<br>\n input : 向量 A，B</p>\n<pre><code>output : 两个向量的余弦相似度 0-1\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">cosine</span>(<span class=\"params\">a,b</span>):</span><br><span class=\"line\">    dot_product = np.dot(a, b)</span><br><span class=\"line\">    norm_a = np.linalg.norm(a)</span><br><span class=\"line\">    norm_b = np.linalg.norm(b)</span><br><span class=\"line\">    cosine_similarity = dot_product / (norm_a * norm_b) </span><br><span class=\"line\">    <span class=\"keyword\">return</span> cosine_similarity</span><br></pre></td></tr></table></figure>\n<h3 id=\"划分训练集与测试集\"><a class=\"markdownIt-Anchor\" href=\"#划分训练集与测试集\">#</a> 划分训练集与测试集</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br></pre></td></tr></table></figure>\n<h2 id=\"problem-one-全指标集数学模型建立与求解\"><a class=\"markdownIt-Anchor\" href=\"#problem-one-全指标集数学模型建立与求解\">#</a> Problem ONE – 全指标集数学模型建立与求解</h2>\n<pre><code>利用多种数学模型拟合本问题，并得出不同指标的权重\n多元线性回归\n梯度提升树\n决策树\n随机森林模型\n</code></pre>\n<h3 id=\"模型一-线性回归\"><a class=\"markdownIt-Anchor\" href=\"#模型一-线性回归\">#</a> 模型一 线性回归</h3>\n<pre><code>原理：利用标准方程法求解线性方程组\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\">model_line=LinearRegression()</span><br><span class=\"line\">model_line.fit(X_train,y_train)</span><br><span class=\"line\">y_pred = model_line.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = model_line.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;模型的系数为: <span class=\"subst\">&#123;model_line.coef_&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;模型的截距为: <span class=\"subst\">&#123;model_line.intercept_&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\">joblib.dump(model_line,<span class=\"string\">&#x27;../Model/linear.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Model score: <span class=\"number\">0</span>.<span class=\"number\">8444528508563269</span></span><br><span class=\"line\">均方误差为: <span class=\"number\">0</span>.<span class=\"number\">0004043169737229802</span></span><br><span class=\"line\">模型的系数为: [<span class=\"number\">0.00560656</span> <span class=\"number\">0.00564613</span> <span class=\"number\">0.00565985</span> <span class=\"number\">0.00567684</span> <span class=\"number\">0.00565284</span> <span class=\"number\">0.0056578</span></span><br><span class=\"line\"> <span class=\"number\">0.00565561</span> <span class=\"number\">0.00564293</span> <span class=\"number\">0.0056437</span>  <span class=\"number\">0.0056492</span>  <span class=\"number\">0.00564238</span> <span class=\"number\">0.0056413</span></span><br><span class=\"line\"> <span class=\"number\">0.005674</span>   <span class=\"number\">0.00564575</span> <span class=\"number\">0.0056467</span>  <span class=\"number\">0.00562068</span> <span class=\"number\">0.00568107</span> <span class=\"number\">0.00563092</span></span><br><span class=\"line\"> <span class=\"number\">0.00561738</span> <span class=\"number\">0.00564302</span>]</span><br><span class=\"line\">模型的截距为: -<span class=\"number\">0</span>.<span class=\"number\">053357024379501294</span></span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">9992129608069907</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"模型二-梯度提升树\"><a class=\"markdownIt-Anchor\" href=\"#模型二-梯度提升树\">#</a> 模型二 梯度提升树</h3>\n<pre><code>原理：递归的决策树，能发现更深层的变量关系\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> GradientBoostingRegressor</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> plot_tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\">n_estimators = <span class=\"number\">1200</span></span><br><span class=\"line\">gb_model = GradientBoostingRegressor(n_estimators=n_estimators, random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">cv_scores = cross_val_score(gb_model, X_train, y_train, cv=<span class=\"number\">5</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;每折交叉验证的评分:&quot;</span>, cv_scores)</span><br><span class=\"line\">gb_model.fit(X_train, y_train)</span><br><span class=\"line\">gb_score  = gb_model.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model Score : <span class=\"subst\">&#123;gb_score&#125;</span>&#x27;</span>)</span><br><span class=\"line\">feature_importances = gb_model.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\">train_loss = np.zeros((gb_model.n_estimators,), dtype=np.float64)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, y_pred <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(gb_model.staged_predict(X_train)):</span><br><span class=\"line\">    train_loss[i] = mean_squared_error(y_train, y_pred)</span><br><span class=\"line\"></span><br><span class=\"line\">test_loss = np.zeros((gb_model.n_estimators,), dtype=np.float64)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, y_pred <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(gb_model.staged_predict(X_test)):</span><br><span class=\"line\">    test_loss[i] = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">y_pred = gb_model.predict(X_test)</span><br><span class=\"line\">theta = cosine(y_pred,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;theta&#125;</span>&#x27;</span>)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差为<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(np.arange(<span class=\"number\">1</span>, gb_model.n_estimators + <span class=\"number\">1</span>), train_loss, label=<span class=\"string\">&#x27;Training Loss&#x27;</span>)</span><br><span class=\"line\">plt.plot(np.arange(<span class=\"number\">1</span>, gb_model.n_estimators + <span class=\"number\">1</span>), test_loss, label=<span class=\"string\">&#x27;Test Loss&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Number of Iterations&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Mean Squared Error&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Training and Test Loss&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances)), feature_importances, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\">joblib.dump(gb_model,<span class=\"string\">&#x27;../Model/gb_tree.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">每折交叉验证的评分: [<span class=\"number\">0.84262125</span> <span class=\"number\">0.84055718</span> <span class=\"number\">0.84249464</span> <span class=\"number\">0.84247138</span> <span class=\"number\">0.84228929</span>]</span><br><span class=\"line\">Model Score : <span class=\"number\">0</span>.<span class=\"number\">8414966684722095</span></span><br><span class=\"line\">特征重要性: [<span class=\"number\">0.05053843</span> <span class=\"number\">0.0513698</span>  <span class=\"number\">0.05097438</span> <span class=\"number\">0.04985333</span> <span class=\"number\">0.04968169</span> <span class=\"number\">0.0498542</span></span><br><span class=\"line\"> <span class=\"number\">0.05148326</span> <span class=\"number\">0.05025949</span> <span class=\"number\">0.04944183</span> <span class=\"number\">0.04878379</span> <span class=\"number\">0.04970291</span> <span class=\"number\">0.04908077</span></span><br><span class=\"line\"> <span class=\"number\">0.0490136</span>  <span class=\"number\">0.05042491</span> <span class=\"number\">0.04939282</span> <span class=\"number\">0.05113171</span> <span class=\"number\">0.05085744</span> <span class=\"number\">0.04953673</span></span><br><span class=\"line\"> <span class=\"number\">0.04897519</span> <span class=\"number\">0.04964374</span>]</span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">9991979970651009</span></span><br><span class=\"line\">均方误差为<span class=\"number\">0</span>.<span class=\"number\">00041200104072066957</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"模型三-决策树\"><a class=\"markdownIt-Anchor\" href=\"#模型三-决策树\">#</a> 模型三 决策树</h3>\n<pre><code>原理：利用信息增益实现节点的划分\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> plot_tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\">tree_model = DecisionTreeRegressor(random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">cv_scores = cross_val_score(tree_model, X_train, y_train, cv=<span class=\"number\">5</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;每折交叉验证的评分:&quot;</span>, cv_scores)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;交叉验证评分的平均值:&quot;</span>, np.mean(cv_scores))</span><br><span class=\"line\">tree_model.fit(X_train, y_train)</span><br><span class=\"line\">tree_score = tree_model.score(X_test, y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;Model Score :&quot;</span>, tree_score)</span><br><span class=\"line\">feature_importances = tree_model.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\">feature_importances_flat = np.ravel(feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 可视化特征重要性</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances_flat)), feature_importances_flat, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances_flat))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上进行预测</span></span><br><span class=\"line\">y_pred = tree_model.predict(X_test)</span><br><span class=\"line\">theta = cosine(y_pred,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;theta&#125;</span>&#x27;</span>)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差为<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br><span class=\"line\">joblib.dump(tree_model,<span class=\"string\">&#x27;../Model/ju_tree.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">每折交叉验证的评分: [<span class=\"number\">0.04694866</span> <span class=\"number\">0.04297524</span> <span class=\"number\">0.0450139</span>  <span class=\"number\">0.04790429</span> <span class=\"number\">0.04502323</span>]</span><br><span class=\"line\">交叉验证评分的平均值: <span class=\"number\">0</span>.<span class=\"number\">045573064737767635</span></span><br><span class=\"line\">Model Score : <span class=\"number\">0</span>.<span class=\"number\">05301513744804842</span></span><br><span class=\"line\">特征重要性: [<span class=\"number\">0.05072873</span> <span class=\"number\">0.04679774</span> <span class=\"number\">0.04822921</span> <span class=\"number\">0.0498514</span>  <span class=\"number\">0.05054892</span> <span class=\"number\">0.05003494</span></span><br><span class=\"line\"> <span class=\"number\">0.04871661</span> <span class=\"number\">0.0509244</span>  <span class=\"number\">0.05185402</span> <span class=\"number\">0.04976417</span> <span class=\"number\">0.04994974</span> <span class=\"number\">0.0515037</span></span><br><span class=\"line\"> <span class=\"number\">0.05054295</span> <span class=\"number\">0.05088047</span> <span class=\"number\">0.04947362</span> <span class=\"number\">0.04914221</span> <span class=\"number\">0.04920693</span> <span class=\"number\">0.0502652</span></span><br><span class=\"line\"> <span class=\"number\">0.05116479</span> <span class=\"number\">0.05042025</span>]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">余弦相似度为0.9952026345820846</span><br><span class=\"line\">均方误差为0.0024615176549126197</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"模型四-随机森林\"><a class=\"markdownIt-Anchor\" href=\"#模型四-随机森林\">#</a> 模型四 随机森林</h3>\n<pre><code>原理： 抽样决策树并使用投票策略\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rf = RandomForestRegressor(n_estimators=<span class=\"number\">200</span>, random_state=<span class=\"number\">42</span>) </span><br><span class=\"line\">rf.fit(X_train, y_train)</span><br><span class=\"line\">y_pred = rf.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = rf.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;准确率:&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(r2_score(y_test, y_pred))</span><br><span class=\"line\">feature_importances = rf.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\">feature_importances_flat = np.ravel(feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 可视化特征重要性</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances_flat)), feature_importances_flat, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X_train.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances_flat))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"><span class=\"keyword\">import</span> joblib</span><br><span class=\"line\">joblib.dump(rf,<span class=\"string\">&#x27;../Model/rf_forest.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Model score: <span class=\"number\">0</span>.<span class=\"number\">6559609909975268</span></span><br><span class=\"line\">均方误差为: <span class=\"number\">0</span>.<span class=\"number\">000894267826368524</span></span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">9982658517029762</span></span><br><span class=\"line\">准确率:</span><br><span class=\"line\"><span class=\"number\">0</span>.<span class=\"number\">6559609909975268</span></span><br><span class=\"line\">特征重要性: [<span class=\"number\">0.05020068</span> <span class=\"number\">0.04813886</span> <span class=\"number\">0.04897409</span> <span class=\"number\">0.05041827</span> <span class=\"number\">0.05079291</span> <span class=\"number\">0.05009829</span></span><br><span class=\"line\"> <span class=\"number\">0.04924856</span> <span class=\"number\">0.050444</span>   <span class=\"number\">0.05074958</span> <span class=\"number\">0.05022871</span> <span class=\"number\">0.04958712</span> <span class=\"number\">0.05085425</span></span><br><span class=\"line\"> <span class=\"number\">0.05060721</span> <span class=\"number\">0.05060514</span> <span class=\"number\">0.04969013</span> <span class=\"number\">0.04885388</span> <span class=\"number\">0.04925186</span> <span class=\"number\">0.05013874</span></span><br><span class=\"line\"> <span class=\"number\">0.0504078</span>  <span class=\"number\">0.05070993</span>]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"problem-two-风险聚类\"><a class=\"markdownIt-Anchor\" href=\"#problem-two-风险聚类\">#</a> Problem TWO 风险聚类</h2>\n<h3 id=\"读入数据\"><a class=\"markdownIt-Anchor\" href=\"#读入数据\">#</a> 读入数据</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br></pre></td></tr></table></figure>\n<h3 id=\"聚类算法kmeans\"><a class=\"markdownIt-Anchor\" href=\"#聚类算法kmeans\">#</a> 聚类算法：Kmeans</h3>\n<pre><code>原理: 利用n维空间距离对初始聚类中心进行学习，得到最终聚类中心\n</code></pre>\n<h4 id=\"聚类预测函数\"><a class=\"markdownIt-Anchor\" href=\"#聚类预测函数\">#</a> 聚类预测函数</h4>\n<pre><code>predict_cluster(kmeans,points)\ninput: kmeans模型 points需要预测的点集\noutput: 点集的预测结果\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">predict_cluster</span>(<span class=\"params\">kmeans, points</span>):</span><br><span class=\"line\">    points = np.array(points)</span><br><span class=\"line\">    points = points.reshape(-<span class=\"number\">1</span>,<span class=\"number\">1</span>)</span><br><span class=\"line\">    cluster_label = kmeans.predict(points)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> cluster_label</span><br></pre></td></tr></table></figure>\n<h4 id=\"建立kmeans模型\"><a class=\"markdownIt-Anchor\" href=\"#建立kmeans模型\">#</a> 建立 Kmeans 模型</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.cluster <span class=\"keyword\">import</span> KMeans</span><br><span class=\"line\">y=train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">y=np.array(y)</span><br><span class=\"line\"><span class=\"comment\">#y=-np.log(1/y-1)</span></span><br><span class=\"line\">data=np.array(y)</span><br><span class=\"line\">data_2d = data.reshape(-<span class=\"number\">1</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">kmeans = KMeans(n_clusters=<span class=\"number\">3</span>)</span><br><span class=\"line\">kmeans.fit(data_2d)</span><br><span class=\"line\">cluster_centers = kmeans.cluster_centers_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(cluster_centers)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">f:\\a\\envs\\env\\lib\\site-packages\\sklearn\\cluster\\_kmeans.py:870: FutureWarning: The<span class=\"built_in\"> default </span>value of `n_init` will change <span class=\"keyword\">from</span> 10 <span class=\"keyword\">to</span> <span class=\"string\">&#x27;auto&#x27;</span> <span class=\"keyword\">in</span> 1.4. <span class=\"built_in\">Set</span> the value of `n_init` explicitly <span class=\"keyword\">to</span> suppress the <span class=\"built_in\">warning</span></span><br><span class=\"line\">  warnings.warn(</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight lua\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">[[0.56840101]</span></span><br><span class=\"line\"><span class=\"string\"> [0.44612593]</span></span><br><span class=\"line\"><span class=\"string\"> [0.50701183]]</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h4 id=\"建立聚类中心到风险的映射字典\"><a class=\"markdownIt-Anchor\" href=\"#建立聚类中心到风险的映射字典\">#</a> 建立聚类中心到风险的映射字典</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">temp = np.array(cluster_centers)</span><br><span class=\"line\">indices= np.argsort(temp,axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">dic=&#123;&#125;</span><br><span class=\"line\">dic[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;indices[<span class=\"number\">0</span>]&#125;</span>&#x27;</span>]=<span class=\"string\">&#x27;低风险&#x27;</span></span><br><span class=\"line\">dic[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;indices[<span class=\"number\">1</span>]&#125;</span>&#x27;</span>]=<span class=\"string\">&#x27;中风险&#x27;</span></span><br><span class=\"line\">dic[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;indices[<span class=\"number\">2</span>]&#125;</span>&#x27;</span>]=<span class=\"string\">&#x27;高风险&#x27;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"示例\"><a class=\"markdownIt-Anchor\" href=\"#示例\">#</a> 示例</h4>\n<p>data= [0.55,0.99,0.51,0.42]</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data= [<span class=\"number\">0.55</span>,<span class=\"number\">0.99</span>,<span class=\"number\">0.51</span>,<span class=\"number\">0.42</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(predict_cluster(kmeans,data))</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">[0 0 2 1]</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"基于风险预警的预测模型\"><a class=\"markdownIt-Anchor\" href=\"#基于风险预警的预测模型\">#</a> 基于风险预警的预测模型</h3>\n<h4 id=\"模型建立-mymodel\"><a class=\"markdownIt-Anchor\" href=\"#模型建立-mymodel\">#</a> 模型建立 MyModel</h4>\n<pre><code>内核    ：某一个概率预测模型与kmeans聚类模型\npredict : 预测输入的X对应的y的风险类别\nscore   : 利用预测成功的比例衡量得分\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyModel</span>:</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self,model,kmeans</span>) -&gt; <span class=\"literal\">None</span>:</span><br><span class=\"line\">        self.model = model</span><br><span class=\"line\">        self.kmeans = kmeans</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">predict</span>(<span class=\"params\">self,X_test</span>) -&gt; np.ndarray:</span><br><span class=\"line\">        y_pred=self.model.predict(X_test)</span><br><span class=\"line\">        y_pred=np.array(y_pred)</span><br><span class=\"line\">        y_pred=predict_cluster(kmeans,y_pred)</span><br><span class=\"line\">        y_pred=np.array(y_pred)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> y_pred</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">score</span>(<span class=\"params\">self,X_test,y_test</span>):</span><br><span class=\"line\">        y_pred=self.predict(X_test)</span><br><span class=\"line\">        y_test = np.array(y_test)</span><br><span class=\"line\">        y_true=predict_cluster(kmeans,y_test)</span><br><span class=\"line\">        correct_predictions = np.<span class=\"built_in\">sum</span>(y_pred == y_true)</span><br><span class=\"line\">        overlap = correct_predictions / y_pred.size</span><br><span class=\"line\">        <span class=\"keyword\">return</span> overlap</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"数据读入-2\"><a class=\"markdownIt-Anchor\" href=\"#数据读入-2\">#</a> 数据读入</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">train_data=train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">y=train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">y=np.array(y)</span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"模型训练\"><a class=\"markdownIt-Anchor\" href=\"#模型训练\">#</a> 模型训练</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\">models = [<span class=\"string\">&#x27;linear.pkl&#x27;</span>,<span class=\"string\">&#x27;gb_tree.pkl&#x27;</span>,<span class=\"string\">&#x27;ju_tree.pkl&#x27;</span>,<span class=\"string\">&#x27;rf_forest.pkl&#x27;</span>]</span><br><span class=\"line\">path = <span class=\"string\">&#x27;../Model&#x27;</span></span><br><span class=\"line\">m_path=<span class=\"string\">&#x27;../Model/3_means&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> model <span class=\"keyword\">in</span> models:</span><br><span class=\"line\">    model_name=model.replace(<span class=\"string\">&#x27;.pkl&#x27;</span>,<span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;当前模型为<span class=\"subst\">&#123;model&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    model_path=os.path.join(path,model)</span><br><span class=\"line\">    model = joblib.load(model_path)</span><br><span class=\"line\">    model = MyModel(model,kmeans)</span><br><span class=\"line\">    <span class=\"comment\"># 这里可以加入模型的预测过程</span></span><br><span class=\"line\">    y_pred = model.predict(X_test)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(y_pred)</span><br><span class=\"line\">    y_true=predict_cluster(kmeans,y_test)</span><br><span class=\"line\">    mse = mean_squared_error(y_true, y_pred)</span><br><span class=\"line\">    score = model.score(X_test,y_test)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\">    accuracy = cosine(y_true,y_pred)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> model_name == <span class=\"string\">&#x27;linear&#x27;</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;不同指标的权重为&#x27;</span>)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(model.model.coef_)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;不同指标的权重为&#x27;</span>)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(model.model.feature_importances_)</span><br><span class=\"line\">    joblib.dump(model,m_path+<span class=\"string\">&#x27;/&#x27;</span>+model_name+<span class=\"string\">&#x27;.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">当前模型为linear.pkl</span><br><span class=\"line\">[<span class=\"number\">2</span> <span class=\"number\">1</span> <span class=\"number\">2</span> ... <span class=\"number\">2</span> <span class=\"number\">0</span> <span class=\"number\">2</span>]</span><br><span class=\"line\">Model score: <span class=\"number\">0</span>.<span class=\"number\">7317788427151134</span></span><br><span class=\"line\">均方误差为: <span class=\"number\">0</span>.<span class=\"number\">5221944066948001</span></span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">8803888726908916</span></span><br><span class=\"line\">不同指标的权重为</span><br><span class=\"line\">[<span class=\"number\">0.00560656</span> <span class=\"number\">0.00564613</span> <span class=\"number\">0.00565985</span> <span class=\"number\">0.00567684</span> <span class=\"number\">0.00565284</span> <span class=\"number\">0.0056578</span></span><br><span class=\"line\"> <span class=\"number\">0.00565561</span> <span class=\"number\">0.00564293</span> <span class=\"number\">0.0056437</span>  <span class=\"number\">0.0056492</span>  <span class=\"number\">0.00564238</span> <span class=\"number\">0.0056413</span></span><br><span class=\"line\"> <span class=\"number\">0.005674</span>   <span class=\"number\">0.00564575</span> <span class=\"number\">0.0056467</span>  <span class=\"number\">0.00562068</span> <span class=\"number\">0.00568107</span> <span class=\"number\">0.00563092</span></span><br><span class=\"line\"> <span class=\"number\">0.00561738</span> <span class=\"number\">0.00564302</span>]</span><br><span class=\"line\">当前模型为gb_tree.pkl</span><br><span class=\"line\">[<span class=\"number\">2</span> <span class=\"number\">1</span> <span class=\"number\">2</span> ... <span class=\"number\">2</span> <span class=\"number\">0</span> <span class=\"number\">2</span>]</span><br><span class=\"line\">Model score: <span class=\"number\">0</span>.<span class=\"number\">7343871444579548</span></span><br><span class=\"line\">均方误差为: <span class=\"number\">0</span>.<span class=\"number\">5196004100803472</span></span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">880265047613983</span></span><br><span class=\"line\">不同指标的权重为</span><br><span class=\"line\">[<span class=\"number\">0.05053843</span> <span class=\"number\">0.0513698</span>  <span class=\"number\">0.05097438</span> <span class=\"number\">0.04985333</span> <span class=\"number\">0.04968169</span> <span class=\"number\">0.0498542</span></span><br><span class=\"line\"> <span class=\"number\">0.05148326</span> <span class=\"number\">0.05025949</span> <span class=\"number\">0.04944183</span> <span class=\"number\">0.04878379</span> <span class=\"number\">0.04970291</span> <span class=\"number\">0.04908077</span></span><br><span class=\"line\"> <span class=\"number\">0.0490136</span>  <span class=\"number\">0.05042491</span> <span class=\"number\">0.04939282</span> <span class=\"number\">0.05113171</span> <span class=\"number\">0.05085744</span> <span class=\"number\">0.04953673</span></span><br><span class=\"line\"> <span class=\"number\">0.04897519</span> <span class=\"number\">0.04964374</span>]</span><br><span class=\"line\">当前模型为ju_tree.pkl</span><br><span class=\"line\">[<span class=\"number\">2</span> <span class=\"number\">1</span> <span class=\"number\">1</span> ... <span class=\"number\">1</span> <span class=\"number\">0</span> <span class=\"number\">2</span>]</span><br><span class=\"line\">Model score: <span class=\"number\">0</span>.<span class=\"number\">4960875473857378</span></span><br><span class=\"line\">均方误差为: <span class=\"number\">1</span>.<span class=\"number\">077290608683213</span></span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">7375760993349438</span></span><br><span class=\"line\">不同指标的权重为</span><br><span class=\"line\">[<span class=\"number\">0.05072873</span> <span class=\"number\">0.04679774</span> <span class=\"number\">0.04822921</span> <span class=\"number\">0.0498514</span>  <span class=\"number\">0.05054892</span> <span class=\"number\">0.05003494</span></span><br><span class=\"line\"> <span class=\"number\">0.04871661</span> <span class=\"number\">0.0509244</span>  <span class=\"number\">0.05185402</span> <span class=\"number\">0.04976417</span> <span class=\"number\">0.04994974</span> <span class=\"number\">0.0515037</span></span><br><span class=\"line\"> <span class=\"number\">0.05054295</span> <span class=\"number\">0.05088047</span> <span class=\"number\">0.04947362</span> <span class=\"number\">0.04914221</span> <span class=\"number\">0.04920693</span> <span class=\"number\">0.0502652</span></span><br><span class=\"line\"> <span class=\"number\">0.05116479</span> <span class=\"number\">0.05042025</span>]</span><br><span class=\"line\">当前模型为rf_forest.pkl</span><br><span class=\"line\">[<span class=\"number\">2</span> <span class=\"number\">2</span> <span class=\"number\">2</span> ... <span class=\"number\">2</span> <span class=\"number\">0</span> <span class=\"number\">2</span>]</span><br><span class=\"line\">Model score: <span class=\"number\">0</span>.<span class=\"number\">6358057363564839</span></span><br><span class=\"line\">均方误差为: <span class=\"number\">0</span>.<span class=\"number\">825391602889636</span></span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">8551008397005384</span></span><br><span class=\"line\">不同指标的权重为</span><br><span class=\"line\">[<span class=\"number\">0.05020068</span> <span class=\"number\">0.04813886</span> <span class=\"number\">0.04897409</span> <span class=\"number\">0.05041827</span> <span class=\"number\">0.05079291</span> <span class=\"number\">0.05009829</span></span><br><span class=\"line\"> <span class=\"number\">0.04924856</span> <span class=\"number\">0.050444</span>   <span class=\"number\">0.05074958</span> <span class=\"number\">0.05022871</span> <span class=\"number\">0.04958712</span> <span class=\"number\">0.05085425</span></span><br><span class=\"line\"> <span class=\"number\">0.05060721</span> <span class=\"number\">0.05060514</span> <span class=\"number\">0.04969013</span> <span class=\"number\">0.04885388</span> <span class=\"number\">0.04925186</span> <span class=\"number\">0.05013874</span></span><br><span class=\"line\"> <span class=\"number\">0.0504078</span>  <span class=\"number\">0.05070993</span>]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"模型灵敏度分析\"><a class=\"markdownIt-Anchor\" href=\"#模型灵敏度分析\">#</a> 模型灵敏度分析</h3>\n<pre><code>利用结果的熵值来衡量模型的灵敏度\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"设置熵的计算函数-calculate_entropy\"><a class=\"markdownIt-Anchor\" href=\"#设置熵的计算函数-calculate_entropy\">#</a> 设置熵的计算函数 calculate_entropy</h4>\n<pre><code>input: list\nouput :总熵\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">calculate_entropy</span>(<span class=\"params\">lst</span>):</span><br><span class=\"line\">    value_counts = np.unique(lst, return_counts=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    values, counts = value_counts</span><br><span class=\"line\">    total_count = <span class=\"built_in\">len</span>(lst)</span><br><span class=\"line\">    probabilities = counts / total_count</span><br><span class=\"line\">    entropy = -np.<span class=\"built_in\">sum</span>(probabilities * np.log2(probabilities))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> entropy</span><br></pre></td></tr></table></figure>\n<h4 id=\"设置基于属性变化率的计算函数-average_change_rate\"><a class=\"markdownIt-Anchor\" href=\"#设置基于属性变化率的计算函数-average_change_rate\">#</a> 设置基于属性变化率的计算函数 average_change_rate</h4>\n<pre><code>input:list\noutput: 平均相邻变化率\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">average_change_rate</span>(<span class=\"params\">lst</span>):</span><br><span class=\"line\">    <span class=\"comment\"># 检查列表是否至少有两项</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(lst) &lt; <span class=\"number\">2</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">None</span></span><br><span class=\"line\">    change_rates = [(lst[i+<span class=\"number\">1</span>] - lst[i]) / lst[i] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(lst) - <span class=\"number\">1</span>)]</span><br><span class=\"line\">    avg_change_rate = <span class=\"built_in\">sum</span>(change_rates) / <span class=\"built_in\">len</span>(change_rates)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> avg_change_rate</span><br></pre></td></tr></table></figure>\n<h4 id=\"启动基于熵值的灵敏度计算\"><a class=\"markdownIt-Anchor\" href=\"#启动基于熵值的灵敏度计算\">#</a> 启动基于熵值的灵敏度计算</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\">models = [<span class=\"string\">&#x27;linear.pkl&#x27;</span>,<span class=\"string\">&#x27;gb_tree.pkl&#x27;</span>,<span class=\"string\">&#x27;ju_tree.pkl&#x27;</span>,<span class=\"string\">&#x27;rf_forest.pkl&#x27;</span>]</span><br><span class=\"line\">path=<span class=\"string\">&#x27;../Model&#x27;</span></span><br><span class=\"line\">m_path=<span class=\"string\">&#x27;../Model/3_means&#x27;</span></span><br><span class=\"line\">entropy_list=[]</span><br><span class=\"line\"><span class=\"keyword\">for</span> model <span class=\"keyword\">in</span> models:</span><br><span class=\"line\">    model_copy=model</span><br><span class=\"line\">    train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">    train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">    train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">    X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">    model_name=model.replace(<span class=\"string\">&#x27;.pkl&#x27;</span>,<span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;当前模型为<span class=\"subst\">&#123;model&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    <span class=\"comment\"># 读入模型</span></span><br><span class=\"line\">    model_path=os.path.join(path,model)</span><br><span class=\"line\">    model = joblib.load(model_path)</span><br><span class=\"line\">    av_list=[]</span><br><span class=\"line\">    <span class=\"comment\"># 计算不同模型的变化率</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> each_column <span class=\"keyword\">in</span> X.columns: </span><br><span class=\"line\">        temp_X=pd.DataFrame(columns=X.columns)</span><br><span class=\"line\">        target=np.array(X[each_column])</span><br><span class=\"line\">        <span class=\"built_in\">min</span>=np.<span class=\"built_in\">min</span>(target)</span><br><span class=\"line\">        <span class=\"built_in\">max</span>=np.<span class=\"built_in\">max</span>(target)</span><br><span class=\"line\">        column_list=[]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">min</span>,<span class=\"built_in\">max</span>+<span class=\"number\">1</span>):</span><br><span class=\"line\">            temp_X_copy=X</span><br><span class=\"line\">            temp_X_copy[each_column]=i</span><br><span class=\"line\">            y_pred=model.predict(temp_X_copy)</span><br><span class=\"line\">            column_list.append(y_pred.mean())</span><br><span class=\"line\">        av_list.append(average_change_rate(column_list))</span><br><span class=\"line\">    df = pd.DataFrame(&#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;属性&#x27;</span>: X.columns,</span><br><span class=\"line\">    <span class=\"string\">&#x27;变化率&#x27;</span>: av_list</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    df.plot(kind=<span class=\"string\">&#x27;bar&#x27;</span>, x=<span class=\"string\">&#x27;属性&#x27;</span>, y=<span class=\"string\">&#x27;变化率&#x27;</span>)</span><br><span class=\"line\">    plt.title(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;model_name&#125;</span>属性平均变化率&#x27;</span>)</span><br><span class=\"line\">    plt.xlabel(<span class=\"string\">&#x27;属性&#x27;</span>)</span><br><span class=\"line\">    plt.ylabel(<span class=\"string\">&#x27;变化率&#x27;</span>)</span><br><span class=\"line\">    plt.show()</span><br><span class=\"line\">    model_path=os.path.join(m_path,model_copy)</span><br><span class=\"line\">    model = joblib.load(model_path)</span><br><span class=\"line\">    train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">    train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">    train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">    X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">    train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">    temp_X=X</span><br><span class=\"line\">    y_pred=model.predict(X)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(y_pred)</span><br><span class=\"line\">    temp_X[<span class=\"string\">&#x27;洪水概率&#x27;</span>]=y_pred</span><br><span class=\"line\">    temp_X[<span class=\"string\">&#x27;id&#x27;</span>]=train_data[<span class=\"string\">&#x27;id&#x27;</span>]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">3</span>):    </span><br><span class=\"line\">        temp=temp_X[temp_X[<span class=\"string\">&#x27;洪水概率&#x27;</span>]==i]</span><br><span class=\"line\">        temp[<span class=\"string\">&#x27;洪水概率&#x27;</span>]=dic[<span class=\"string\">f&#x27;[<span class=\"subst\">&#123;i&#125;</span>]&#x27;</span>]</span><br><span class=\"line\">        name=dic[<span class=\"string\">f&#x27;[<span class=\"subst\">&#123;i&#125;</span>]&#x27;</span>]</span><br><span class=\"line\">        csv_path=<span class=\"string\">&#x27;../Data/3_means/&#x27;</span></span><br><span class=\"line\">        temp.to_csv(csv_path+<span class=\"string\">f&#x27;<span class=\"subst\">&#123;model_name&#125;</span>&#x27;</span>+<span class=\"string\">&#x27;/&#x27;</span>+<span class=\"string\">f&#x27;<span class=\"subst\">&#123;name&#125;</span>.csv&#x27;</span>,index=<span class=\"literal\">False</span>,encoding=<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">    entropy_list.append(calculate_entropy(y_pred))</span><br><span class=\"line\">df = pd.DataFrame(&#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;模型&#x27;</span>: [<span class=\"string\">&#x27;线性回归&#x27;</span>,<span class=\"string\">&#x27;梯度提升树&#x27;</span>,<span class=\"string\">&#x27;决策树&#x27;</span>,<span class=\"string\">&#x27;随机森林&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;熵值&#x27;</span>: entropy_list</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">df.plot(kind=<span class=\"string\">&#x27;bar&#x27;</span>, x=<span class=\"string\">&#x27;模型&#x27;</span>, y=<span class=\"string\">&#x27;熵值&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">f&#x27;不同模型的灵敏度&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;模型&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;熵值&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">当前模型为<span class=\"built_in\">linear</span>.pkl</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight tap\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[2<span class=\"number\"> 2 </span>2 ...<span class=\"number\"> 2 </span>2 0]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Users\\<span class=\"number\">12780</span>\\AppData\\Local\\Temp\\ipykernel_28736\\<span class=\"number\">2860376030</span>.<span class=\"keyword\">py</span>:<span class=\"number\">54</span>: SettingWithCopyWarning: </span><br><span class=\"line\">A value <span class=\"keyword\">is</span> trying <span class=\"keyword\">to</span> <span class=\"keyword\">be</span> <span class=\"keyword\">set</span> <span class=\"keyword\">on</span> <span class=\"keyword\">a</span> <span class=\"keyword\">copy</span> of <span class=\"keyword\">a</span> slice from <span class=\"keyword\">a</span> DataFrame.</span><br><span class=\"line\">Try using .<span class=\"keyword\">loc</span>[row_indexer,col_indexer] = value instead</span><br><span class=\"line\"></span><br><span class=\"line\">See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-<span class=\"keyword\">a</span>-<span class=\"keyword\">view</span>-versus-<span class=\"keyword\">a</span>-<span class=\"keyword\">copy</span></span><br><span class=\"line\">  temp[<span class=\"string\">&#x27;洪水概率&#x27;</span>]=dic[<span class=\"keyword\">f</span><span class=\"string\">&#x27;[&#123;i&#125;]&#x27;</span>]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">当前模型为gb_tree<span class=\"selector-class\">.pkl</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight tap\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[1<span class=\"number\"> 1 </span>2 ...<span class=\"number\"> 2 </span>2 0]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Users\\<span class=\"number\">12780</span>\\AppData\\Local\\Temp\\ipykernel_28736\\<span class=\"number\">2860376030</span>.<span class=\"keyword\">py</span>:<span class=\"number\">54</span>: SettingWithCopyWarning: </span><br><span class=\"line\">A value <span class=\"keyword\">is</span> trying <span class=\"keyword\">to</span> <span class=\"keyword\">be</span> <span class=\"keyword\">set</span> <span class=\"keyword\">on</span> <span class=\"keyword\">a</span> <span class=\"keyword\">copy</span> of <span class=\"keyword\">a</span> slice from <span class=\"keyword\">a</span> DataFrame.</span><br><span class=\"line\">Try using .<span class=\"keyword\">loc</span>[row_indexer,col_indexer] = value instead</span><br><span class=\"line\"></span><br><span class=\"line\">See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-<span class=\"keyword\">a</span>-<span class=\"keyword\">view</span>-versus-<span class=\"keyword\">a</span>-<span class=\"keyword\">copy</span></span><br><span class=\"line\">  temp[<span class=\"string\">&#x27;洪水概率&#x27;</span>]=dic[<span class=\"keyword\">f</span><span class=\"string\">&#x27;[&#123;i&#125;]&#x27;</span>]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight mipsasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">当前模型为<span class=\"keyword\">ju_tree.pkl</span></span><br><span class=\"line\"><span class=\"keyword\"></span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight tap\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[2<span class=\"number\"> 1 </span>2 ...<span class=\"number\"> 1 </span>1 2]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Users\\<span class=\"number\">12780</span>\\AppData\\Local\\Temp\\ipykernel_28736\\<span class=\"number\">2860376030</span>.<span class=\"keyword\">py</span>:<span class=\"number\">54</span>: SettingWithCopyWarning: </span><br><span class=\"line\">A value <span class=\"keyword\">is</span> trying <span class=\"keyword\">to</span> <span class=\"keyword\">be</span> <span class=\"keyword\">set</span> <span class=\"keyword\">on</span> <span class=\"keyword\">a</span> <span class=\"keyword\">copy</span> of <span class=\"keyword\">a</span> slice from <span class=\"keyword\">a</span> DataFrame.</span><br><span class=\"line\">Try using .<span class=\"keyword\">loc</span>[row_indexer,col_indexer] = value instead</span><br><span class=\"line\"></span><br><span class=\"line\">See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-<span class=\"keyword\">a</span>-<span class=\"keyword\">view</span>-versus-<span class=\"keyword\">a</span>-<span class=\"keyword\">copy</span></span><br><span class=\"line\">  temp[<span class=\"string\">&#x27;洪水概率&#x27;</span>]=dic[<span class=\"keyword\">f</span><span class=\"string\">&#x27;[&#123;i&#125;]&#x27;</span>]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">当前模型为rf_forest<span class=\"selector-class\">.pkl</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight tap\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[2<span class=\"number\"> 1 </span>2 ...<span class=\"number\"> 2 </span>1 2]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Users\\<span class=\"number\">12780</span>\\AppData\\Local\\Temp\\ipykernel_28736\\<span class=\"number\">2860376030</span>.<span class=\"keyword\">py</span>:<span class=\"number\">54</span>: SettingWithCopyWarning: </span><br><span class=\"line\">A value <span class=\"keyword\">is</span> trying <span class=\"keyword\">to</span> <span class=\"keyword\">be</span> <span class=\"keyword\">set</span> <span class=\"keyword\">on</span> <span class=\"keyword\">a</span> <span class=\"keyword\">copy</span> of <span class=\"keyword\">a</span> slice from <span class=\"keyword\">a</span> DataFrame.</span><br><span class=\"line\">Try using .<span class=\"keyword\">loc</span>[row_indexer,col_indexer] = value instead</span><br><span class=\"line\"></span><br><span class=\"line\">See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-<span class=\"keyword\">a</span>-<span class=\"keyword\">view</span>-versus-<span class=\"keyword\">a</span>-<span class=\"keyword\">copy</span></span><br><span class=\"line\">  temp[<span class=\"string\">&#x27;洪水概率&#x27;</span>]=dic[<span class=\"keyword\">f</span><span class=\"string\">&#x27;[&#123;i&#125;]&#x27;</span>]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"problem-three-从不同指标集建立洪水的预测模型\"><a class=\"markdownIt-Anchor\" href=\"#problem-three-从不同指标集建立洪水的预测模型\">#</a> Problem THREE 从不同指标集建立洪水的预测模型</h2>\n<h3 id=\"利用半指标集重新训练模型\"><a class=\"markdownIt-Anchor\" href=\"#利用半指标集重新训练模型\">#</a> 利用半指标集重新训练模型</h3>\n<h4 id=\"数据读入与划分\"><a class=\"markdownIt-Anchor\" href=\"#数据读入与划分\">#</a> 数据读入与划分</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\">X=X[ten_columns]</span><br><span class=\"line\">y=train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">y=np.array(y)</span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"多元线性回归\"><a class=\"markdownIt-Anchor\" href=\"#多元线性回归\">#</a> 多元线性回归</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\">model_line=LinearRegression()</span><br><span class=\"line\">model_line.fit(X_train,y_train)</span><br><span class=\"line\">y_pred = model_line.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = model_line.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;模型的系数为: <span class=\"subst\">&#123;model_line.coef_&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;模型的截距为: <span class=\"subst\">&#123;model_line.intercept_&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\">joblib.dump(model_line,<span class=\"string\">&#x27;../Model/min20/linear.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Model score: <span class=\"number\">0</span>.<span class=\"number\">3797909073877743</span></span><br><span class=\"line\">均方误差为: <span class=\"number\">0</span>.<span class=\"number\">0016121225286413457</span></span><br><span class=\"line\">模型的系数为: [<span class=\"number\">0.00502906</span> <span class=\"number\">0.00505761</span> <span class=\"number\">0.00500356</span> <span class=\"number\">0.00496802</span> <span class=\"number\">0.00499052</span> <span class=\"number\">0.00504195</span></span><br><span class=\"line\"> <span class=\"number\">0.00501869</span> <span class=\"number\">0.00496276</span> <span class=\"number\">0.00495814</span> <span class=\"number\">0.00499007</span>]</span><br><span class=\"line\">模型的截距为: <span class=\"number\">0</span>.<span class=\"number\">2576458803465974</span></span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">9968581620856443</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h4 id=\"梯度提升树\"><a class=\"markdownIt-Anchor\" href=\"#梯度提升树\">#</a> 梯度提升树</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> GradientBoostingRegressor</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> plot_tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\">n_estimators = <span class=\"number\">1000</span></span><br><span class=\"line\">gb_model = GradientBoostingRegressor(n_estimators=n_estimators, random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">cv_scores = cross_val_score(gb_model, X_train, y_train, cv=<span class=\"number\">5</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;每折交叉验证的评分:&quot;</span>, cv_scores)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;交叉验证评分的平均值:&quot;</span>, np.mean(cv_scores))</span><br><span class=\"line\">gb_model.fit(X_train, y_train)</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上评估模型性能</span></span><br><span class=\"line\">gb_score  = gb_model.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model Score : <span class=\"subst\">&#123;gb_score&#125;</span>&#x27;</span>)</span><br><span class=\"line\">feature_importances = gb_model.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 计算每轮迭代的损失值</span></span><br><span class=\"line\">train_loss = np.zeros((gb_model.n_estimators,), dtype=np.float64)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, y_pred <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(gb_model.staged_predict(X_train)):</span><br><span class=\"line\">    train_loss[i] = mean_squared_error(y_train, y_pred)</span><br><span class=\"line\"></span><br><span class=\"line\">test_loss = np.zeros((gb_model.n_estimators,), dtype=np.float64)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, y_pred <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(gb_model.staged_predict(X_test)):</span><br><span class=\"line\">    test_loss[i] = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上进行预测</span></span><br><span class=\"line\">y_pred = gb_model.predict(X_test)</span><br><span class=\"line\">theta = cosine(y_pred,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;theta&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 计算均方误差</span></span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差为<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 绘制损失曲线</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(np.arange(<span class=\"number\">1</span>, gb_model.n_estimators + <span class=\"number\">1</span>), train_loss, label=<span class=\"string\">&#x27;Training Loss&#x27;</span>)</span><br><span class=\"line\">plt.plot(np.arange(<span class=\"number\">1</span>, gb_model.n_estimators + <span class=\"number\">1</span>), test_loss, label=<span class=\"string\">&#x27;Test Loss&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Number of Iterations&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Mean Squared Error&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Training and Test Loss&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"><span class=\"comment\"># 可视化特征重要性</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances)), feature_importances, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X_train.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\">joblib.dump(gb_model,<span class=\"string\">&#x27;../Model/min20/gb_tree.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">每折交叉验证的评分: [<span class=\"number\">0.38422655</span> <span class=\"number\">0.38220555</span> <span class=\"number\">0.38382033</span> <span class=\"number\">0.38356502</span> <span class=\"number\">0.38412738</span>]</span><br><span class=\"line\">交叉验证评分的平均值: <span class=\"number\">0</span>.<span class=\"number\">38358896650341584</span></span><br><span class=\"line\">Model Score : <span class=\"number\">0</span>.<span class=\"number\">38390663962200555</span></span><br><span class=\"line\">特征重要性: [<span class=\"number\">0.10205675</span> <span class=\"number\">0.10034733</span> <span class=\"number\">0.10139756</span> <span class=\"number\">0.1018449</span>  <span class=\"number\">0.10108517</span> <span class=\"number\">0.10034581</span></span><br><span class=\"line\"> <span class=\"number\">0.10023741</span> <span class=\"number\">0.0967709</span>  <span class=\"number\">0.09875688</span> <span class=\"number\">0.0971573</span> ]</span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">9968790479654901</span></span><br><span class=\"line\">均方误差为<span class=\"number\">0</span>.<span class=\"number\">0016014244193493427</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h4 id=\"决策树\"><a class=\"markdownIt-Anchor\" href=\"#决策树\">#</a> 决策树</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> plot_tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\">tree_model = DecisionTreeRegressor(random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">cv_scores = cross_val_score(tree_model, X_train, y_train, cv=<span class=\"number\">5</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;每折交叉验证的评分:&quot;</span>, cv_scores)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;交叉验证评分的平均值:&quot;</span>, np.mean(cv_scores))</span><br><span class=\"line\">tree_model.fit(X_train, y_train)</span><br><span class=\"line\">tree_score = tree_model.score(X_test, y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;Model Score :&quot;</span>, tree_score)</span><br><span class=\"line\">feature_importances = tree_model.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\">feature_importances_flat = np.ravel(feature_importances)</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances_flat)), feature_importances_flat, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X_train.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances_flat))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\">y_pred = tree_model.predict(X_test)</span><br><span class=\"line\">theta = cosine(y_pred,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;theta&#125;</span>&#x27;</span>)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差为<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br><span class=\"line\">joblib.dump(tree_model,<span class=\"string\">&#x27;../Model/min20/ju_tree.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">每折交叉验证的评分: [-<span class=\"number\">0.38044123</span> -<span class=\"number\">0.37039988</span> -<span class=\"number\">0.37308455</span> -<span class=\"number\">0.37506536</span> -<span class=\"number\">0.37448948</span>]</span><br><span class=\"line\">交叉验证评分的平均值: -<span class=\"number\">0</span>.<span class=\"number\">37469609875144927</span></span><br><span class=\"line\">Model Score : -<span class=\"number\">0</span>.<span class=\"number\">3724991072858381</span></span><br><span class=\"line\">特征重要性: [<span class=\"number\">0.10005281</span> <span class=\"number\">0.09983183</span> <span class=\"number\">0.09977541</span> <span class=\"number\">0.09885637</span> <span class=\"number\">0.09927343</span> <span class=\"number\">0.10018744</span></span><br><span class=\"line\"> <span class=\"number\">0.10027551</span> <span class=\"number\">0.10119409</span> <span class=\"number\">0.1001009</span>  <span class=\"number\">0.1004522</span> ]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">余弦相似度为0.9930576700128282</span><br><span class=\"line\">均方误差为0.003567565773788236</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>随机森林</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rf = RandomForestRegressor(n_estimators=<span class=\"number\">200</span>, random_state=<span class=\"number\">42</span>)  <span class=\"comment\"># 使用100棵树</span></span><br><span class=\"line\">rf.fit(X_train, y_train)</span><br><span class=\"line\">y_pred = rf.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = rf.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;准确率:&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(r2_score(y_test, y_pred))</span><br><span class=\"line\">feature_importances = rf.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\">feature_importances_flat = np.ravel(feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 可视化特征重要性</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances_flat)), feature_importances_flat, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X_train.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances_flat))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"><span class=\"keyword\">import</span> joblib</span><br><span class=\"line\">joblib.dump(rf,<span class=\"string\">&#x27;../Model/min20/rf_forest.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Model score: <span class=\"number\">0</span>.<span class=\"number\">34325879744154253</span></span><br><span class=\"line\">均方误差为: <span class=\"number\">0</span>.<span class=\"number\">001707081209777524</span></span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">996672979089785</span></span><br><span class=\"line\">准确率:</span><br><span class=\"line\"><span class=\"number\">0</span>.<span class=\"number\">34325879744154253</span></span><br><span class=\"line\">特征重要性: [<span class=\"number\">0.09920083</span> <span class=\"number\">0.09998751</span> <span class=\"number\">0.09940968</span> <span class=\"number\">0.09865654</span> <span class=\"number\">0.09964584</span> <span class=\"number\">0.10035755</span></span><br><span class=\"line\"> <span class=\"number\">0.09983987</span> <span class=\"number\">0.10085278</span> <span class=\"number\">0.1012155</span>  <span class=\"number\">0.10083389</span>]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"利用核心指标集重新训练模型\"><a class=\"markdownIt-Anchor\" href=\"#利用核心指标集重新训练模型\">#</a> 利用核心指标集重新训练模型</h3>\n<h4 id=\"数据读入-3\"><a class=\"markdownIt-Anchor\" href=\"#数据读入-3\">#</a> 数据读入</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">train_data_path=<span class=\"string\">&#x27;../Data/train.csv&#x27;</span></span><br><span class=\"line\">train_data = pd.read_csv(train_data_path)</span><br><span class=\"line\">train_data = train_data.drop(columns=<span class=\"string\">&#x27;id&#x27;</span>)</span><br><span class=\"line\">X=train_data.drop(columns=<span class=\"string\">&#x27;洪水概率&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 在这里进行数据指标的选择</span></span><br><span class=\"line\">X=X[five_columns]</span><br><span class=\"line\">y=train_data[<span class=\"string\">&#x27;洪水概率&#x27;</span>]</span><br><span class=\"line\">y=np.array(y)</span><br><span class=\"line\"><span class=\"comment\">#y=-np.log(1/y-1)</span></span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">42</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"多元线性回归-2\"><a class=\"markdownIt-Anchor\" href=\"#多元线性回归-2\">#</a> 多元线性回归</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\">model_line=LinearRegression()</span><br><span class=\"line\">model_line.fit(X_train,y_train)</span><br><span class=\"line\">y_pred = model_line.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = model_line.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;模型的系数为: <span class=\"subst\">&#123;model_line.coef_&#125;</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;模型的截距为: <span class=\"subst\">&#123;model_line.intercept_&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\">joblib.dump(model_line,<span class=\"string\">&#x27;../Model/5features/linear.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Model score: <span class=\"number\">0</span>.<span class=\"number\">1835669186041815</span></span><br><span class=\"line\">均方误差为: <span class=\"number\">0</span>.<span class=\"number\">002122171666498279</span></span><br><span class=\"line\">模型的系数为: [<span class=\"number\">0.00485089</span> <span class=\"number\">0.00484171</span> <span class=\"number\">0.00476767</span> <span class=\"number\">0.00471688</span> <span class=\"number\">0.00477062</span>]</span><br><span class=\"line\">模型的截距为: <span class=\"number\">0</span>.<span class=\"number\">3862570525392469</span></span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">9958620768117359</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h4 id=\"梯度提升树-2\"><a class=\"markdownIt-Anchor\" href=\"#梯度提升树-2\">#</a> 梯度提升树</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> GradientBoostingRegressor</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> plot_tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\"><span class=\"comment\"># 设置迭代次数为100</span></span><br><span class=\"line\">n_estimators = <span class=\"number\">1000</span></span><br><span class=\"line\"><span class=\"comment\"># 创建并训练梯度提升树回归模型</span></span><br><span class=\"line\">gb_model = GradientBoostingRegressor(n_estimators=n_estimators, random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\">gb_model.fit(X_train, y_train)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 在测试集上评估模型性能</span></span><br><span class=\"line\">gb_score  = gb_model.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model Score : <span class=\"subst\">&#123;gb_score&#125;</span>&#x27;</span>)</span><br><span class=\"line\">feature_importances = gb_model.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 计算每轮迭代的损失值</span></span><br><span class=\"line\">train_loss = np.zeros((gb_model.n_estimators,), dtype=np.float64)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, y_pred <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(gb_model.staged_predict(X_train)):</span><br><span class=\"line\">    train_loss[i] = mean_squared_error(y_train, y_pred)</span><br><span class=\"line\"></span><br><span class=\"line\">test_loss = np.zeros((gb_model.n_estimators,), dtype=np.float64)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, y_pred <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(gb_model.staged_predict(X_test)):</span><br><span class=\"line\">    test_loss[i] = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上进行预测</span></span><br><span class=\"line\">y_pred = gb_model.predict(X_test)</span><br><span class=\"line\">theta = cosine(y_pred,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;theta&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 计算均方误差</span></span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差为<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 绘制损失曲线</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(np.arange(<span class=\"number\">1</span>, gb_model.n_estimators + <span class=\"number\">1</span>), train_loss, label=<span class=\"string\">&#x27;Training Loss&#x27;</span>)</span><br><span class=\"line\">plt.plot(np.arange(<span class=\"number\">1</span>, gb_model.n_estimators + <span class=\"number\">1</span>), test_loss, label=<span class=\"string\">&#x27;Test Loss&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Number of Iterations&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Mean Squared Error&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Training and Test Loss&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\">joblib.dump(gb_model,<span class=\"string\">&#x27;../Model/5features/gb_tree.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Model Score : <span class=\"number\">0</span>.<span class=\"number\">18706274403216527</span></span><br><span class=\"line\">特征重要性: [<span class=\"number\">0.20230352</span> <span class=\"number\">0.19922658</span> <span class=\"number\">0.19952716</span> <span class=\"number\">0.20019026</span> <span class=\"number\">0.19875248</span>]</span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">9958798307923142</span></span><br><span class=\"line\">均方误差为<span class=\"number\">0</span>.<span class=\"number\">0021130848939956166</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h4 id=\"决策树-2\"><a class=\"markdownIt-Anchor\" href=\"#决策树-2\">#</a> 决策树</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> plot_tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> mean_squared_error</span><br><span class=\"line\"><span class=\"comment\"># 创建并训练决策树回归模型</span></span><br><span class=\"line\">tree_model = DecisionTreeRegressor(random_state=<span class=\"number\">42</span>)</span><br><span class=\"line\"><span class=\"comment\"># 执行 K 折交叉验证</span></span><br><span class=\"line\">cv_scores = cross_val_score(tree_model, X_train, y_train, cv=<span class=\"number\">5</span>)</span><br><span class=\"line\"><span class=\"comment\"># 输出每折交叉验证的评分</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;每折交叉验证的评分:&quot;</span>, cv_scores)</span><br><span class=\"line\"><span class=\"comment\"># 输出交叉验证评分的平均值</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;交叉验证评分的平均值:&quot;</span>, np.mean(cv_scores))</span><br><span class=\"line\">tree_model.fit(X_train, y_train)</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上评估模型性能</span></span><br><span class=\"line\">tree_score = tree_model.score(X_test, y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;Model Score :&quot;</span>, tree_score)</span><br><span class=\"line\"><span class=\"comment\"># 输出特征重要性</span></span><br><span class=\"line\">feature_importances = tree_model.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 将特征重要性展平</span></span><br><span class=\"line\">feature_importances_flat = np.ravel(feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 可视化特征重要性</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances_flat)), feature_importances_flat, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances_flat))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"><span class=\"comment\"># 在测试集上进行预测</span></span><br><span class=\"line\">y_pred = tree_model.predict(X_test)</span><br><span class=\"line\">theta = cosine(y_pred,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;theta&#125;</span>&#x27;</span>)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;均方误差为<span class=\"subst\">&#123;mse&#125;</span>&#x27;</span>)</span><br><span class=\"line\">joblib.dump(tree_model,<span class=\"string\">&#x27;../Model/5features/ju_tree.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">每折交叉验证的评分: [<span class=\"number\">0.04361354</span> <span class=\"number\">0.04034011</span> <span class=\"number\">0.04317059</span> <span class=\"number\">0.04289384</span> <span class=\"number\">0.04444733</span>]</span><br><span class=\"line\">交叉验证评分的平均值: <span class=\"number\">0</span>.<span class=\"number\">04289308234438856</span></span><br><span class=\"line\">Model Score : <span class=\"number\">0</span>.<span class=\"number\">06096464073076868</span></span><br><span class=\"line\">特征重要性: [<span class=\"number\">0.19962294</span> <span class=\"number\">0.19925044</span> <span class=\"number\">0.20269697</span> <span class=\"number\">0.19846155</span> <span class=\"number\">0.1999681</span> ]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">余弦相似度为0.9952401471395698</span><br><span class=\"line\">均方误差为0.002440854343964364</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h4 id=\"随机森林\"><a class=\"markdownIt-Anchor\" href=\"#随机森林\">#</a> 随机森林</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rf = RandomForestRegressor(n_estimators=<span class=\"number\">200</span>, random_state=<span class=\"number\">42</span>)  <span class=\"comment\"># 使用100棵树</span></span><br><span class=\"line\">rf.fit(X_train, y_train)</span><br><span class=\"line\">y_pred = rf.predict(X_test)</span><br><span class=\"line\">mse = mean_squared_error(y_test, y_pred)</span><br><span class=\"line\">score = rf.score(X_test,y_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Model score: <span class=\"subst\">&#123;score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;均方误差为: <span class=\"subst\">&#123;mse&#125;</span>&quot;</span>)</span><br><span class=\"line\">accuracy = cosine(y_test,y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;余弦相似度为<span class=\"subst\">&#123;accuracy&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;准确率:&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(r2_score(y_test, y_pred))</span><br><span class=\"line\">feature_importances = rf.feature_importances_</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征重要性:&quot;</span>, feature_importances)</span><br><span class=\"line\">feature_importances_flat = np.ravel(feature_importances)</span><br><span class=\"line\"><span class=\"comment\"># 可视化特征重要性</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">30</span>, <span class=\"number\">18</span>))</span><br><span class=\"line\">plt.bar(<span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(feature_importances_flat)), feature_importances_flat, tick_label=[<span class=\"string\">f&#x27;<span class=\"subst\">&#123;X_train.columns[i]&#125;</span>&#x27;</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(feature_importances_flat))])</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Feature&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Importance&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Feature Importance&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"><span class=\"keyword\">import</span> joblib</span><br><span class=\"line\">joblib.dump(rf,<span class=\"string\">&#x27;../Model/5features/rf_forest.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dns\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Model score: <span class=\"number\">0</span>.<span class=\"number\">11505358895416717</span></span><br><span class=\"line\">均方误差为: <span class=\"number\">0</span>.<span class=\"number\">002300259804122661</span></span><br><span class=\"line\">余弦相似度为<span class=\"number\">0</span>.<span class=\"number\">9955143525656249</span></span><br><span class=\"line\">准确率:</span><br><span class=\"line\"><span class=\"number\">0</span>.<span class=\"number\">11505358895416717</span></span><br><span class=\"line\">特征重要性: [<span class=\"number\">0.19860426</span> <span class=\"number\">0.1997008</span>  <span class=\"number\">0.20150083</span> <span class=\"number\">0.20023265</span> <span class=\"number\">0.19996146</span>]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"problem-four-预测洪水发生的概率\"><a class=\"markdownIt-Anchor\" href=\"#problem-four-预测洪水发生的概率\">#</a> Problem FOUR 预测洪水发生的概率</h2>\n<h4 id=\"利用准确率最高的梯度提升树模型进行预测\"><a class=\"markdownIt-Anchor\" href=\"#利用准确率最高的梯度提升树模型进行预测\">#</a> 利用准确率最高的梯度提升树模型进行预测</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data_path = <span class=\"string\">&#x27;../Data/test.csv&#x27;</span></span><br><span class=\"line\">data=pd.read_csv(data_path)</span><br><span class=\"line\">data=data.drop(columns=[<span class=\"string\">&#x27;id&#x27;</span>,<span class=\"string\">&#x27;洪水概率&#x27;</span>])</span><br><span class=\"line\">model_path=<span class=\"string\">&#x27;../Model/gb_tree.pkl&#x27;</span></span><br><span class=\"line\">model=joblib.load(model_path)</span><br><span class=\"line\">y_pred=model.predict(data)</span><br><span class=\"line\">data_path=<span class=\"string\">&#x27;../Data/submit.csv&#x27;</span></span><br><span class=\"line\">df=pd.read_csv(data_path)</span><br><span class=\"line\">df[<span class=\"string\">&#x27;洪水概率&#x27;</span>]=y_pred</span><br><span class=\"line\">df=df[[<span class=\"string\">&#x27;id&#x27;</span>,<span class=\"string\">&#x27;洪水概率&#x27;</span>]]</span><br><span class=\"line\">df.to_csv(<span class=\"string\">&#x27;../Data/submit.csv&#x27;</span>,encoding=<span class=\"string\">&#x27;utf-8&#x27;</span>,index=<span class=\"literal\">False</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"利用直方图与折线图可视化结果\"><a class=\"markdownIt-Anchor\" href=\"#利用直方图与折线图可视化结果\">#</a> 利用直方图与折线图可视化结果</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data=y_pred</span><br><span class=\"line\">data=np.array(data)</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">12</span>, <span class=\"number\">4</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 第一个子图：直方图</span></span><br><span class=\"line\">plt.subplot(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">plt.hist(data, bins=<span class=\"number\">30</span>, alpha=<span class=\"number\">0.5</span>, color=<span class=\"string\">&#x27;blue&#x27;</span>, edgecolor=<span class=\"string\">&#x27;black&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;分布&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Value&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Frequency&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 第二个子图：折线图</span></span><br><span class=\"line\">plt.subplot(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">plt.plot(np.random.choice(data,<span class=\"built_in\">int</span>(<span class=\"number\">0.001</span>*<span class=\"built_in\">len</span>(data))), color=<span class=\"string\">&#x27;red&#x27;</span>, linestyle=<span class=\"string\">&#x27;-&#x27;</span>, marker=<span class=\"string\">&#x27;o&#x27;</span>, markersize=<span class=\"number\">3</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;分布&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Index&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Value&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 显示图表</span></span><br><span class=\"line\">plt.tight_layout()</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<h4 id=\"判别是否服从正态分布\"><a class=\"markdownIt-Anchor\" href=\"#判别是否服从正态分布\">#</a> 判别是否服从正态分布</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> scipy.stats <span class=\"keyword\">as</span> stats</span><br><span class=\"line\">normalized_data = (data - np.mean(data)) / np.std(data)</span><br><span class=\"line\"></span><br><span class=\"line\">ks_stat, ks_p = stats.kstest(normalized_data, <span class=\"string\">&#x27;norm&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;\\nKolmogorov-Smirnov Test:&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;Statistics:&quot;</span>, ks_stat)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;p-value:&quot;</span>, ks_p)</span><br><span class=\"line\"><span class=\"keyword\">if</span> ks_p &lt; <span class=\"number\">0.05</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;不服从正态分布).&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;服从正态分布&quot;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight nestedtext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">Kolmogorov-Smirnov Test</span><span class=\"punctuation\">:</span></span><br><span class=\"line\"><span class=\"attribute\">Statistics</span><span class=\"punctuation\">:</span> <span class=\"string\">0.05078130889692345</span></span><br><span class=\"line\"><span class=\"attribute\">p-value</span><span class=\"punctuation\">:</span> <span class=\"string\">0.0</span></span><br><span class=\"line\">不服从正态分布).</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        },
        {
            "id": "https://enjundu.github.io/bit/%E7%BE%8E%E8%B5%9B%E2%80%94%E2%80%94%E4%B8%83%E9%B3%83%E9%B3%97/",
            "url": "https://enjundu.github.io/bit/%E7%BE%8E%E8%B5%9B%E2%80%94%E2%80%94%E4%B8%83%E9%B3%83%E9%B3%97/",
            "title": "美赛——七鳃鳗",
            "date_published": "2024-07-04T01:41:31.000Z",
            "content_html": "<h1 id=\"mcm-paper\"><a class=\"markdownIt-Anchor\" href=\"#mcm-paper\">#</a> MCM paper</h1>\n<h2 id=\"question\"><a class=\"markdownIt-Anchor\" href=\"#question\">#</a> question</h2>\n<p>​\tWhile some animal species exist outside of the usual male or female sexes, most species are</p>\n<p>substantially either male or female. Although many species exhibit a 1:1 sex ratio at birth, other</p>\n<p>species deviate from an even sex ratio. This is called adaptive sex ratio variation. For example,</p>\n<p>the temperature of the nest incubating eggs of the American alligator influences the sex ratios at</p>\n<p>birth</p>\n<p>​\tThe role of <strong>lampreys</strong> is complex. In some lake habitats, they are seen as parasites with a</p>\n<p>significant impact on the ecosystem, whereas lampreys are also a food source in some regions of</p>\n<p>the world, such as Scandinavia, the Baltics, and for some Indigenous peoples of the Pacific</p>\n<p>Northwest in North America.</p>\n<p>​\tThe sex ratio of sea lampreys can vary based on external circumstances. Sea lampreys become</p>\n<p>male or female depending on how quickly they grow during the larval stage. These larval growth</p>\n<p>rates are influenced by the availability of food. In environments where food availability is low,</p>\n<p>growth rates will be lower, and the percentage of males can reach approximately 78% of the</p>\n<p>population. In environments where food is more readily available, the percentage of males has</p>\n<p>been observed to be approximately 56% of the population.</p>\n<p>​\tWe focus on the question of sex ratios and their dependence on local conditions, specifically for</p>\n<p>sea lampreys. Sea lampreys live in lake or sea habitats and migrate up rivers to spawn. The task</p>\n<p>is to examine the advantages and disadvantages of the ability for a species to alter its sex ratio</p>\n<p>depending on resource availability. Your team should develop and examine a model to provide</p>\n<p>insights into the resulting interactions in an ecosystem.</p>\n<p>Questions to examine include the following:</p>\n<ul>\n<li>\n<p>What is the impact on the larger ecological system when the population of lampreys can</p>\n<p>alter its sex ratio?</p>\n</li>\n<li>\n<p>What are the advantages and disadvantages to the population of lampreys?</p>\n</li>\n<li>\n<p>What is the impact on the stability of the ecosystem given the changes in the sex ratios of</p>\n<p>lampreys?</p>\n</li>\n<li>\n<p>Can an ecosystem with variable sex ratios in the lamprey population offer advantages to</p>\n<p>others in the ecosystem, such as parasites?</p>\n<h2 id=\"paper-begin\"><a class=\"markdownIt-Anchor\" href=\"#paper-begin\">#</a> Paper begin</h2>\n<h3 id=\"summary\"><a class=\"markdownIt-Anchor\" href=\"#summary\">#</a> <strong>Summary</strong></h3>\n<p>In this study, we first innovatively constructed a dynamic simulated ecological environment through the <em><strong>*Netlogo model*</strong></em>, and thoroughly investigated the multifaceted impacts of changes in the sex ratio of seven-gill eels on the entire ecosystem. Then we used a variety of models and methods to synthesize the analysis around research questions I to IV.</p>\n<p>For problem 1: We use analytic Hierarchy Process (AHP) and LA model to quantify the relationship between various factors and study the multi-level impact of sex ratio change on the ecosystem. Through AHP, we derive the weight allocation of the impact of sex ratio changes on the ecosystem, while the LA model optimizes the decision-making process. The results show that changes in <strong>sex ratio significantly affect adaptation</strong>, resource utilization and species diversity, and provide a key ecological balance mechanism for the system.</p>\n<p>For problem 2: Using a comprehensive evaluation method and genetic algorithm, we considered the advantages and disadvantages of the lamprey population in a comprehensive manner. Through the parameter optimization of the genetic algorithm, we gained a deeper understanding of the advantages of the dynamic adjustment of the sex ratio of the lamprey on its own reproductive growth. By cross-corroborating the two models, we conclude that the ecological advantages of dynamically adjusting the sex ratio far outweigh the disadvantages. <strong>The ecological adaptations and advantages demonstrated by lampreys through the flexible adjustment of sex ratios dominate in maintaining ecosystem balance and diversity.</strong></p>\n<p>For problem 3: Using the eigenvalue method of differential equation combined with Jacobian matrix, we deeply discuss the effect of sex ratio change on ecosystem stability. Eigenvalue analysis reveals the key role of sex ratio in maintaining ecosystem stability. Our conclusion emphasizes that the change of sex ratio is an important factor in the dynamic balance of ecosystems and provides scientific basis for ecological conservation and management.</p>\n<p>For problem 4: Using system dynamics and ecosystem interaction models, we comprehensively consider the complex relationships between lampreys and other species. By simulating ecological interactions under different scenarios, <strong>we found that changes in sex ratios have positive effects on other species and maintain the relative balance of the entire ecosystem.</strong></p>\n<p>Sensitivity analysis: We conducted an in-depth sensitivity analysis of all models to verify the reliability of the models in different scenarios. The steps of sensitivity analysis involve a systematic study of changes in the key parameters of each model. In the AHP and LA models, we adjusted the weights and decision parameters and simulated different decision scenarios to assess the sensitivity of the models to changes in the sex ratio. For the comprehensive evaluation method and the genetic algorithm, we vary the operational parameters of the genetic algorithm, such as the crossover rate and the mutation rate, and observe the optimization results of the population under different parameter Settings. In differential equations combined with Jacobian matrix, system dynamics and ecosystem interaction models, we adjusted the key parameters in the equations to evaluate the model’s response to changes in sex ratio by simulating ecological dynamic processes under different conditions. This series of sensitivity analysis helps to identify the key factors affecting the results in each model, and provides strong support for the reliability and robustness of the model.</p>\n<p>Pros and cons evaluation and outlook: All models are comprehensively evaluated, and the advantages and disadvantages of each model are summarized. Despite some simplifications and assumptions, these models provide insights into understanding the combined effects of changes in lampreys’ sex ratios on ecosystems. Looking to the future, the authenticity and reliability of the model can be further improved by introducing more ecological parameters and field observation data to support more accurate ecological management.</p>\n<h4 id=\"keywords\"><a class=\"markdownIt-Anchor\" href=\"#keywords\">#</a> Keywords</h4>\n<p>Lampreys, sex ratio change,Netlogo, Analytic Hierarchy Process, Lotka-Volterra model, Comprehensive evaluation Method, Genetic algorithm, Jacobian Matrix and eigenvalues, System dynamics, ecosystem interaction model</p>\n<p><em><strong>*Contents*</strong></em></p>\n<p><a href=\"#_Toc15523\">1  Introduction\t</a></p>\n<p><a href=\"#_Toc13865\">1.1  Background\t</a></p>\n<p><a href=\"#_Toc16722\">1.2  Problem Restatement and Analysis\t</a></p>\n<p><a href=\"#_Toc32468\">1.3  Overview of our work\t</a></p>\n<p><a href=\"#_Toc5833\">2  Assumptions\t</a></p>\n<p><a href=\"#_Toc21803\">3  List of Notation\t</a></p>\n<p><a href=\"#_Toc24626\">4  Preliminary conclusions obtained by Netlogo simulation\t</a></p>\n<p><a href=\"#_Toc8651\">4.1 Preliminary setting\t</a></p>\n<p><a href=\"#_Toc21863\">4.2 Netlogo solves problem one, two, three, four\t</a></p>\n<p><a href=\"#_Toc12299\">5  Effect of variable sex ratio in lampreys on bigger ecosystem\t</a></p>\n<p><a href=\"#_Toc25511\">5.1  Analytic Hierarchy Process (AHP)\t</a></p>\n<p><a href=\"#_Toc21101\">5.2  Lotka-Volterra model\t</a></p>\n<p><a href=\"#_Toc11452\">5.3  Conclusion\t</a></p>\n<p><a href=\"#_Toc8089\">6 Advantages and disadvantages of variable sex ratio for lampreys populations\t</a></p>\n<p><a href=\"#_Toc8339\">6.1 Integrated assessment method\t</a></p>\n<p><a href=\"#_Toc13350\">6.2  Genetic Algorithm\t</a></p>\n<p><a href=\"#_Toc3157\">6.3  Conclusion\t</a></p>\n<p><a href=\"#_Toc1986\">7  Effects of variable sex ratio of lamprey on ecosystem stability\t</a></p>\n<p><a href=\"#_Toc4989\">7.1  Not considering the prey of lampreys\t</a></p>\n<p><a href=\"#_Toc6259\">7.2  Consider the prey of lampreys\t</a></p>\n<p><a href=\"#_Toc27275\">7.3  Conclusion\t</a></p>\n<p><a href=\"#_Toc1288\">8  Effects of variable sex ratio in lampreys on other species\t</a></p>\n<p><a href=\"#_Toc10293\">8.1  System Dynamics\t</a></p>\n<p><a href=\"#_Toc14325\">8.2  Ecological Interaction Model\t</a></p>\n<p><a href=\"#_Toc26957\">8.3  Conclusion\t</a></p>\n<p><a href=\"#_Toc3631\">9  Sensitivity Analysis\t</a></p>\n<p><a href=\"#_Toc9399\">9.1  AHP sensitivity analysis\t</a></p>\n<p><a href=\"#_Toc452\">9.2 Lotka-Volterra sensitivity analysis\t</a></p>\n<p><a href=\"#_Toc14368\">9.3  Comprehensive assessment sensitivity analysis\t</a></p>\n<p><a href=\"#_Toc24121\">9.4  Sensitivity analysis of genetic algorithm\t</a></p>\n<p><a href=\"#_Toc15186\">9.5 Sensitivity testing of eigenvalue models using differential equations\t</a></p>\n<p><a href=\"#_Toc29957\">9.6  Sensitivity analysis of system dynamics\t</a></p>\n<p><a href=\"#_Toc22371\">9.7 Sensitivity analysis of ecological interactions model\t</a></p>\n<p><a href=\"#_Toc14997\">10  Model Evaluation and Further Discussion\t</a></p>\n<p><a href=\"#_Toc2058\">10.1  Question One\t</a></p>\n<p><a href=\"#_Toc14527\">10.2  Question Two\t</a></p>\n<p><a href=\"#_Toc8408\">10.3  Question Three\t</a></p>\n<p><a href=\"#_Toc27028\">10.4  Question Four\t</a></p>\n<p><a href=\"#_Toc32058\">11 Reference\t</a></p>\n<h1 id=\"1-introduction\"><a class=\"markdownIt-Anchor\" href=\"#1-introduction\">#</a> <strong>1  Introduction</strong></h1>\n<h2 id=\"11-background\"><a class=\"markdownIt-Anchor\" href=\"#11-background\">#</a> <strong>1.1  Background</strong></h2>\n<p><em><strong>*Sea lampreys*</strong></em> live in lake or sea habitats and migrate up rivers to spawn, which have unique position in the study of biology and ecology. Both predatory and parasitic relationships.</p>\n<p>One of the most striking features for lampreys is that their sex can vary according to resource availability. In environments where food is plentiful and growing conditions are favorable, larvae are more likely to develop into larger females, while in environments where resources are scarce, larvae tend to develop into smaller males.This mechanism of sex change may be an adaptive evolutionary strategy that allows the lampreys to adjust its sex ratio to environmental conditions to optimize reproductive success and resource use efficiency.</p>\n<p>The task focus the sex ratios of sea lampreys under resource availability can provide insights into biological adaptation, sex determination, and ecosystem management.</p>\n<h2 id=\"12-problem-restatement-and-analysis\"><a class=\"markdownIt-Anchor\" href=\"#12-problem-restatement-and-analysis\">#</a> <strong>1.2  Problem Restatement and Analysis</strong></h2>\n<p><em><strong>*Problem One:*</strong></em> What are the overall effects of adjusting the sex ratio of lampreys populations on the entire ecosystem? This requires us to explore how changes in sex ratios shape the ecological role of lampreys in the wider ecosystem, and to fully understand ecosystem interrelationships through modeling and analysis.</p>\n<p><em><strong>*Problem Two:*</strong></em> What are the advantages and disadvantages of the changing sex ratio for Lampreys? This requires a systematic assessment of the effects of sex ratio adjustment, including advantages such as adaptation, population control and genetic diversity, as well as disadvantages such as fluctuations in reproductive rate and competition for resources.</p>\n<p><em><strong>*Problem Three:*</strong></em> How do changes in the sex ratio collectively affect the stability of the entire ecosystem? Differential equations and Jacobian matrices can be used to explore the effects of sex ratio changes on ecosystem stability, especially when considering factors such as parasites.</p>\n<p><em><strong>*Problem Four:*</strong></em> Do lamprey ecosystems with changing sex ratios have an overall advantage over other species, such as parasites? System dynamics and ecological interaction models can be used to further study the combined effects of sex ratio changes on other species, including advantages in terms of stability, adaptation and niche differentiation.</p>\n<h2 id=\"13-overview-of-our-work\"><a class=\"markdownIt-Anchor\" href=\"#13-overview-of-our-work\">#</a> <strong>1.3  Overview of our work</strong></h2>\n<p>To avoid complicated description, intuitively reflect our work process, the flow chart is show as the following figure:</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/RvtpDkwnb6fghdl.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture 1 Our working flow chart*</strong></em></p>\n<h1 id=\"2-assumptions\"><a class=\"markdownIt-Anchor\" href=\"#2-assumptions\">#</a> <strong>2  Assumptions</strong></h1>\n<p><em><strong>*Assumption 1*</strong></em>: The growth of the lamprey population approximately follows the Logistic model, with a maximum number allowed by environmental conditions, i.e., the carrying capacity K. The environmental resistance to the lamprey population increases proportionally with population density.</p>\n<p><em><strong>*Assumption 2*</strong></em>: We only consider parasitic marine lampreys, whose juvenile lampreys feed on plankton and are preyed upon by fish and birds, and adults parasitize large fish, with parasitism actions reducing the survival and reproductive capabilities of the host fish.</p>\n<p><em><strong>*Assumption 3*</strong></em>: The sex of lampreys is directly influenced by the amount of food resources acquired during the larval stage in a linear manner.</p>\n<p><em><strong>*Assumption 4*</strong></em>: It is assumed that the number of male lampreys always exceeds that of female lampreys in the natural environment, and the birth rate is proportionally related to the female sex ratio. <em><strong>*Justification*</strong></em>: The data shows that the sex ratio of adult lamprey populations almost always has more males than females. Hadisty and Potter (1971) found that this ratio varies from nearly equal to males nearly five times that of females. Knowing that both male and female lampreys die immediately after mating and spawning, it suggests that lampreys mate only once in their lifetime. The higher the female ratio, the higher the birth rate.</p>\n<h1 id=\"3-list-of-notation\"><a class=\"markdownIt-Anchor\" href=\"#3-list-of-notation\">#</a> <strong>3  List of Notation</strong></h1>\n<p><strong>Table 1: Notations used in this paper</strong></p>\n<table>\n<thead>\n<tr>\n<th><em><strong>*Symbol*</strong></em></th>\n<th><em><strong>*Description*</strong></em></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>A</td>\n<td>large ecosystem</td>\n<td></td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps1.jpg)</td>\n<td>Ecological balance, biodiversity, energy flow</td>\n<td></td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps2.jpg)</td>\n<td>Population characteristics of lampreys</td>\n<td></td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps3.jpg)</td>\n<td>Ecosystem impact factors</td>\n<td></td>\n</tr>\n<tr>\n<td>W</td>\n<td>Composite for initial evaluation of question two_ Indicator</td>\n<td></td>\n</tr>\n<tr>\n<td>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps4.jpg)</td>\n<td>Question three: Interactions between predators and prey</td>\n<td></td>\n</tr>\n<tr>\n<td>SR</td>\n<td>Sex Ratio</td>\n<td></td>\n</tr>\n<tr>\n<td>FA</td>\n<td>Food Availability</td>\n<td></td>\n</tr>\n<tr>\n<td>RR</td>\n<td>Reproductive Rate</td>\n<td></td>\n</tr>\n<tr>\n<td>P</td>\n<td>Predtion</td>\n<td></td>\n</tr>\n<tr>\n<td>HU![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps5.jpg) ![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps6.jpg) ![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps7.jpg) ![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps8.jpg)</td>\n<td>Habitat Utilizationpopulation size of the lampreysintrinsic growth rate of the lamprey populationcarrying capacity of the lamprey populationthe intrinsic growth rate of the parasite population</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"4-preliminary-conclusions-obtained-by-netlogo-simulation\"><a class=\"markdownIt-Anchor\" href=\"#4-preliminary-conclusions-obtained-by-netlogo-simulation\">#</a> <strong>4</strong>  <strong>Preliminary conclusions obtained by</strong> <strong>N****etlogo simulation</strong></h1>\n<h2 id=\"41-preliminary-setting\"><a class=\"markdownIt-Anchor\" href=\"#41-preliminary-setting\">#</a> <strong>4.1</strong> <strong>Preliminary setting</strong></h2>\n<p>Our time was refreshed by 0.1s. In our analysis and solution, we found that netlogo virtual simulation software could be used to simulate a simplified version of the fish ecosystem to initially judge a series of effects of the changes in the sex ratio of lampreys. We first set a series of conditions on netlogo with code: the color of the male lampreys is pink, and the initial energy is a random number of 6 to 16. Female Lampreys are red in color and have an initial energy of a random number from 1 to 10. Male lampreys have a feeding efficiency of 35% and female lampreys have a feeding efficiency of 20%. The color of the lake trout is blue, the energy is set to infinity (relative to the lampreys), and the initial number is set to 1/5 of the total number of lampreys, which can continuously gain energy on the lake trout. We set the color of the bacteria to purple, the initial number to 200, the reproduction rate to 2000%, carrying energy 0.5. The algae are green in color, have an initial number of 50, a reproductive rate of 2500%, and carry energy 2. We set the lampreys to consume 0.5 per step, and they die when they reach negative energy. Lampreys can reproduce at a specified time (time lapse mod40=30~40), when any two lampreys of the opposite sex can mate and produce 12~18 small white fish, both parents die immediately after producing offspring. Baby Lampreys have a 75% chance of dying as they grow. If the baby lampreys survive mod40&gt;10, they can be transformed into male or female lampreys depending on the amount of food resources around them. The specific rules are as follows:When there is plenty of food around (algae + fungi + lake trout more than 60% of the area), small fish are 56% more likely to become male.When there is not enough food around (algae + fungi + lake trout less than 30% of the area) the small fish are 78% more likely to become female lampreys.The proportion of small fish becoming males varies linearly between 56% and 78% according to the resource area.We also created human fishing rules, and we set the environment for lampreys to be able to sustain K.When the number of lampreys is greater than K of the square root of two fractions, humans catch 40-60% of lampreys at a time (of which 10% are juveniles, 60% are females, and 30% are males).</p>\n<p>Based on this preliminary setting, the dynamic changes of lampreys are simulated to derive the initial trend.</p>\n<h2 id=\"42-netlogo-solves-problem-one-two-three-four\"><a class=\"markdownIt-Anchor\" href=\"#42-netlogo-solves-problem-one-two-three-four\">#</a> <strong>4.2</strong> <strong>Netlogo solves problem one, two, three, four</strong></h2>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/Qf9pvxKleIPXZ5U.png\" alt=\"image.png\"></p>\n<p><strong>Picture 2 Dynamic simulation of each element with netlogo</strong></p>\n<p>As for problem 1, the larger ecosystem can be determined by the total resources and human predation. When lampreys can dynamically adjust their energy change according to the resource ratio, and when we adjust the sex ratio of lampreys from 56% to 78%, the curve shows that the total resources of the ecosystem are basically unchanged after 50 iterations.</p>\n<p>For the analysis of problem 2, when we remove the effect that lampreys can dynamically adjust the sex ratio with respect to the surrounding resources, we find that the total resources of the ecosystem and the total amount of lampreys both show a downward trend. It turns out that lampreys’ ability to adjust their sex ratio helps them grow and compete.</p>\n<p>For question 3, we found that when lampreys were able to adjust their sex ratio, the human catch would first remain at a stable value. Secondly, the total energy of the ecosystem will remain basically consistent, and the stability of species diversity will be effectively guaranteed.</p>\n<p>In response to question 4, we found that changes in the sex ratio of lampreys populations not only ensure the adaptability of host populations and the diversity of ecological niches, but also provide opportunities for parasite populations to stabilize and grow. Therefore, we can reasonably infer that this change in sex ratio does provide ecological advantages to other species such as parasites, especially in terms of stability and adaptability. This advantage may be critical to maintaining the overall health and diversity of the ecosystem.</p>\n<h1 id=\"5-effect-of-variable-sex-ratio-in-lampreys-on-bigger-ecosystem\"><a class=\"markdownIt-Anchor\" href=\"#5-effect-of-variable-sex-ratio-in-lampreys-on-bigger-ecosystem\">#</a> <strong>5  E****ffect of variable</strong> <strong>sex ratio</strong> <strong>in lampreys on</strong> <strong>bigger ecosystem</strong></h1>\n<h2 id=\"51-analytic-hierarchy-process-ahp\"><a class=\"markdownIt-Anchor\" href=\"#51-analytic-hierarchy-process-ahp\">#</a> <strong>5.1</strong>  <strong>Analytic Hierarchy Process (AHP)</strong></h2>\n<h3 id=\"511-model-establishment\"><a class=\"markdownIt-Anchor\" href=\"#511-model-establishment\">#</a> <strong>5.1.1  Model</strong> <strong>Establishment</strong></h3>\n<p>In hierarchical analysis, we hierarchized the problem as influencing the macroecosystem in terms of orientation (A), ecological balance (B1), biodiversity (B2), energy flow (B3), population size (C1), changes in sex ratios (C2), birth mortality rate (C3), natural and anthropogenic influences (D1), food abundance (D2), hatchery environmental conditions (D3), the waters of the effects of other organisms (D4), seasonal variation (D5), water quality conditions (D6), and temperature effects (D7). At the same time, we establish the hierarchical diagram as follows:</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/thozAHl7Te5rLSM.png\" alt=\"image.png\"></p>\n<p>Created a judgment matrix B=<img data-src=\"https://s2.loli.net/2024/07/04/TdbYR2tOpgFqM3D.png\" alt=\"image.png\"></p>\n<p>C=<img data-src=\"https://s2.loli.net/2024/07/04/Jys8Rn75Qbxl4rY.png\" alt=\"image.png\"></p>\n<p>We calculate the weight vector of B from the code as [0.93103448 0.03448276 0.03448276]</p>\n<p><strong>A hierarchical general ordering table for B and C is then created as follows.</strong></p>\n<p><strong>Table 2</strong> <strong>A hierarchical general ordering table for B and C</strong></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/IzAZyiaDh7uO3Bq.png\" alt=\"image.png\"></p>\n<p>Also we get the judgment matrix of D under C1~3</p>\n<p>Table 3 The judgment matrix of D when C1, C2, and C3 are fixed respectively</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/YZz6fTC2N4mawUX.png\" alt=\"image.png\"></p>\n<h3 id=\"512-model-solution\"><a class=\"markdownIt-Anchor\" href=\"#512-model-solution\">#</a> <strong>5.1.2  Model solution</strong></h3>\n<p>For <em><strong>*C*</strong></em><em><strong>*1*</strong></em><em><strong>*, C*</strong></em><em><strong>*2*</strong></em><em><strong>*, and C*</strong></em><em><strong>*3*</strong></em> fixed we compute the weight vectors D****1~7**** to get the following table.Multiplying the weights of criterion layer 2 by the coefficients, i.e., multiplying the individual influences by the criterion layer weights, yields:</p>\n<p><em><strong>*Table 4*</strong></em> <em><strong>*table of total weights*</strong></em></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/uipg9FsTJ2ZoV5d.png\" alt=\"image.png\"></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/rq3dpSFUvyzCkcD.png\" alt=\"image.png\"></p>\n<p>​                <em><strong>*Picture 4*</strong></em>\t<em><strong>*Various factors affect the heat map*</strong></em></p>\n<h3 id=\"513-results-and-analysis\"><a class=\"markdownIt-Anchor\" href=\"#513-results-and-analysis\">#</a> <strong>5.1.3  Results and Analysis</strong></h3>\n<p>As can be seen from the above table:</p>\n<p>（i）The population dynamics of lampreys were greatly affected by the change of sex ratio, followed by the population size. Changes in the sex ratio may directly affect the growth and dynamics of the population. At the same time, species such as lampreys may have complex social structures and behavioral patterns, including courtship behavior and breeding seasons. In these social structures, changes in the sex ratio may cause changes in behavior patterns and dynamics within the population, thus affecting the stability and dynamics of the entire population. Changes in lamprey population size can be relatively stable, as ecosystems usually have a certain carrying capacity. It can be seen from the weight table that the weight of gender ratio in layer C is the highest (1.137930), so the influence of gender ratio on many levels cannot be ignored.</p>\n<p>（ii）It can be seen from the heat map that the sex ratio has the largest or larger influence on the other seven factors, so the sex ratio can affect the population dynamics of lampreys by influencing, for example, the population size of lampreys, the population size of lampreys and the birth mortality rate of lampreys. The change of lampreys population dynamics not only has an impact on the ecological balance and energy flow of the ecosystem, but also has a strong impact on the activities of other organisms. In our view, this effect is positive for the larger ecosystem, which is conducive to improving the stability of the larger ecosystem. In order to keep the energy of the large ecosystem in a specific range, and dynamically regulate the ecological balance and biodiversity to maintain a stable range.</p>\n<h2 id=\"52-lotka-volterra-model\"><a class=\"markdownIt-Anchor\" href=\"#52-lotka-volterra-model\">#</a> <strong>5.2</strong>  <strong>Lotka-Volterra model</strong></h2>\n<h3 id=\"521-model-assumptions\"><a class=\"markdownIt-Anchor\" href=\"#521-model-assumptions\">#</a> <strong>5.2.1  Model</strong> <strong>Assumptions</strong></h3>\n<p>Our model is predicated on the ecological premise that the sex ratio of marine lamprey populations is a variable trait influenced by environmental factors such as food availability. In our assumptions, we consider the following variables:</p>\n<p>Sex Ratio (SR): A continuum from 0 (all male) to 1 (all female), affecting reproductive rates and predation dynamics.</p>\n<p>Food Availability (FA): A key factor influencing the sex ratio and growth rates within the lamprey population.</p>\n<p>Reproductive Rate (RR): Tied to the sex ratio, determining the potential for population increase.</p>\n<p>Predation §: Reflecting the food chain’s impact, with humans as a primary predator, influencing lamprey survival rates.</p>\n<p>Habitat Utilization (HU): The lampreys’ response to environmental conditions, which may affect their migratory and spawning behaviors.</p>\n<p>These factors form the basis of our ecological simulation, where we seek to understand how adaptive changes in sex ratio can affect the broader ecosystem in terms of resource allocation, population dynamics, and overall ecological balance.</p>\n<h3 id=\"522-model-establishment\"><a class=\"markdownIt-Anchor\" href=\"#522-model-establishment\">#</a> <strong>5.2.2  Model</strong> <strong>Establishment</strong></h3>\n<p>For codes 1.1 to 1.6, we utilized polynomial fitting to model the impact of sex ratio changes on various ecological variables. The polynomial fitting is an analytical approach used to model relationships between variables in a system where linear assumptions are inadequate. In our case, we use a 3rd degree polynomial to fit the relationship between the gender ratio and food supply, which can be expressed as:</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/1Cy8LJnxFjYIPv6.png\" alt=\"image.png\"></p>\n<p>Where:</p>\n<p><strong>N</strong> is the prey population (lampreys), <strong>P</strong> is the predator population (humans),<strong>r</strong> is the intrinsic growth rate of the prey,<strong>K</strong> is the carrying capacity of the prey,</p>\n<p><strong>α</strong> is the predation rate coefficient,</p>\n<p><strong>β</strong> is the growth rate coefficient of predators,</p>\n<p>![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps9.jpg) is the death rate of predators.</p>\n<p>These equations allow us to model the dynamic feedback loop where the prey’s growth is limited by the carrying capacity and predation, while the predator’s growth is fueled by the successful capture of prey but tempered by their own mortality.</p>\n<p>In your code for code 1.7, the variables are adjusted to reflect the influence of food availability on gender ratio and its subsequent impact on reproductive success and food resource sustainability. The simulation captures how the lamprey population, when considered as prey, is affected by the changing sex ratios and how this, in turn, affects the predator population over time.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/RP9Wc78TpkAadhU.png\" alt=\"image.png\"></p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/pUNxry97tlmoa4z.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture 5 Simulated Gender Ratio in Response to Food Availability  Picture 6 The effect of sex ratio on different variables*</strong></em></p>\n<h3 id=\"523-conclusions\"><a class=\"markdownIt-Anchor\" href=\"#523-conclusions\">#</a> <strong>5.2.3</strong> <strong>Conclusions</strong></h3>\n<p>Our model suggests that the marine lamprey’s capacity to modify its sex ratio is a significant evolutionary adaptation with profound implications for the ecosystem. An optimal sex ratio can enhance reproductive success, fortify the species’ position in the food chain, and improve the sustainable use of food resources. However, these benefits are not without their drawbacks; imbalances may expose the population to increased predation pressure and reproductive challenges, particularly in the face of environmental stressors such as overfishing and habitat degradation.</p>\n<p>In conclusion, the marine lamprey’s ability to alter its sex ratio in response to environmental conditions underscores a delicate ecological dance of adaptability and vulnerability. This balancing act is critical to the maintenance of ecosystem health, offering a window into the complex interdependencies that govern life within our waterways. Our findings shed light on the pivotal role that sex ratio variability plays in ecological resilience and resource management, providing key insights for the conservation and management of these unique species.</p>\n<h2 id=\"53-conclusion\"><a class=\"markdownIt-Anchor\" href=\"#53-conclusion\">#</a> <strong>5.3  Conclusion</strong></h2>\n<p>Combining the results of the two models, we conclude that the species has the adaptive sex ratio adjustment ability, which has a profound impact on the ecosystem. An optimal sex ratio enhances reproductive success, strengthens the position of species in the food chain, and enhances the sustainable use of food resources. However, this adaptation also brings challenges, and an unbalanced sex ratio can increase predation pressures and reproductive challenges faced by populations, especially in the presence of environmental pressures such as overfishing and habitat degradation.</p>\n<p>Overall, the ray population shows a delicate balance between adaptability and vulnerability in the ecosystem through sex ratio adjustment. This balance is critical to maintaining ecosystem health and provides a window into the complex interdependencies of life in our waters. Our study reveals the key role of sex ratio variation in ecological resilience and resource management, providing important insights into the conservation and management of these unique species.</p>\n<h1 id=\"6-advantages-and-disadvantages-of-variable-sex-ratio-for-lampreys-populations\"><a class=\"markdownIt-Anchor\" href=\"#6-advantages-and-disadvantages-of-variable-sex-ratio-for-lampreys-populations\">#</a> <strong>6</strong> <strong>Advantages and disadvantages of</strong> <strong>variable</strong> <strong>sex ratio for lampreys populations</strong></h1>\n<h2 id=\"61-integrated-assessment-method\"><a class=\"markdownIt-Anchor\" href=\"#61-integrated-assessment-method\">#</a> <strong>6.1</strong> <strong>I****ntegrated assessment method</strong></h2>\n<h3 id=\"611-model-estabilishment\"><a class=\"markdownIt-Anchor\" href=\"#611-model-estabilishment\">#</a> <strong>6.1.1  Model Estabilishment</strong></h3>\n<p>According to the Netlogo fitting results in point 4 we can see the advantage of the seven-gill eel that can dynamically regulate its sex ratio:</p>\n<p><em><strong>*Adaptable:*</strong></em> the ability to adjust the sex ratio to environmental conditions improves the ability to survive and reproduce in resource-limited environments.</p>\n<p><em><strong>*Population control:*</strong></em> By adjusting the sex ratio, lampreyeels are able to control their population size more effectively and reduce excessive competition.</p>\n<p><em><strong>*Genetic diversity:*</strong></em> changing sex ratios may promote genetic diversity and thus increase the adaptive capacity of populations.</p>\n<p>The disadvantages are：</p>\n<p><em><strong>*Fluctuations in reproductive rates:*</strong></em> If one sex is too dominant in a given environment, this may lead to a reduction in reproductive opportunities, affecting the long-term stability of the population.</p>\n<p><em><strong>*Competition for resources:*</strong></em> Changing sex ratios may exacerbate same-sex competition, especially if food or mates are limited.</p>\n<p>Through academic search on google, we built a comprehensive evaluation model after borrowing the paper of William D. Swink.[1]: firstly, we set up the number of initial predators, reproductive success, reproduction process, predation rate, and food resources, and then we set up the parameters to simulate the different sex ability and species change of the lampreyeel, and to simulate the population change of predators and so on.</p>\n<p>The initial evaluation indicator is obtained in our code by W = 0.4 * gender_ratio[gen] + 0.3 * predator_population[gen] + 0.2 * reproductive_success[gen] + 0.1 * food_resources[gen].</p>\n<p>The probability of predation on lampreyP = 0.2*(1-gender_ration[gen ]) to represent the effect of the gender shift on the lampreypopulation.</p>\n<p>The following code iterates the W loop 50 times.</p>\n<p>Then set the weights of the eight variables, i.e.Predation Control=0.2*![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps10.jpg)、Food Chain Role=![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps11.jpg)<em>0.3、Adaptability=![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps12.jpg)<em>0.1、Predation Threat=0.1</em>random(0.1,0.2)、Reproduction Threat=0.2</em>random(0.2,0.5)、Overfishing Risk=0.4<em>random(0.4,0.8)、Environmental Pressure=0.1</em>(0.1,0.5)，ecosystem_provider=0.2*![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps13.jpg)</p>\n<p>Data Setting Analysis:We set the weight of transitional predation by humans to 0.4 and used a random function (0.4,0.8) for the parameter settings, this is due to the fact that human fishing is the main cause of mortality in lampreyeels. Then we set the weight of reproductive threat to 0.2 and the random number set to (0.2,0.5), this is due to the fact that the juvenile mortality of the lampreyeel is also to important cause. And according to William’s article, setting Adaptability to the standard deviation of W is necessary. Setting the role of the lampreyeel in the food chain as the maximum value of W, which can reflect the status of the lampreyeel. And his Predation Control set to the mean value of W also responds well to the function of the seven-gill eel. Here the total energy provided by the ecosystem is recorded as the cumulative sum of W.</p>\n<p>The final comprehensive evaluation equation is  <strong>overall_score=</strong><img data-src=\"https://s2.loli.net/2024/07/04/fURQqInYcloaB6C.png\" alt=\"image.png\">,X for the factors mentioned above.</p>\n<h3 id=\"612-results-and-analysis\"><a class=\"markdownIt-Anchor\" href=\"#612-results-and-analysis\">#</a> <strong>6.1.2 Results and Analysis:</strong></h3>\n<p>The results demonstrated that with the output of the model, we output the sex ratio in the 21 cases of (0,1,0.05) which is overall_score with the specific values of the eight factors and plotted the heat map between the models.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/2ubCiAYfn7Mc1kj.png\" alt=\"image.png\"><img data-src=\"https://s2.loli.net/2024/07/04/VL2Dcsf4rJmaP7h.png\" alt=\"image.png\"><img data-src=\"https://s2.loli.net/2024/07/04/WrBImgHf9hquVdk.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture 9 Thermal map representation of the relationship between the influencing factors*</strong></em></p>\n<p>Through comprehensive evaluation, we can see that, first of all, we observe picture 7, where the food Chain Role increases with the increase of male proportion, which is caused by the fact that males of lampreys have a stronger ability to obtain resources than females. When lampreys have fewer resources or are attacked by predators, increasing the male ratio helps them reduce mortality and improve their status in the ecological chain. Secondly, we pay attention to the change of predation control. In the range of male possibility value (greater than 50%) of lampreys, the threat of predation slowly decreases with the increase of male proportion. Finally, we pay attention to the change of environmental pressure, and we can see that the environmental pressure decreases with the increase of male proportion after 50%, which also means that the environmental pressure on lampreys decreases with the increase of male proportion. And as you can see from Picture 8, the total resources of the ecosystem do not change as the proportion of male lampreys increases, which means that the ecological balance will not be affected, but the adaptability of lampreys will be enhanced.</p>\n<p>So let’s look at the last line of the heat map. It can be seen that the male ratio of lampreys is correlated with all factors, with the strongest correlation for favorable factors, which is shown in red in the figure. However, the association with adverse factors was small, suggesting that an increase in the sex ratio of lampreys can effectively enlarge its beneficial effects and reduce its adverse effects.</p>\n<p>According to our analysis, the most important advantage of regulating the sex ratio of lampreys is to increase the net birth rate: when food is scarce, an increase in the proportion of males reduces the competition for food and improves the success of mating, and when food is abundant, an increase in the proportion of females increases the number of eggs laid and thus the number of offspring.</p>\n<p>Possible disadvantages include: Reduced fertility: When the proportion of males is too high, it may lead to a lack of females, thereby reducing reproductive rate and genetic diversity. When the proportion of females is too high, it can lead to excessive consumption of food, which can affect their growth and health. [Note, this is not inconsistent with advantage, but in a different dimension of thinking about the problem] or over-parasitical other species, resulting in resource damage, population increase, overfishing, disruption of ecological balance, affecting population diversity</p>\n<h2 id=\"62-genetic-algorithmjavascript\"><a class=\"markdownIt-Anchor\" href=\"#62-genetic-algorithmjavascript\">#</a> <strong>6.2</strong>  [Genetic Algorithm](javascript:)</h2>\n<h3 id=\"621-model-assumptions\"><a class=\"markdownIt-Anchor\" href=\"#621-model-assumptions\">#</a> <strong>6.2.1</strong> <strong>Model Assumptions</strong></h3>\n<p>Our genetic algorithm-based model is founded on the premise that adaptive sex ratio variability is a response to environmental pressures. In the case of the marine lamprey, whose sex determination can be influenced by factors such as food availability during larval development, this adaptability may provide a distinct survival advantage. We assume that in environments where food is scarce, a higher proportion of males could reduce intraspecific competition for resources, while in resource-rich settings, a balanced sex ratio could maximize reproductive opportunities. Nonetheless, these adaptations are not without their trade-offs, as a skewed sex ratio could lead to decreased breeding options and heightened vulnerability to environmental stressors.</p>\n<h3 id=\"622-model-establishment\"><a class=\"markdownIt-Anchor\" href=\"#622-model-establishment\">#</a> <strong>6.2.2  Model Establishment</strong></h3>\n<p>Our modeling process begins by initializing a population of potential solutions, represented by binary-encoded DNA. The DNA_LENGTH is set to 24, indicating that each individual solution comprises 24 ‘genes’. The POP_SIZE of 200 specifies that we will simulate 200 potential sex ratio strategies within the lamprey population. CROSSOVER_RATE at 0.8 and MUTATION_RATE at 0.005 are probability thresholds dictating how often genetic mixing and random mutations occur, respectively, throughout our generations of evolution.</p>\n<p>In the context of lamprey populations, we are particularly interested in how the sex ratio—ranging from 0 (all male) to 1 (all female)—and food availability—also scaled from 0 (lowest) to 1 (highest)—affect the overall fitness of the population. Fitness is a measure of how well each strategy copes with environmental conditions and is calculated by the simulate_environment function, which considers the deviation from an expected sex ratio based on food availability.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/o4RsirmxyGXMTIH.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture 10 Genetic algorithm design flow chart*</strong></em></p>\n<h3 id=\"623-results-and-analysis\"><a class=\"markdownIt-Anchor\" href=\"#623-results-and-analysis\">#</a> <strong>6.2.3</strong>  <strong>Results and Analysis</strong></h3>\n<p><em><strong>*Picture 11~16 Food Availability, Food Chain Status, Adaptability, Overfishing, Reproduction threatened and ambient pressure were taken as the y axis, and sex ratio was taken as the x axis. The calculation is a 3D scatter plot of the z axis*</strong></em></p>\n<p>Our simulations reveal that the marine lamprey’s ability to adjust its sex ratio confers several advantages. It allows the population to adapt to varying levels of food availability, improves its position in the food chain by optimizing resource allocation, and exhibits remarkable adaptability to environmental conditions. However, the disadvantages become apparent when reproductive opportunities are threatened, or the population faces environmental pressures such as overfishing, which leads to a decrease in fitness. Thus, while the adaptive sex ratio variability of the lamprey population provides certain ecological benefits, it also poses significant risks, underscoring the delicate balance this species maintains within its ecosystem.</p>\n<h2 id=\"63-conclusion\"><a class=\"markdownIt-Anchor\" href=\"#63-conclusion\">#</a> <strong>6.3  Conclusion</strong></h2>\n<p>Lampreys show multiple ecological advantages by dynamically regulating the sex ratio. First, increasing the proportion of males increases their position in the food chain, and males are better at resource access, especially when resources are scarce or threatened by predation, which helps to reduce mortality and improve survival competitiveness in the ecological chain. Secondly, adjusting the sex ratio makes lampreys more adaptable, able to flexibly respond to environmental changes, and improve the success rate of survival and reproduction. In addition, an increased male ratio could help reduce predation threats to lampreys, reducing predation pressure and maintaining a more stable population. Finally, the model showed that environmental stress was significantly reduced when the proportion of males was more than 50%, suggesting that the presence of lampreys helped to reduce ecosystem pressure on them and promote the maintenance of ecological balance.</p>\n<p>But sex-ratio adjustment comes with some potential disadvantages. One of these is that it can lead to reduced reproductive opportunities, when the proportion of males is too high there may not be enough females, reducing reproductive rate and genetic diversity. In addition, if the proportion of females is too high, it can lead to overpredation and resource consumption, negatively affecting the growth and health of lampreys. At the same time, factors such as overfishing and environmental pressure may also cause resource damage, excessive population growth, overfishing and other problems, destroy the ecological balance and affect the diversity of the population. Therefore, while enjoying the multiple advantages brought about by sex ratio adjustment, it is also necessary to carefully deal with some disadvantages that may be triggered in order to maintain the balance and stability of lampreys in their ecosystem.</p>\n<p>However, for lampreys, the ecological advantages shown by dynamically adjusting the sex ratio far outweigh the disadvantages. This ability to adjust allows lampreys to respond flexibly to different environmental conditions, improving their survival and reproductive success. By optimizing their position in the food chain, mitigating the threat of predation, and reducing environmental stress, lampreys are able to better adapt to complex ecological environments and maintain their balance in the ecosystem. Despite some potential disadvantages, such as reduced reproductive opportunities and increased environmental pressures, the benefits of sex ratio regulation can be better realized through careful management and integrated consideration of the complexity of ecosystems. Thus, overall, lampreys’ ecological adaptations and advantages, demonstrated through flexible regulation of sex ratios, dominate in maintaining balance and diversity in their ecosystems.</p>\n<h1 id=\"7-effects-of-variable-sex-ratio-of-lamprey-on-ecosystem-stability\"><a class=\"markdownIt-Anchor\" href=\"#7-effects-of-variable-sex-ratio-of-lamprey-on-ecosystem-stability\">#</a> <strong>7</strong>  <strong>Effects of variable sex ratio of lamprey on ecosystem stability</strong></h1>\n<p>We use differential equation - Jacobian matrix to find eigenvalues to judge the stability of ecosystem. Select the points whose derivative or partial derivative is equal to zero, and analyze these points to calculate the Jacobian matrix near the stable point, and analyze its eigenvalue. We calculate the Jacobian matrix at two stable points (origin and non-zero stable point) and solve their eigenvalues. These eigenvalues can be used to analyze the stability of the system at these points. The real parts of the eigenvalues tell us how the system behaves around these points: if the real parts of the eigenvalues are all negative, then the system is locally stable at that point; If the real part of at least one eigenvalue is positive, the system is unstable at that point.。</p>\n<h2 id=\"71-not-considering-the-prey-of-lampreys\"><a class=\"markdownIt-Anchor\" href=\"#71-not-considering-the-prey-of-lampreys\">#</a> <strong>7.1</strong>  <strong>Not considering the prey of lampreys</strong></h2>\n<p>We use the Rottka-Volterra model differential equation, namely:</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/FnJBo8GOHqWCAXK.png\" alt=\"image.png\"></p>\n<p>The stability of the ecosystem is understood here as a stable population of lampreys and their natural predators. Initialize Natural_Growth_Rate = 0.5+0.5* (gender_ratio[gen] -0.5), make the probability of predation of lampreys β=0.4* (1-gender_ratio), initialize the number of lampreys and the number of predators, and iteration 200 times. According to the output model of the Jacobi equation, the ecosystem is stable when the male proportion is 55% to 81%, and unstable at the rest of the time.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/SyfGlPHKitk9hwb.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture 17 Population dynamics of lampreys and their predators*</strong></em></p>\n<h2 id=\"72-consider-the-prey-of-lampreys\"><a class=\"markdownIt-Anchor\" href=\"#72-consider-the-prey-of-lampreys\">#</a> <strong>7.2</strong>  <strong>Consider the prey of lampreys</strong></h2>\n<p>At this point we call the ecosystem differential model:</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/R3Hy1V2OidnmeU8.png\" alt=\"image.png\"></p>\n<p>Where G is the number of prey, R is the number of prey, and E is the number of predatorsSimilar to 7.1, we added that the predation ability of lampreys increases with the increase of males. Then we performed the Jacobian operation on these three equations, and we were surprised to find that the ecosystem was stable within the range of 50% to 82% males.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/IHDVN6EPCwpBfvA.png\" alt=\"image.png\"></p>\n<h2 id=\"73-conclusion\"><a class=\"markdownIt-Anchor\" href=\"#73-conclusion\">#</a> <strong>7.3  Conclusion</strong></h2>\n<p>Based on the results of the study, the change in the sex ratio of lampreys has a positive effect on maintaining the stability of the ecosystem. Without taking into account parasitism, studies have shown that the ecosystem is relatively stable at a male ratio of 55% to 81%. This suggests that lampreys have the ability to promote a relatively balanced ecosystem within a specific range of male ratios by dynamically adjusting the sex ratio. In the case of lampreys as parasites, the ecosystem remained relatively stable in the 50 to 82 percent range, even with the increased male ratio. This indicates that the regulation of the sex ratio of lampreys can maintain the relative balance of the ecosystem in a wider range, so that the ecosystem shows a certain resilience to the change of sex ratio.</p>\n<p>Combining the two models, we can see that lampreys show positive effects on ecosystem stability by adjusting the sex ratio, providing a regulatory mechanism for ecological balance. This regulation of ecosystem stability may be related to lampreys’ ecological roles in resource utilization, predation control and adaptation, contributing to their relative balance in a complex ecological environment. The excess of the interval constructed by the model indicates that even when lampreys are hit by sudden shocks or sudden natural disasters, the sex ratio breaks through the normal interval, they can still maintain their relative stability.</p>\n<h1 id=\"8-effects-of-variable-sex-ratio-in-lampreys-on-other-species\"><a class=\"markdownIt-Anchor\" href=\"#8-effects-of-variable-sex-ratio-in-lampreys-on-other-species\">#</a> <strong>8</strong>  <strong>Effects of variable sex ratio in lampreys on other species</strong></h1>\n<h2 id=\"81-system-dynamics\"><a class=\"markdownIt-Anchor\" href=\"#81-system-dynamics\">#</a> <strong>8.1</strong>  <strong>System Dynamics</strong></h2>\n<h3 id=\"811-model-assumptions\"><a class=\"markdownIt-Anchor\" href=\"#811-model-assumptions\">#</a> <strong>8.1.1 Model Assumptions</strong></h3>\n<p>Our model is predicated on the assumption that the sex ratio of marine lamprey populations, represented as R（T）=F(T)/M(T), can significantly affect ecological dynamics within their habitat. Given the dependence of parasites on their hosts, any fluctuations in the lamprey population—attributable to changes in the sex ratio—could provide an ecological advantage to these parasites. Specifically, we hypothesize that:</p>\n<p>A higher reproduction rate, facilitated by an abundant food supply P(t), will lead to an increase in the lamprey population, subsequently benefiting the parasite population due to increased host availability.</p>\n<p>Parasites might exhibit resilience by maintaining or even increasing their population in the face of fluctuating food supplies, suggesting an advantage in their life cycle and infection strategies that allow survival and propagation when host numbers vary, as expressed by the dynamic <img data-src=\"https://s2.loli.net/2024/07/04/38fOLsUykthHFQu.png\" alt=\"image.png\"></p>\n</li>\n</ul>\n<p>, where ![img](file:///C:\\Users\\JackDu\\AppData\\Local\\Temp\\ksohtml8880\\wps14.jpg)represents the survival rate of parasites.</p>\n<h3 id=\"812-model-creation-process\"><a class=\"markdownIt-Anchor\" href=\"#812-model-creation-process\">#</a> <strong>8.1</strong>**.2** <strong>Model</strong> <strong>Creation Process</strong></h3>\n<p>In constructing our model, we employed a systems dynamics approach to articulate the complex interplay between lamprey populations, parasite populations, and the food supply. The core parameters of our model include:</p>\n<p>The lamprey population over time, *<strong>*<em>N(t)*</em>*</strong>, influenced by the birth rate *<strong>*<em>b*</em>*</strong> related to the female lamprey population *<strong>*<em>F(t)*</em>*</strong> and the death rate *<strong>*<em>d*</em>*</strong>, as well as the external food supply *<strong>*<em>P(t)*</em>*</strong>.</p>\n<p>The parasite population over time, <em><strong>*<em>P(t)*</em>*</strong>, which depends on the lamprey population as its host and is subject to the survival rate <em><strong>*<em>s*</em>*</strong> and death rate <em><strong>*<em>d*</em>*</strong></em></em></em>*<em>p*</em>***.</p>\n<p>The food supply, *<strong>*<em>P(t)*</em>*</strong>, which directly impacts the reproduction rate of lampreys, thereby influencing the availability of hosts for parasites.</p>\n<p>The model is expressed through differential equations that delineate the growth or decline of both the lamprey and parasite populations, incorporating the variables of birth *<strong>*<em>b*</em>*</strong>, death *<strong>*<em>d*</em>*</strong>, and survival *<strong>*<em>s*</em>*</strong> rates<img data-src=\"https://s2.loli.net/2024/07/04/wpJXdxRlCK9gfQS.png\" alt=\"image.png\"></p>\n<p>These equations represent the core of our dynamic model, capturing the interdependencies and feedback loops within the ecosystem influenced by the sex ratio of the lamprey population.</p>\n<h3 id=\"813-results-and-analysis\"><a class=\"markdownIt-Anchor\" href=\"#813-results-and-analysis\">#</a> <strong>8.1.3 Results and Analysis</strong></h3>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/4mG9YzIo8NTr5t6.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture 19~20 Population changes of LamPrey and Parasite under High Food Supply(19) and Low Food Supply(20)*</strong></em></p>\n<p>Figure 19 and  Figure 20 show that :</p>\n<p>Under high food availability, both lamprey populations and parasite populations show an increasing trend . This may be due to the fact that high food availability increases the reproduction rate of lamprey, which in turn provides more hosts for the parasites. Under low food availability, the growth rate of the lamprey population was slower, but the parasite population was still able to grow. Despite the slowdown in lamprey growth, this did not appear to prevent the expansion of the parasite population. These observations suggest that parasitoids show some advantage in this model in that they are able to maintain and even grow populations in spite of changes in lamprey populations. This advantage may stem from their life cycle and infection strategy that allows them to survive and reproduce when host populations fluctuate.</p>\n<p>In conclusion, the model suggests that parasites can leverage variations in the sex ratio of the lamprey population to their advantage, as they are able to grow under various food supply conditions. The ability of parasites to thrive even when food supplies are low, potentially due to a higher number of females during times of resource abundance, points to a significant ecological advantage.</p>\n<h2 id=\"82-ecological-interaction-model\"><a class=\"markdownIt-Anchor\" href=\"#82-ecological-interaction-model\">#</a> <strong>8.2</strong>  <strong>Ecological Interaction Model</strong></h2>\n<h3 id=\"821-model-assumptions\"><a class=\"markdownIt-Anchor\" href=\"#821-model-assumptions\">#</a> <strong>8.2.1 Model Assumptions</strong></h3>\n<p>In our Ecological Interaction Model, we begin by hypothesizing that variations in the sex ratio of the marine lamprey population can significantly affect reproductive success rates and survival strategies. This, in turn, may have cascading effects on the growth patterns of associated parasitic populations. \tWe postulate that:</p>\n<p>The sex ratio can shift dynamically in response to environmental pressures.</p>\n<p>These shifts can lead to differentiated reproductive roles and success rates between genders.</p>\n<p>Parasites will respond indirectly to these changes due to their dependence on the host population’s structure and density.</p>\n<p>For the lamprey population dynamics:</p>\n<p>![of the lamprey population size and the sex ratio <strong>R</strong>.</p>\n<h3 id=\"822-model-establishment\"><a class=\"markdownIt-Anchor\" href=\"#822-model-establishment\">#</a> <strong>8.2.2  Model Establishment</strong></h3>\n<p>The creation of our model involved several steps:</p>\n<p>We defined the intrinsic growth rates for lampreys and their parasites, denoted by ‘r_lamprey’ and ‘r_parasite’, respectively.</p>\n<p>A carrying capacity ‘K_lamprey®’ was established, which adjusts based on the sex ratio ‘R’, indicating the population’s maximum sustainable size under varying sex ratios.</p>\n<p>We formulated the interaction terms, particularly ‘sigma_lamprey’, which represents the rate at which parasites affect lampreys, and ‘K_parasite(N_lamprey, R)’, the modified carrying capacity for parasites influenced by lamprey numbers and sex ratio.</p>\n<p>Differential equations were developed to model the dynamics of both populations, allowing for the simulation of long-term ecological interactions.</p>\n<h3 id=\"823-results-and-analysishttpss2lolinet20240704onnwjqlb7ibsp1vpng\"><a class=\"markdownIt-Anchor\" href=\"#823-results-and-analysishttpss2lolinet20240704onnwjqlb7ibsp1vpng\">#</a> <strong>8.2.3  Results and analysis</strong>](<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zMi5sb2xpLm5ldC8yMDI0LzA3LzA0L29ObldKcWxCN2lic1Axdi5wbmc=\">https://s2.loli.net/2024/07/04/oNnWJqlB7ibsP1v.png</span>)</h3>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/LisHxdGoZm6jOAY.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture 21 Dynamics of Lamprey and Parasite Populations*</strong></em></p>\n<p>The variable sex ratio of lamprey populations do offer an advantage to other species in the ecosystem, such as parasites. This advantage is reflected in several key aspects:</p>\n<p>l Sex ratio changes and population stability:</p>\n<p>The graph shows that although the lamprey population declined rapidly initially, it stabilised over time. This stabilisation may be a direct effect of the sex ratio change on the ecosystem, providing a stable host population for the parasites, allowing their population to expand and remain stable. Stable host populations provide a continuous resource for the parasites, allowing them to not only survive, but to reproduce.</p>\n<p>l The ability to adapt to the environment:</p>\n<p>Changes in sex ratios may lead to increased adaptability of lamprey populations to different environmental conditions. For example, during periods of food scarcity, an increase in the proportion of males may help to reduce competition for limited resources, which provides a more stable environment for the parasite as the host population does not collapse due to food shortages.</p>\n<p>l Ecological niche occupancy:</p>\n<p>Changes in sex ratios may mean that male and female lampreys have different roles in the ecosystem. This may lead to changes in ecological niches that provide new or underutilised resources for the parasites, thus increasing their chances of survival and reproduction.</p>\n<p>l Long-term symbiotic relationships:</p>\n<p>The steady growth of parasite populations in the charts suggests that, despite the limited number of hosts, the parasites have adapted to the conditions and have developed a long-term symbiotic relationship with their hosts. This relationship may be caused by changes in sex ratio, as such changes help to limit the growth of parasite populations and prevent them from causing excessive damage to their hosts.</p>\n<h2 id=\"83-conclusion\"><a class=\"markdownIt-Anchor\" href=\"#83-conclusion\">#</a> <strong>8.3  Conclusion</strong></h2>\n<p>In conclusion, our two models demonstrate that variable sex ratio of lamyprey offer significant ecological advantages its parasitic counterparts.</p>\n<p>These changes in sex ratio not only promote population stability but also enhance adaptability to environmental variations, offering a consistent resource base and food supply for parasites. They are able to grow under various food supply conditions and when food supplies are low, potentially due to a higher number of females during times of resource abundance.</p>\n<p>Additionally, the alterations in sex ratio lead to ecological niche differentiation, thus providing new opportunities for parasitic population expansion. The establishment of long-term symbiotic relationships also suggests that prudent adjustments in sex ratio can maintain a balance between hosts and parasites, which is essential for the health and diversity of the entire ecosystem.</p>\n<h1 id=\"9-sensitivity-analysis\"><a class=\"markdownIt-Anchor\" href=\"#9-sensitivity-analysis\">#</a> <strong>9  Sensitivity</strong> <strong>Analysis</strong></h1>\n<h2 id=\"91-ahp-sensitivity-analysis\"><a class=\"markdownIt-Anchor\" href=\"#91-ahp-sensitivity-analysis\">#</a> <strong>9.1  AHP</strong> <strong>sensitivity analysis</strong></h2>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/MrymS8e5O2nilbZ.png\" alt=\"image.png\"></p>\n<h2 id=\"92-lotka-volterra-sensitivity-analysis\"><a class=\"markdownIt-Anchor\" href=\"#92-lotka-volterra-sensitivity-analysis\">#</a> <strong>9.2</strong> <strong>Lotka-Volterra</strong> <strong>sensitivity analysis</strong></h2>\n<p>The sensitivity analysis of model parameters is a critical step in understanding the dynamics of ecological system models. In our Lotka-Volterra model, we conducted a sensitivity analysis on the predation rate ® and the predation efficiency (beta). These parameters directly affect the interactions between prey and predator populations over time.</p>\n<p>The sensitivity analysis results indicate that the prey population (lampreys) is highly sensitive to changes in the predation rate ® and predation efficiency (beta). As r and beta increase, there is a significant decrease in the prey population. This sensitivity suggests that even slight variations in predation pressure can significantly impact prey numbers.</p>\n<p>Conversely, the predator population (humans) showed a contrasting trend under certain parameter combinations. With higher rates of r and beta, predator populations initially surge but then stabilize. This may indicate that predators can adapt to changes in food supply by increasing predation activities.</p>\n<p>The sensitivity analysis allows us to conclude that in the Lotka-Volterra model, the impact of the predation rate ® and predation efficiency (beta) on prey populations is pronounced. The prey population exhibits high sensitivity to these changes, whereas the predator population displays greater adaptability. These findings emphasize the importance of considering these key parameter variations when devising strategies for ecosystem management and conservation.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/gJMQ1NOWbmfdjFZ.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture 22*</strong></em> <em><strong>*Sensitivity analysis plots for predation rate ® and predation efficiency (β) for the LV equation*</strong></em></p>\n<h2 id=\"93-comprehensive-assessment-sensitivity-analysis\"><a class=\"markdownIt-Anchor\" href=\"#93-comprehensive-assessment-sensitivity-analysis\">#</a> <strong>9.3</strong>  <strong>C****omprehensive assessment</strong> <strong>sensitivity analysis</strong></h2>\n<p>We obtained the gender through records_ The line chart of the ratio overall score shows that within the achievable male proportion range, the overall score remains relatively stable. After deducing the third question, the models of the second and third questions are mutually confirmed, and the model is established.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/weEfzsVSI7lFM6h.png\" alt=\"image.png\"></p>\n<p><strong>Picture 23 Line graph of total IMRT score as a function of gender ratio</strong></p>\n<h2 id=\"94-sensitivity-analysis-of-genetic-algorithm\"><a class=\"markdownIt-Anchor\" href=\"#94-sensitivity-analysis-of-genetic-algorithm\">#</a> <strong>9.4</strong>  <strong>Sensitivity analysis of genetic algorithm</strong></h2>\n<p>This sensitivity analysis evaluates how changes in sex ratio and food availability affect the fitness of a simulated lamprey population within a genetic algorithm framework. The analysis aims to determine the model’s sensitivity to these two parameters by observing the variations in fitness outcomes.</p>\n<p>The genetic algorithm’s population was initialized with a range of sex ratios from 0 (all male) to 1 (all female) and food availability from 0 (lowest) to 1 (highest). For each combination of sex ratio and food availability, the model calculated the corresponding fitness, which represents the population’s viability under those conditions.</p>\n<p>The resulting surface plot demonstrates that fitness is highly sensitive to changes in sex ratio when food availability is low. In contrast, the model shows less sensitivity to variations in food availability when the sex ratio is near the extremes (0 or 1). The steepest gradient occurs when transitioning from a male-dominant population to a balanced or female-dominant one, particularly in environments with limited food resources.</p>\n<p>The model displays significant sensitivity to sex ratio changes, particularly in scenarios of low food availability, suggesting that the sex ratio is a critical factor in the population’s adaptability. Conversely, the population’s fitness is less sensitive to food availability, especially when the sex ratio is balanced. These findings highlight the importance of sex ratio management in conservation and resource allocation strategies for the lamprey species.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/Wu5bPqjHnfsRJKz.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture 24 Sensitivity analysis of sex ratio and food availability*</strong></em></p>\n<h2 id=\"95-sensitivity-testing-of-eigenvalue-models-using-differential-equations\"><a class=\"markdownIt-Anchor\" href=\"#95-sensitivity-testing-of-eigenvalue-models-using-differential-equations\">#</a> <strong>9.5</strong> <strong>Sensitivity testing of eigenvalue models using differential equations</strong></h2>\n<p>When we adjust the sex ratio and parameters, within the allowable error range (5%), the stability of the ecosystem output of the code is not affected, and the model is valid.</p>\n<h2 id=\"96-sensitivity-analysis-of-system-dynamics\"><a class=\"markdownIt-Anchor\" href=\"#96-sensitivity-analysis-of-system-dynamics\">#</a> <strong>9.6</strong>  <strong>Sensitivity analysis of system dynamics</strong></h2>\n<p>This report examines the sensitivity of the total population size to variations in birth and death rates within a population model. By altering these parameters, the trends in population changes over time are observed.</p>\n<p>The findings indicate that the population size is significantly sensitive to changes in both the birth and death rates. An increase in the birth rate leads to an upward trend in population size, while an increase in the death rate results in a downward trend. Within the parameter range analyzed in this study, the effect of the birth rate appears to be more pronounced, suggesting that it is a critical control parameter for population growth. On the other hand, an increase in the death rate decreases the population size, but the population can still sustain growth when the birth rate is sufficiently high.</p>\n<p>In conclusion, the birth and death rates are sensitive parameters in the population model, exerting direct and significant influences on the population size. Therefore, changes in these parameters should be closely monitored in population management and conservation efforts.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/FmJPS6LZ2OQxlo3.png\" alt=\"inmage\"></p>\n<p><em><strong>*Picture 25 Sensitivity analysis of birth and death rates by system dynamics*</strong></em></p>\n<h2 id=\"97-sensitivity-analysis-of-ecological-interactions-model\"><a class=\"markdownIt-Anchor\" href=\"#97-sensitivity-analysis-of-ecological-interactions-model\">#</a> <strong>9.7</strong> <strong>Sensitivity analysis of ecological interactions model</strong></h2>\n<p>This report presents the findings from a sensitivity analysis conducted on a population model concerning birth and death rates. Our objective was to determine how variations in these parameters influence the overall population growth over time.</p>\n<p>The sensitivity analysis was performed by systematically varying the birth rate between 0.01 to 0.1 and the death rate between 0.005 to 0.02. A total of 40 simulations were run, combining different levels of birth and death rates to observe their effects on the population dynamics.</p>\n<p>The model’s output indicates a direct correlation between the birth rate and population size, with higher birth rates resulting in greater population growth. Conversely, increased death rates dampen this growth, as expected. However, the population’s sensitivity to changes in the death rate is less pronounced when compared to the birth rate.</p>\n<p>The model demonstrates a high sensitivity to changes in the birth rate, with even slight increases leading to significant rises in population size. In contrast, the death rate’s impact is noticeable but less influential. Therefore, we conclude that the population model is more sensitive to variations in birth rate than to changes in death rate.</p>\n<p><img data-src=\"https://s2.loli.net/2024/07/04/eoO1A2baGQBJkW4.png\" alt=\"image.png\"></p>\n<p><em><strong>*Picture 26 Ecosystem interaction modeling for sensitivity analysis of birth and death rates*</strong></em></p>\n<h1 id=\"10-model-evaluation-and-further-discussion\"><a class=\"markdownIt-Anchor\" href=\"#10-model-evaluation-and-further-discussion\">#</a> <strong>10</strong>  <strong>Model Evaluation and Further Discussion</strong></h1>\n<h2 id=\"101-question-one\"><a class=\"markdownIt-Anchor\" href=\"#101-question-one\">#</a> <strong>10.1</strong>  <strong>Question One</strong></h2>\n<p>The Analytic Hierarchy Process (AHP) offers a comprehensive analysis of multiple factors, facilitating weight calculation and intuitive insights. However, it is subjective and may not always yield precise conclusions. On the other hand, the Lotka-Volterra model allows dynamic simulation, ecosystem interactions, and adaptive analysis, albeit with the drawback of simplification and parameter uncertainty. In essence, these two models can complement each other. AHP can provide weights and relationships for broader ecosystem impacts, while the Lotka-Volterra model delves deeper into species interactions. Future development should focus on constructing a more realistic and comprehensive ecosystem model by leveraging the strengths of both.</p>\n<h2 id=\"102-question-two\"><a class=\"markdownIt-Anchor\" href=\"#102-question-two\">#</a> <strong>10.2</strong>  <strong>Question Two</strong></h2>\n<p>The advantage of the Comprehensive Evaluation Method lies in its ability to conduct a thorough analysis, set reasonable weights, and offer multiple perspectives. While it visually displays relationships through heatmaps, it suffers from subjective parameter setting and complexity. Genetic algorithms, with their adaptability and global search capabilities, are well-suited for complex ecosystem problems. In summary, both models have distinct advantages, and combining them allows for a more holistic understanding of the European eel’s impact on the ecosystem. Future research can enhance model reliability and practicality through optimization, improved data quality, and enhanced field observations.</p>\n<h2 id=\"103-question-three\"><a class=\"markdownIt-Anchor\" href=\"#103-question-three\">#</a> <strong>10.3</strong>  <strong>Question Three</strong></h2>\n<p>The Ecosystem Stability Model exhibits several merits: it is built on a mathematical framework employing differential equations and Jacobian matrices, providing a scientific and systematic analysis tool. The model compares two scenarios, considering and not considering parasitism, forming a foundation for a more comprehensive understanding. By applying the model to real cases, such as changes in the gender ratio of European eels, it enhances the credibility of practical applications and offers valuable quantitative results to decision-makers. Nevertheless, the model relies on simplified assumptions and may not fully capture all factors impacting real ecosystems. Future efforts could refine algorithms and the model itself for increased precision.</p>\n<h2 id=\"104-question-four\"><a class=\"markdownIt-Anchor\" href=\"#104-question-four\">#</a> <strong>10.4</strong>  <strong>Question Four</strong></h2>\n<p>The System Dynamics model, based on system dynamics, comprehensively addresses the complex interactions between European eel populations, parasite populations, and food supply. Core parameters and equations are well-defined, and ecological interactions are explicitly considered. However, both models simplify other factors, such as interactions with other species. These two models complement each other, suggesting the potential for an integrated ecosystem dynamic model in the future to better understand the impact of gender ratio changes on the entire ecosystem.</p>\n<h1 id=\"11-reference\"><a class=\"markdownIt-Anchor\" href=\"#11-reference\">#</a> <strong>11</strong> <strong>R****eference</strong></h1>\n<p>[1] William D. Swink. Host Selection and Lethality of Attacks by Sea Lampreys (Petromyzon marinus) in Laboratory Studies (2003). Journal of Great Lakes Research, 29, 307-31</p>\n<p>[2] RYAPOLLOVA N I, PARSHUTA V V, MINTAS A R. Fish industry lamprey larvae breeding-keeping. SU1565441-A. BALTIISK FISH ECON. 2023-08-10. DIIDW:1991034673.</p>\n<p>[3] DAVIS W A. Sea lamprey population control method. US4934318-A; CA2007417-A; CA2007417-C. DAVIS W A. 2023-08-10. DIIDW:1990208774.</p>\n<p>[4] MAURINSH O K, EGGERTS B V. Lamprey fry rearing method. SU1355200-A. TSARNIKAVA KOLKHOZ. 2023-08-10. DIIDW:1988167501.</p>\n<p>[5] WU F, XU A, ZHANG T. Performing artificial breeding of wild Siberian lamprey, by selecting matured northeast lamprey as parent, performing artificial insemination, washing and incubating fertilized egg, separating hatched eggs, and feeding hatched ones. CN104137799-A; CN104137799-B. UNIV SUN YAT-SEN. 2023-08-10. DIIDW:201505012A.</p>\n<p>[6] ZHANG J, CHEN D, MO W, CUI J, SUN S, WANG G. Method for farming river lamprey, involves feeding eel, Penaeus white shrimp and carp into pond followed by feeding and daily management including aeration, disinfection, microbial agent application, water exchange and disease control. CN103416337-A; CN103416337-B. NINGBO CHUANGHUI VEGETABLES ENG &amp; TECHNO; NINGBO DAQIAO ZOOLOGY AGRIC CO LTD; CIXI VEGETABLE DEV CO LTD. 2014-01-03. DIIDW:2014C16110.</p>\n<p>[7] OpenAI.(2023)Chatgpt3.5 <span class=\"exturl\" data-url=\"aHR0cDovL29wZW5haS5jb20vY2hhdGdwdA==\">http://openai.com/chatgpt</span></p>\n<p><em><strong>*Artificial Intelligence Usage Report*</strong></em></p>\n<p>Question 1: “Please explain the Analytic Hierarchy Process (AHP) and its application in assessing the impact of gender ratio changes in ecosystems.”</p>\n<p>Output: “Analytic Hierarchy Process (AHP) is a decision analysis tool that decomposes complex problems into several factors and sub factors by establishing a hierarchical structure, and then evaluates the importance of each factor through pairwise comparison and weight allocation. In the study of gender ratio changes in ecosystems, AHP can help quantify different factors (such as resource utilization, species diversity, etc.)” The importance of impacts on ecosystems in order to optimize decision-making processes. “</p>\n<p>Question 2: “Please provide a simplified genetic algorithm example for optimizing the simulation of adjusting the sex ratio of lampreys.”</p>\n<p>Output: “Genetic algorithm is a search heuristic algorithm used to solve optimization and search problems, imitating the process of natural selection. Simplified examples include defining a fitness function to evaluate the reproductive growth advantage of the lamprey population, and then generating a new generation of population through selection, crossover, and mutation operations, iterating continuously to find the optimal gender ratio configuration.”</p>\n<p>Question 3: “How to use system dynamics models to simulate ecological interactions between lampreys and other species?”</p>\n<p>Output: “The system dynamics model simulates system behavior by constructing causal diagrams and differential equations between variables. In the simulation of interactions between lampreys and other species, variables including lampreys population size, gender ratio, resource quantity, and other species population size can be defined, and their changes over time can be described through a system of equations to study the impact of gender ratio changes on other members of the ecosystem.”</p>\n<p>Question 4: “Explain the application of difference equations and Jacobian matrices in evaluating ecosystem stability.”</p>\n<p>Output: Differential equations are used to describe the process of variable discrete changes over time, while Jacobian matrices are a mathematical tool used to analyze the local stability of nonlinear systems. In ecosystem stability assessment, differential equations can be constructed to simulate the dynamic changes of populations in the ecosystem. Jacobian matrices can be used to analyze the impact of gender ratio changes on system stability, identify the equilibrium state of the system, and its sensitivity to disturbances Sex. “</p>\n<p>Question 5: “What are the advantages of using the NetLogo model to simulate the ecological impact of gender ratio changes in lampreys?”</p>\n<p>Output: “NetLogo is a multi-agent simulation software that can simulate interactions between individuals in complex systems. The advantage of using NetLogo to simulate changes in the sex ratio of lampreys is that it can intuitively demonstrate how individual behavior accumulates and affects the dynamics of the entire system, allowing researchers to adjust model parameters and observe ecosystem responses in real-time under different conditions, thereby gaining a deeper understanding of the multidimensional effects of gender ratio adjustments on the ecosystem.”</p>\n<p>Question 6: “How to determine key parameters when conducting model sensitivity analysis?”</p>\n<p>Output: “In model sensitivity analysis, the process of determining key parameters typically involves evaluating the sensitivity of model output to changes in various input parameters. By changing parameter values one by one and observing their impact on model results, the parameters that have the greatest impact on model prediction results can be identified. This helps to understand the sources of uncertainty in the model and which parameters are the key factors determining model behavior.”</p>\n<p>Question 7: “How can existing data be used to validate the accuracy and reliability of the model?”</p>\n<p>Output: “Verifying the accuracy and reliability of a model can be achieved by comparing its predicted results with actual observation data. This includes testing the model’s predictive ability for known events using historical data, and conducting cross validation to evaluate the model’s generalization ability on unknown data. Through this approach, the model’s predictive accuracy can be evaluated, and deviations or inaccuracies in the model can be identified and adjusted.”</p>\n<h1 id=\"美赛代码\"><a class=\"markdownIt-Anchor\" href=\"#美赛代码\">#</a> 美赛代码</h1>\n<h2 id=\"层次分析法\"><a class=\"markdownIt-Anchor\" href=\"#层次分析法\">#</a> 层次分析法</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">AHP</span>:</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    相关信息的传入和准备</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, array</span>):</span><br><span class=\"line\">        <span class=\"comment\">## 记录矩阵相关信息</span></span><br><span class=\"line\">        self.array = array</span><br><span class=\"line\">        <span class=\"comment\">## 记录矩阵大小</span></span><br><span class=\"line\">        self.n = array.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">        <span class=\"comment\"># 初始化RI值，用于一致性检验</span></span><br><span class=\"line\">        self.RI_list = [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0.52</span>, <span class=\"number\">0.89</span>, <span class=\"number\">1.12</span>, <span class=\"number\">1.26</span>, <span class=\"number\">1.36</span>, <span class=\"number\">1.41</span>, <span class=\"number\">1.46</span>, <span class=\"number\">1.49</span>, <span class=\"number\">1.52</span>, <span class=\"number\">1.54</span>, <span class=\"number\">1.56</span>, <span class=\"number\">1.58</span>,</span><br><span class=\"line\">                        <span class=\"number\">1.59</span>]</span><br><span class=\"line\">        <span class=\"comment\"># 矩阵的特征值和特征向量</span></span><br><span class=\"line\">        self.eig_val, self.eig_vector = np.linalg.eig(self.array)</span><br><span class=\"line\">        <span class=\"comment\"># 矩阵的最大特征值</span></span><br><span class=\"line\">        self.max_eig_val = np.<span class=\"built_in\">max</span>(self.eig_val)</span><br><span class=\"line\">        <span class=\"comment\"># 矩阵最大特征值对应的特征向量</span></span><br><span class=\"line\">        self.max_eig_vector = self.eig_vector[:, np.argmax(self.eig_val)].real</span><br><span class=\"line\">        <span class=\"comment\"># 矩阵的一致性指标CI</span></span><br><span class=\"line\">        self.CI_val = (self.max_eig_val - self.n) / (self.n - <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"comment\"># 矩阵的一致性比例CR</span></span><br><span class=\"line\">        self.CR_val = self.CI_val / (self.RI_list[self.n - <span class=\"number\">1</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    一致性判断</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">test_consist</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"comment\"># 打印矩阵的一致性指标CI和一致性比例CR</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的CI值为：&quot;</span> + <span class=\"built_in\">str</span>(self.CI_val))</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的CR值为：&quot;</span> + <span class=\"built_in\">str</span>(self.CR_val))</span><br><span class=\"line\">        <span class=\"comment\"># 进行一致性检验判断</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> self.n == <span class=\"number\">2</span>:  <span class=\"comment\"># 当只有两个子因素的情况</span></span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&quot;仅包含两个子因素，不存在一致性问题&quot;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> self.CR_val &lt; <span class=\"number\">0.1</span>:  <span class=\"comment\"># CR值小于0.1，可以通过一致性检验</span></span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的CR值为&quot;</span> + <span class=\"built_in\">str</span>(self.CR_val) + <span class=\"string\">&quot;,通过一致性检验&quot;</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">True</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:  <span class=\"comment\"># CR值大于0.1, 一致性检验不通过</span></span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的CR值为&quot;</span> + <span class=\"built_in\">str</span>(self.CR_val) + <span class=\"string\">&quot;未通过一致性检验&quot;</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    算术平均法求权重</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">cal_weight_by_arithmetic_method</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"comment\"># 求矩阵的每列的和</span></span><br><span class=\"line\">        col_sum = np.<span class=\"built_in\">sum</span>(self.array, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"comment\"># 将判断矩阵按照列归一化</span></span><br><span class=\"line\">        array_normed = self.array / col_sum</span><br><span class=\"line\">        <span class=\"comment\"># 计算权重向量</span></span><br><span class=\"line\">        array_weight = np.<span class=\"built_in\">sum</span>(array_normed, axis=<span class=\"number\">1</span>) / self.n</span><br><span class=\"line\">        <span class=\"comment\"># 打印权重向量</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;算术平均法计算得到的权重向量为：\\n&quot;</span>, array_weight)</span><br><span class=\"line\">        <span class=\"comment\"># 返回权重向量的值</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> array_weight</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    几何平均法求权重</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">cal_weight__by_geometric_method</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"comment\"># 求矩阵的每列的积</span></span><br><span class=\"line\">        col_product = np.product(self.array, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"comment\"># 将得到的积向量的每个分量进行开n次方</span></span><br><span class=\"line\">        array_power = np.power(col_product, <span class=\"number\">1</span> / self.n)</span><br><span class=\"line\">        <span class=\"comment\"># 将列向量归一化</span></span><br><span class=\"line\">        array_weight = array_power / np.<span class=\"built_in\">sum</span>(array_power)</span><br><span class=\"line\">        <span class=\"comment\"># 打印权重向量</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;几何平均法计算得到的权重向量为：\\n&quot;</span>, array_weight)</span><br><span class=\"line\">        <span class=\"comment\"># 返回权重向量的值</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> array_weight</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    特征值法求权重</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">cal_weight__by_eigenvalue_method</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"comment\"># 将矩阵最大特征值对应的特征向量进行归一化处理就得到了权重</span></span><br><span class=\"line\">        array_weight = self.max_eig_vector / np.<span class=\"built_in\">sum</span>(self.max_eig_vector)</span><br><span class=\"line\">        <span class=\"comment\"># 打印权重向量</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;特征值法计算得到的权重向量为：\\n&quot;</span>, array_weight)</span><br><span class=\"line\">        <span class=\"comment\"># 返回权重向量的值</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> array_weight</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&quot;__main__&quot;</span>:</span><br><span class=\"line\">    <span class=\"comment\"># 给出判断矩阵</span></span><br><span class=\"line\">    b = np.array([[<span class=\"number\">1</span>, <span class=\"number\">1</span> / <span class=\"number\">3</span>, <span class=\"number\">1</span> / <span class=\"number\">8</span>], [<span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span> / <span class=\"number\">3</span>], [<span class=\"number\">8</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>]])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 算术平均法求权重</span></span><br><span class=\"line\">    weight1 = AHP(b).cal_weight_by_arithmetic_method()</span><br><span class=\"line\">    <span class=\"comment\"># 几何平均法求权重</span></span><br><span class=\"line\">    weight2 = AHP(b).cal_weight__by_geometric_method()</span><br><span class=\"line\">    <span class=\"comment\"># 特征值法求权重</span></span><br><span class=\"line\">    weight3 = AHP(b).cal_weight__by_eigenvalue_method()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"计算一致性比例cr\"><a class=\"markdownIt-Anchor\" href=\"#计算一致性比例cr\">#</a> 计算一致性比例 CR</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">consistency_ratio</span>(<span class=\"params\">CI, RI</span>):</span><br><span class=\"line\">    CR = CI / RI</span><br><span class=\"line\">    <span class=\"keyword\">return</span> CR</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 假设 A 是你的判断矩阵</span></span><br><span class=\"line\">A = np.array([</span><br><span class=\"line\">    [<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">4</span>],</span><br><span class=\"line\">    [<span class=\"number\">5</span>, <span class=\"number\">1</span>, <span class=\"number\">4</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\">])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算特征值</span></span><br><span class=\"line\">eigenvalues, eigenvectors = np.linalg.eig(A)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 找到最大特征值</span></span><br><span class=\"line\">lambda_max = <span class=\"built_in\">max</span>(eigenvalues)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算一致性指标 CI</span></span><br><span class=\"line\">n = <span class=\"built_in\">len</span>(A)</span><br><span class=\"line\">CI = (lambda_max - n) / (n - <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查找平均随机一致性指标 RI</span></span><br><span class=\"line\">random_matrices = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">500</span>):</span><br><span class=\"line\">    random_matrix = np.random.randint(<span class=\"number\">1</span>, n+<span class=\"number\">1</span>, size=(n, n))</span><br><span class=\"line\">    random_matrices.append(random_matrix)</span><br><span class=\"line\"></span><br><span class=\"line\">average_lambda_max = np.mean([<span class=\"built_in\">max</span>(np.linalg.eig(mat)[<span class=\"number\">0</span>]) <span class=\"keyword\">for</span> mat <span class=\"keyword\">in</span> random_matrices])</span><br><span class=\"line\">RI = (average_lambda_max - n) / (n - <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算一致性比率 CR</span></span><br><span class=\"line\">CR = consistency_ratio(CI, RI)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;最大特征值 (λmax):&quot;</span>, lambda_max)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;一致性指标 CI:&quot;</span>, CI)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;查找平均随机一致性指标 RI:&quot;</span>, RI)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;一致性比率 CR:&quot;</span>, CR)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 判断一致性是否可接受</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> CR &lt; <span class=\"number\">0.10</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的一致性是可以接受的&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的一致性需要适当修正&quot;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"遗传算法\"><a class=\"markdownIt-Anchor\" href=\"#遗传算法\">#</a> 遗传算法</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> matplotlib <span class=\"keyword\">import</span> cm</span><br><span class=\"line\"><span class=\"keyword\">from</span> mpl_toolkits.mplot3d <span class=\"keyword\">import</span> Axes3D</span><br><span class=\"line\"></span><br><span class=\"line\">DNA_SIZE = <span class=\"number\">24</span></span><br><span class=\"line\">POP_SIZE = <span class=\"number\">200</span></span><br><span class=\"line\">CROSSOVER_RATE = <span class=\"number\">0.8</span></span><br><span class=\"line\">MUTATION_RATE = <span class=\"number\">0.005</span></span><br><span class=\"line\">N_GENERATIONS = <span class=\"number\">50</span></span><br><span class=\"line\">X_BOUND = [-<span class=\"number\">3</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\">Y_BOUND = [-<span class=\"number\">3</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">F</span>(<span class=\"params\">x, y</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">3</span> * (<span class=\"number\">1</span> - x) ** <span class=\"number\">2</span> * np.exp(-(x ** <span class=\"number\">2</span>) - (y + <span class=\"number\">1</span>) ** <span class=\"number\">2</span>) - <span class=\"number\">10</span> * (x / <span class=\"number\">5</span> - x ** <span class=\"number\">3</span> - y ** <span class=\"number\">5</span>) * np.exp(</span><br><span class=\"line\">        -x ** <span class=\"number\">2</span> - y ** <span class=\"number\">2</span>) - <span class=\"number\">1</span> / <span class=\"number\">3</span> ** np.exp(-(x + <span class=\"number\">1</span>) ** <span class=\"number\">2</span> - y ** <span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">plot_3d</span>(<span class=\"params\">ax</span>):</span><br><span class=\"line\">    X = np.linspace(*X_BOUND, <span class=\"number\">100</span>)</span><br><span class=\"line\">    Y = np.linspace(*Y_BOUND, <span class=\"number\">100</span>)</span><br><span class=\"line\">    X, Y = np.meshgrid(X, Y)</span><br><span class=\"line\">    Z = F(X, Y)</span><br><span class=\"line\">    ax.plot_surface(X, Y, Z, rstride=<span class=\"number\">1</span>, cstride=<span class=\"number\">1</span>, cmap=cm.coolwarm)</span><br><span class=\"line\">    ax.set_zlim(-<span class=\"number\">10</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\">    ax.set_xlabel(<span class=\"string\">&#x27;x&#x27;</span>)</span><br><span class=\"line\">    ax.set_ylabel(<span class=\"string\">&#x27;y&#x27;</span>)</span><br><span class=\"line\">    ax.set_zlabel(<span class=\"string\">&#x27;z&#x27;</span>)</span><br><span class=\"line\">    plt.pause(<span class=\"number\">3</span>)</span><br><span class=\"line\">    plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">get_fitness</span>(<span class=\"params\">pop</span>):</span><br><span class=\"line\">    x, y = translateDNA(pop)</span><br><span class=\"line\">    pred = F(x, y)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (pred - np.<span class=\"built_in\">min</span>(</span><br><span class=\"line\">        pred)) + <span class=\"number\">1e-3</span>  <span class=\"comment\"># 减去最小的适应度是为了防止适应度出现负数，通过这一步fitness的范围为[0, np.max(pred)-np.min(pred)],最后在加上一个很小的数防止出现为0的适应度</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">translateDNA</span>(<span class=\"params\">pop</span>):  <span class=\"comment\"># pop表示种群矩阵，一行表示一个二进制编码表示的DNA，矩阵的行数为种群数目</span></span><br><span class=\"line\">    x_pop = pop[:, <span class=\"number\">1</span>::<span class=\"number\">2</span>]  <span class=\"comment\"># 奇数列表示X</span></span><br><span class=\"line\">    y_pop = pop[:, ::<span class=\"number\">2</span>]  <span class=\"comment\"># 偶数列表示y</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># pop:(POP_SIZE,DNA_SIZE)*(DNA_SIZE,1) --&gt; (POP_SIZE,1)</span></span><br><span class=\"line\">    x = x_pop.dot(<span class=\"number\">2</span> ** np.arange(DNA_SIZE)[::-<span class=\"number\">1</span>]) / <span class=\"built_in\">float</span>(<span class=\"number\">2</span> ** DNA_SIZE - <span class=\"number\">1</span>) * (X_BOUND[<span class=\"number\">1</span>] - X_BOUND[<span class=\"number\">0</span>]) + X_BOUND[<span class=\"number\">0</span>]</span><br><span class=\"line\">    y = y_pop.dot(<span class=\"number\">2</span> ** np.arange(DNA_SIZE)[::-<span class=\"number\">1</span>]) / <span class=\"built_in\">float</span>(<span class=\"number\">2</span> ** DNA_SIZE - <span class=\"number\">1</span>) * (Y_BOUND[<span class=\"number\">1</span>] - Y_BOUND[<span class=\"number\">0</span>]) + Y_BOUND[<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x, y</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">crossover_and_mutation</span>(<span class=\"params\">pop, CROSSOVER_RATE=<span class=\"number\">0.8</span></span>):</span><br><span class=\"line\">    new_pop = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> father <span class=\"keyword\">in</span> pop:  <span class=\"comment\"># 遍历种群中的每一个个体，将该个体作为父亲</span></span><br><span class=\"line\">        child = father  <span class=\"comment\"># 孩子先得到父亲的全部基因（这里我把一串二进制串的那些0，1称为基因）</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> np.random.rand() &lt; CROSSOVER_RATE:  <span class=\"comment\"># 产生子代时不是必然发生交叉，而是以一定的概率发生交叉</span></span><br><span class=\"line\">            mother = pop[np.random.randint(POP_SIZE)]  <span class=\"comment\"># 再种群中选择另一个个体，并将该个体作为母亲</span></span><br><span class=\"line\">            cross_points = np.random.randint(low=<span class=\"number\">0</span>, high=DNA_SIZE * <span class=\"number\">2</span>)  <span class=\"comment\"># 随机产生交叉的点</span></span><br><span class=\"line\">            child[cross_points:] = mother[cross_points:]  <span class=\"comment\"># 孩子得到位于交叉点后的母亲的基因</span></span><br><span class=\"line\">        mutation(child)  <span class=\"comment\"># 每个后代有一定的机率发生变异</span></span><br><span class=\"line\">        new_pop.append(child)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> new_pop</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">mutation</span>(<span class=\"params\">child, MUTATION_RATE=<span class=\"number\">0.003</span></span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> np.random.rand() &lt; MUTATION_RATE:  <span class=\"comment\"># 以MUTATION_RATE的概率进行变异</span></span><br><span class=\"line\">        mutate_point = np.random.randint(<span class=\"number\">0</span>, DNA_SIZE)  <span class=\"comment\"># 随机产生一个实数，代表要变异基因的位置</span></span><br><span class=\"line\">        child[mutate_point] = child[mutate_point] ^ <span class=\"number\">1</span>  <span class=\"comment\"># 将变异点的二进制为反转</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">select</span>(<span class=\"params\">pop, fitness</span>):  <span class=\"comment\"># nature selection wrt pop&#x27;s fitness</span></span><br><span class=\"line\">    idx = np.random.choice(np.arange(POP_SIZE), size=POP_SIZE, replace=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                           p=(fitness) / (fitness.<span class=\"built_in\">sum</span>()))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> pop[idx]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">print_info</span>(<span class=\"params\">pop</span>):</span><br><span class=\"line\">    fitness = get_fitness(pop)</span><br><span class=\"line\">    max_fitness_index = np.argmax(fitness)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;max_fitness:&quot;</span>, fitness[max_fitness_index])</span><br><span class=\"line\">    x, y = translateDNA(pop)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;最优的基因型：&quot;</span>, pop[max_fitness_index])</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;(x, y):&quot;</span>, (x[max_fitness_index], y[max_fitness_index]))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&quot;__main__&quot;</span>:</span><br><span class=\"line\">    fig = plt.figure()</span><br><span class=\"line\">    ax = Axes3D(fig)</span><br><span class=\"line\">    plt.ion()  <span class=\"comment\"># 将画图模式改为交互模式，程序遇到plt.show不会暂停，而是继续执行</span></span><br><span class=\"line\">    plot_3d(ax)</span><br><span class=\"line\"></span><br><span class=\"line\">    pop = np.random.randint(<span class=\"number\">2</span>, size=(POP_SIZE, DNA_SIZE * <span class=\"number\">2</span>))  <span class=\"comment\"># matrix (POP_SIZE, DNA_SIZE)</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(N_GENERATIONS):  <span class=\"comment\"># 迭代N代</span></span><br><span class=\"line\">        x, y = translateDNA(pop)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">&#x27;sca&#x27;</span> <span class=\"keyword\">in</span> <span class=\"built_in\">locals</span>():</span><br><span class=\"line\">            sca.remove()</span><br><span class=\"line\">        sca = ax.scatter(x, y, F(x, y), c=<span class=\"string\">&#x27;black&#x27;</span>, marker=<span class=\"string\">&#x27;o&#x27;</span>);</span><br><span class=\"line\">        plt.show();</span><br><span class=\"line\">        plt.pause(<span class=\"number\">0.1</span>)</span><br><span class=\"line\">        pop = np.array(crossover_and_mutation(pop, CROSSOVER_RATE))</span><br><span class=\"line\">        <span class=\"comment\"># F_values = F(translateDNA(pop)[0], translateDNA(pop)[1])#x, y --&gt; Z matrix</span></span><br><span class=\"line\">        fitness = get_fitness(pop)</span><br><span class=\"line\">        pop = select(pop, fitness)  <span class=\"comment\"># 选择生成新的种群</span></span><br><span class=\"line\"></span><br><span class=\"line\">    print_info(pop)</span><br><span class=\"line\">    plt.ioff()</span><br><span class=\"line\">    plot_3d(ax)</span><br></pre></td></tr></table></figure>\n<h3 id=\"intgr\"><a class=\"markdownIt-Anchor\" href=\"#intgr\">#</a> intgr</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> scipy <span class=\"keyword\">import</span> integrate</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">Logistic</span>(<span class=\"params\">y,t,para</span>):</span><br><span class=\"line\">    <span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">    Na     : Sum Adult</span></span><br><span class=\"line\"><span class=\"string\">    Nf     : Female</span></span><br><span class=\"line\"><span class=\"string\">    Nm     : Male</span></span><br><span class=\"line\"><span class=\"string\">    Nc     : Cub(No Gender)</span></span><br><span class=\"line\"><span class=\"string\">    N_Fresh: Predator in Fresh Water</span></span><br><span class=\"line\"><span class=\"string\">    N_Sea  : Prey in Sea Water</span></span><br><span class=\"line\"><span class=\"string\">    Alpha1 : Cub Natural mortality rate</span></span><br><span class=\"line\"><span class=\"string\">    Alpha2 : Sea Natural growth rate</span></span><br><span class=\"line\"><span class=\"string\">    Beta1  : Fresh Natural mortality rate</span></span><br><span class=\"line\"><span class=\"string\">    Beta2  : Adult Natural mortality rate</span></span><br><span class=\"line\"><span class=\"string\">    Gamma1 : Fresh Predation rate</span></span><br><span class=\"line\"><span class=\"string\">    Gamma2 : Sea Predation rate</span></span><br><span class=\"line\"><span class=\"string\">    Rou1   : Female immigration/emigration rate</span></span><br><span class=\"line\"><span class=\"string\">    Rou2   : Male immigration/emigration rate</span></span><br><span class=\"line\"><span class=\"string\">    e1,e2  : correction factor</span></span><br><span class=\"line\"><span class=\"string\">    S      : </span></span><br><span class=\"line\"><span class=\"string\">    &#x27;&#x27;&#x27;</span></span><br><span class=\"line\">    Nf,Nm,Nc,N_Fresh,N_Sea = y</span><br><span class=\"line\">    Na = Nf + Nm</span><br><span class=\"line\">    Alpha1,Alpha2,Beta1,Beta2,Gamma1,Gamma2,Rou1,Rou2,e1,e2,S,k = para</span><br><span class=\"line\">    dNcdt = k * Nf - Alpha1 * Nc - Gamma1 * Nc * N_Fresh - (Rou1 + Rou2) * Nc * S</span><br><span class=\"line\">    dNFreshdt = -Beta1 * N_Fresh + e1 * Gamma1 * Nc * N_Fresh</span><br><span class=\"line\">    dNSeadt = Alpha2 * N_Sea - Gamma2 * N_Sea * Na</span><br><span class=\"line\">    <span class=\"comment\">#dNadt = (rou1 + rou2) * Nc * S - Beta2 * Na + e2 * Gamma2 * N_Sea * Na</span></span><br><span class=\"line\">    dNfdt = Rou1 * Nc * S - Beta2 * Nf + e2 * Gamma2 * N_Sea * Nf</span><br><span class=\"line\">    dNmdt = Rou2 * Nc * S - Beta2 * Nm + e1 * Gamma1 * N_Sea * Nm</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [dNfdt,dNmdt,dNcdt,dNFreshdt,dNSeadt]</span><br><span class=\"line\">t = np.linspace(<span class=\"number\">0</span>,<span class=\"number\">2000</span>,<span class=\"number\">2000</span>)</span><br><span class=\"line\">paras = ( </span><br><span class=\"line\">    <span class=\"number\">0.1</span>,<span class=\"number\">0.04</span>,</span><br><span class=\"line\">    <span class=\"number\">0.04</span>,<span class=\"number\">0.005</span>,</span><br><span class=\"line\">    <span class=\"number\">0.00005</span>,<span class=\"number\">8E-7</span>,</span><br><span class=\"line\">    <span class=\"number\">0.2</span>,<span class=\"number\">0.8</span>,</span><br><span class=\"line\">    <span class=\"number\">0.1</span>,<span class=\"number\">0.01</span>,</span><br><span class=\"line\">    <span class=\"number\">0.01</span>,</span><br><span class=\"line\">    <span class=\"number\">2</span></span><br><span class=\"line\">)</span><br><span class=\"line\">y = integrate.odeint(Logistic, [<span class=\"number\">20</span>,<span class=\"number\">2</span>,<span class=\"number\">300</span>,<span class=\"number\">1</span>,<span class=\"number\">100</span>], t,args=(paras,))</span><br><span class=\"line\">plt.plot(t, y[:,<span class=\"number\">0</span>]+y[:,<span class=\"number\">1</span>]+y[:,<span class=\"number\">2</span>]) <span class=\"comment\">#Group Population</span></span><br><span class=\"line\"><span class=\"comment\">#plt.plot(t, y[:,1]/y[:,0]) #Sex ratio</span></span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<h3 id=\"遗传模型\"><a class=\"markdownIt-Anchor\" href=\"#遗传模型\">#</a> 遗传模型</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 参数设定</span></span><br><span class=\"line\">r_M = <span class=\"number\">0.04</span>  <span class=\"comment\"># 雄性海七鳃鳗的繁殖率</span></span><br><span class=\"line\">d_M = <span class=\"number\">0.02</span>  <span class=\"comment\"># 雄性海七鳃鳗的自然死亡率</span></span><br><span class=\"line\">b_M = <span class=\"number\">0.002</span> <span class=\"comment\"># 雄性海七鳃鳗的捕食效率</span></span><br><span class=\"line\"></span><br><span class=\"line\">r_F = <span class=\"number\">0.03</span>  <span class=\"comment\"># 雌性海七鳃鳗的繁殖率</span></span><br><span class=\"line\">d_F = <span class=\"number\">0.02</span>  <span class=\"comment\"># 雌性海七鳃鳗的自然死亡率</span></span><br><span class=\"line\">b_F = <span class=\"number\">0.001</span> <span class=\"comment\"># 雌性海七鳃鳗的捕食效率</span></span><br><span class=\"line\"></span><br><span class=\"line\">r_P = <span class=\"number\">0.1</span>   <span class=\"comment\"># 猎物的自然增长率</span></span><br><span class=\"line\">a = <span class=\"number\">0.001</span>    <span class=\"comment\"># 猎物被捕食的概率</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始条件</span></span><br><span class=\"line\">M0 = <span class=\"number\">78</span>   <span class=\"comment\"># 雄性海七鳃鳗的初始种群数量</span></span><br><span class=\"line\">F0 = <span class=\"number\">22</span>   <span class=\"comment\"># 雌性海七鳃鳗的初始种群数量</span></span><br><span class=\"line\">P0 = <span class=\"number\">300</span>   <span class=\"comment\"># 猎物的初始种群数量</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 时间设定</span></span><br><span class=\"line\">dt = <span class=\"number\">0.05</span>  <span class=\"comment\"># 时间步长</span></span><br><span class=\"line\">T = <span class=\"number\">100</span>    <span class=\"comment\"># 总模拟时间</span></span><br><span class=\"line\">N = <span class=\"built_in\">int</span>(T / dt) <span class=\"comment\"># 总步数</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始化数组</span></span><br><span class=\"line\">M = np.zeros(N)</span><br><span class=\"line\">F = np.zeros(N)</span><br><span class=\"line\">P = np.zeros(N)</span><br><span class=\"line\">M[<span class=\"number\">0</span>] = M0</span><br><span class=\"line\">F[<span class=\"number\">0</span>] = F0</span><br><span class=\"line\">P[<span class=\"number\">0</span>] = P0</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 模拟过程</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> t <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(N - <span class=\"number\">1</span>):</span><br><span class=\"line\">    M[t + <span class=\"number\">1</span>] = M[t] + (r_M * M[t] - d_M * M[t] + b_M * a * P[t] * M[t]) * dt</span><br><span class=\"line\">    F[t + <span class=\"number\">1</span>] = F[t] + (r_F * F[t] - d_F * F[t] + b_F * a * P[t] * F[t]) * dt</span><br><span class=\"line\">    P[t + <span class=\"number\">1</span>] = P[t] + (r_P * P[t] - a * P[t] * (M[t] + F[t])) * dt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘图</span></span><br><span class=\"line\">time = np.linspace(<span class=\"number\">0</span>, T, N)</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">12</span>, <span class=\"number\">6</span>))</span><br><span class=\"line\">plt.plot(time, M, label=<span class=\"string\">&#x27;Male Sea Lampreys&#x27;</span>, color=<span class=\"string\">&#x27;blue&#x27;</span>)</span><br><span class=\"line\">plt.plot(time, F, label=<span class=\"string\">&#x27;Female Sea Lampreys&#x27;</span>, color=<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">plt.plot(time, P, label=<span class=\"string\">&#x27;Prey&#x27;</span>, color=<span class=\"string\">&#x27;grey&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Time&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Population&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Structured Population Model Simulation&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"元胞自动机\"><a class=\"markdownIt-Anchor\" href=\"#元胞自动机\">#</a> 元胞自动机</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义格子大小</span></span><br><span class=\"line\">grid_size = (<span class=\"number\">1000</span>, <span class=\"number\">1000</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始状态</span></span><br><span class=\"line\">initial_bacteria = <span class=\"number\">100</span></span><br><span class=\"line\">initial_grass = <span class=\"number\">50</span></span><br><span class=\"line\">initial_host = <span class=\"number\">1</span></span><br><span class=\"line\">initial_male_eels = <span class=\"number\">20</span>  <span class=\"comment\"># 修改为雄性20</span></span><br><span class=\"line\">initial_female_eels = <span class=\"number\">5</span>  <span class=\"comment\"># 修改为雌性5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 繁殖率</span></span><br><span class=\"line\">bacteria_reproduction_rate = <span class=\"number\">2.0</span></span><br><span class=\"line\">grass_reproduction_rate = <span class=\"number\">1.0</span></span><br><span class=\"line\">eels_reproduction_rate = <span class=\"number\">0.0</span>  <span class=\"comment\"># 初始时七鳃鳗数量不变</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 人类捕捉比例</span></span><br><span class=\"line\">human_capture_rate = np.random.uniform(<span class=\"number\">0.3</span>, <span class=\"number\">0.6</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 迭代次数</span></span><br><span class=\"line\">iterations = <span class=\"number\">20</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始化格子</span></span><br><span class=\"line\">grid = np.zeros(grid_size)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始化各个生物的位置</span></span><br><span class=\"line\">grid[:initial_bacteria] = <span class=\"number\">1</span>  <span class=\"comment\"># 细菌</span></span><br><span class=\"line\">grid[initial_bacteria:initial_bacteria + initial_grass] = <span class=\"number\">2</span>  <span class=\"comment\"># 草</span></span><br><span class=\"line\">grid[-initial_host:] = <span class=\"number\">3</span>  <span class=\"comment\"># 宿主</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始化七鳃鳗的位置和性别</span></span><br><span class=\"line\">grid[np.random.choice(grid_size[<span class=\"number\">0</span>], initial_male_eels, replace=<span class=\"literal\">False</span>)] = <span class=\"number\">4</span>  <span class=\"comment\"># 男性七鳃鳗</span></span><br><span class=\"line\">grid[np.random.choice(grid_size[<span class=\"number\">0</span>], initial_female_eels, replace=<span class=\"literal\">False</span>)] = <span class=\"number\">5</span>  <span class=\"comment\"># 女性七鳃鳗</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 定义函数来执行一代的更新</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">update</span>(<span class=\"params\">grid</span>):</span><br><span class=\"line\">    new_grid = np.zeros_like(grid)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(grid_size[<span class=\"number\">0</span>]):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(grid_size[<span class=\"number\">1</span>]):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> grid[i, j] == <span class=\"number\">1</span>:  <span class=\"comment\"># 细菌</span></span><br><span class=\"line\">                new_grid[i, j] = <span class=\"number\">1</span> <span class=\"keyword\">if</span> np.random.rand() &lt; bacteria_reproduction_rate <span class=\"keyword\">else</span> <span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"keyword\">elif</span> grid[i, j] == <span class=\"number\">2</span>:  <span class=\"comment\"># 草</span></span><br><span class=\"line\">                new_grid[i, j] = <span class=\"number\">2</span> <span class=\"keyword\">if</span> np.random.rand() &lt; grass_reproduction_rate <span class=\"keyword\">else</span> <span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"keyword\">elif</span> grid[i, j] == <span class=\"number\">3</span>:  <span class=\"comment\"># 宿主</span></span><br><span class=\"line\">                new_grid[i, j] = <span class=\"number\">3</span></span><br><span class=\"line\">            <span class=\"keyword\">elif</span> grid[i, j] == <span class=\"number\">4</span> <span class=\"keyword\">or</span> grid[i, j] == <span class=\"number\">5</span>:  <span class=\"comment\"># 七鳃鳗</span></span><br><span class=\"line\">                new_grid[i, j] = grid[i, j]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> new_grid</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 迭代模型</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(iterations):</span><br><span class=\"line\">    grid = update(grid)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制结果</span></span><br><span class=\"line\">plt.imshow(grid, cmap=<span class=\"string\">&#x27;viridis&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&quot;Cellular Automaton after 20 iterations&quot;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"层次权重\"><a class=\"markdownIt-Anchor\" href=\"#层次权重\">#</a> 层次权重</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 假设 A 是判断矩阵，每列代表一个因素</span></span><br><span class=\"line\">A = np.array([</span><br><span class=\"line\">    [<span class=\"number\">1</span>, <span class=\"number\">7</span>, <span class=\"number\">7</span>, <span class=\"number\">7</span>, <span class=\"number\">7</span>, <span class=\"number\">7</span>, <span class=\"number\">7</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>/<span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>/<span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>/<span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>/<span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>/<span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>/<span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>]</span><br><span class=\"line\">])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算权重</span></span><br><span class=\"line\">eigenvalues, eigenvectors = np.linalg.eig(A)</span><br><span class=\"line\">weights = eigenvectors[:, np.argmax(eigenvalues)]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 归一化权重</span></span><br><span class=\"line\">weights /= <span class=\"built_in\">sum</span>(weights)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 假设有三个情况，每个情况在层次结构的权重</span></span><br><span class=\"line\">case_weights = np.array([</span><br><span class=\"line\">    [<span class=\"number\">0.2</span>, <span class=\"number\">0.3</span>, <span class=\"number\">0.5</span>],</span><br><span class=\"line\">    [<span class=\"number\">0.4</span>, <span class=\"number\">0.4</span>, <span class=\"number\">0.2</span>],</span><br><span class=\"line\">    [<span class=\"number\">0.1</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.4</span>]</span><br><span class=\"line\">])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算每个情况的总排序分数</span></span><br><span class=\"line\">total_scores = np.<span class=\"built_in\">sum</span>(case_weights * weights, axis=<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 排序结果</span></span><br><span class=\"line\">sorted_indices = np.argsort(total_scores)[::-<span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输出排序结果</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> idx, score <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>(sorted_indices, total_scores[sorted_indices]):</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;情况 <span class=\"subst\">&#123;idx+<span class=\"number\">1</span>&#125;</span>: 总排序分数 <span class=\"subst\">&#123;score&#125;</span>&quot;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"热力图生成\"><a class=\"markdownIt-Anchor\" href=\"#热力图生成\">#</a> 热力图生成</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Prepare the data in DataFrame</span></span><br><span class=\"line\">data = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;Natural and Anthropogenic Factors&#x27;</span>: [<span class=\"number\">0.998053414</span>, <span class=\"number\">1.124388586</span>, <span class=\"number\">0.505350047</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Food Abundance&#x27;</span>: [<span class=\"number\">0.010752428</span>, <span class=\"number\">0.004509764</span>, <span class=\"number\">0.000233752</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Hatching Environment Conditions&#x27;</span>: [<span class=\"number\">0.006704276</span>, <span class=\"number\">6.56459E-06</span>, <span class=\"number\">0.000756631</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Influence of Other Organisms in Water&#x27;</span>: [<span class=\"number\">2.83968E-08</span>, <span class=\"number\">3.19914E-08</span>, <span class=\"number\">3.24933E-10</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Seasonal Changes&#x27;</span>: [<span class=\"number\">1.07524E-05</span>, <span class=\"number\">0.004509764</span>, <span class=\"number\">3.33414E-06</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Water Quality Conditions&#x27;</span>: [<span class=\"number\">0.006704276</span>, <span class=\"number\">6.56459E-06</span>, <span class=\"number\">0.000756631</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Temperature Influence&#x27;</span>: [<span class=\"number\">1.07524E-05</span>, <span class=\"number\">0.004509764</span>, <span class=\"number\">3.33414E-06</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">index = [<span class=\"string\">&#x27;Population Size&#x27;</span>, <span class=\"string\">&#x27;Gender Ratio Variation&#x27;</span>, <span class=\"string\">&#x27;Birth and Death Rate&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Round the values directly on the DataFrame</span></span><br><span class=\"line\">df = pd.DataFrame(data, index=index).<span class=\"built_in\">round</span>(<span class=\"number\">8</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Increase the figure size for better visibility</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">12</span>, <span class=\"number\">10</span>))</span><br><span class=\"line\">sns.heatmap(df, annot=<span class=\"literal\">True</span>, cmap=<span class=\"string\">&quot;YlGnBu&quot;</span>, linewidths=<span class=\"number\">.5</span>, fmt=<span class=\"string\">&#x27;.8f&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Impact of Factors on the Ecosystem - Heatmap&#x27;</span>)</span><br><span class=\"line\">plt.savefig(<span class=\"string\">&quot;zuizhongrelitu.png&quot;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"calculate-the-maximum-eigenvalue求最大特征值\"><a class=\"markdownIt-Anchor\" href=\"#calculate-the-maximum-eigenvalue求最大特征值\">#</a> calculate the maximum eigenvalue (求最大特征值)</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">consistency_ratio</span>(<span class=\"params\">CI, RI</span>):</span><br><span class=\"line\">    CR = CI / RI</span><br><span class=\"line\">    <span class=\"keyword\">return</span> CR</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 假设 A 是你的判断矩阵</span></span><br><span class=\"line\">A = np.array([</span><br><span class=\"line\">    [<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">4</span>],</span><br><span class=\"line\">    [<span class=\"number\">5</span>, <span class=\"number\">1</span>, <span class=\"number\">4</span>],</span><br><span class=\"line\">    [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\">])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算特征值</span></span><br><span class=\"line\">eigenvalues, eigenvectors = np.linalg.eig(A)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 找到最大特征值</span></span><br><span class=\"line\">lambda_max = <span class=\"built_in\">max</span>(eigenvalues)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算一致性指标 CI</span></span><br><span class=\"line\">n = <span class=\"built_in\">len</span>(A)</span><br><span class=\"line\">CI = (lambda_max - n) / (n - <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查找平均随机一致性指标 RI</span></span><br><span class=\"line\">random_matrices = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">500</span>):</span><br><span class=\"line\">    random_matrix = np.random.randint(<span class=\"number\">1</span>, n+<span class=\"number\">1</span>, size=(n, n))</span><br><span class=\"line\">    random_matrices.append(random_matrix)</span><br><span class=\"line\"></span><br><span class=\"line\">average_lambda_max = np.mean([<span class=\"built_in\">max</span>(np.linalg.eig(mat)[<span class=\"number\">0</span>]) <span class=\"keyword\">for</span> mat <span class=\"keyword\">in</span> random_matrices])</span><br><span class=\"line\">RI = (average_lambda_max - n) / (n - <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算一致性比率 CR</span></span><br><span class=\"line\">CR = consistency_ratio(CI, RI)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;最大特征值 (λmax):&quot;</span>, lambda_max)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;一致性指标 CI:&quot;</span>, CI)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;查找平均随机一致性指标 RI:&quot;</span>, RI)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;一致性比率 CR:&quot;</span>, CR)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 判断一致性是否可接受</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> CR &lt; <span class=\"number\">0.10</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的一致性是可以接受的&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;判断矩阵的一致性需要适当修正&quot;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"第二问雷达图\"><a class=\"markdownIt-Anchor\" href=\"#第二问雷达图\">#</a> 第二问雷达图</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 读取Excel文件</span></span><br><span class=\"line\">file_path = <span class=\"string\">&#x27;shuju.xlsx&#x27;</span></span><br><span class=\"line\">df = pd.read_excel(file_path)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 提取需要的列</span></span><br><span class=\"line\">selected_columns = [<span class=\"string\">&#x27;Predation Threat&#x27;</span>, <span class=\"string\">&#x27;Reproduction Threat&#x27;</span>, <span class=\"string\">&#x27;Overfishing Risk&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"string\">&#x27;Environmental Pressure&#x27;</span>, <span class=\"string\">&#x27;Predation Control&#x27;</span>, <span class=\"string\">&#x27;Food Chain Role&#x27;</span>, <span class=\"string\">&#x27;Adaptability&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建热力图</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">8</span>))</span><br><span class=\"line\">heatmap_data = df[selected_columns + [<span class=\"string\">&#x27;Gender Ratio Variation&#x27;</span>]]</span><br><span class=\"line\">heatmap = sns.heatmap(heatmap_data.corr(), annot=<span class=\"literal\">True</span>, cmap=<span class=\"string\">&quot;coolwarm&quot;</span>, fmt=<span class=\"string\">&quot;.2f&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置热力图的标题</span></span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Correlation Heatmap between Gender Ratio Variation and Other Factors&#x27;</span>)</span><br><span class=\"line\">plt.savefig(<span class=\"string\">&quot;123123.png&quot;</span>)</span><br><span class=\"line\"><span class=\"comment\"># 显示热力图</span></span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a class=\"markdownIt-Anchor\" href=\"#\">#</a> </h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">simulate_ecosystem</span>(<span class=\"params\">initial_ratio</span>):</span><br><span class=\"line\">    generations = <span class=\"number\">50</span></span><br><span class=\"line\">    gender_ratio = np.zeros(generations)</span><br><span class=\"line\">    gender_ratio[<span class=\"number\">0</span>] = initial_ratio</span><br><span class=\"line\"></span><br><span class=\"line\">    predator_population = np.ones(generations)</span><br><span class=\"line\">    reproductive_success = np.ones(generations)</span><br><span class=\"line\">    food_resources = np.ones(generations)</span><br><span class=\"line\">    composite_indicator = np.zeros(generations)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> gen <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, generations):</span><br><span class=\"line\">        gender_ratio[gen] = gender_ratio[gen - <span class=\"number\">1</span>]</span><br><span class=\"line\">        reproductive_success[gen] = reproductive_success[gen - <span class=\"number\">1</span>] - <span class=\"number\">0.005</span> * <span class=\"built_in\">abs</span>(gender_ratio[gen] - <span class=\"number\">0.5</span>)</span><br><span class=\"line\">        predator_population[gen] = predator_population[gen - <span class=\"number\">1</span>] * reproductive_success[gen]</span><br><span class=\"line\">        food_resources[gen] = food_resources[gen - <span class=\"number\">1</span>] - <span class=\"number\">0.02</span></span><br><span class=\"line\">        composite_indicator[gen] = <span class=\"number\">0.4</span> * gender_ratio[gen] + <span class=\"number\">0.3</span> * predator_population[gen] + <span class=\"number\">0.2</span> * reproductive_success[gen] + <span class=\"number\">0.1</span> * food_resources[gen]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> composite_indicator</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">evaluate_population</span>(<span class=\"params\">initial_ratio</span>):</span><br><span class=\"line\">    composite_indicator = simulate_ecosystem(initial_ratio)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 计算各个评价指标</span></span><br><span class=\"line\">    predation_control = np.mean(composite_indicator)</span><br><span class=\"line\">    food_chain_role = np.<span class=\"built_in\">max</span>(composite_indicator)</span><br><span class=\"line\">    ecosystem_provider = np.<span class=\"built_in\">sum</span>(composite_indicator)</span><br><span class=\"line\">    adaptability = np.<span class=\"built_in\">min</span>(composite_indicator)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 模拟其他劣势因素</span></span><br><span class=\"line\">    predation_threat = np.random.uniform(<span class=\"number\">0.1</span>, <span class=\"number\">0.5</span>)</span><br><span class=\"line\">    reproduction_threat = np.random.uniform(<span class=\"number\">0.1</span>, <span class=\"number\">0.5</span>)</span><br><span class=\"line\">    overfishing_risk = np.random.uniform(<span class=\"number\">0.1</span>, <span class=\"number\">0.5</span>)</span><br><span class=\"line\">    environmental_pressure = np.random.uniform(<span class=\"number\">0.1</span>, <span class=\"number\">0.5</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 计算各个评价指标的权重</span></span><br><span class=\"line\">    weight_predation_control = <span class=\"number\">0.2</span></span><br><span class=\"line\">    weight_food_chain_role = <span class=\"number\">0.2</span></span><br><span class=\"line\">    weight_ecosystem_provider = <span class=\"number\">0.2</span></span><br><span class=\"line\">    weight_adaptability = <span class=\"number\">0.1</span></span><br><span class=\"line\">    weight_predation_threat = <span class=\"number\">0.1</span></span><br><span class=\"line\">    weight_reproduction_threat = <span class=\"number\">0.1</span></span><br><span class=\"line\">    weight_overfishing_risk = <span class=\"number\">0.1</span></span><br><span class=\"line\">    weight_environmental_pressure = <span class=\"number\">0.1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 计算综合评分</span></span><br><span class=\"line\">    overall_score = (weight_predation_control * predation_control +</span><br><span class=\"line\">                     weight_food_chain_role * food_chain_role +</span><br><span class=\"line\">                     weight_ecosystem_provider * ecosystem_provider +</span><br><span class=\"line\">                     weight_adaptability * adaptability -</span><br><span class=\"line\">                     weight_predation_threat * predation_threat -</span><br><span class=\"line\">                     weight_reproduction_threat * reproduction_threat -</span><br><span class=\"line\">                     weight_overfishing_risk * overfishing_risk -</span><br><span class=\"line\">                     weight_environmental_pressure * environmental_pressure)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> overall_score</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 循环遍历不同的 initial_ratio</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> initial_ratio <span class=\"keyword\">in</span> np.arange(<span class=\"number\">0</span>, <span class=\"number\">1.05</span>, <span class=\"number\">0.05</span>):</span><br><span class=\"line\">    initial_ratio = <span class=\"built_in\">round</span>(initial_ratio, <span class=\"number\">2</span>)  <span class=\"comment\"># 保留两位小数</span></span><br><span class=\"line\">    overall_score = evaluate_population(initial_ratio)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Initial Ratio: <span class=\"subst\">&#123;initial_ratio&#125;</span>, Overall Score: <span class=\"subst\">&#123;overall_score&#125;</span>&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 存储初始比例和综合评分的列表</span></span><br><span class=\"line\">initial_ratios = []</span><br><span class=\"line\">overall_scores = []</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 循环遍历不同的 initial_ratio</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> initial_ratio <span class=\"keyword\">in</span> np.arange(<span class=\"number\">0</span>, <span class=\"number\">1.05</span>, <span class=\"number\">0.05</span>):</span><br><span class=\"line\">    initial_ratio = <span class=\"built_in\">round</span>(initial_ratio, <span class=\"number\">2</span>)  <span class=\"comment\"># 保留两位小数</span></span><br><span class=\"line\">    overall_score = evaluate_population(initial_ratio)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 存储数据</span></span><br><span class=\"line\">    initial_ratios.append(initial_ratio)</span><br><span class=\"line\">    overall_scores.append(overall_score)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制折线图</span></span><br><span class=\"line\">plt.plot(initial_ratios, overall_scores, marker=<span class=\"string\">&#x27;o&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Overall Score vs Initial Gender Ratio&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Initial Gender Ratio&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Overall Score&#x27;</span>)</span><br><span class=\"line\">plt.grid(<span class=\"literal\">True</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"雅克比矩阵\"><a class=\"markdownIt-Anchor\" href=\"#雅克比矩阵\">#</a> 雅克比矩阵</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> scipy.integrate <span class=\"keyword\">import</span> odeint</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 七鳃鳗的雄性比例范围</span></span><br><span class=\"line\">Male_proportion = np.arange(<span class=\"number\">0.51</span>, <span class=\"number\">0.90</span>, <span class=\"number\">0.01</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> s <span class=\"keyword\">in</span> Male_proportion:</span><br><span class=\"line\">    <span class=\"comment\"># 初始化模型参数</span></span><br><span class=\"line\">    Natural_Growth_Rate = <span class=\"number\">0.65</span>-<span class=\"number\">0.5</span>*<span class=\"built_in\">abs</span>(<span class=\"number\">0.5</span>-s)  <span class=\"comment\"># 七鳃鳗的自然增长率</span></span><br><span class=\"line\">    beta = <span class=\"number\">0.1</span>  <span class=\"comment\"># 七鳃鳗被捕食的概率</span></span><br><span class=\"line\">    gamma = <span class=\"number\">0.5</span> <span class=\"comment\">#捕食者自然死亡率</span></span><br><span class=\"line\">    delta = <span class=\"number\">0.15</span>*(<span class=\"number\">1</span>+beta*<span class=\"number\">0.9</span>)   <span class=\"comment\"># 捕食成功率</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 初始化种群数量</span></span><br><span class=\"line\">    x0 = <span class=\"number\">25</span>  <span class=\"comment\"># 初始七鳃鳗数量</span></span><br><span class=\"line\">    y0 = <span class=\"number\">2</span>  <span class=\"comment\"># 初始捕食者数量</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 设置模拟时间</span></span><br><span class=\"line\">    T = np.arange(<span class=\"number\">0</span>, <span class=\"number\">50</span>, <span class=\"number\">0.1</span>)  <span class=\"comment\"># 从0到50时间单位，每0.1单位计算一次</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 定义洛特卡-沃尔泰拉模型方程</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">lotka_volterra</span>(<span class=\"params\">Y, t</span>):</span><br><span class=\"line\">        prey, predator = Y</span><br><span class=\"line\">        dpreydt = Natural_Growth_Rate * prey - beta * prey * predator</span><br><span class=\"line\">        dpredatordt = delta * prey * predator - gamma * predator</span><br><span class=\"line\">        <span class=\"keyword\">return</span> [dpreydt, dpredatordt]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 微分方程求解</span></span><br><span class=\"line\">    solution = odeint(lotka_volterra, [x0, y0], T)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 绘制结果</span></span><br><span class=\"line\">    plt.figure()</span><br><span class=\"line\">    plt.plot(T, solution[:, <span class=\"number\">0</span>], <span class=\"string\">&#x27;r-&#x27;</span>, label=<span class=\"string\">&#x27;Prey&#x27;</span>)</span><br><span class=\"line\">    plt.plot(T, solution[:, <span class=\"number\">1</span>], <span class=\"string\">&#x27;b-&#x27;</span>, label=<span class=\"string\">&#x27;Predator&#x27;</span>)</span><br><span class=\"line\">    plt.xlabel(<span class=\"string\">&#x27;Time&#x27;</span>)</span><br><span class=\"line\">    plt.ylabel(<span class=\"string\">&#x27;Population&#x27;</span>)</span><br><span class=\"line\">    plt.legend()</span><br><span class=\"line\">    plt.title(<span class=\"string\">&#x27;Lotka-Volterra Predator-Prey Model&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 计算雅可比矩阵</span></span><br><span class=\"line\">    J = np.array([[Natural_Growth_Rate - beta * solution[-<span class=\"number\">1</span>, <span class=\"number\">1</span>], -beta * solution[-<span class=\"number\">1</span>, <span class=\"number\">0</span>]],</span><br><span class=\"line\">                  [delta * solution[-<span class=\"number\">1</span>, <span class=\"number\">1</span>], -gamma - delta * solution[-<span class=\"number\">1</span>, <span class=\"number\">0</span>]]])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 计算特征值</span></span><br><span class=\"line\">    eigenvalues = np.linalg.eigvals(J)</span><br><span class=\"line\">    <span class=\"comment\"># 输出相关信息</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;雄性比例p = <span class=\"subst\">&#123;s&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Eigenvalues: <span class=\"subst\">&#123;eigenvalues&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    <span class=\"comment\"># 判断稳定性</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">all</span>(np.real(eigenvalues) &lt; <span class=\"number\">0</span>):</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;系统稳定：&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;系统不稳定:&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<h3 id=\"雅克比矩阵matlab\"><a class=\"markdownIt-Anchor\" href=\"#雅克比矩阵matlab\">#</a> 雅克比矩阵 MATLAB</h3>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">clear all</span><br><span class=\"line\">clc</span><br><span class=\"line\">close all</span><br><span class=\"line\">s=<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> ii=<span class=\"number\">0.56</span>:<span class=\"number\">0.01</span>:<span class=\"number\">0.85</span> <span class=\"comment\">%七思鳗的雄性比例</span></span><br><span class=\"line\"><span class=\"comment\">% 初始化模型参数</span></span><br><span class=\"line\">alpha = ii<span class=\"number\">-0.15</span>;  <span class=\"comment\">% 食饵的自然增长率</span></span><br><span class=\"line\"><span class=\"built_in\">beta</span> = <span class=\"number\">0.1</span>;  <span class=\"comment\">% 食饵被捕食的概率</span></span><br><span class=\"line\"><span class=\"built_in\">gamma</span> = <span class=\"number\">0.5</span>;  <span class=\"comment\">% 捕食者的自然死亡率</span></span><br><span class=\"line\">delta = <span class=\"number\">0.02</span>; <span class=\"comment\">% 捕食成功率</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 初始化种群数量</span></span><br><span class=\"line\">x0 = <span class=\"number\">25</span>; <span class=\"comment\">% 初始食饵数量</span></span><br><span class=\"line\">y0 = <span class=\"number\">2</span>;  <span class=\"comment\">% 初始捕食者数量</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 设置模拟时间</span></span><br><span class=\"line\">T = <span class=\"number\">0</span>:<span class=\"number\">0.1</span>:<span class=\"number\">50</span>; <span class=\"comment\">% 从0到50时间单位，每0.1单位计算一次</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 定义洛特卡-沃尔泰拉模型方程</span></span><br><span class=\"line\">lotkaVolterra = @(t, Y) [alpha*Y(<span class=\"number\">1</span>) - <span class=\"built_in\">beta</span>*Y(<span class=\"number\">1</span>)*Y(<span class=\"number\">2</span>); </span><br><span class=\"line\">                         delta*Y(<span class=\"number\">1</span>)*Y(<span class=\"number\">2</span>) - <span class=\"built_in\">gamma</span>*Y(<span class=\"number\">2</span>)];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 使用ode45求解器进行模拟</span></span><br><span class=\"line\">[T, Y] = ode45(lotkaVolterra, T, [x0 y0]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 绘制结果</span></span><br><span class=\"line\"><span class=\"built_in\">figure</span>;</span><br><span class=\"line\"><span class=\"built_in\">plot</span>(T, Y(:,<span class=\"number\">1</span>), <span class=\"string\">&#x27;r-&#x27;</span>, T, Y(:,<span class=\"number\">2</span>), <span class=\"string\">&#x27;b-&#x27;</span>);</span><br><span class=\"line\">xlabel(<span class=\"string\">&#x27;Time&#x27;</span>);</span><br><span class=\"line\">ylabel(<span class=\"string\">&#x27;Population&#x27;</span>);</span><br><span class=\"line\"><span class=\"built_in\">legend</span>(<span class=\"string\">&#x27;Prey&#x27;</span>, <span class=\"string\">&#x27;Predator&#x27;</span>);</span><br><span class=\"line\">title(<span class=\"string\">&#x27;Lotka-Volterra Predator-Prey Model&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% </span></span><br><span class=\"line\"><span class=\"comment\">% % 初始化模型参数</span></span><br><span class=\"line\"><span class=\"comment\">% alpha = 0.1;  % 食饵的自然增长率</span></span><br><span class=\"line\"><span class=\"comment\">% beta = 0.02;  % 食饵被捕食的概率</span></span><br><span class=\"line\"><span class=\"comment\">% gamma = 0.3;  % 捕食者的自然死亡率</span></span><br><span class=\"line\"><span class=\"comment\">% delta = 0.01; % 捕食成功率</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 定义洛特卡-沃尔泰拉模型方程</span></span><br><span class=\"line\">lotkaVolterra = @(t, Y) [alpha*Y(<span class=\"number\">1</span>) - <span class=\"built_in\">beta</span>*Y(<span class=\"number\">1</span>)*Y(<span class=\"number\">2</span>); </span><br><span class=\"line\">                         delta*Y(<span class=\"number\">1</span>)*Y(<span class=\"number\">2</span>) - <span class=\"built_in\">gamma</span>*Y(<span class=\"number\">2</span>)];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 设置模拟的初始条件</span></span><br><span class=\"line\">initialConditions = [<span class=\"number\">40</span> <span class=\"number\">9</span>; <span class=\"number\">35</span> <span class=\"number\">5</span>; <span class=\"number\">50</span> <span class=\"number\">20</span>; <span class=\"number\">45</span> <span class=\"number\">15</span>]; <span class=\"comment\">% 不同的初始条件</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 设置模拟时间</span></span><br><span class=\"line\">Tspan = [<span class=\"number\">0</span> <span class=\"number\">50</span>]; <span class=\"comment\">% 从0到50时间单位</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 创建图形窗口</span></span><br><span class=\"line\"><span class=\"built_in\">figure</span>;</span><br><span class=\"line\"><span class=\"built_in\">hold</span> on;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%为每一组初始条件绘制相轨迹</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(initialConditions, <span class=\"number\">1</span>)</span><br><span class=\"line\">    [T, Y] = ode45(lotkaVolterra, Tspan, initialConditions(<span class=\"built_in\">i</span>, :));</span><br><span class=\"line\">    <span class=\"built_in\">plot</span>(Y(:,<span class=\"number\">1</span>), Y(:,<span class=\"number\">2</span>));</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 设置图形属性</span></span><br><span class=\"line\">xlabel(<span class=\"string\">&#x27;Prey Population&#x27;</span>);</span><br><span class=\"line\">ylabel(<span class=\"string\">&#x27;Predator Population&#x27;</span>);</span><br><span class=\"line\">title(<span class=\"string\">&#x27;Phase Trajectories of Lotka-Volterra Model&#x27;</span>);</span><br><span class=\"line\"><span class=\"built_in\">legend</span>(<span class=\"string\">&#x27;Trajectory 1&#x27;</span>, <span class=\"string\">&#x27;Trajectory 2&#x27;</span>, <span class=\"string\">&#x27;Trajectory 3&#x27;</span>, <span class=\"string\">&#x27;Trajectory 4&#x27;</span>);</span><br><span class=\"line\">grid on;</span><br><span class=\"line\"><span class=\"built_in\">hold</span> off;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 初始化模型参数</span></span><br><span class=\"line\"><span class=\"comment\">% 草与兔子的相互作用参数</span></span><br><span class=\"line\"></span><br><span class=\"line\">alpha1 = <span class=\"number\">1</span>;  <span class=\"comment\">% 草的自然增长率</span></span><br><span class=\"line\">beta1 = <span class=\"number\">0.15</span>;  <span class=\"comment\">% 兔子吃草的效率</span></span><br><span class=\"line\">gamma1 = <span class=\"number\">0.5</span>-alpha*<span class=\"number\">0.01</span>;  <span class=\"comment\">% 兔子的自然死亡率，不考虑老鹰捕食的情况</span></span><br><span class=\"line\">delta1 = <span class=\"number\">0.03</span>; <span class=\"comment\">% 兔子因吃草而增加的存活率</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 兔子与老鹰的相互作用参数</span></span><br><span class=\"line\"><span class=\"comment\">% alpha2 = 0.2;  % 兔子的自然增长率，考虑了吃草的影响</span></span><br><span class=\"line\">alpha2=alpha;</span><br><span class=\"line\">beta2 = <span class=\"number\">0.6</span>;  <span class=\"comment\">% 老鹰捕食兔子的效率</span></span><br><span class=\"line\">gamma2 = <span class=\"number\">0.25</span>;  <span class=\"comment\">% 老鹰的自然死亡率</span></span><br><span class=\"line\">delta2 = <span class=\"number\">0.02</span>; <span class=\"comment\">% 老鹰因吃兔子而增加的存活率</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 定义模型方程</span></span><br><span class=\"line\">modelEquations = @(t, Y) [alpha1*Y(<span class=\"number\">1</span>) - beta1*Y(<span class=\"number\">1</span>)*Y(<span class=\"number\">2</span>);  <span class=\"comment\">% 草的增长方程</span></span><br><span class=\"line\">                          beta1*Y(<span class=\"number\">1</span>)*Y(<span class=\"number\">2</span>) - gamma1*Y(<span class=\"number\">2</span>) - beta2*Y(<span class=\"number\">2</span>)*Y(<span class=\"number\">3</span>);  <span class=\"comment\">% 兔子的增长方程</span></span><br><span class=\"line\">                          delta2*Y(<span class=\"number\">2</span>)*Y(<span class=\"number\">3</span>) - gamma2*Y(<span class=\"number\">3</span>)];  <span class=\"comment\">% 老鹰的增长方程</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 设置初始条件</span></span><br><span class=\"line\">initialConditions = [<span class=\"number\">100</span>; <span class=\"number\">10</span>; <span class=\"number\">5</span>];  <span class=\"comment\">% 初始条件：草、兔子、老鹰的数量</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 设置模拟时间</span></span><br><span class=\"line\">Tspan = [<span class=\"number\">0</span> <span class=\"number\">50</span>];  <span class=\"comment\">% 模拟时间从0到100</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 使用ode45求解模型方程</span></span><br><span class=\"line\">[T, Y] = ode45(modelEquations, Tspan, initialConditions);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%绘制结果</span></span><br><span class=\"line\"><span class=\"built_in\">figure</span>;</span><br><span class=\"line\"><span class=\"built_in\">plot</span>(T, Y(:,<span class=\"number\">1</span>), <span class=\"string\">&#x27;g-&#x27;</span>, T, Y(:,<span class=\"number\">2</span>), <span class=\"string\">&#x27;r-&#x27;</span>, T, Y(:,<span class=\"number\">3</span>), <span class=\"string\">&#x27;b-&#x27;</span>);</span><br><span class=\"line\">xlabel(<span class=\"string\">&#x27;Time&#x27;</span>);</span><br><span class=\"line\">ylabel(<span class=\"string\">&#x27;Population&#x27;</span>);</span><br><span class=\"line\"><span class=\"built_in\">legend</span>(<span class=\"string\">&#x27;Grass&#x27;</span>, <span class=\"string\">&#x27;Rabbits&#x27;</span>, <span class=\"string\">&#x27;Eagles&#x27;</span>);</span><br><span class=\"line\">title(<span class=\"string\">&#x27;Ecosystem Model: Grass, Rabbits, and Eagles&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">% 计算雅可比矩阵</span></span><br><span class=\"line\">    J = [alpha1-beta2*Y(<span class=\"keyword\">end</span>,<span class=\"number\">2</span>), -beta1*Y(<span class=\"keyword\">end</span>,<span class=\"number\">1</span>); delta1*Y(<span class=\"keyword\">end</span>,<span class=\"number\">2</span>), -gamma2-delta2*Y(<span class=\"keyword\">end</span>,<span class=\"number\">1</span>)];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">% 计算特征值</span></span><br><span class=\"line\">    eigenvalues = eig(J);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">% 判断稳定性</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> all(<span class=\"built_in\">real</span>(eigenvalues) &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>(<span class=\"string\">&#x27;系统稳定：&#x27;</span>);</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;alpha = &#x27;</span> num2str(alpha)]);</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;雄性比例p=&#x27;</span> num2str(ii)])</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>(<span class=\"string\">&#x27;Eigenvalues:&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"built_in\">length</span>(eigenvalues)</span><br><span class=\"line\">            <span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;Eigenvalue &#x27;</span> num2str(<span class=\"built_in\">j</span>) <span class=\"string\">&#x27;: &#x27;</span> num2str(eigenvalues(<span class=\"built_in\">j</span>))]);</span><br><span class=\"line\">        <span class=\"keyword\">end</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">disp</span>(<span class=\"string\">&#x27;系统不稳定：&#x27;</span>);</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;alpha = &#x27;</span> num2str(alpha)]);</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>(<span class=\"string\">&#x27;Eigenvalues:&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"built_in\">length</span>(eigenvalues)</span><br><span class=\"line\">            <span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;Eigenvalue &#x27;</span> num2str(<span class=\"built_in\">j</span>) <span class=\"string\">&#x27;: &#x27;</span> num2str(eigenvalues(<span class=\"built_in\">j</span>))]);</span><br><span class=\"line\">        <span class=\"keyword\">end</span></span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "Hexo",
                "Front Matter",
                "code",
                "recommendation"
            ]
        }
    ]
}